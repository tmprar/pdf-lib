{"version":3,"sources":["../src/utils/base64.ts","../src/utils/strings.ts","../src/utils/arrays.ts","../src/utils/async.ts","../src/utils/unicode.ts","../src/utils/numbers.ts","../src/utils/errors.ts","../src/utils/objects.ts","../src/utils/validators.ts","../src/utils/pdfDocEncoding.ts","../src/utils/Cache.ts","../src/core/errors.ts","../src/core/syntax/CharCodes.ts","../src/core/PDFContext.ts","../src/core/document/PDFHeader.ts","../src/core/objects/PDFObject.ts","../src/core/objects/PDFNumber.ts","../src/core/objects/PDFArray.ts","../src/core/objects/PDFBool.ts","../src/core/syntax/Delimiters.ts","../src/core/syntax/Whitespace.ts","../src/core/syntax/Irregular.ts","../src/core/objects/PDFName.ts","../src/core/objects/PDFNull.ts","../src/core/objects/PDFDict.ts","../src/core/objects/PDFStream.ts","../src/core/objects/PDFRawStream.ts","../src/core/objects/PDFRef.ts","../src/core/operators/PDFOperator.ts","../src/core/operators/PDFOperatorNames.ts","../src/core/structures/PDFFlateStream.ts","../src/core/structures/PDFContentStream.ts","../src/utils/rng.ts","../src/core/structures/PDFPageLeaf.ts","../src/core/PDFObjectCopier.ts","../src/core/document/PDFCrossRefSection.ts","../src/core/document/PDFTrailer.ts","../src/core/document/PDFTrailerDict.ts","../src/core/structures/PDFObjectStream.ts","../src/core/writers/PDFWriter.ts","../src/core/objects/PDFInvalidObject.ts","../src/core/structures/PDFCrossRefStream.ts","../src/core/writers/PDFStreamWriter.ts","../src/core/embedders/StandardFontEmbedder.ts","../src/core/objects/PDFHexString.ts","../src/core/embedders/CMap.ts","../src/core/embedders/FontFlags.ts","../src/core/objects/PDFString.ts","../src/core/embedders/CustomFontEmbedder.ts","../src/core/embedders/CustomFontSubsetEmbedder.ts","../src/core/embedders/FileEmbedder.ts","../src/core/embedders/JpegEmbedder.ts","../src/utils/png.ts","../src/core/embedders/PngEmbedder.ts","../src/core/streams/Stream.ts","../src/core/streams/DecodeStream.ts","../src/core/streams/Ascii85Stream.ts","../src/core/streams/AsciiHexStream.ts","../src/core/streams/FlateStream.ts","../src/core/streams/LZWStream.ts","../src/core/streams/RunLengthStream.ts","../src/core/streams/decode.ts","../src/core/embedders/PDFPageEmbedder.ts","../src/core/interactive/ViewerPreferences.ts","../src/core/acroform/PDFAcroField.ts","../src/core/annotation/BorderStyle.ts","../src/core/annotation/PDFAnnotation.ts","../src/core/annotation/AppearanceCharacteristics.ts","../src/core/annotation/PDFWidgetAnnotation.ts","../src/core/acroform/PDFAcroTerminal.ts","../src/core/acroform/PDFAcroButton.ts","../src/core/acroform/PDFAcroCheckBox.ts","../src/core/acroform/flags.ts","../src/core/acroform/PDFAcroChoice.ts","../src/core/acroform/PDFAcroComboBox.ts","../src/core/acroform/PDFAcroNonTerminal.ts","../src/core/acroform/PDFAcroSignature.ts","../src/core/acroform/PDFAcroText.ts","../src/core/acroform/PDFAcroPushButton.ts","../src/core/acroform/PDFAcroRadioButton.ts","../src/core/acroform/PDFAcroListBox.ts","../src/core/acroform/utils.ts","../src/core/acroform/PDFAcroForm.ts","../src/core/structures/PDFCatalog.ts","../src/core/structures/PDFPageTree.ts","../src/core/syntax/Numeric.ts","../src/core/parser/BaseParser.ts","../src/core/parser/ByteStream.ts","../src/core/syntax/Keywords.ts","../src/core/parser/PDFObjectParser.ts","../src/core/parser/PDFObjectStreamParser.ts","../src/core/parser/PDFXRefStreamParser.ts","../src/core/parser/PDFParser.ts","../src/core/annotation/flags.ts","../src/api/objects.ts","../src/api/rotations.ts","../src/api/operators.ts","../src/api/colors.ts","../src/api/svgPath.ts","../src/api/operations.ts","../src/api/errors.ts","../src/api/text/alignment.ts","../src/api/text/layout.ts","../src/api/form/appearances.ts","../src/api/PDFEmbeddedPage.ts","../src/api/PDFFont.ts","../src/api/PDFImage.ts","../src/api/image/alignment.ts","../src/api/form/PDFField.ts","../src/api/form/PDFCheckBox.ts","../src/api/form/PDFDropdown.ts","../src/api/form/PDFOptionList.ts","../src/api/form/PDFRadioGroup.ts","../src/api/form/PDFSignature.ts","../src/api/form/PDFTextField.ts","../src/api/StandardFonts.ts","../src/api/form/PDFForm.ts","../src/api/sizes.ts","../src/api/PDFDocumentOptions.ts","../src/api/PDFEmbeddedFile.ts","../src/api/PDFJavaScript.ts","../src/core/embedders/JavaScriptEmbedder.ts","../src/api/PDFDocument.ts","../src/api/PDFPageOptions.ts","../src/api/PDFPage.ts","../src/api/form/PDFButton.ts"],"sourcesContent":["/*\n * The `chars`, `lookup`, `encode`, and `decode` members of this file are\n * licensed under the following:\n *\n *     base64-arraybuffer\n *     https://github.com/niklasvh/base64-arraybuffer\n *\n *     Copyright (c) 2012 Niklas von Hertzen\n *     Licensed under the MIT license.\n *\n */\n\nconst chars =\n  'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n// Use a lookup table to find the index.\nconst lookup = new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n  lookup[chars.charCodeAt(i)] = i;\n}\n\nexport const encodeToBase64 = (bytes: Uint8Array): string => {\n  let base64 = '';\n  const len = bytes.length;\n  for (let i = 0; i < len; i += 3) {\n    base64 += chars[bytes[i] >> 2];\n    base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n    base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n    base64 += chars[bytes[i + 2] & 63];\n  }\n\n  if (len % 3 === 2) {\n    base64 = base64.substring(0, base64.length - 1) + '=';\n  } else if (len % 3 === 1) {\n    base64 = base64.substring(0, base64.length - 2) + '==';\n  }\n\n  return base64;\n};\n\nexport const decodeFromBase64 = (base64: string): Uint8Array => {\n  let bufferLength = base64.length * 0.75;\n  const len = base64.length;\n  let i;\n  let p = 0;\n  let encoded1;\n  let encoded2;\n  let encoded3;\n  let encoded4;\n\n  if (base64[base64.length - 1] === '=') {\n    bufferLength--;\n    if (base64[base64.length - 2] === '=') {\n      bufferLength--;\n    }\n  }\n\n  const bytes = new Uint8Array(bufferLength);\n\n  for (i = 0; i < len; i += 4) {\n    encoded1 = lookup[base64.charCodeAt(i)];\n    encoded2 = lookup[base64.charCodeAt(i + 1)];\n    encoded3 = lookup[base64.charCodeAt(i + 2)];\n    encoded4 = lookup[base64.charCodeAt(i + 3)];\n\n    bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n    bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n    bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n  }\n\n  return bytes;\n};\n\n// This regex is designed to be as flexible as possible. It will parse certain\n// invalid data URIs.\nconst DATA_URI_PREFIX_REGEX =\n  /^(data)?:?([\\w\\/\\+]+)?;?(charset=[\\w-]+|base64)?.*,/i;\n\n/**\n * If the `dataUri` input is a data URI, then the data URI prefix must not be\n * longer than 100 characters, or this function will fail to decode it.\n *\n * @param dataUri a base64 data URI or plain base64 string\n * @returns a Uint8Array containing the decoded input\n */\nexport const decodeFromBase64DataUri = (dataUri: string): Uint8Array => {\n  const trimmedUri = dataUri.trim();\n\n  const prefix = trimmedUri.substring(0, 100);\n  const res = prefix.match(DATA_URI_PREFIX_REGEX);\n\n  // Assume it's not a data URI - just a plain base64 string\n  if (!res) return decodeFromBase64(trimmedUri);\n\n  // Remove the data URI prefix and parse the remainder as a base64 string\n  const [fullMatch] = res;\n  const data = trimmedUri.substring(fullMatch.length);\n\n  return decodeFromBase64(data);\n};\n","export const toCharCode = (character: string) => character.charCodeAt(0);\n\nexport const toCodePoint = (character: string) => character.codePointAt(0);\n\nexport const toHexStringOfMinLength = (num: number, minLength: number) =>\n  padStart(num.toString(16), minLength, '0').toUpperCase();\n\nexport const toHexString = (num: number) => toHexStringOfMinLength(num, 2);\n\nexport const charFromCode = (code: number) => String.fromCharCode(code);\n\nexport const charFromHexCode = (hex: string) => charFromCode(parseInt(hex, 16));\n\nexport const padStart = (value: string, length: number, padChar: string) => {\n  let padding = '';\n  for (let idx = 0, len = length - value.length; idx < len; idx++) {\n    padding += padChar;\n  }\n  return padding + value;\n};\n\nexport const copyStringIntoBuffer = (\n  str: string,\n  buffer: Uint8Array,\n  offset: number,\n): number => {\n  const length = str.length;\n  for (let idx = 0; idx < length; idx++) {\n    buffer[offset++] = str.charCodeAt(idx);\n  }\n  return length;\n};\n\nexport const addRandomSuffix = (prefix: string, suffixLength = 4) =>\n  `${prefix}-${Math.floor(Math.random() * 10 ** suffixLength)}`;\n\nexport const escapeRegExp = (str: string) =>\n  str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n\nexport const cleanText = (text: string) =>\n  text.replace(/\\t|\\u0085|\\u2028|\\u2029/g, '    ').replace(/[\\b\\v]/g, '');\n\nexport const escapedNewlineChars = ['\\\\n', '\\\\f', '\\\\r', '\\\\u000B'];\n\nexport const newlineChars = ['\\n', '\\f', '\\r', '\\u000B'];\n\nexport const isNewlineChar = (text: string) => /^[\\n\\f\\r\\u000B]$/.test(text);\n\nexport const lineSplit = (text: string) => text.split(/[\\n\\f\\r\\u000B]/);\n\nexport const mergeLines = (text: string) =>\n  text.replace(/[\\n\\f\\r\\u000B]/g, ' ');\n\n// JavaScript's String.charAt() method doesn work on strings containing UTF-16\n// characters (with high and low surrogate pairs), such as 💩 (poo emoji). This\n// `charAtIndex()` function does.\n//\n// Credit: https://github.com/mathiasbynens/String.prototype.at/blob/master/at.js#L14-L48\nexport const charAtIndex = (text: string, index: number): [string, number] => {\n  // Get the first code unit and code unit value\n  const cuFirst = text.charCodeAt(index);\n  let cuSecond: number;\n  const nextIndex = index + 1;\n  let length = 1;\n  if (\n    // Check if it's the start of a surrogate pair.\n    cuFirst >= 0xd800 &&\n    cuFirst <= 0xdbff && // high surrogate\n    text.length > nextIndex // there is a next code unit\n  ) {\n    cuSecond = text.charCodeAt(nextIndex);\n    if (cuSecond >= 0xdc00 && cuSecond <= 0xdfff) length = 2; // low surrogate\n  }\n  return [text.slice(index, index + length), length];\n};\n\nexport const charSplit = (text: string) => {\n  const chars: string[] = [];\n\n  for (let idx = 0, len = text.length; idx < len; ) {\n    const [c, cLen] = charAtIndex(text, idx);\n    chars.push(c);\n    idx += cLen;\n  }\n\n  return chars;\n};\n\nconst buildWordBreakRegex = (wordBreaks: string[]) => {\n  const newlineCharUnion = escapedNewlineChars.join('|');\n\n  const escapedRules: string[] = ['$'];\n  for (let idx = 0, len = wordBreaks.length; idx < len; idx++) {\n    const wordBreak = wordBreaks[idx];\n    if (isNewlineChar(wordBreak)) {\n      throw new TypeError(`\\`wordBreak\\` must not include ${newlineCharUnion}`);\n    }\n    escapedRules.push(wordBreak === '' ? '.' : escapeRegExp(wordBreak));\n  }\n\n  const breakRules = escapedRules.join('|');\n  return new RegExp(`(${newlineCharUnion})|((.*?)(${breakRules}))`, 'gm');\n};\n\nexport const breakTextIntoLines = (\n  text: string,\n  wordBreaks: string[],\n  maxWidth: number,\n  computeWidthOfText: (t: string) => number,\n): string[] => {\n  const regex = buildWordBreakRegex(wordBreaks);\n\n  const words = cleanText(text).match(regex)!;\n\n  let currLine = '';\n  let currWidth = 0;\n  const lines: string[] = [];\n\n  const pushCurrLine = () => {\n    if (currLine !== '') lines.push(currLine);\n    currLine = '';\n    currWidth = 0;\n  };\n\n  for (let idx = 0, len = words.length; idx < len; idx++) {\n    const word = words[idx];\n    if (isNewlineChar(word)) {\n      pushCurrLine();\n    } else {\n      const width = computeWidthOfText(word);\n      if (currWidth + width > maxWidth) pushCurrLine();\n      currLine += word;\n      currWidth += width;\n    }\n  }\n  pushCurrLine();\n\n  return lines;\n};\n\n// See section \"7.9.4 Dates\" of the PDF specification\nconst dateRegex =\n  /^D:(\\d\\d\\d\\d)(\\d\\d)?(\\d\\d)?(\\d\\d)?(\\d\\d)?(\\d\\d)?([+\\-Z])?(\\d\\d)?'?(\\d\\d)?'?$/;\n\nexport const parseDate = (dateStr: string): Date | undefined => {\n  const match = dateStr.match(dateRegex);\n\n  if (!match) return undefined;\n\n  const [\n    ,\n    year,\n    month = '01',\n    day = '01',\n    hours = '00',\n    mins = '00',\n    secs = '00',\n    offsetSign = 'Z',\n    offsetHours = '00',\n    offsetMins = '00',\n  ] = match;\n\n  // http://www.ecma-international.org/ecma-262/5.1/#sec-15.9.1.15\n  const tzOffset =\n    offsetSign === 'Z' ? 'Z' : `${offsetSign}${offsetHours}:${offsetMins}`;\n  const date = new Date(\n    `${year}-${month}-${day}T${hours}:${mins}:${secs}${tzOffset}`,\n  );\n\n  return date;\n};\n\nexport const findLastMatch = (value: string, regex: RegExp) => {\n  let position = 0;\n  let lastMatch: RegExpMatchArray | undefined;\n  while (position < value.length) {\n    const match = value.substring(position).match(regex);\n    if (!match) return { match: lastMatch, pos: position };\n    lastMatch = match;\n    position += (match.index ?? 0) + match[0].length;\n  }\n  return { match: lastMatch, pos: position };\n};\n","import { decodeFromBase64DataUri } from 'src/utils/base64';\nimport { charFromCode } from 'src/utils/strings';\n\nexport const last = <T>(array: T[]): T => array[array.length - 1];\n\n// export const dropLast = <T>(array: T[]): T[] =>\n// array.slice(0, array.length - 1);\n\nexport const typedArrayFor = (value: string | Uint8Array): Uint8Array => {\n  if (value instanceof Uint8Array) return value;\n  const length = value.length;\n  const typedArray = new Uint8Array(length);\n  for (let idx = 0; idx < length; idx++) {\n    typedArray[idx] = value.charCodeAt(idx);\n  }\n  return typedArray;\n};\n\nexport const mergeIntoTypedArray = (...arrays: (string | Uint8Array)[]) => {\n  const arrayCount = arrays.length;\n\n  const typedArrays: Uint8Array[] = [];\n  for (let idx = 0; idx < arrayCount; idx++) {\n    const element = arrays[idx];\n    typedArrays[idx] =\n      element instanceof Uint8Array ? element : typedArrayFor(element);\n  }\n\n  let totalSize = 0;\n  for (let idx = 0; idx < arrayCount; idx++) {\n    totalSize += arrays[idx].length;\n  }\n\n  const merged = new Uint8Array(totalSize);\n  let offset = 0;\n  for (let arrIdx = 0; arrIdx < arrayCount; arrIdx++) {\n    const arr = typedArrays[arrIdx];\n    for (let byteIdx = 0, arrLen = arr.length; byteIdx < arrLen; byteIdx++) {\n      merged[offset++] = arr[byteIdx];\n    }\n  }\n\n  return merged;\n};\n\nexport const mergeUint8Arrays = (arrays: Uint8Array[]): Uint8Array => {\n  let totalSize = 0;\n  for (let idx = 0, len = arrays.length; idx < len; idx++) {\n    totalSize += arrays[idx].length;\n  }\n\n  const mergedBuffer = new Uint8Array(totalSize);\n  let offset = 0;\n  for (let idx = 0, len = arrays.length; idx < len; idx++) {\n    const array = arrays[idx];\n    mergedBuffer.set(array, offset);\n    offset += array.length;\n  }\n\n  return mergedBuffer;\n};\n\nexport const arrayAsString = (array: Uint8Array | number[]): string => {\n  let str = '';\n  for (let idx = 0, len = array.length; idx < len; idx++) {\n    str += charFromCode(array[idx]);\n  }\n  return str;\n};\n\nexport const byAscendingId = <T extends { id: any }>(a: T, b: T) => a.id - b.id;\n\nexport const sortedUniq = <T>(array: T[], indexer: (elem: T) => any): T[] => {\n  const uniq: T[] = [];\n\n  for (let idx = 0, len = array.length; idx < len; idx++) {\n    const curr = array[idx];\n    const prev = array[idx - 1];\n    if (idx === 0 || indexer(curr) !== indexer(prev)) {\n      uniq.push(curr);\n    }\n  }\n\n  return uniq;\n};\n\n// Arrays and TypedArrays in JS both have .reverse() methods, which would seem\n// to negate the need for this function. However, not all runtimes support this\n// method (e.g. React Native). This function compensates for that fact.\nexport const reverseArray = (array: Uint8Array) => {\n  const arrayLen = array.length;\n  for (let idx = 0, len = Math.floor(arrayLen / 2); idx < len; idx++) {\n    const leftIdx = idx;\n    const rightIdx = arrayLen - idx - 1;\n    const temp = array[idx];\n\n    array[leftIdx] = array[rightIdx];\n    array[rightIdx] = temp;\n  }\n  return array;\n};\n\nexport const sum = (array: number[] | Uint8Array): number => {\n  let total = 0;\n  for (let idx = 0, len = array.length; idx < len; idx++) {\n    total += array[idx];\n  }\n  return total;\n};\n\nexport const range = (start: number, end: number): number[] => {\n  const arr = new Array(end - start);\n  for (let idx = 0, len = arr.length; idx < len; idx++) {\n    arr[idx] = start + idx;\n  }\n  return arr;\n};\n\nexport const pluckIndices = <T>(arr: T[], indices: number[]) => {\n  const plucked = new Array<T>(indices.length);\n  for (let idx = 0, len = indices.length; idx < len; idx++) {\n    plucked[idx] = arr[indices[idx]];\n  }\n  return plucked;\n};\n\nexport const canBeConvertedToUint8Array = (\n  input: any,\n): input is string | ArrayBuffer | Uint8Array =>\n  input instanceof Uint8Array ||\n  input instanceof ArrayBuffer ||\n  typeof input === 'string';\n\nexport const toUint8Array = (input: string | ArrayBuffer | Uint8Array) => {\n  if (typeof input === 'string') {\n    return decodeFromBase64DataUri(input);\n  } else if (input instanceof ArrayBuffer) {\n    return new Uint8Array(input);\n  } else if (input instanceof Uint8Array) {\n    return input;\n  } else {\n    throw new TypeError(\n      '`input` must be one of `string | ArrayBuffer | Uint8Array`',\n    );\n  }\n};\n","/**\n * Returns a Promise that resolves after at least one tick of the\n * Macro Task Queue occurs.\n */\nexport const waitForTick = (): Promise<void> =>\n  new Promise((resolve) => {\n    setTimeout(() => resolve(), 0);\n  });\n","import { toHexString } from 'src/utils/strings';\n\n/**\n * Encodes a string to UTF-8.\n *\n * @param input The string to be encoded.\n * @param byteOrderMark Whether or not a byte order marker (BOM) should be added\n *                      to the start of the encoding. (default `true`)\n * @returns A Uint8Array containing the UTF-8 encoding of the input string.\n *\n * -----------------------------------------------------------------------------\n *\n * JavaScript strings are composed of Unicode code points. Code points are\n * integers in the range 0 to 1,114,111 (0x10FFFF). When serializing a string,\n * it must be encoded as a sequence of words. A word is typically 8, 16, or 32\n * bytes in size. As such, Unicode defines three encoding forms: UTF-8, UTF-16,\n * and UTF-32. These encoding forms are described in the Unicode standard [1].\n * This function implements the UTF-8 encoding form.\n *\n * -----------------------------------------------------------------------------\n *\n * In UTF-8, each code point is mapped to a sequence of 1, 2, 3, or 4 bytes.\n * Note that the logic which defines this mapping is slightly convoluted, and\n * not as straightforward as the mapping logic for UTF-16 or UTF-32. The UTF-8\n * mapping logic is as follows [2]:\n *\n * • If a code point is in the range U+0000..U+007F, then view it as a 7-bit\n *   integer: 0bxxxxxxx. Map the code point to 1 byte with the first high order\n *   bit set to 0:\n *\n *       b1=0b0xxxxxxx\n *\n * • If a code point is in the range U+0080..U+07FF, then view it as an 11-bit\n *   integer: 0byyyyyxxxxxx. Map the code point to 2 bytes with the first 5 bits\n *   of the code point stored in the first byte, and the last 6 bits stored in\n *   the second byte:\n *\n *       b1=0b110yyyyy    b2=0b10xxxxxx\n *\n * • If a code point is in the range U+0800..U+FFFF, then view it as a 16-bit\n *   integer, 0bzzzzyyyyyyxxxxxx. Map the code point to 3 bytes with the first\n *   4 bits stored in the first byte, the next 6 bits stored in the second byte,\n *   and the last 6 bits in the third byte:\n *\n *       b1=0b1110zzzz    b2=0b10yyyyyy    b3=0b10xxxxxx\n *\n * • If a code point is in the range U+10000...U+10FFFF, then view it as a\n *   21-bit integer, 0bvvvzzzzzzyyyyyyxxxxxx. Map the code point to 4 bytes with\n *   the first 3 bits stored in the first byte, the next 6 bits stored in the\n *   second byte, the next 6 bits stored in the third byte, and the last 6 bits\n *   stored in the fourth byte:\n *\n *       b1=0b11110xxx    b2=0b10zzzzzz    b3=0b10yyyyyy    b4=0b10xxxxxx\n *\n * -----------------------------------------------------------------------------\n *\n * It is important to note, when iterating through the code points of a string\n * in JavaScript, that if a character is encoded as a surrogate pair it will\n * increase the string's length by 2 instead of 1 [4]. For example:\n *\n * ```\n * > 'a'.length\n * 1\n * > '💩'.length\n * 2\n * > '語'.length\n * 1\n * > 'a💩語'.length\n * 4\n * ```\n *\n * The results of the above example are explained by the fact that the\n * characters 'a' and '語' are not represented by surrogate pairs, but '💩' is.\n *\n * Because of this idiosyncrasy in JavaScript's string implementation and APIs,\n * we must \"jump\" an extra index after encoding a character as a surrogate\n * pair. In practice, this means we must increment the index of our for loop by\n * 2 if we encode a surrogate pair, and 1 in all other cases.\n *\n * -----------------------------------------------------------------------------\n *\n * References:\n *   - [1] https://www.unicode.org/versions/Unicode12.0.0/UnicodeStandard-12.0.pdf\n *         3.9  Unicode Encoding Forms - UTF-8\n *   - [2] http://www.herongyang.com/Unicode/UTF-8-UTF-8-Encoding.html\n *   - [3] http://www.herongyang.com/Unicode/UTF-8-UTF-8-Encoding-Algorithm.html\n *   - [4] https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/length#Description\n *\n */\nexport const utf8Encode = (input: string, byteOrderMark = true): Uint8Array => {\n  const encoded = [];\n\n  if (byteOrderMark) encoded.push(0xef, 0xbb, 0xbf);\n\n  for (let idx = 0, len = input.length; idx < len; ) {\n    const codePoint = input.codePointAt(idx)!;\n\n    // One byte encoding\n    if (codePoint < 0x80) {\n      const byte1 = codePoint & 0x7f;\n      encoded.push(byte1);\n      idx += 1;\n    }\n\n    // Two byte encoding\n    else if (codePoint < 0x0800) {\n      const byte1 = ((codePoint >> 6) & 0x1f) | 0xc0;\n      const byte2 = (codePoint & 0x3f) | 0x80;\n      encoded.push(byte1, byte2);\n      idx += 1;\n    }\n\n    // Three byte encoding\n    else if (codePoint < 0x010000) {\n      const byte1 = ((codePoint >> 12) & 0x0f) | 0xe0;\n      const byte2 = ((codePoint >> 6) & 0x3f) | 0x80;\n      const byte3 = (codePoint & 0x3f) | 0x80;\n      encoded.push(byte1, byte2, byte3);\n      idx += 1;\n    }\n\n    // Four byte encoding (surrogate pair)\n    else if (codePoint < 0x110000) {\n      const byte1 = ((codePoint >> 18) & 0x07) | 0xf0;\n      const byte2 = ((codePoint >> 12) & 0x3f) | 0x80;\n      const byte3 = ((codePoint >> 6) & 0x3f) | 0x80;\n      const byte4 = ((codePoint >> 0) & 0x3f) | 0x80;\n      encoded.push(byte1, byte2, byte3, byte4);\n      idx += 2;\n    }\n\n    // Should never reach this case\n    else throw new Error(`Invalid code point: 0x${toHexString(codePoint)}`);\n  }\n\n  return new Uint8Array(encoded);\n};\n\n/**\n * Encodes a string to UTF-16.\n *\n * @param input The string to be encoded.\n * @param byteOrderMark Whether or not a byte order marker (BOM) should be added\n *                      to the start of the encoding. (default `true`)\n * @returns A Uint16Array containing the UTF-16 encoding of the input string.\n *\n * -----------------------------------------------------------------------------\n *\n * JavaScript strings are composed of Unicode code points. Code points are\n * integers in the range 0 to 1,114,111 (0x10FFFF). When serializing a string,\n * it must be encoded as a sequence of words. A word is typically 8, 16, or 32\n * bytes in size. As such, Unicode defines three encoding forms: UTF-8, UTF-16,\n * and UTF-32. These encoding forms are described in the Unicode standard [1].\n * This function implements the UTF-16 encoding form.\n *\n * -----------------------------------------------------------------------------\n *\n * In UTF-16, each code point is mapped to one or two 16-bit integers. The\n * UTF-16 mapping logic is as follows [2]:\n *\n * • If a code point is in the range U+0000..U+FFFF, then map the code point to\n *   a 16-bit integer with the most significant byte first.\n *\n * • If a code point is in the range U+10000..U+10000, then map the code point\n *   to two 16-bit integers. The first integer should contain the high surrogate\n *   and the second integer should contain the low surrogate. Both surrogates\n *   should be written with the most significant byte first.\n *\n * -----------------------------------------------------------------------------\n *\n * It is important to note, when iterating through the code points of a string\n * in JavaScript, that if a character is encoded as a surrogate pair it will\n * increase the string's length by 2 instead of 1 [4]. For example:\n *\n * ```\n * > 'a'.length\n * 1\n * > '💩'.length\n * 2\n * > '語'.length\n * 1\n * > 'a💩語'.length\n * 4\n * ```\n *\n * The results of the above example are explained by the fact that the\n * characters 'a' and '語' are not represented by surrogate pairs, but '💩' is.\n *\n * Because of this idiosyncrasy in JavaScript's string implementation and APIs,\n * we must \"jump\" an extra index after encoding a character as a surrogate\n * pair. In practice, this means we must increment the index of our for loop by\n * 2 if we encode a surrogate pair, and 1 in all other cases.\n *\n * -----------------------------------------------------------------------------\n *\n * References:\n *   - [1] https://www.unicode.org/versions/Unicode12.0.0/UnicodeStandard-12.0.pdf\n *         3.9  Unicode Encoding Forms - UTF-8\n *   - [2] http://www.herongyang.com/Unicode/UTF-16-UTF-16-Encoding.html\n *   - [3] https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/length#Description\n *\n */\nexport const utf16Encode = (\n  input: string,\n  byteOrderMark = true,\n): Uint16Array => {\n  const encoded = [];\n\n  if (byteOrderMark) encoded.push(0xfeff);\n\n  for (let idx = 0, len = input.length; idx < len; ) {\n    const codePoint = input.codePointAt(idx)!;\n\n    // Two byte encoding\n    if (codePoint < 0x010000) {\n      encoded.push(codePoint);\n      idx += 1;\n    }\n\n    // Four byte encoding (surrogate pair)\n    else if (codePoint < 0x110000) {\n      encoded.push(highSurrogate(codePoint), lowSurrogate(codePoint));\n      idx += 2;\n    }\n\n    // Should never reach this case\n    else throw new Error(`Invalid code point: 0x${toHexString(codePoint)}`);\n  }\n\n  return new Uint16Array(encoded);\n};\n\n/**\n * Returns `true` if the `codePoint` is within the\n * Basic Multilingual Plane (BMP). Code points inside the BMP are not encoded\n * with surrogate pairs.\n * @param codePoint The code point to be evaluated.\n *\n * Reference: https://en.wikipedia.org/wiki/UTF-16#Description\n */\nexport const isWithinBMP = (codePoint: number) =>\n  codePoint >= 0 && codePoint <= 0xffff;\n\n/**\n * Returns `true` if the given `codePoint` is valid and must be represented\n * with a surrogate pair when encoded.\n * @param codePoint The code point to be evaluated.\n *\n * Reference: https://en.wikipedia.org/wiki/UTF-16#Description\n */\nexport const hasSurrogates = (codePoint: number) =>\n  codePoint >= 0x010000 && codePoint <= 0x10ffff;\n\n// From Unicode 3.0 spec, section 3.7:\n//   http://unicode.org/versions/Unicode3.0.0/ch03.pdf\nexport const highSurrogate = (codePoint: number) =>\n  Math.floor((codePoint - 0x10000) / 0x400) + 0xd800;\n\n// From Unicode 3.0 spec, section 3.7:\n//   http://unicode.org/versions/Unicode3.0.0/ch03.pdf\nexport const lowSurrogate = (codePoint: number) =>\n  ((codePoint - 0x10000) % 0x400) + 0xdc00;\n\nenum ByteOrder {\n  BigEndian = 'BigEndian',\n  LittleEndian = 'LittleEndian'\n}\n\nconst REPLACEMENT = '�'.codePointAt(0)!;\n\n/**\n * Decodes a Uint8Array of data to a string using UTF-16.\n *\n * Note that this function attempts to recover from erronous input by\n * inserting the replacement character (�) to mark invalid code points\n * and surrogate pairs.\n *\n * @param input A Uint8Array containing UTF-16 encoded data\n * @param byteOrderMark Whether or not a byte order marker (BOM) should be read\n *                      at the start of the encoding. (default `true`)\n * @returns The decoded string.\n */\nexport const utf16Decode = (\n  input: Uint8Array,\n  byteOrderMark = true,\n): string => {\n  // Need at least 2 bytes of data in UTF-16 encodings\n  if (input.length <= 1) return String.fromCodePoint(REPLACEMENT);\n\n  const byteOrder = byteOrderMark ? readBOM(input) : ByteOrder.BigEndian;\n\n  // Skip byte order mark if needed\n  let idx = byteOrderMark ? 2 : 0;\n\n  const codePoints: number[] = [];\n\n  while (input.length - idx >= 2) {\n    const first = decodeValues(input[idx++], input[idx++], byteOrder);\n\n    if (isHighSurrogate(first)) {\n      if (input.length - idx < 2) {\n        // Need at least 2 bytes left for the low surrogate that is required\n        codePoints.push(REPLACEMENT);\n      } else {\n        const second = decodeValues(input[idx++], input[idx++], byteOrder);\n        if (isLowSurrogate(second)) {\n          codePoints.push(first, second);\n        } else {\n          // Low surrogates should always follow high surrogates\n          codePoints.push(REPLACEMENT);\n        }\n      }\n    } else if (isLowSurrogate(first)) {\n      // High surrogates should always come first since `decodeValues()`\n      // accounts for the byte ordering\n      idx += 2;\n      codePoints.push(REPLACEMENT);\n    } else {\n      codePoints.push(first);\n    }\n  }\n\n  // There shouldn't be extra byte(s) left over\n  if (idx < input.length) codePoints.push(REPLACEMENT);\n\n  return String.fromCodePoint(...codePoints);\n};\n\n/**\n * Returns `true` if the given `codePoint` is a high surrogate.\n * @param codePoint The code point to be evaluated.\n *\n * Reference: https://en.wikipedia.org/wiki/UTF-16#Description\n */\nconst isHighSurrogate = (codePoint: number) =>\n  codePoint >= 0xd800 && codePoint <= 0xdbff;\n\n/**\n * Returns `true` if the given `codePoint` is a low surrogate.\n * @param codePoint The code point to be evaluated.\n *\n * Reference: https://en.wikipedia.org/wiki/UTF-16#Description\n */\nconst isLowSurrogate = (codePoint: number) =>\n  codePoint >= 0xdc00 && codePoint <= 0xdfff;\n\n/**\n * Decodes the given utf-16 values first and second using the specified\n * byte order.\n * @param first The first byte of the encoding.\n * @param second The second byte of the encoding.\n * @param byteOrder The byte order of the encoding.\n * Reference: https://en.wikipedia.org/wiki/UTF-16#Examples\n */\nconst decodeValues = (first: number, second: number, byteOrder: ByteOrder) => {\n  // Append the binary representation of the preceding byte by shifting the\n  // first one 8 to the left and than applying a bitwise or-operator to append\n  // the second one.\n  if (byteOrder === ByteOrder.LittleEndian) return (second << 8) | first;\n  if (byteOrder === ByteOrder.BigEndian) return (first << 8) | second;\n  throw new Error(`Invalid byteOrder: ${byteOrder}`);\n};\n\n/**\n * Returns whether the given array contains a byte order mark for the\n * UTF-16BE or UTF-16LE encoding. If it has neither, BigEndian is assumed.\n *\n * Reference: https://en.wikipedia.org/wiki/Byte_order_mark#UTF-16\n *\n * @param bytes The byte array to be evaluated.\n */\n// prettier-ignore\nconst readBOM = (bytes: Uint8Array): ByteOrder => (\n  hasUtf16BigEndianBOM(bytes) ? ByteOrder.BigEndian\n    : hasUtf16LittleEndianBOM(bytes) ? ByteOrder.LittleEndian\n      : ByteOrder.BigEndian\n);\n\nconst hasUtf16BigEndianBOM = (bytes: Uint8Array) =>\n  bytes[0] === 0xfe && bytes[1] === 0xff;\n\nconst hasUtf16LittleEndianBOM = (bytes: Uint8Array) =>\n  bytes[0] === 0xff && bytes[1] === 0xfe;\n\nexport const hasUtf16BOM = (bytes: Uint8Array) =>\n  hasUtf16BigEndianBOM(bytes) || hasUtf16LittleEndianBOM(bytes);\n","// tslint:disable radix\n\n/**\n * Converts a number to its string representation in decimal. This function\n * differs from simply converting a number to a string with `.toString()`\n * because this function's output string will **not** contain exponential\n * notation.\n *\n * Credit: https://stackoverflow.com/a/46545519\n */\nexport const numberToString = (num: number) => {\n  let numStr = String(num);\n\n  if (Math.abs(num) < 1.0) {\n    const e = parseInt(num.toString().split('e-')[1]);\n    if (e) {\n      const negative = num < 0;\n      if (negative) num *= -1;\n      num *= Math.pow(10, e - 1);\n      numStr = '0.' + new Array(e).join('0') + num.toString().substring(2);\n      if (negative) numStr = '-' + numStr;\n    }\n  } else {\n    let e = parseInt(num.toString().split('+')[1]);\n    if (e > 20) {\n      e -= 20;\n      num /= Math.pow(10, e);\n      numStr = num.toString() + new Array(e + 1).join('0');\n    }\n  }\n\n  return numStr;\n};\n\nexport const sizeInBytes = (n: number) => Math.ceil(n.toString(2).length / 8);\n\n/**\n * Converts a number into its constituent bytes and returns them as\n * a number[].\n *\n * Returns most significant byte as first element in array. It may be necessary\n * to call .reverse() to get the bits in the desired order.\n *\n * Example:\n *   bytesFor(0x02A41E) => [ 0b10, 0b10100100, 0b11110 ]\n *\n * Credit for algorithm: https://stackoverflow.com/a/1936865\n */\nexport const bytesFor = (n: number) => {\n  const bytes = new Uint8Array(sizeInBytes(n));\n  for (let i = 1; i <= bytes.length; i++) {\n    bytes[i - 1] = n >> ((bytes.length - i) * 8);\n  }\n  return bytes;\n};\n","export const error = (msg: string) => {\n  throw new Error(msg);\n};\n","import { FontNames } from '@pdf-lib/standard-fonts';\n\nexport const values = (obj: any) => Object.keys(obj).map((k) => obj[k]);\n\nexport const StandardFontValues = values(FontNames);\n\nexport const isStandardFont = (input: any): input is FontNames =>\n  StandardFontValues.includes(input);\n\nexport const rectanglesAreEqual = (\n  a: { x: number; y: number; width: number; height: number },\n  b: { x: number; y: number; width: number; height: number },\n) => a.x === b.x && a.y === b.y && a.width === b.width && a.height === b.height;\n","/* tslint:disable:ban-types */\n\nimport { values as objectValues } from 'src/utils/objects';\n\nexport const backtick = (val: any) => `\\`${val}\\``;\nexport const singleQuote = (val: any) => `'${val}'`;\n\ntype Primitive = string | number | boolean | undefined | null;\n\n// prettier-ignore\nconst formatValue = (value: any) => {\n  const type = typeof value;\n  if (type ==='string') return singleQuote(value);\n  else if (type ==='undefined') return backtick(value);\n  else return value;\n};\n\nexport const createValueErrorMsg = (\n  value: any,\n  valueName: string,\n  values: Primitive[],\n) => {\n  const allowedValues = new Array(values.length);\n\n  for (let idx = 0, len = values.length; idx < len; idx++) {\n    const v = values[idx];\n    allowedValues[idx] = formatValue(v);\n  }\n\n  const joinedValues = allowedValues.join(' or ');\n\n  // prettier-ignore\n  return `${backtick(valueName)} must be one of ${joinedValues}, but was actually ${formatValue(value)}`;\n};\n\nexport const assertIsOneOf = (\n  value: any,\n  valueName: string,\n  allowedValues: Primitive[] | { [key: string]: Primitive },\n) => {\n  if (!Array.isArray(allowedValues)) {\n    allowedValues = objectValues(allowedValues);\n  }\n  for (let idx = 0, len = allowedValues.length; idx < len; idx++) {\n    if (value === allowedValues[idx]) return;\n  }\n  throw new TypeError(createValueErrorMsg(value, valueName, allowedValues));\n};\n\nexport const assertIsOneOfOrUndefined = (\n  value: any,\n  valueName: string,\n  allowedValues: Primitive[] | { [key: string]: Primitive },\n) => {\n  if (!Array.isArray(allowedValues)) {\n    allowedValues = objectValues(allowedValues);\n  }\n  assertIsOneOf(value, valueName, allowedValues.concat(undefined));\n};\n\nexport const assertIsSubset = (\n  values: any[],\n  valueName: string,\n  allowedValues: Primitive[] | { [key: string]: Primitive },\n) => {\n  if (!Array.isArray(allowedValues)) {\n    allowedValues = objectValues(allowedValues);\n  }\n  for (let idx = 0, len = values.length; idx < len; idx++) {\n    assertIsOneOf(values[idx], valueName, allowedValues);\n  }\n};\n\nexport const getType = (val: any) => {\n  if (val === null) return 'null';\n  if (val === undefined) return 'undefined';\n  if (typeof val === 'string') return 'string';\n  if (isNaN(val)) return 'NaN';\n  if (typeof val === 'number') return 'number';\n  if (typeof val === 'boolean') return 'boolean';\n  if (typeof val === 'symbol') return 'symbol';\n  if (typeof val === 'bigint') return 'bigint';\n  if (val.constructor && val.constructor.name) return val.constructor.name;\n  if (val.name) return val.name;\n  if (val.constructor) return String(val.constructor);\n  return String(val);\n};\n\nexport type TypeDescriptor =\n  | 'null'\n  | 'undefined'\n  | 'string'\n  | 'number'\n  | 'boolean'\n  | 'symbol'\n  | 'bigint'\n  | DateConstructor\n  | ArrayConstructor\n  | Uint8ArrayConstructor\n  | ArrayBufferConstructor\n  | FunctionConstructor\n  | [Function, string];\n\nexport const isType = (value: any, type: TypeDescriptor) => {\n  if (type === 'null') return value === null;\n  if (type === 'undefined') return value === undefined;\n  if (type === 'string') return typeof value === 'string';\n  if (type === 'number') return typeof value === 'number' && !isNaN(value);\n  if (type === 'boolean') return typeof value === 'boolean';\n  if (type === 'symbol') return typeof value === 'symbol';\n  if (type === 'bigint') return typeof value === 'bigint';\n  if (type === Date) return value instanceof Date;\n  if (type === Array) return value instanceof Array;\n  if (type === Uint8Array) return value instanceof Uint8Array;\n  if (type === ArrayBuffer) return value instanceof ArrayBuffer;\n  if (type === Function) return value instanceof Function;\n  return value instanceof (type as [Function, string])[0];\n};\n\nexport const createTypeErrorMsg = (\n  value: any,\n  valueName: string,\n  types: TypeDescriptor[],\n) => {\n  const allowedTypes = new Array(types.length);\n\n  for (let idx = 0, len = types.length; idx < len; idx++) {\n    const type = types[idx];\n    if (type === 'null') allowedTypes[idx] = backtick('null');\n    if (type === 'undefined') allowedTypes[idx] = backtick('undefined');\n    if (type === 'string') allowedTypes[idx] = backtick('string');\n    else if (type === 'number') allowedTypes[idx] = backtick('number');\n    else if (type === 'boolean') allowedTypes[idx] = backtick('boolean');\n    else if (type === 'symbol') allowedTypes[idx] = backtick('symbol');\n    else if (type === 'bigint') allowedTypes[idx] = backtick('bigint');\n    else if (type === Array) allowedTypes[idx] = backtick('Array');\n    else if (type === Uint8Array) allowedTypes[idx] = backtick('Uint8Array');\n    else if (type === ArrayBuffer) allowedTypes[idx] = backtick('ArrayBuffer');\n    else allowedTypes[idx] = backtick((type as [Function, string])[1]);\n  }\n\n  const joinedTypes = allowedTypes.join(' or ');\n\n  // prettier-ignore\n  return `${backtick(valueName)} must be of type ${joinedTypes}, but was actually of type ${backtick(getType(value))}`;\n};\n\nexport const assertIs = (\n  value: any,\n  valueName: string,\n  types: TypeDescriptor[],\n) => {\n  for (let idx = 0, len = types.length; idx < len; idx++) {\n    if (isType(value, types[idx])) return;\n  }\n  throw new TypeError(createTypeErrorMsg(value, valueName, types));\n};\n\nexport const assertOrUndefined = (\n  value: any,\n  valueName: string,\n  types: TypeDescriptor[],\n) => {\n  assertIs(value, valueName, types.concat('undefined'));\n};\n\nexport const assertEachIs = (\n  values: any[],\n  valueName: string,\n  types: TypeDescriptor[],\n) => {\n  for (let idx = 0, len = values.length; idx < len; idx++) {\n    assertIs(values[idx], valueName, types);\n  }\n};\n\nexport const assertRange = (\n  value: any,\n  valueName: string,\n  min: number,\n  max: number,\n) => {\n  assertIs(value, valueName, ['number']);\n  assertIs(min, 'min', ['number']);\n  assertIs(max, 'max', ['number']);\n  max = Math.max(min, max);\n  if (value < min || value > max) {\n    // prettier-ignore\n    throw new Error(`${backtick(valueName)} must be at least ${min} and at most ${max}, but was actually ${value}`);\n  }\n};\n\nexport const assertRangeOrUndefined = (\n  value: any,\n  valueName: string,\n  min: number,\n  max: number,\n) => {\n  assertIs(value, valueName, ['number', 'undefined']);\n  if (typeof value === 'number') assertRange(value, valueName, min, max);\n};\n\nexport const assertMultiple = (\n  value: any,\n  valueName: string,\n  multiplier: number,\n) => {\n  assertIs(value, valueName, ['number']);\n  if (value % multiplier !== 0) {\n    // prettier-ignore\n    throw new Error(`${backtick(valueName)} must be a multiple of ${multiplier}, but was actually ${value}`);\n  }\n};\n\nexport const assertInteger = (value: any, valueName: string) => {\n  if (!Number.isInteger(value)) {\n    throw new Error(\n      `${backtick(valueName)} must be an integer, but was actually ${value}`,\n    );\n  }\n};\n\nexport const assertPositive = (value: number, valueName: string) => {\n  if (![1, 0].includes(Math.sign(value))) {\n    // prettier-ignore\n    throw new Error(`${backtick(valueName)} must be a positive number or 0, but was actually ${value}`);\n  }\n};\n","import { toCharCode } from 'src/utils/strings';\n\n// Mapping from PDFDocEncoding to Unicode code point\nconst pdfDocEncodingToUnicode = new Uint16Array(256);\n\n// Initialize the code points which are the same\nfor (let idx = 0; idx < 256; idx++) {\n  pdfDocEncodingToUnicode[idx] = idx;\n}\n\n// Set differences (see \"Table D.2 – PDFDocEncoding Character Set\" of the PDF spec)\npdfDocEncodingToUnicode[0x16] = toCharCode('\\u0017'); // SYNCRONOUS IDLE\npdfDocEncodingToUnicode[0x18] = toCharCode('\\u02D8'); // BREVE\npdfDocEncodingToUnicode[0x19] = toCharCode('\\u02C7'); // CARON\npdfDocEncodingToUnicode[0x1a] = toCharCode('\\u02C6'); // MODIFIER LETTER CIRCUMFLEX ACCENT\npdfDocEncodingToUnicode[0x1b] = toCharCode('\\u02D9'); // DOT ABOVE\npdfDocEncodingToUnicode[0x1c] = toCharCode('\\u02DD'); // DOUBLE ACUTE ACCENT\npdfDocEncodingToUnicode[0x1d] = toCharCode('\\u02DB'); // OGONEK\npdfDocEncodingToUnicode[0x1e] = toCharCode('\\u02DA'); // RING ABOVE\npdfDocEncodingToUnicode[0x1f] = toCharCode('\\u02DC'); // SMALL TILDE\npdfDocEncodingToUnicode[0x7f] = toCharCode('\\uFFFD'); // REPLACEMENT CHARACTER (box with questionmark)\npdfDocEncodingToUnicode[0x80] = toCharCode('\\u2022'); // BULLET\npdfDocEncodingToUnicode[0x81] = toCharCode('\\u2020'); // DAGGER\npdfDocEncodingToUnicode[0x82] = toCharCode('\\u2021'); // DOUBLE DAGGER\npdfDocEncodingToUnicode[0x83] = toCharCode('\\u2026'); // HORIZONTAL ELLIPSIS\npdfDocEncodingToUnicode[0x84] = toCharCode('\\u2014'); // EM DASH\npdfDocEncodingToUnicode[0x85] = toCharCode('\\u2013'); // EN DASH\npdfDocEncodingToUnicode[0x86] = toCharCode('\\u0192'); // LATIN SMALL LETTER SCRIPT F\npdfDocEncodingToUnicode[0x87] = toCharCode('\\u2044'); // FRACTION SLASH (solidus)\npdfDocEncodingToUnicode[0x88] = toCharCode('\\u2039'); // SINGLE LEFT-POINTING ANGLE QUOTATION MARK\npdfDocEncodingToUnicode[0x89] = toCharCode('\\u203A'); // SINGLE RIGHT-POINTING ANGLE QUOTATION MARK\npdfDocEncodingToUnicode[0x8a] = toCharCode('\\u2212'); // MINUS SIGN\npdfDocEncodingToUnicode[0x8b] = toCharCode('\\u2030'); // PER MILLE SIGN\npdfDocEncodingToUnicode[0x8c] = toCharCode('\\u201E'); // DOUBLE LOW-9 QUOTATION MARK (quotedblbase)\npdfDocEncodingToUnicode[0x8d] = toCharCode('\\u201C'); // LEFT DOUBLE QUOTATION MARK (quotedblleft)\npdfDocEncodingToUnicode[0x8e] = toCharCode('\\u201D'); // RIGHT DOUBLE QUOTATION MARK (quotedblright)\npdfDocEncodingToUnicode[0x8f] = toCharCode('\\u2018'); // LEFT SINGLE QUOTATION MARK (quoteleft)\npdfDocEncodingToUnicode[0x90] = toCharCode('\\u2019'); // RIGHT SINGLE QUOTATION MARK (quoteright)\npdfDocEncodingToUnicode[0x91] = toCharCode('\\u201A'); // SINGLE LOW-9 QUOTATION MARK (quotesinglbase)\npdfDocEncodingToUnicode[0x92] = toCharCode('\\u2122'); // TRADE MARK SIGN\npdfDocEncodingToUnicode[0x93] = toCharCode('\\uFB01'); // LATIN SMALL LIGATURE FI\npdfDocEncodingToUnicode[0x94] = toCharCode('\\uFB02'); // LATIN SMALL LIGATURE FL\npdfDocEncodingToUnicode[0x95] = toCharCode('\\u0141'); // LATIN CAPITAL LETTER L WITH STROKE\npdfDocEncodingToUnicode[0x96] = toCharCode('\\u0152'); // LATIN CAPITAL LIGATURE OE\npdfDocEncodingToUnicode[0x97] = toCharCode('\\u0160'); // LATIN CAPITAL LETTER S WITH CARON\npdfDocEncodingToUnicode[0x98] = toCharCode('\\u0178'); // LATIN CAPITAL LETTER Y WITH DIAERESIS\npdfDocEncodingToUnicode[0x99] = toCharCode('\\u017D'); // LATIN CAPITAL LETTER Z WITH CARON\npdfDocEncodingToUnicode[0x9a] = toCharCode('\\u0131'); // LATIN SMALL LETTER DOTLESS I\npdfDocEncodingToUnicode[0x9b] = toCharCode('\\u0142'); // LATIN SMALL LETTER L WITH STROKE\npdfDocEncodingToUnicode[0x9c] = toCharCode('\\u0153'); // LATIN SMALL LIGATURE OE\npdfDocEncodingToUnicode[0x9d] = toCharCode('\\u0161'); // LATIN SMALL LETTER S WITH CARON\npdfDocEncodingToUnicode[0x9e] = toCharCode('\\u017E'); // LATIN SMALL LETTER Z WITH CARON\npdfDocEncodingToUnicode[0x9f] = toCharCode('\\uFFFD'); // REPLACEMENT CHARACTER (box with questionmark)\npdfDocEncodingToUnicode[0xa0] = toCharCode('\\u20AC'); // EURO SIGN\npdfDocEncodingToUnicode[0xad] = toCharCode('\\uFFFD'); // REPLACEMENT CHARACTER (box with questionmark)\n\n/**\n * Decode a byte array into a string using PDFDocEncoding.\n *\n * @param bytes a byte array (decimal representation) containing a string\n *              encoded with PDFDocEncoding.\n */\nexport const pdfDocEncodingDecode = (bytes: Uint8Array): string => {\n  const codePoints = new Array(bytes.length);\n  for (let idx = 0, len = bytes.length; idx < len; idx++) {\n    codePoints[idx] = pdfDocEncodingToUnicode[bytes[idx]];\n  }\n  return String.fromCodePoint(...codePoints);\n};\n","class Cache<T> {\n  static readonly populatedBy = <T>(populate: () => T) => new Cache(populate);\n\n  private readonly populate: () => T;\n  private value: T | undefined;\n\n  private constructor(populate: () => T) {\n    this.populate = populate;\n    this.value = undefined;\n  }\n\n  getValue(): T | undefined {\n    return this.value;\n  }\n\n  access(): T {\n    if (!this.value) this.value = this.populate();\n    return this.value;\n  }\n\n  invalidate(): void {\n    this.value = undefined;\n  }\n}\n\nexport default Cache;\n","// tslint:disable: max-classes-per-file\nimport PDFObject from 'src/core/objects/PDFObject';\nimport { arrayAsString } from 'src/utils';\n\nexport class MethodNotImplementedError extends Error {\n  constructor(className: string, methodName: string) {\n    const msg = `Method ${className}.${methodName}() not implemented`;\n    super(msg);\n  }\n}\n\nexport class PrivateConstructorError extends Error {\n  constructor(className: string) {\n    const msg = `Cannot construct ${className} - it has a private constructor`;\n    super(msg);\n  }\n}\n\nexport class UnexpectedObjectTypeError extends Error {\n  constructor(expected: any | any[], actual: any) {\n    const name = (t: any) => t?.name ?? t?.constructor?.name;\n\n    const expectedTypes = Array.isArray(expected)\n      ? expected.map(name)\n      : [name(expected)];\n\n    const msg =\n      `Expected instance of ${expectedTypes.join(' or ')}, ` +\n      `but got instance of ${actual ? name(actual) : actual}`;\n\n    super(msg);\n  }\n}\n\nexport class UnsupportedEncodingError extends Error {\n  constructor(encoding: string) {\n    const msg = `${encoding} stream encoding not supported`;\n    super(msg);\n  }\n}\n\nexport class ReparseError extends Error {\n  constructor(className: string, methodName: string) {\n    const msg = `Cannot call ${className}.${methodName}() more than once`;\n    super(msg);\n  }\n}\n\nexport class MissingCatalogError extends Error {\n  constructor(ref?: PDFObject) {\n    const msg = `Missing catalog (ref=${ref})`;\n    super(msg);\n  }\n}\n\nexport class MissingPageContentsEmbeddingError extends Error {\n  constructor() {\n    const msg = 'Can\\'t embed page with missing Contents';\n    super(msg);\n  }\n}\n\nexport class UnrecognizedStreamTypeError extends Error {\n  constructor(stream: any) {\n    const streamType = stream?.contructor?.name ?? stream?.name ?? stream;\n    const msg = `Unrecognized stream type: ${streamType}`;\n    super(msg);\n  }\n}\n\nexport class PageEmbeddingMismatchedContextError extends Error {\n  constructor() {\n    const msg = 'Found mismatched contexts while embedding pages. All pages in the array passed to `PDFDocument.embedPages()` must be from the same document.';\n    super(msg);\n  }\n}\n\nexport class PDFArrayIsNotRectangleError extends Error {\n  constructor(size: number) {\n    const msg = `Attempted to convert PDFArray with ${size} elements to rectangle, but must have exactly 4 elements.`;\n    super(msg);\n  }\n}\n\nexport class InvalidPDFDateStringError extends Error {\n  constructor(value: string) {\n    const msg = `Attempted to convert \"${value}\" to a date, but it does not match the PDF date string format.`;\n    super(msg);\n  }\n}\n\nexport class InvalidTargetIndexError extends Error {\n  constructor(targetIndex: number, Count: number) {\n    const msg = `Invalid targetIndex specified: targetIndex=${targetIndex} must be less than Count=${Count}`;\n    super(msg);\n  }\n}\n\nexport class CorruptPageTreeError extends Error {\n  constructor(targetIndex: number, operation: string) {\n    const msg = `Failed to ${operation} at targetIndex=${targetIndex} due to corrupt page tree: It is likely that one or more 'Count' entries are invalid`;\n    super(msg);\n  }\n}\n\nexport class IndexOutOfBoundsError extends Error {\n  constructor(index: number, min: number, max: number) {\n    const msg = `index should be at least ${min} and at most ${max}, but was actually ${index}`;\n    super(msg);\n  }\n}\n\nexport class InvalidAcroFieldValueError extends Error {\n  constructor() {\n    const msg = 'Attempted to set invalid field value';\n    super(msg);\n  }\n}\n\nexport class MultiSelectValueError extends Error {\n  constructor() {\n    const msg = 'Attempted to select multiple values for single-select field';\n    super(msg);\n  }\n}\n\nexport class MissingDAEntryError extends Error {\n  constructor(fieldName: string) {\n    const msg = `No /DA (default appearance) entry found for field: ${fieldName}`;\n    super(msg);\n  }\n}\n\nexport class MissingTfOperatorError extends Error {\n  constructor(fieldName: string) {\n    const msg = `No Tf operator found for DA of field: ${fieldName}`;\n    super(msg);\n  }\n}\n\n/***** Parser Errors ******/\n\nexport interface Position {\n  line: number;\n  column: number;\n  offset: number;\n}\n\nexport class NumberParsingError extends Error {\n  constructor(pos: Position, value: string) {\n    const msg =\n      'Failed to parse number ' +\n      `(line:${pos.line} col:${pos.column} offset=${pos.offset}): \"${value}\"`;\n    super(msg);\n  }\n}\n\nexport class PDFParsingError extends Error {\n  constructor(pos: Position, details: string) {\n    const msg =\n      'Failed to parse PDF document ' +\n      `(line:${pos.line} col:${pos.column} offset=${pos.offset}): ${details}`;\n    super(msg);\n  }\n}\n\nexport class NextByteAssertionError extends PDFParsingError {\n  constructor(pos: Position, expectedByte: number, actualByte: number) {\n    const msg = `Expected next byte to be ${expectedByte} but it was actually ${actualByte}`;\n    super(pos, msg);\n  }\n}\n\nexport class PDFObjectParsingError extends PDFParsingError {\n  constructor(pos: Position, byte: number) {\n    const msg = `Failed to parse PDF object starting with the following byte: ${byte}`;\n    super(pos, msg);\n  }\n}\n\nexport class PDFInvalidObjectParsingError extends PDFParsingError {\n  constructor(pos: Position) {\n    const msg = 'Failed to parse invalid PDF object';\n    super(pos, msg);\n  }\n}\n\nexport class PDFStreamParsingError extends PDFParsingError {\n  constructor(pos: Position) {\n    const msg = 'Failed to parse PDF stream';\n    super(pos, msg);\n  }\n}\n\nexport class UnbalancedParenthesisError extends PDFParsingError {\n  constructor(pos: Position) {\n    const msg = 'Failed to parse PDF literal string due to unbalanced parenthesis';\n    super(pos, msg);\n  }\n}\n\nexport class StalledParserError extends PDFParsingError {\n  constructor(pos: Position) {\n    const msg = 'Parser stalled';\n    super(pos, msg);\n  }\n}\n\nexport class MissingPDFHeaderError extends PDFParsingError {\n  constructor(pos: Position) {\n    const msg = 'No PDF header found';\n    super(pos, msg);\n  }\n}\n\nexport class MissingKeywordError extends PDFParsingError {\n  constructor(pos: Position, keyword: number[]) {\n    const msg = `Did not find expected keyword '${arrayAsString(keyword)}'`;\n    super(pos, msg);\n  }\n}\n","enum CharCodes {\n  Null = 0,\n  Backspace = 8,\n  Tab = 9,\n  Newline = 10,\n  FormFeed = 12,\n  CarriageReturn = 13,\n  Space = 32,\n  ExclamationPoint = 33,\n  Hash = 35,\n  Percent = 37,\n  LeftParen = 40,\n  RightParen = 41,\n  Plus = 43,\n  Minus = 45,\n  Dash = 45,\n  Period = 46,\n  ForwardSlash = 47,\n  Zero = 48,\n  One = 49,\n  Two = 50,\n  Three = 51,\n  Four = 52,\n  Five = 53,\n  Six = 54,\n  Seven = 55,\n  Eight = 56,\n  Nine = 57,\n  LessThan = 60,\n  GreaterThan = 62,\n  A = 65,\n  D = 68,\n  E = 69,\n  F = 70,\n  O = 79,\n  P = 80,\n  R = 82,\n  LeftSquareBracket = 91,\n  BackSlash = 92,\n  RightSquareBracket = 93,\n  a = 97,\n  b = 98,\n  d = 100,\n  e = 101,\n  f = 102,\n  i = 105,\n  j = 106,\n  l = 108,\n  m = 109,\n  n = 110,\n  o = 111,\n  r = 114,\n  s = 115,\n  t = 116,\n  u = 117,\n  x = 120,\n  LeftCurly = 123,\n  RightCurly = 125,\n  Tilde = 126\n}\n\nexport default CharCodes;\n","import pako from 'pako';\n\nimport PDFHeader from 'src/core/document/PDFHeader';\nimport { UnexpectedObjectTypeError } from 'src/core/errors';\nimport PDFArray from 'src/core/objects/PDFArray';\nimport PDFBool from 'src/core/objects/PDFBool';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNull from 'src/core/objects/PDFNull';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFRawStream from 'src/core/objects/PDFRawStream';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFStream from 'src/core/objects/PDFStream';\nimport PDFString from 'src/core/objects/PDFString';\nimport PDFOperator from 'src/core/operators/PDFOperator';\nimport Ops from 'src/core/operators/PDFOperatorNames';\nimport PDFContentStream from 'src/core/structures/PDFContentStream';\nimport { typedArrayFor } from 'src/utils';\nimport { SimpleRNG } from 'src/utils/rng';\n\ntype LookupKey = PDFRef | PDFObject | undefined;\n\ninterface LiteralObject {\n  [name: string]: Literal | PDFObject;\n}\n\ninterface LiteralArray {\n  [index: number]: Literal | PDFObject;\n}\n\ntype Literal =\n  | LiteralObject\n  | LiteralArray\n  | string\n  | number\n  | boolean\n  | null\n  | undefined;\n\nconst byAscendingObjectNumber = (\n  [a]: [PDFRef, PDFObject],\n  [b]: [PDFRef, PDFObject],\n) => a.objectNumber - b.objectNumber;\n\nclass PDFContext {\n  static create = () => new PDFContext();\n\n  largestObjectNumber: number;\n  header: PDFHeader;\n  trailerInfo: {\n    Root?: PDFObject;\n    Encrypt?: PDFObject;\n    Info?: PDFObject;\n    ID?: PDFObject;\n  };\n  rng: SimpleRNG;\n\n  private readonly indirectObjects: Map<PDFRef, PDFObject>;\n\n  private pushGraphicsStateContentStreamRef?: PDFRef;\n  private popGraphicsStateContentStreamRef?: PDFRef;\n\n  private constructor() {\n    this.largestObjectNumber = 0;\n    this.header = PDFHeader.forVersion(1, 7);\n    this.trailerInfo = {};\n\n    this.indirectObjects = new Map();\n    this.rng = SimpleRNG.withSeed(1);\n  }\n\n  assign(ref: PDFRef, object: PDFObject): void {\n    this.indirectObjects.set(ref, object);\n    if (ref.objectNumber > this.largestObjectNumber) {\n      this.largestObjectNumber = ref.objectNumber;\n    }\n  }\n\n  nextRef(): PDFRef {\n    this.largestObjectNumber += 1;\n    return PDFRef.of(this.largestObjectNumber);\n  }\n\n  register(object: PDFObject): PDFRef {\n    const ref = this.nextRef();\n    this.assign(ref, object);\n    return ref;\n  }\n\n  delete(ref: PDFRef): boolean {\n    return this.indirectObjects.delete(ref);\n  }\n\n  lookupMaybe(ref: LookupKey, type: typeof PDFArray): PDFArray | undefined;\n  lookupMaybe(ref: LookupKey, type: typeof PDFBool): PDFBool | undefined;\n  lookupMaybe(ref: LookupKey, type: typeof PDFDict): PDFDict | undefined;\n  lookupMaybe(\n    ref: LookupKey,\n    type: typeof PDFHexString,\n  ): PDFHexString | undefined;\n  lookupMaybe(ref: LookupKey, type: typeof PDFName): PDFName | undefined;\n  lookupMaybe(ref: LookupKey, type: typeof PDFNull): typeof PDFNull | undefined;\n  lookupMaybe(ref: LookupKey, type: typeof PDFNumber): PDFNumber | undefined;\n  lookupMaybe(ref: LookupKey, type: typeof PDFStream): PDFStream | undefined;\n  lookupMaybe(ref: LookupKey, type: typeof PDFRef): PDFRef | undefined;\n  lookupMaybe(ref: LookupKey, type: typeof PDFString): PDFString | undefined;\n  lookupMaybe(\n    ref: LookupKey,\n    type1: typeof PDFString,\n    type2: typeof PDFHexString,\n  ): PDFString | PDFHexString | undefined;\n\n  lookupMaybe(ref: LookupKey, ...types: any[]) {\n    // TODO: `preservePDFNull` is for backwards compatibility. Should be\n    // removed in next breaking API change.\n    const preservePDFNull = types.includes(PDFNull);\n\n    const result = ref instanceof PDFRef ? this.indirectObjects.get(ref) : ref;\n\n    if (!result || (result === PDFNull && !preservePDFNull)) return undefined;\n\n    for (let idx = 0, len = types.length; idx < len; idx++) {\n      const type = types[idx];\n      if (type === PDFNull) {\n        if (result === PDFNull) return result;\n      } else {\n        if (result instanceof type) return result;\n      }\n    }\n    throw new UnexpectedObjectTypeError(types, result);\n  }\n\n  lookup(ref: LookupKey): PDFObject | undefined;\n  lookup(ref: LookupKey, type: typeof PDFArray): PDFArray;\n  lookup(ref: LookupKey, type: typeof PDFBool): PDFBool;\n  lookup(ref: LookupKey, type: typeof PDFDict): PDFDict;\n  lookup(ref: LookupKey, type: typeof PDFHexString): PDFHexString;\n  lookup(ref: LookupKey, type: typeof PDFName): PDFName;\n  lookup(ref: LookupKey, type: typeof PDFNull): typeof PDFNull;\n  lookup(ref: LookupKey, type: typeof PDFNumber): PDFNumber;\n  lookup(ref: LookupKey, type: typeof PDFStream): PDFStream;\n  lookup(ref: LookupKey, type: typeof PDFRef): PDFRef;\n  lookup(ref: LookupKey, type: typeof PDFString): PDFString;\n  lookup(\n    ref: LookupKey,\n    type1: typeof PDFString,\n    type2: typeof PDFHexString,\n  ): PDFString | PDFHexString;\n\n  lookup(ref: LookupKey, ...types: any[]) {\n    const result = ref instanceof PDFRef ? this.indirectObjects.get(ref) : ref;\n\n    if (types.length === 0) return result;\n\n    for (let idx = 0, len = types.length; idx < len; idx++) {\n      const type = types[idx];\n      if (type === PDFNull) {\n        if (result === PDFNull) return result;\n      } else {\n        if (result instanceof type) return result;\n      }\n    }\n\n    throw new UnexpectedObjectTypeError(types, result);\n  }\n\n  getObjectRef(pdfObject: PDFObject): PDFRef | undefined {\n    const entries = Array.from(this.indirectObjects.entries());\n    for (let idx = 0, len = entries.length; idx < len; idx++) {\n      const [ref, object] = entries[idx];\n      if (object === pdfObject) {\n        return ref;\n      }\n    }\n\n    return undefined;\n  }\n\n  enumerateIndirectObjects(): [PDFRef, PDFObject][] {\n    return Array.from(this.indirectObjects.entries()).sort(\n      byAscendingObjectNumber,\n    );\n  }\n\n  obj(literal: null | undefined): typeof PDFNull;\n  obj(literal: string): PDFName;\n  obj(literal: number): PDFNumber;\n  obj(literal: boolean): PDFBool;\n  obj(literal: LiteralObject): PDFDict;\n  obj(literal: LiteralArray): PDFArray;\n\n  obj(literal: Literal) {\n    if (literal instanceof PDFObject) {\n      return literal;\n    } else if (literal === null || literal === undefined) {\n      return PDFNull;\n    } else if (typeof literal === 'string') {\n      return PDFName.of(literal);\n    } else if (typeof literal === 'number') {\n      return PDFNumber.of(literal);\n    } else if (typeof literal === 'boolean') {\n      return literal ? PDFBool.True : PDFBool.False;\n    } else if (Array.isArray(literal)) {\n      const array = PDFArray.withContext(this);\n      for (let idx = 0, len = literal.length; idx < len; idx++) {\n        array.push(this.obj(literal[idx]));\n      }\n      return array;\n    } else {\n      const dict = PDFDict.withContext(this);\n      const keys = Object.keys(literal);\n      for (let idx = 0, len = keys.length; idx < len; idx++) {\n        const key = keys[idx];\n        const value = (literal as LiteralObject)[key] as any;\n        if (value !== undefined) dict.set(PDFName.of(key), this.obj(value));\n      }\n      return dict;\n    }\n  }\n\n  stream(\n    contents: string | Uint8Array,\n    dict: LiteralObject = {},\n  ): PDFRawStream {\n    return PDFRawStream.of(this.obj(dict), typedArrayFor(contents));\n  }\n\n  flateStream(\n    contents: string | Uint8Array,\n    dict: LiteralObject = {},\n  ): PDFRawStream {\n    return this.stream(pako.deflate(typedArrayFor(contents)), {\n      ...dict,\n      Filter: 'FlateDecode',\n    });\n  }\n\n  contentStream(\n    operators: PDFOperator[],\n    dict: LiteralObject = {},\n  ): PDFContentStream {\n    return PDFContentStream.of(this.obj(dict), operators);\n  }\n\n  formXObject(\n    operators: PDFOperator[],\n    dict: LiteralObject = {},\n  ): PDFContentStream {\n    return this.contentStream(operators, {\n      BBox: this.obj([0, 0, 0, 0]),\n      Matrix: this.obj([1, 0, 0, 1, 0, 0]),\n      ...dict,\n      Type: 'XObject',\n      Subtype: 'Form',\n    });\n  }\n\n  /*\n   * Reference to PDFContentStream that contains a single PDFOperator: `q`.\n   * Used by [[PDFPageLeaf]] instances to ensure that when content streams are\n   * added to a modified PDF, they start in the default, unchanged graphics\n   * state.\n   */\n  getPushGraphicsStateContentStream(): PDFRef {\n    if (this.pushGraphicsStateContentStreamRef) {\n      return this.pushGraphicsStateContentStreamRef;\n    }\n    const dict = this.obj({});\n    const op = PDFOperator.of(Ops.PushGraphicsState);\n    const stream = PDFContentStream.of(dict, [op]);\n    this.pushGraphicsStateContentStreamRef = this.register(stream);\n    return this.pushGraphicsStateContentStreamRef;\n  }\n\n  /*\n   * Reference to PDFContentStream that contains a single PDFOperator: `Q`.\n   * Used by [[PDFPageLeaf]] instances to ensure that when content streams are\n   * added to a modified PDF, they start in the default, unchanged graphics\n   * state.\n   */\n  getPopGraphicsStateContentStream(): PDFRef {\n    if (this.popGraphicsStateContentStreamRef) {\n      return this.popGraphicsStateContentStreamRef;\n    }\n    const dict = this.obj({});\n    const op = PDFOperator.of(Ops.PopGraphicsState);\n    const stream = PDFContentStream.of(dict, [op]);\n    this.popGraphicsStateContentStreamRef = this.register(stream);\n    return this.popGraphicsStateContentStreamRef;\n  }\n\n  addRandomSuffix(prefix: string, suffixLength = 4): string {\n    return `${prefix}-${Math.floor(this.rng.nextInt() * 10 ** suffixLength)}`;\n  }\n}\n\nexport default PDFContext;\n","import CharCodes from 'src/core/syntax/CharCodes';\nimport { charFromCode, copyStringIntoBuffer } from 'src/utils';\n\nclass PDFHeader {\n  static forVersion = (major: number, minor: number) =>\n    new PDFHeader(major, minor);\n\n  private readonly major: string;\n  private readonly minor: string;\n\n  private constructor(major: number, minor: number) {\n    this.major = String(major);\n    this.minor = String(minor);\n  }\n\n  toString(): string {\n    const bc = charFromCode(129);\n    return `%PDF-${this.major}.${this.minor}\\n%${bc}${bc}${bc}${bc}`;\n  }\n\n  sizeInBytes(): number {\n    return 12 + this.major.length + this.minor.length;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    const initialOffset = offset;\n\n    buffer[offset++] = CharCodes.Percent;\n    buffer[offset++] = CharCodes.P;\n    buffer[offset++] = CharCodes.D;\n    buffer[offset++] = CharCodes.F;\n    buffer[offset++] = CharCodes.Dash;\n\n    offset += copyStringIntoBuffer(this.major, buffer, offset);\n    buffer[offset++] = CharCodes.Period;\n    offset += copyStringIntoBuffer(this.minor, buffer, offset);\n    buffer[offset++] = CharCodes.Newline;\n\n    buffer[offset++] = CharCodes.Percent;\n    buffer[offset++] = 129;\n    buffer[offset++] = 129;\n    buffer[offset++] = 129;\n    buffer[offset++] = 129;\n\n    return offset - initialOffset;\n  }\n}\n\nexport default PDFHeader;\n","import { MethodNotImplementedError } from 'src/core/errors';\nimport PDFContext from 'src/core/PDFContext';\n\nclass PDFObject {\n  clone(_context?: PDFContext): PDFObject {\n    throw new MethodNotImplementedError(this.constructor.name, 'clone');\n  }\n\n  toString(): string {\n    throw new MethodNotImplementedError(this.constructor.name, 'toString');\n  }\n\n  sizeInBytes(): number {\n    throw new MethodNotImplementedError(this.constructor.name, 'sizeInBytes');\n  }\n\n  copyBytesInto(_buffer: Uint8Array, _offset: number): number {\n    throw new MethodNotImplementedError(this.constructor.name, 'copyBytesInto');\n  }\n}\n\nexport default PDFObject;\n","import { copyStringIntoBuffer, numberToString } from 'src/utils/index';\n\nimport PDFObject from 'src/core/objects/PDFObject';\n\nclass PDFNumber extends PDFObject {\n  static of = (value: number) => new PDFNumber(value);\n\n  private readonly numberValue: number;\n  private readonly stringValue: string;\n\n  private constructor(value: number) {\n    super();\n    this.numberValue = value;\n    this.stringValue = numberToString(value);\n  }\n\n  asNumber(): number {\n    return this.numberValue;\n  }\n\n  /** @deprecated in favor of [[PDFNumber.asNumber]] */\n  value(): number {\n    return this.numberValue;\n  }\n\n  clone(): PDFNumber {\n    return PDFNumber.of(this.numberValue);\n  }\n\n  toString(): string {\n    return this.stringValue;\n  }\n\n  sizeInBytes(): number {\n    return this.stringValue.length;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    offset += copyStringIntoBuffer(this.stringValue, buffer, offset);\n    return this.stringValue.length;\n  }\n}\n\nexport default PDFNumber;\n","import PDFBool from 'src/core/objects/PDFBool';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNull from 'src/core/objects/PDFNull';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFStream from 'src/core/objects/PDFStream';\nimport PDFString from 'src/core/objects/PDFString';\nimport PDFContext from 'src/core/PDFContext';\nimport CharCodes from 'src/core/syntax/CharCodes';\nimport { PDFArrayIsNotRectangleError } from 'src/core/errors';\nimport PDFRawStream from 'src/core/objects/PDFRawStream';\n\nclass PDFArray extends PDFObject {\n  static withContext = (context: PDFContext) => new PDFArray(context);\n\n  private readonly array: PDFObject[];\n  private readonly context: PDFContext;\n\n  private constructor(context: PDFContext) {\n    super();\n    this.array = [];\n    this.context = context;\n  }\n\n  size(): number {\n    return this.array.length;\n  }\n\n  push(object: PDFObject): void {\n    this.array.push(object);\n  }\n\n  insert(index: number, object: PDFObject): void {\n    this.array.splice(index, 0, object);\n  }\n\n  indexOf(object: PDFObject): number | undefined {\n    const index = this.array.indexOf(object);\n    return index === -1 ? undefined : index;\n  }\n\n  remove(index: number): void {\n    this.array.splice(index, 1);\n  }\n\n  set(idx: number, object: PDFObject): void {\n    this.array[idx] = object;\n  }\n\n  get(index: number): PDFObject {\n    return this.array[index];\n  }\n\n  lookupMaybe(index: number, type: typeof PDFArray): PDFArray | undefined;\n  lookupMaybe(index: number, type: typeof PDFBool): PDFBool | undefined;\n  lookupMaybe(index: number, type: typeof PDFDict): PDFDict | undefined;\n  lookupMaybe(\n    index: number,\n    type: typeof PDFHexString,\n  ): PDFHexString | undefined;\n  lookupMaybe(index: number, type: typeof PDFName): PDFName | undefined;\n  lookupMaybe(index: number, type: typeof PDFNull): typeof PDFNull | undefined;\n  lookupMaybe(index: number, type: typeof PDFNumber): PDFNumber | undefined;\n  lookupMaybe(index: number, type: typeof PDFStream): PDFStream | undefined;\n  lookupMaybe(\n    index: number,\n    type: typeof PDFRawStream,\n  ): PDFRawStream | undefined;\n  lookupMaybe(index: number, type: typeof PDFRef): PDFRef | undefined;\n  lookupMaybe(index: number, type: typeof PDFString): PDFString | undefined;\n  lookupMaybe(\n    index: number,\n    type1: typeof PDFString,\n    type2: typeof PDFHexString,\n  ): PDFString | PDFHexString | undefined;\n\n  lookupMaybe(index: number, ...types: any[]) {\n    return this.context.lookupMaybe(\n      this.get(index),\n      // @ts-ignore\n      ...types,\n    ) as any;\n  }\n\n  lookup(index: number): PDFObject | undefined;\n  lookup(index: number, type: typeof PDFArray): PDFArray;\n  lookup(index: number, type: typeof PDFBool): PDFBool;\n  lookup(index: number, type: typeof PDFDict): PDFDict;\n  lookup(index: number, type: typeof PDFHexString): PDFHexString;\n  lookup(index: number, type: typeof PDFName): PDFName;\n  lookup(index: number, type: typeof PDFNull): typeof PDFNull;\n  lookup(index: number, type: typeof PDFNumber): PDFNumber;\n  lookup(index: number, type: typeof PDFStream): PDFStream;\n  lookup(index: number, type: typeof PDFRawStream): PDFRawStream;\n  lookup(index: number, type: typeof PDFRef): PDFRef;\n  lookup(index: number, type: typeof PDFString): PDFString;\n  lookup(\n    index: number,\n    type1: typeof PDFString,\n    type2: typeof PDFHexString,\n  ): PDFString | PDFHexString;\n\n  lookup(index: number, ...types: any[]) {\n    return this.context.lookup(\n      this.get(index),\n      // @ts-ignore\n      ...types,\n    ) as any;\n  }\n\n  asRectangle(): { x: number; y: number; width: number; height: number } {\n    if (this.size() !== 4) throw new PDFArrayIsNotRectangleError(this.size());\n\n    const lowerLeftX = this.lookup(0, PDFNumber).asNumber();\n    const lowerLeftY = this.lookup(1, PDFNumber).asNumber();\n    const upperRightX = this.lookup(2, PDFNumber).asNumber();\n    const upperRightY = this.lookup(3, PDFNumber).asNumber();\n\n    const x = lowerLeftX;\n    const y = lowerLeftY;\n    const width = upperRightX - lowerLeftX;\n    const height = upperRightY - lowerLeftY;\n\n    return { x, y, width, height };\n  }\n\n  asArray(): PDFObject[] {\n    return this.array.slice();\n  }\n\n  clone(context?: PDFContext): PDFArray {\n    const clone = PDFArray.withContext(context || this.context);\n    for (let idx = 0, len = this.size(); idx < len; idx++) {\n      clone.push(this.array[idx]);\n    }\n    return clone;\n  }\n\n  toString(): string {\n    let arrayString = '[ ';\n    for (let idx = 0, len = this.size(); idx < len; idx++) {\n      arrayString += this.get(idx).toString();\n      arrayString += ' ';\n    }\n    arrayString += ']';\n    return arrayString;\n  }\n\n  sizeInBytes(): number {\n    let size = 3;\n    for (let idx = 0, len = this.size(); idx < len; idx++) {\n      size += this.get(idx).sizeInBytes() + 1;\n    }\n    return size;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    const initialOffset = offset;\n\n    buffer[offset++] = CharCodes.LeftSquareBracket;\n    buffer[offset++] = CharCodes.Space;\n    for (let idx = 0, len = this.size(); idx < len; idx++) {\n      offset += this.get(idx).copyBytesInto(buffer, offset);\n      buffer[offset++] = CharCodes.Space;\n    }\n    buffer[offset++] = CharCodes.RightSquareBracket;\n\n    return offset - initialOffset;\n  }\n\n  scalePDFNumbers(x: number, y: number): void {\n    for (let idx = 0, len = this.size(); idx < len; idx++) {\n      const el = this.lookup(idx);\n      if (el instanceof PDFNumber) {\n        const factor = idx % 2 === 0 ? x : y;\n        this.set(idx, PDFNumber.of(el.asNumber() * factor));\n      }\n    }\n  }\n}\n\nexport default PDFArray;\n","import { PrivateConstructorError } from 'src/core/errors';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport CharCodes from 'src/core/syntax/CharCodes';\n\nconst ENFORCER = {};\n\nclass PDFBool extends PDFObject {\n  static readonly True = new PDFBool(ENFORCER, true);\n  static readonly False = new PDFBool(ENFORCER, false);\n\n  private readonly value: boolean;\n\n  private constructor(enforcer: any, value: boolean) {\n    if (enforcer !== ENFORCER) throw new PrivateConstructorError('PDFBool');\n    super();\n    this.value = value;\n  }\n\n  asBoolean(): boolean {\n    return this.value;\n  }\n\n  clone(): PDFBool {\n    return this;\n  }\n\n  toString(): string {\n    return String(this.value);\n  }\n\n  sizeInBytes(): number {\n    return this.value ? 4 : 5;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    if (this.value) {\n      buffer[offset++] = CharCodes.t;\n      buffer[offset++] = CharCodes.r;\n      buffer[offset++] = CharCodes.u;\n      buffer[offset++] = CharCodes.e;\n      return 4;\n    } else {\n      buffer[offset++] = CharCodes.f;\n      buffer[offset++] = CharCodes.a;\n      buffer[offset++] = CharCodes.l;\n      buffer[offset++] = CharCodes.s;\n      buffer[offset++] = CharCodes.e;\n      return 5;\n    }\n  }\n}\n\nexport default PDFBool;\n","import CharCodes from 'src/core/syntax/CharCodes';\n\nexport const IsDelimiter = new Uint8Array(256);\n\nIsDelimiter[CharCodes.LeftParen] = 1;\nIsDelimiter[CharCodes.RightParen] = 1;\nIsDelimiter[CharCodes.LessThan] = 1;\nIsDelimiter[CharCodes.GreaterThan] = 1;\nIsDelimiter[CharCodes.LeftSquareBracket] = 1;\nIsDelimiter[CharCodes.RightSquareBracket] = 1;\nIsDelimiter[CharCodes.LeftCurly] = 1;\nIsDelimiter[CharCodes.RightCurly] = 1;\nIsDelimiter[CharCodes.ForwardSlash] = 1;\nIsDelimiter[CharCodes.Percent] = 1;\n","import CharCodes from 'src/core/syntax/CharCodes';\n\nexport const IsWhitespace = new Uint8Array(256);\n\nIsWhitespace[CharCodes.Null] = 1;\nIsWhitespace[CharCodes.Tab] = 1;\nIsWhitespace[CharCodes.Newline] = 1;\nIsWhitespace[CharCodes.FormFeed] = 1;\nIsWhitespace[CharCodes.CarriageReturn] = 1;\nIsWhitespace[CharCodes.Space] = 1;\n","import CharCodes from 'src/core/syntax/CharCodes';\nimport { IsDelimiter } from 'src/core/syntax/Delimiters';\nimport { IsWhitespace } from 'src/core/syntax/Whitespace';\n\nexport const IsIrregular = new Uint8Array(256);\n\nfor (let idx = 0, len = 256; idx < len; idx++) {\n  IsIrregular[idx] = IsWhitespace[idx] || IsDelimiter[idx] ? 1 : 0;\n}\nIsIrregular[CharCodes.Hash] = 1;\n","import { PrivateConstructorError } from 'src/core/errors';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport CharCodes from 'src/core/syntax/CharCodes';\nimport { IsIrregular } from 'src/core/syntax/Irregular';\nimport {\n  charFromHexCode,\n  copyStringIntoBuffer,\n  toCharCode,\n  toHexString,\n} from 'src/utils';\n\nconst decodeName = (name: string) =>\n  name.replace(/#([\\dABCDEF]{2})/g, (_, hex) => charFromHexCode(hex));\n\nconst isRegularChar = (charCode: number) =>\n  charCode >= CharCodes.ExclamationPoint &&\n  charCode <= CharCodes.Tilde &&\n  !IsIrregular[charCode];\n\nconst ENFORCER = {};\nconst pool = new Map<string, PDFName>();\n\nclass PDFName extends PDFObject {\n  static of = (name: string): PDFName => {\n    const decodedValue = decodeName(name);\n\n    let instance = pool.get(decodedValue);\n    if (!instance) {\n      instance = new PDFName(ENFORCER, decodedValue);\n      pool.set(decodedValue, instance);\n    }\n\n    return instance;\n  };\n\n  /* tslint:disable member-ordering */\n  static readonly Length = PDFName.of('Length');\n  static readonly FlateDecode = PDFName.of('FlateDecode');\n  static readonly Resources = PDFName.of('Resources');\n  static readonly Font = PDFName.of('Font');\n  static readonly XObject = PDFName.of('XObject');\n  static readonly ExtGState = PDFName.of('ExtGState');\n  static readonly Contents = PDFName.of('Contents');\n  static readonly Type = PDFName.of('Type');\n  static readonly Parent = PDFName.of('Parent');\n  static readonly MediaBox = PDFName.of('MediaBox');\n  static readonly Page = PDFName.of('Page');\n  static readonly Annots = PDFName.of('Annots');\n  static readonly TrimBox = PDFName.of('TrimBox');\n  static readonly ArtBox = PDFName.of('ArtBox');\n  static readonly BleedBox = PDFName.of('BleedBox');\n  static readonly CropBox = PDFName.of('CropBox');\n  static readonly Rotate = PDFName.of('Rotate');\n  static readonly Title = PDFName.of('Title');\n  static readonly Author = PDFName.of('Author');\n  static readonly Subject = PDFName.of('Subject');\n  static readonly Creator = PDFName.of('Creator');\n  static readonly Keywords = PDFName.of('Keywords');\n  static readonly Producer = PDFName.of('Producer');\n  static readonly CreationDate = PDFName.of('CreationDate');\n  static readonly ModDate = PDFName.of('ModDate');\n  /* tslint:enable member-ordering */\n\n  private readonly encodedName: string;\n\n  private constructor(enforcer: any, name: string) {\n    if (enforcer !== ENFORCER) throw new PrivateConstructorError('PDFName');\n    super();\n\n    let encodedName = '/';\n    for (let idx = 0, len = name.length; idx < len; idx++) {\n      const character = name[idx];\n      const code = toCharCode(character);\n      encodedName += isRegularChar(code) ? character : `#${toHexString(code)}`;\n    }\n\n    this.encodedName = encodedName;\n  }\n\n  asBytes(): Uint8Array {\n    const bytes: number[] = [];\n\n    let hex = '';\n    let escaped = false;\n\n    const pushByte = (byte?: number) => {\n      if (byte !== undefined) bytes.push(byte);\n      escaped = false;\n    };\n\n    for (let idx = 1, len = this.encodedName.length; idx < len; idx++) {\n      const char = this.encodedName[idx];\n      const byte = toCharCode(char);\n      const nextChar = this.encodedName[idx + 1];\n      if (!escaped) {\n        if (byte === CharCodes.Hash) escaped = true;\n        else pushByte(byte);\n      } else {\n        if (\n          (byte >= CharCodes.Zero && byte <= CharCodes.Nine) ||\n          (byte >= CharCodes.a && byte <= CharCodes.f) ||\n          (byte >= CharCodes.A && byte <= CharCodes.F)\n        ) {\n          hex += char;\n          if (\n            hex.length === 2 ||\n            !(\n              (nextChar >= '0' && nextChar <= '9') ||\n              (nextChar >= 'a' && nextChar <= 'f') ||\n              (nextChar >= 'A' && nextChar <= 'F')\n            )\n          ) {\n            pushByte(parseInt(hex, 16));\n            hex = '';\n          }\n        } else {\n          pushByte(byte);\n        }\n      }\n    }\n\n    return new Uint8Array(bytes);\n  }\n\n  // TODO: This should probably use `utf8Decode()`\n  // TODO: Polyfill Array.from?\n  decodeText(): string {\n    const bytes = this.asBytes();\n    return String.fromCharCode(...Array.from(bytes));\n  }\n\n  asString(): string {\n    return this.encodedName;\n  }\n\n  /** @deprecated in favor of [[PDFName.asString]] */\n  value(): string {\n    return this.encodedName;\n  }\n\n  clone(): PDFName {\n    return this;\n  }\n\n  toString(): string {\n    return this.encodedName;\n  }\n\n  sizeInBytes(): number {\n    return this.encodedName.length;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    offset += copyStringIntoBuffer(this.encodedName, buffer, offset);\n    return this.encodedName.length;\n  }\n}\n\nexport default PDFName;\n","import PDFObject from 'src/core/objects/PDFObject';\nimport CharCodes from 'src/core/syntax/CharCodes';\n\nclass PDFNull extends PDFObject {\n  asNull(): null {\n    return null;\n  }\n\n  clone(): PDFNull {\n    return this;\n  }\n\n  toString(): string {\n    return 'null';\n  }\n\n  sizeInBytes(): number {\n    return 4;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    buffer[offset++] = CharCodes.n;\n    buffer[offset++] = CharCodes.u;\n    buffer[offset++] = CharCodes.l;\n    buffer[offset++] = CharCodes.l;\n    return 4;\n  }\n}\n\nexport default new PDFNull();\n","import PDFArray from 'src/core/objects/PDFArray';\nimport PDFBool from 'src/core/objects/PDFBool';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNull from 'src/core/objects/PDFNull';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFStream from 'src/core/objects/PDFStream';\nimport PDFString from 'src/core/objects/PDFString';\nimport PDFContext from 'src/core/PDFContext';\nimport CharCodes from 'src/core/syntax/CharCodes';\n\nexport type DictMap = Map<PDFName, PDFObject>;\n\nclass PDFDict extends PDFObject {\n  static withContext = (context: PDFContext) => new PDFDict(new Map(), context);\n\n  static fromMapWithContext = (map: DictMap, context: PDFContext) =>\n    new PDFDict(map, context);\n\n  readonly context: PDFContext;\n\n  private readonly dict: DictMap;\n\n  protected constructor(map: DictMap, context: PDFContext) {\n    super();\n    this.dict = map;\n    this.context = context;\n  }\n\n  keys(): PDFName[] {\n    return Array.from(this.dict.keys());\n  }\n\n  values(): PDFObject[] {\n    return Array.from(this.dict.values());\n  }\n\n  entries(): [PDFName, PDFObject][] {\n    return Array.from(this.dict.entries());\n  }\n\n  set(key: PDFName, value: PDFObject): void {\n    this.dict.set(key, value);\n  }\n\n  get(\n    key: PDFName,\n    // TODO: `preservePDFNull` is for backwards compatibility. Should be\n    // removed in next breaking API change.\n    preservePDFNull = false,\n  ): PDFObject | undefined {\n    const value = this.dict.get(key);\n    if (value === PDFNull && !preservePDFNull) return undefined;\n    return value;\n  }\n\n  has(key: PDFName): boolean {\n    const value = this.dict.get(key);\n    return value !== undefined && value !== PDFNull;\n  }\n\n  lookupMaybe(key: PDFName, type: typeof PDFArray): PDFArray | undefined;\n  lookupMaybe(key: PDFName, type: typeof PDFBool): PDFBool | undefined;\n  lookupMaybe(key: PDFName, type: typeof PDFDict): PDFDict | undefined;\n  lookupMaybe(\n    key: PDFName,\n    type: typeof PDFHexString,\n  ): PDFHexString | undefined;\n  lookupMaybe(key: PDFName, type: typeof PDFName): PDFName | undefined;\n  lookupMaybe(key: PDFName, type: typeof PDFNull): typeof PDFNull | undefined;\n  lookupMaybe(key: PDFName, type: typeof PDFNumber): PDFNumber | undefined;\n  lookupMaybe(key: PDFName, type: typeof PDFStream): PDFStream | undefined;\n  lookupMaybe(key: PDFName, type: typeof PDFRef): PDFRef | undefined;\n  lookupMaybe(key: PDFName, type: typeof PDFString): PDFString | undefined;\n  lookupMaybe(\n    ref: PDFName,\n    type1: typeof PDFString,\n    type2: typeof PDFHexString,\n  ): PDFString | PDFHexString | undefined;\n  lookupMaybe(\n    ref: PDFName,\n    type1: typeof PDFDict,\n    type2: typeof PDFStream,\n  ): PDFDict | PDFStream | undefined;\n  lookupMaybe(\n    ref: PDFName,\n    type1: typeof PDFString,\n    type2: typeof PDFHexString,\n    type3: typeof PDFArray,\n  ): PDFString | PDFHexString | PDFArray | undefined;\n\n  lookupMaybe(key: PDFName, ...types: any[]) {\n    // TODO: `preservePDFNull` is for backwards compatibility. Should be\n    // removed in next breaking API change.\n    const preservePDFNull = types.includes(PDFNull);\n\n    const value = this.context.lookupMaybe(\n      this.get(key, preservePDFNull),\n      // @ts-ignore\n      ...types,\n    ) as any;\n\n    if (value === PDFNull && !preservePDFNull) return undefined;\n\n    return value;\n  }\n\n  lookup(key: PDFName): PDFObject | undefined;\n  lookup(key: PDFName, type: typeof PDFArray): PDFArray;\n  lookup(key: PDFName, type: typeof PDFBool): PDFBool;\n  lookup(key: PDFName, type: typeof PDFDict): PDFDict;\n  lookup(key: PDFName, type: typeof PDFHexString): PDFHexString;\n  lookup(key: PDFName, type: typeof PDFName): PDFName;\n  lookup(key: PDFName, type: typeof PDFNull): typeof PDFNull;\n  lookup(key: PDFName, type: typeof PDFNumber): PDFNumber;\n  lookup(key: PDFName, type: typeof PDFStream): PDFStream;\n  lookup(key: PDFName, type: typeof PDFRef): PDFRef;\n  lookup(key: PDFName, type: typeof PDFString): PDFString;\n  lookup(\n    ref: PDFName,\n    type1: typeof PDFString,\n    type2: typeof PDFHexString,\n  ): PDFString | PDFHexString;\n  lookup(\n    ref: PDFName,\n    type1: typeof PDFDict,\n    type2: typeof PDFStream,\n  ): PDFDict | PDFStream;\n  lookup(\n    ref: PDFName,\n    type1: typeof PDFString,\n    type2: typeof PDFHexString,\n    type3: typeof PDFArray,\n  ): PDFString | PDFHexString | PDFArray;\n\n  lookup(key: PDFName, ...types: any[]) {\n    // TODO: `preservePDFNull` is for backwards compatibility. Should be\n    // removed in next breaking API change.\n    const preservePDFNull = types.includes(PDFNull);\n\n    const value = this.context.lookup(\n      this.get(key, preservePDFNull),\n      // @ts-ignore\n      ...types,\n    ) as any;\n\n    if (value === PDFNull && !preservePDFNull) return undefined;\n\n    return value;\n  }\n\n  delete(key: PDFName): boolean {\n    return this.dict.delete(key);\n  }\n\n  asMap(): Map<PDFName, PDFObject> {\n    return new Map(this.dict);\n  }\n\n  /** Generate a random key that doesn't exist in current key set */\n  uniqueKey(tag = ''): PDFName {\n    const existingKeys = this.keys();\n    let key = PDFName.of(this.context.addRandomSuffix(tag, 10));\n    while (existingKeys.includes(key)) {\n      key = PDFName.of(this.context.addRandomSuffix(tag, 10));\n    }\n    return key;\n  }\n\n  clone(context?: PDFContext): PDFDict {\n    const clone = PDFDict.withContext(context || this.context);\n    const entries = this.entries();\n    for (let idx = 0, len = entries.length; idx < len; idx++) {\n      const [key, value] = entries[idx];\n      clone.set(key, value);\n    }\n    return clone;\n  }\n\n  toString(): string {\n    let dictString = '<<\\n';\n    const entries = this.entries();\n    for (let idx = 0, len = entries.length; idx < len; idx++) {\n      const [key, value] = entries[idx];\n      dictString += key.toString() + ' ' + value.toString() + '\\n';\n    }\n    dictString += '>>';\n    return dictString;\n  }\n\n  sizeInBytes(): number {\n    let size = 5;\n    const entries = this.entries();\n    for (let idx = 0, len = entries.length; idx < len; idx++) {\n      const [key, value] = entries[idx];\n      size += key.sizeInBytes() + value.sizeInBytes() + 2;\n    }\n    return size;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    const initialOffset = offset;\n\n    buffer[offset++] = CharCodes.LessThan;\n    buffer[offset++] = CharCodes.LessThan;\n    buffer[offset++] = CharCodes.Newline;\n\n    const entries = this.entries();\n    for (let idx = 0, len = entries.length; idx < len; idx++) {\n      const [key, value] = entries[idx];\n      offset += key.copyBytesInto(buffer, offset);\n      buffer[offset++] = CharCodes.Space;\n      offset += value.copyBytesInto(buffer, offset);\n      buffer[offset++] = CharCodes.Newline;\n    }\n\n    buffer[offset++] = CharCodes.GreaterThan;\n    buffer[offset++] = CharCodes.GreaterThan;\n\n    return offset - initialOffset;\n  }\n}\n\nexport default PDFDict;\n","import { MethodNotImplementedError } from 'src/core/errors';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFContext from 'src/core/PDFContext';\nimport CharCodes from 'src/core/syntax/CharCodes';\n\nclass PDFStream extends PDFObject {\n  readonly dict: PDFDict;\n\n  constructor(dict: PDFDict) {\n    super();\n    this.dict = dict;\n  }\n\n  clone(_context?: PDFContext): PDFStream {\n    throw new MethodNotImplementedError(this.constructor.name, 'clone');\n  }\n\n  getContentsString(): string {\n    throw new MethodNotImplementedError(\n      this.constructor.name,\n      'getContentsString',\n    );\n  }\n\n  getContents(): Uint8Array {\n    throw new MethodNotImplementedError(this.constructor.name, 'getContents');\n  }\n\n  getContentsSize(): number {\n    throw new MethodNotImplementedError(\n      this.constructor.name,\n      'getContentsSize',\n    );\n  }\n\n  updateDict(): void {\n    const contentsSize = this.getContentsSize();\n    this.dict.set(PDFName.Length, PDFNumber.of(contentsSize));\n  }\n\n  sizeInBytes(): number {\n    this.updateDict();\n    return this.dict.sizeInBytes() + this.getContentsSize() + 18;\n  }\n\n  toString(): string {\n    this.updateDict();\n    let streamString = this.dict.toString();\n    streamString += '\\nstream\\n';\n    streamString += this.getContentsString();\n    streamString += '\\nendstream';\n    return streamString;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    this.updateDict();\n    const initialOffset = offset;\n\n    offset += this.dict.copyBytesInto(buffer, offset);\n    buffer[offset++] = CharCodes.Newline;\n\n    buffer[offset++] = CharCodes.s;\n    buffer[offset++] = CharCodes.t;\n    buffer[offset++] = CharCodes.r;\n    buffer[offset++] = CharCodes.e;\n    buffer[offset++] = CharCodes.a;\n    buffer[offset++] = CharCodes.m;\n    buffer[offset++] = CharCodes.Newline;\n\n    const contents = this.getContents();\n    for (let idx = 0, len = contents.length; idx < len; idx++) {\n      buffer[offset++] = contents[idx];\n    }\n\n    buffer[offset++] = CharCodes.Newline;\n    buffer[offset++] = CharCodes.e;\n    buffer[offset++] = CharCodes.n;\n    buffer[offset++] = CharCodes.d;\n    buffer[offset++] = CharCodes.s;\n    buffer[offset++] = CharCodes.t;\n    buffer[offset++] = CharCodes.r;\n    buffer[offset++] = CharCodes.e;\n    buffer[offset++] = CharCodes.a;\n    buffer[offset++] = CharCodes.m;\n\n    return offset - initialOffset;\n  }\n}\n\nexport default PDFStream;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport PDFStream from 'src/core/objects/PDFStream';\nimport PDFContext from 'src/core/PDFContext';\nimport { arrayAsString } from 'src/utils';\n\nclass PDFRawStream extends PDFStream {\n  static of = (dict: PDFDict, contents: Uint8Array) =>\n    new PDFRawStream(dict, contents);\n\n  readonly contents: Uint8Array;\n\n  private constructor(dict: PDFDict, contents: Uint8Array) {\n    super(dict);\n    this.contents = contents;\n  }\n\n  asUint8Array(): Uint8Array {\n    return this.contents.slice();\n  }\n\n  clone(context?: PDFContext): PDFRawStream {\n    return PDFRawStream.of(this.dict.clone(context), this.contents.slice());\n  }\n\n  getContentsString(): string {\n    return arrayAsString(this.contents);\n  }\n\n  getContents(): Uint8Array {\n    return this.contents;\n  }\n\n  getContentsSize(): number {\n    return this.contents.length;\n  }\n}\n\nexport default PDFRawStream;\n","import { PrivateConstructorError } from 'src/core/errors';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport { copyStringIntoBuffer } from 'src/utils';\n\nconst ENFORCER = {};\nconst pool = new Map<string, PDFRef>();\n\nclass PDFRef extends PDFObject {\n  static of = (objectNumber: number, generationNumber = 0) => {\n    const tag = `${objectNumber} ${generationNumber} R`;\n\n    let instance = pool.get(tag);\n    if (!instance) {\n      instance = new PDFRef(ENFORCER, objectNumber, generationNumber);\n      pool.set(tag, instance);\n    }\n\n    return instance;\n  };\n\n  readonly objectNumber: number;\n  readonly generationNumber: number;\n  readonly tag: string;\n\n  private constructor(\n    enforcer: any,\n    objectNumber: number,\n    generationNumber: number,\n  ) {\n    if (enforcer !== ENFORCER) throw new PrivateConstructorError('PDFRef');\n    super();\n    this.objectNumber = objectNumber;\n    this.generationNumber = generationNumber;\n    this.tag = `${objectNumber} ${generationNumber} R`;\n  }\n\n  clone(): PDFRef {\n    return this;\n  }\n\n  toString(): string {\n    return this.tag;\n  }\n\n  sizeInBytes(): number {\n    return this.tag.length;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    offset += copyStringIntoBuffer(this.tag, buffer, offset);\n    return this.tag.length;\n  }\n}\n\nexport default PDFRef;\n","import PDFArray from 'src/core/objects/PDFArray';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFString from 'src/core/objects/PDFString';\nimport PDFOperatorNames from 'src/core/operators/PDFOperatorNames';\nimport PDFContext from 'src/core/PDFContext';\nimport CharCodes from 'src/core/syntax/CharCodes';\nimport { copyStringIntoBuffer } from 'src/utils';\n\nexport type PDFOperatorArg =\n  | string\n  | PDFName\n  | PDFArray\n  | PDFNumber\n  | PDFString\n  | PDFHexString;\n\nclass PDFOperator {\n  static of = (name: PDFOperatorNames, args?: PDFOperatorArg[]) =>\n    new PDFOperator(name, args);\n\n  private readonly name: PDFOperatorNames;\n  private readonly args: PDFOperatorArg[];\n\n  private constructor(name: PDFOperatorNames, args?: PDFOperatorArg[]) {\n    this.name = name;\n    this.args = args || [];\n  }\n\n  clone(context?: PDFContext): PDFOperator {\n    const args = new Array(this.args.length);\n    for (let idx = 0, len = args.length; idx < len; idx++) {\n      const arg = this.args[idx];\n      args[idx] = arg instanceof PDFObject ? arg.clone(context) : arg;\n    }\n    return PDFOperator.of(this.name, args);\n  }\n\n  toString(): string {\n    let value = '';\n    for (let idx = 0, len = this.args.length; idx < len; idx++) {\n      value += String(this.args[idx]) + ' ';\n    }\n    value += this.name;\n    return value;\n  }\n\n  sizeInBytes(): number {\n    let size = 0;\n    for (let idx = 0, len = this.args.length; idx < len; idx++) {\n      const arg = this.args[idx];\n      size += (arg instanceof PDFObject ? arg.sizeInBytes() : arg.length) + 1;\n    }\n    size += this.name.length;\n    return size;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    const initialOffset = offset;\n\n    for (let idx = 0, len = this.args.length; idx < len; idx++) {\n      const arg = this.args[idx];\n      if (arg instanceof PDFObject) {\n        offset += arg.copyBytesInto(buffer, offset);\n      } else {\n        offset += copyStringIntoBuffer(arg, buffer, offset);\n      }\n      buffer[offset++] = CharCodes.Space;\n    }\n\n    offset += copyStringIntoBuffer(this.name, buffer, offset);\n\n    return offset - initialOffset;\n  }\n}\n\nexport default PDFOperator;\n","enum PDFOperatorNames {\n  // Non Stroking Color Operators\n  NonStrokingColor = 'sc',\n  NonStrokingColorN = 'scn',\n  NonStrokingColorRgb = 'rg',\n  NonStrokingColorGray = 'g',\n  NonStrokingColorCmyk = 'k',\n  NonStrokingColorspace = 'cs',\n\n  // Stroking Color Operators\n  StrokingColor = 'SC',\n  StrokingColorN = 'SCN',\n  StrokingColorRgb = 'RG',\n  StrokingColorGray = 'G',\n  StrokingColorCmyk = 'K',\n  StrokingColorspace = 'CS',\n\n  // Marked Content Operators\n  BeginMarkedContentSequence = 'BDC',\n  BeginMarkedContent = 'BMC',\n  EndMarkedContent = 'EMC',\n  MarkedContentPointWithProps = 'DP',\n  MarkedContentPoint = 'MP',\n  DrawObject = 'Do',\n\n  // Graphics State Operators\n  ConcatTransformationMatrix = 'cm',\n  PopGraphicsState = 'Q',\n  PushGraphicsState = 'q',\n  SetFlatness = 'i',\n  SetGraphicsStateParams = 'gs',\n  SetLineCapStyle = 'J',\n  SetLineDashPattern = 'd',\n  SetLineJoinStyle = 'j',\n  SetLineMiterLimit = 'M',\n  SetLineWidth = 'w',\n  SetTextMatrix = 'Tm',\n  SetRenderingIntent = 'ri',\n\n  // Graphics Operators\n  AppendRectangle = 're',\n  BeginInlineImage = 'BI',\n  BeginInlineImageData = 'ID',\n  EndInlineImage = 'EI',\n  ClipEvenOdd = 'W*',\n  ClipNonZero = 'W',\n  CloseAndStroke = 's',\n  CloseFillEvenOddAndStroke = 'b*',\n  CloseFillNonZeroAndStroke = 'b',\n  ClosePath = 'h',\n  AppendBezierCurve = 'c',\n  CurveToReplicateFinalPoint = 'y',\n  CurveToReplicateInitialPoint = 'v',\n  EndPath = 'n',\n  FillEvenOddAndStroke = 'B*',\n  FillEvenOdd = 'f*',\n  FillNonZeroAndStroke = 'B',\n  FillNonZero = 'f',\n  LegacyFillNonZero = 'F',\n  LineTo = 'l',\n  MoveTo = 'm',\n  ShadingFill = 'sh',\n  StrokePath = 'S',\n\n  // Text Operators\n  BeginText = 'BT',\n  EndText = 'ET',\n  MoveText = 'Td',\n  MoveTextSetLeading = 'TD',\n  NextLine = 'T*',\n  SetCharacterSpacing = 'Tc',\n  SetFontAndSize = 'Tf',\n  SetTextHorizontalScaling = 'Tz',\n  SetTextLineHeight = 'TL',\n  SetTextRenderingMode = 'Tr',\n  SetTextRise = 'Ts',\n  SetWordSpacing = 'Tw',\n  ShowText = 'Tj',\n  ShowTextAdjusted = 'TJ',\n  ShowTextLine = \"'\", // tslint:disable-line quotemark\n  ShowTextLineAndSpace = '\"',\n\n  // Type3 Font Operators\n  Type3D0 = 'd0',\n  Type3D1 = 'd1',\n\n  // Compatibility Section Operators\n  BeginCompatibilitySection = 'BX',\n  EndCompatibilitySection = 'EX'\n}\n\nexport default PDFOperatorNames;\n","import pako from 'pako';\n\nimport { MethodNotImplementedError } from 'src/core/errors';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFStream from 'src/core/objects/PDFStream';\nimport { Cache } from 'src/utils';\n\nclass PDFFlateStream extends PDFStream {\n  protected readonly contentsCache: Cache<Uint8Array>;\n  protected readonly encode: boolean;\n\n  constructor(dict: PDFDict, encode: boolean) {\n    super(dict);\n\n    this.encode = encode;\n\n    if (encode) dict.set(PDFName.of('Filter'), PDFName.of('FlateDecode'));\n    this.contentsCache = Cache.populatedBy(this.computeContents);\n  }\n\n  computeContents = (): Uint8Array => {\n    const unencodedContents = this.getUnencodedContents();\n    return this.encode ? pako.deflate(unencodedContents) : unencodedContents;\n  };\n\n  getContents(): Uint8Array {\n    return this.contentsCache.access();\n  }\n\n  getContentsSize(): number {\n    return this.contentsCache.access().length;\n  }\n\n  getUnencodedContents(): Uint8Array {\n    throw new MethodNotImplementedError(\n      this.constructor.name,\n      'getUnencodedContents',\n    );\n  }\n}\n\nexport default PDFFlateStream;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport PDFOperator from 'src/core/operators/PDFOperator';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFFlateStream from 'src/core/structures/PDFFlateStream';\nimport CharCodes from 'src/core/syntax/CharCodes';\n\nclass PDFContentStream extends PDFFlateStream {\n  static of = (dict: PDFDict, operators: PDFOperator[], encode = true) =>\n    new PDFContentStream(dict, operators, encode);\n\n  private readonly operators: PDFOperator[];\n\n  private constructor(dict: PDFDict, operators: PDFOperator[], encode = true) {\n    super(dict, encode);\n    this.operators = operators;\n  }\n\n  push(...operators: PDFOperator[]): void {\n    this.operators.push(...operators);\n  }\n\n  clone(context?: PDFContext): PDFContentStream {\n    const operators = new Array(this.operators.length);\n    for (let idx = 0, len = this.operators.length; idx < len; idx++) {\n      operators[idx] = this.operators[idx].clone(context);\n    }\n    const { dict, encode } = this;\n    return PDFContentStream.of(dict.clone(context), operators, encode);\n  }\n\n  getContentsString(): string {\n    let value = '';\n    for (let idx = 0, len = this.operators.length; idx < len; idx++) {\n      value += `${this.operators[idx]}\\n`;\n    }\n    return value;\n  }\n\n  getUnencodedContents(): Uint8Array {\n    const buffer = new Uint8Array(this.getUnencodedContentsSize());\n    let offset = 0;\n    for (let idx = 0, len = this.operators.length; idx < len; idx++) {\n      offset += this.operators[idx].copyBytesInto(buffer, offset);\n      buffer[offset++] = CharCodes.Newline;\n    }\n    return buffer;\n  }\n\n  getUnencodedContentsSize(): number {\n    let size = 0;\n    for (let idx = 0, len = this.operators.length; idx < len; idx++) {\n      size += this.operators[idx].sizeInBytes() + 1;\n    }\n    return size;\n  }\n}\n\nexport default PDFContentStream;\n","/**\n * Generates a pseudo random number. Although it is not cryptographically secure\n * and uniformly distributed, it is not a concern for the intended use-case,\n * which is to generate distinct numbers.\n *\n * Credit: https://stackoverflow.com/a/19303725/10254049\n */\nexport class SimpleRNG {\n  static withSeed = (seed: number) => new SimpleRNG(seed);\n\n  private seed: number;\n\n  private constructor(seed: number) {\n    this.seed = seed;\n  }\n\n  nextInt(): number {\n    const x = Math.sin(this.seed++) * 10000;\n    return x - Math.floor(x);\n  }\n}\n","import PDFArray from 'src/core/objects/PDFArray';\nimport PDFDict, { DictMap } from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFStream from 'src/core/objects/PDFStream';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFPageTree from 'src/core/structures/PDFPageTree';\n\nclass PDFPageLeaf extends PDFDict {\n  static readonly InheritableEntries = [\n    'Resources',\n    'MediaBox',\n    'CropBox',\n    'Rotate',\n  ];\n\n  static withContextAndParent = (context: PDFContext, parent: PDFRef) => {\n    const dict = new Map();\n    dict.set(PDFName.Type, PDFName.Page);\n    dict.set(PDFName.Parent, parent);\n    dict.set(PDFName.Resources, context.obj({}));\n    dict.set(PDFName.MediaBox, context.obj([0, 0, 612, 792]));\n    return new PDFPageLeaf(dict, context, false);\n  };\n\n  static fromMapWithContext = (\n    map: DictMap,\n    context: PDFContext,\n    autoNormalizeCTM = true,\n  ) => new PDFPageLeaf(map, context, autoNormalizeCTM);\n\n  private normalized = false;\n  private readonly autoNormalizeCTM: boolean;\n\n  private constructor(\n    map: DictMap,\n    context: PDFContext,\n    autoNormalizeCTM = true,\n  ) {\n    super(map, context);\n    this.autoNormalizeCTM = autoNormalizeCTM;\n  }\n\n  clone(context?: PDFContext): PDFPageLeaf {\n    const clone = PDFPageLeaf.fromMapWithContext(\n      new Map(),\n      context || this.context,\n      this.autoNormalizeCTM,\n    );\n    const entries = this.entries();\n    for (let idx = 0, len = entries.length; idx < len; idx++) {\n      const [key, value] = entries[idx];\n      clone.set(key, value);\n    }\n    return clone;\n  }\n\n  Parent(): PDFPageTree | undefined {\n    return this.lookupMaybe(PDFName.Parent, PDFDict) as PDFPageTree | undefined;\n  }\n\n  Contents(): PDFStream | PDFArray | undefined {\n    return this.lookup(PDFName.of('Contents')) as\n      | PDFStream\n      | PDFArray\n      | undefined;\n  }\n\n  Annots(): PDFArray | undefined {\n    return this.lookupMaybe(PDFName.Annots, PDFArray);\n  }\n\n  BleedBox(): PDFArray | undefined {\n    return this.lookupMaybe(PDFName.BleedBox, PDFArray);\n  }\n\n  TrimBox(): PDFArray | undefined {\n    return this.lookupMaybe(PDFName.TrimBox, PDFArray);\n  }\n\n  ArtBox(): PDFArray | undefined {\n    return this.lookupMaybe(PDFName.ArtBox, PDFArray);\n  }\n\n  Resources(): PDFDict | undefined {\n    const dictOrRef = this.getInheritableAttribute(PDFName.Resources);\n    return this.context.lookupMaybe(dictOrRef, PDFDict);\n  }\n\n  MediaBox(): PDFArray {\n    const arrayOrRef = this.getInheritableAttribute(PDFName.MediaBox);\n    return this.context.lookup(arrayOrRef, PDFArray);\n  }\n\n  CropBox(): PDFArray | undefined {\n    const arrayOrRef = this.getInheritableAttribute(PDFName.CropBox);\n    return this.context.lookupMaybe(arrayOrRef, PDFArray);\n  }\n\n  Rotate(): PDFNumber | undefined {\n    const numberOrRef = this.getInheritableAttribute(PDFName.Rotate);\n    return this.context.lookupMaybe(numberOrRef, PDFNumber);\n  }\n\n  getInheritableAttribute(name: PDFName): PDFObject | undefined {\n    let attribute: PDFObject | undefined;\n    this.ascend((node) => {\n      if (!attribute) attribute = node.get(name);\n    });\n    return attribute;\n  }\n\n  setParent(parentRef: PDFRef): void {\n    this.set(PDFName.Parent, parentRef);\n  }\n\n  addContentStream(contentStreamRef: PDFRef): void {\n    const Contents = this.normalizedEntries().Contents || this.context.obj([]);\n    this.set(PDFName.Contents, Contents);\n    Contents.push(contentStreamRef);\n  }\n\n  wrapContentStreams(startStream: PDFRef, endStream: PDFRef): boolean {\n    const Contents = this.Contents();\n    if (Contents instanceof PDFArray) {\n      Contents.insert(0, startStream);\n      Contents.push(endStream);\n      return true;\n    }\n    return false;\n  }\n\n  addAnnot(annotRef: PDFRef): void {\n    const { Annots } = this.normalizedEntries();\n    Annots.push(annotRef);\n  }\n\n  removeAnnot(annotRef: PDFRef) {\n    const { Annots } = this.normalizedEntries();\n    const index = Annots.indexOf(annotRef);\n    if (index !== undefined) {\n      Annots.remove(index);\n    }\n  }\n\n  setFontDictionary(name: PDFName, fontDictRef: PDFRef): void {\n    const { Font } = this.normalizedEntries();\n    Font.set(name, fontDictRef);\n  }\n\n  newFontDictionaryKey(tag: string): PDFName {\n    const { Font } = this.normalizedEntries();\n    return Font.uniqueKey(tag);\n  }\n\n  newFontDictionary(tag: string, fontDictRef: PDFRef): PDFName {\n    const key = this.newFontDictionaryKey(tag);\n    this.setFontDictionary(key, fontDictRef);\n    return key;\n  }\n\n  setXObject(name: PDFName, xObjectRef: PDFRef): void {\n    const { XObject } = this.normalizedEntries();\n    XObject.set(name, xObjectRef);\n  }\n\n  newXObjectKey(tag: string): PDFName {\n    const { XObject } = this.normalizedEntries();\n    return XObject.uniqueKey(tag);\n  }\n\n  newXObject(tag: string, xObjectRef: PDFRef): PDFName {\n    const key = this.newXObjectKey(tag);\n    this.setXObject(key, xObjectRef);\n    return key;\n  }\n\n  setExtGState(name: PDFName, extGStateRef: PDFRef | PDFDict): void {\n    const { ExtGState } = this.normalizedEntries();\n    ExtGState.set(name, extGStateRef);\n  }\n\n  newExtGStateKey(tag: string): PDFName {\n    const { ExtGState } = this.normalizedEntries();\n    return ExtGState.uniqueKey(tag);\n  }\n\n  newExtGState(tag: string, extGStateRef: PDFRef | PDFDict): PDFName {\n    const key = this.newExtGStateKey(tag);\n    this.setExtGState(key, extGStateRef);\n    return key;\n  }\n\n  ascend(visitor: (node: PDFPageTree | PDFPageLeaf) => any): void {\n    visitor(this);\n    const Parent = this.Parent();\n    if (Parent) Parent.ascend(visitor);\n  }\n\n  normalize() {\n    if (this.normalized) return;\n\n    const { context } = this;\n\n    const contentsRef = this.get(PDFName.Contents);\n    const contents = this.context.lookup(contentsRef);\n    if (contents instanceof PDFStream) {\n      this.set(PDFName.Contents, context.obj([contentsRef]));\n    }\n\n    if (this.autoNormalizeCTM) {\n      this.wrapContentStreams(\n        this.context.getPushGraphicsStateContentStream(),\n        this.context.getPopGraphicsStateContentStream(),\n      );\n    }\n\n    // TODO: Clone `Resources` if it is inherited\n    const dictOrRef = this.getInheritableAttribute(PDFName.Resources);\n    const Resources =\n      context.lookupMaybe(dictOrRef, PDFDict) || context.obj({});\n    this.set(PDFName.Resources, Resources);\n\n    // TODO: Clone `Font` if it is inherited\n    const Font =\n      Resources.lookupMaybe(PDFName.Font, PDFDict) || context.obj({});\n    Resources.set(PDFName.Font, Font);\n\n    // TODO: Clone `XObject` if it is inherited\n    const XObject =\n      Resources.lookupMaybe(PDFName.XObject, PDFDict) || context.obj({});\n    Resources.set(PDFName.XObject, XObject);\n\n    // TODO: Clone `ExtGState` if it is inherited\n    const ExtGState =\n      Resources.lookupMaybe(PDFName.ExtGState, PDFDict) || context.obj({});\n    Resources.set(PDFName.ExtGState, ExtGState);\n\n    const Annots = this.Annots() || context.obj([]);\n    this.set(PDFName.Annots, Annots);\n\n    this.normalized = true;\n  }\n\n  normalizedEntries() {\n    this.normalize();\n    const Annots = this.Annots()!;\n    const Resources = this.Resources()!;\n    const Contents = this.Contents() as PDFArray | undefined;\n    return {\n      Annots,\n      Resources,\n      Contents,\n      Font: Resources.lookup(PDFName.Font, PDFDict),\n      XObject: Resources.lookup(PDFName.XObject, PDFDict),\n      ExtGState: Resources.lookup(PDFName.ExtGState, PDFDict),\n    };\n  }\n}\n\nexport default PDFPageLeaf;\n","import PDFArray from 'src/core/objects/PDFArray';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFStream from 'src/core/objects/PDFStream';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFPageLeaf from 'src/core/structures/PDFPageLeaf';\n\n/**\n * PDFObjectCopier copies PDFObjects from a src context to a dest context.\n * The primary use case for this is to copy pages between PDFs.\n *\n * _Copying_ an object with a PDFObjectCopier is different from _cloning_ an\n * object with its [[PDFObject.clone]] method:\n *\n * ```\n *   const src: PDFContext = ...\n *   const dest: PDFContext = ...\n *   const originalObject: PDFObject = ...\n *   const copiedObject = PDFObjectCopier.for(src, dest).copy(originalObject);\n *   const clonedObject = originalObject.clone();\n * ```\n *\n * Copying an object is equivalent to cloning it and then copying over any other\n * objects that it references. Note that only dictionaries, arrays, and streams\n * (or structures build from them) can contain indirect references to other\n * objects. Copying a PDFObject that is not a dictionary, array, or stream is\n * supported, but is equivalent to cloning it.\n */\nclass PDFObjectCopier {\n  static for = (src: PDFContext, dest: PDFContext) =>\n    new PDFObjectCopier(src, dest);\n\n  private readonly src: PDFContext;\n  private readonly dest: PDFContext;\n  private readonly traversedObjects = new Map<PDFObject, PDFObject>();\n\n  private constructor(src: PDFContext, dest: PDFContext) {\n    this.src = src;\n    this.dest = dest;\n  }\n\n  // prettier-ignore\n  copy = <T extends PDFObject>(object: T): T => (\n    object instanceof PDFPageLeaf ? this.copyPDFPage(object)\n      : object instanceof PDFDict     ? this.copyPDFDict(object)\n        : object instanceof PDFArray    ? this.copyPDFArray(object)\n          : object instanceof PDFStream   ? this.copyPDFStream(object)\n            : object instanceof PDFRef      ? this.copyPDFIndirectObject(object)\n              : object.clone()\n  ) as T;\n\n  private copyPDFPage = (originalPage: PDFPageLeaf): PDFPageLeaf => {\n    const clonedPage = originalPage.clone();\n\n    // Move any entries that the originalPage is inheriting from its parent\n    // tree nodes directly into originalPage so they are preserved during\n    // the copy.\n    const { InheritableEntries } = PDFPageLeaf;\n    for (let idx = 0, len = InheritableEntries.length; idx < len; idx++) {\n      const key = PDFName.of(InheritableEntries[idx]);\n      const value = clonedPage.getInheritableAttribute(key)!;\n      if (!clonedPage.get(key) && value) clonedPage.set(key, value);\n    }\n\n    // Remove the parent reference to prevent the whole donor document's page\n    // tree from being copied when we only need a single page.\n    clonedPage.delete(PDFName.of('Parent'));\n\n    return this.copyPDFDict(clonedPage) as PDFPageLeaf;\n  };\n\n  private copyPDFDict = (originalDict: PDFDict): PDFDict => {\n    if (this.traversedObjects.has(originalDict)) {\n      return this.traversedObjects.get(originalDict) as PDFDict;\n    }\n\n    const clonedDict = originalDict.clone(this.dest);\n    this.traversedObjects.set(originalDict, clonedDict);\n\n    const entries = originalDict.entries();\n\n    for (let idx = 0, len = entries.length; idx < len; idx++) {\n      const [key, value] = entries[idx];\n      clonedDict.set(key, this.copy(value));\n    }\n\n    return clonedDict;\n  };\n\n  private copyPDFArray = (originalArray: PDFArray): PDFArray => {\n    if (this.traversedObjects.has(originalArray)) {\n      return this.traversedObjects.get(originalArray) as PDFArray;\n    }\n\n    const clonedArray = originalArray.clone(this.dest);\n    this.traversedObjects.set(originalArray, clonedArray);\n\n    for (let idx = 0, len = originalArray.size(); idx < len; idx++) {\n      const value = originalArray.get(idx);\n      clonedArray.set(idx, this.copy(value));\n    }\n\n    return clonedArray;\n  };\n\n  private copyPDFStream = (originalStream: PDFStream): PDFStream => {\n    if (this.traversedObjects.has(originalStream)) {\n      return this.traversedObjects.get(originalStream) as PDFStream;\n    }\n\n    const clonedStream = originalStream.clone(this.dest);\n    this.traversedObjects.set(originalStream, clonedStream);\n\n    const entries = originalStream.dict.entries();\n    for (let idx = 0, len = entries.length; idx < len; idx++) {\n      const [key, value] = entries[idx];\n      clonedStream.dict.set(key, this.copy(value));\n    }\n\n    return clonedStream;\n  };\n\n  private copyPDFIndirectObject = (ref: PDFRef): PDFRef => {\n    const alreadyMapped = this.traversedObjects.has(ref);\n\n    if (!alreadyMapped) {\n      const newRef = this.dest.nextRef();\n      this.traversedObjects.set(ref, newRef);\n\n      const dereferencedValue = this.src.lookup(ref);\n      if (dereferencedValue) {\n        const cloned = this.copy(dereferencedValue);\n        this.dest.assign(newRef, cloned);\n      }\n    }\n\n    return this.traversedObjects.get(ref) as PDFRef;\n  };\n}\n\nexport default PDFObjectCopier;\n","import PDFRef from 'src/core/objects/PDFRef';\nimport CharCodes from 'src/core/syntax/CharCodes';\nimport { copyStringIntoBuffer, padStart } from 'src/utils';\n\nexport interface Entry {\n  ref: PDFRef;\n  offset: number;\n  deleted: boolean;\n}\n\n/**\n * Entries should be added using the [[addEntry]] and [[addDeletedEntry]]\n * methods **in order of ascending object number**.\n */\nclass PDFCrossRefSection {\n  static create = () =>\n    new PDFCrossRefSection({\n      ref: PDFRef.of(0, 65535),\n      offset: 0,\n      deleted: true,\n    });\n\n  static createEmpty = () => new PDFCrossRefSection();\n\n  private subsections: Entry[][];\n  private chunkIdx: number;\n  private chunkLength: number;\n\n  private constructor(firstEntry: Entry | void) {\n    this.subsections = firstEntry ? [[firstEntry]] : [];\n    this.chunkIdx = 0;\n    this.chunkLength = firstEntry ? 1 : 0;\n  }\n\n  addEntry(ref: PDFRef, offset: number): void {\n    this.append({ ref, offset, deleted: false });\n  }\n\n  addDeletedEntry(ref: PDFRef, nextFreeObjectNumber: number): void {\n    this.append({ ref, offset: nextFreeObjectNumber, deleted: true });\n  }\n\n  toString(): string {\n    let section = 'xref\\n';\n\n    for (\n      let rangeIdx = 0, rangeLen = this.subsections.length;\n      rangeIdx < rangeLen;\n      rangeIdx++\n    ) {\n      const range = this.subsections[rangeIdx];\n      section += `${range[0].ref.objectNumber} ${range.length}\\n`;\n      for (\n        let entryIdx = 0, entryLen = range.length;\n        entryIdx < entryLen;\n        entryIdx++\n      ) {\n        const entry = range[entryIdx];\n        section += padStart(String(entry.offset), 10, '0');\n        section += ' ';\n        section += padStart(String(entry.ref.generationNumber), 5, '0');\n        section += ' ';\n        section += entry.deleted ? 'f' : 'n';\n        section += ' \\n';\n      }\n    }\n\n    return section;\n  }\n\n  sizeInBytes(): number {\n    let size = 5;\n    for (let idx = 0, len = this.subsections.length; idx < len; idx++) {\n      const subsection = this.subsections[idx];\n      const subsectionLength = subsection.length;\n      const [firstEntry] = subsection;\n      size += 2;\n      size += String(firstEntry.ref.objectNumber).length;\n      size += String(subsectionLength).length;\n      size += 20 * subsectionLength;\n    }\n    return size;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    const initialOffset = offset;\n\n    buffer[offset++] = CharCodes.x;\n    buffer[offset++] = CharCodes.r;\n    buffer[offset++] = CharCodes.e;\n    buffer[offset++] = CharCodes.f;\n    buffer[offset++] = CharCodes.Newline;\n\n    offset += this.copySubsectionsIntoBuffer(this.subsections, buffer, offset);\n\n    return offset - initialOffset;\n  }\n\n  private copySubsectionsIntoBuffer(\n    subsections: Entry[][],\n    buffer: Uint8Array,\n    offset: number,\n  ): number {\n    const initialOffset = offset;\n    const length = subsections.length;\n\n    for (let idx = 0; idx < length; idx++) {\n      const subsection = this.subsections[idx];\n\n      const firstObjectNumber = String(subsection[0].ref.objectNumber);\n      offset += copyStringIntoBuffer(firstObjectNumber, buffer, offset);\n      buffer[offset++] = CharCodes.Space;\n\n      const rangeLength = String(subsection.length);\n      offset += copyStringIntoBuffer(rangeLength, buffer, offset);\n      buffer[offset++] = CharCodes.Newline;\n\n      offset += this.copyEntriesIntoBuffer(subsection, buffer, offset);\n    }\n\n    return offset - initialOffset;\n  }\n\n  private copyEntriesIntoBuffer(\n    entries: Entry[],\n    buffer: Uint8Array,\n    offset: number,\n  ): number {\n    const length = entries.length;\n\n    for (let idx = 0; idx < length; idx++) {\n      const entry = entries[idx];\n\n      const entryOffset = padStart(String(entry.offset), 10, '0');\n      offset += copyStringIntoBuffer(entryOffset, buffer, offset);\n      buffer[offset++] = CharCodes.Space;\n\n      const entryGen = padStart(String(entry.ref.generationNumber), 5, '0');\n      offset += copyStringIntoBuffer(entryGen, buffer, offset);\n      buffer[offset++] = CharCodes.Space;\n\n      buffer[offset++] = entry.deleted ? CharCodes.f : CharCodes.n;\n\n      buffer[offset++] = CharCodes.Space;\n      buffer[offset++] = CharCodes.Newline;\n    }\n\n    return 20 * length;\n  }\n\n  private append(currEntry: Entry): void {\n    if (this.chunkLength === 0) {\n      this.subsections.push([currEntry]);\n      this.chunkIdx = 0;\n      this.chunkLength = 1;\n      return;\n    }\n\n    const chunk = this.subsections[this.chunkIdx];\n    const prevEntry = chunk[this.chunkLength - 1];\n\n    if (currEntry.ref.objectNumber - prevEntry.ref.objectNumber > 1) {\n      this.subsections.push([currEntry]);\n      this.chunkIdx += 1;\n      this.chunkLength = 1;\n    } else {\n      chunk.push(currEntry);\n      this.chunkLength += 1;\n    }\n  }\n}\n\nexport default PDFCrossRefSection;\n","import CharCodes from 'src/core/syntax/CharCodes';\nimport { copyStringIntoBuffer } from 'src/utils';\n\nclass PDFTrailer {\n  static forLastCrossRefSectionOffset = (offset: number) =>\n    new PDFTrailer(offset);\n\n  private readonly lastXRefOffset: string;\n\n  private constructor(lastXRefOffset: number) {\n    this.lastXRefOffset = String(lastXRefOffset);\n  }\n\n  toString(): string {\n    return `startxref\\n${this.lastXRefOffset}\\n%%EOF`;\n  }\n\n  sizeInBytes(): number {\n    return 16 + this.lastXRefOffset.length;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    const initialOffset = offset;\n\n    buffer[offset++] = CharCodes.s;\n    buffer[offset++] = CharCodes.t;\n    buffer[offset++] = CharCodes.a;\n    buffer[offset++] = CharCodes.r;\n    buffer[offset++] = CharCodes.t;\n    buffer[offset++] = CharCodes.x;\n    buffer[offset++] = CharCodes.r;\n    buffer[offset++] = CharCodes.e;\n    buffer[offset++] = CharCodes.f;\n    buffer[offset++] = CharCodes.Newline;\n\n    offset += copyStringIntoBuffer(this.lastXRefOffset, buffer, offset);\n\n    buffer[offset++] = CharCodes.Newline;\n    buffer[offset++] = CharCodes.Percent;\n    buffer[offset++] = CharCodes.Percent;\n    buffer[offset++] = CharCodes.E;\n    buffer[offset++] = CharCodes.O;\n    buffer[offset++] = CharCodes.F;\n\n    return offset - initialOffset;\n  }\n}\n\nexport default PDFTrailer;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport CharCodes from 'src/core/syntax/CharCodes';\n\nclass PDFTrailerDict {\n  static of = (dict: PDFDict) => new PDFTrailerDict(dict);\n\n  readonly dict: PDFDict;\n\n  private constructor(dict: PDFDict) {\n    this.dict = dict;\n  }\n\n  toString(): string {\n    return `trailer\\n${this.dict.toString()}`;\n  }\n\n  sizeInBytes(): number {\n    return 8 + this.dict.sizeInBytes();\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    const initialOffset = offset;\n\n    buffer[offset++] = CharCodes.t;\n    buffer[offset++] = CharCodes.r;\n    buffer[offset++] = CharCodes.a;\n    buffer[offset++] = CharCodes.i;\n    buffer[offset++] = CharCodes.l;\n    buffer[offset++] = CharCodes.e;\n    buffer[offset++] = CharCodes.r;\n    buffer[offset++] = CharCodes.Newline;\n\n    offset += this.dict.copyBytesInto(buffer, offset);\n\n    return offset - initialOffset;\n  }\n}\n\nexport default PDFTrailerDict;\n","import PDFName from 'src/core/objects/PDFName';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFFlateStream from 'src/core/structures/PDFFlateStream';\nimport CharCodes from 'src/core/syntax/CharCodes';\nimport { copyStringIntoBuffer, last } from 'src/utils';\n\nexport type IndirectObject = [PDFRef, PDFObject];\n\nclass PDFObjectStream extends PDFFlateStream {\n  static withContextAndObjects = (\n    context: PDFContext,\n    objects: IndirectObject[],\n    encode = true,\n  ) => new PDFObjectStream(context, objects, encode);\n\n  private readonly objects: IndirectObject[];\n  private readonly offsets: [number, number][];\n  private readonly offsetsString: string;\n\n  private constructor(\n    context: PDFContext,\n    objects: IndirectObject[],\n    encode = true,\n  ) {\n    super(context.obj({}), encode);\n\n    this.objects = objects;\n    this.offsets = this.computeObjectOffsets();\n    this.offsetsString = this.computeOffsetsString();\n\n    this.dict.set(PDFName.of('Type'), PDFName.of('ObjStm'));\n    this.dict.set(PDFName.of('N'), PDFNumber.of(this.objects.length));\n    this.dict.set(PDFName.of('First'), PDFNumber.of(this.offsetsString.length));\n  }\n\n  getObjectsCount(): number {\n    return this.objects.length;\n  }\n\n  clone(context?: PDFContext): PDFObjectStream {\n    return PDFObjectStream.withContextAndObjects(\n      context || this.dict.context,\n      this.objects.slice(),\n      this.encode,\n    );\n  }\n\n  getContentsString(): string {\n    let value = this.offsetsString;\n    for (let idx = 0, len = this.objects.length; idx < len; idx++) {\n      const [, object] = this.objects[idx];\n      value += `${object}\\n`;\n    }\n    return value;\n  }\n\n  getUnencodedContents(): Uint8Array {\n    const buffer = new Uint8Array(this.getUnencodedContentsSize());\n    let offset = copyStringIntoBuffer(this.offsetsString, buffer, 0);\n    for (let idx = 0, len = this.objects.length; idx < len; idx++) {\n      const [, object] = this.objects[idx];\n      offset += object.copyBytesInto(buffer, offset);\n      buffer[offset++] = CharCodes.Newline;\n    }\n    return buffer;\n  }\n\n  getUnencodedContentsSize(): number {\n    return (\n      this.offsetsString.length +\n      last(this.offsets)[1] +\n      last(this.objects)[1].sizeInBytes() +\n      1\n    );\n  }\n\n  private computeOffsetsString(): string {\n    let offsetsString = '';\n    for (let idx = 0, len = this.offsets.length; idx < len; idx++) {\n      const [objectNumber, offset] = this.offsets[idx];\n      offsetsString += `${objectNumber} ${offset} `;\n    }\n    return offsetsString;\n  }\n\n  private computeObjectOffsets(): [number, number][] {\n    let offset = 0;\n    const offsets = new Array(this.objects.length);\n    for (let idx = 0, len = this.objects.length; idx < len; idx++) {\n      const [ref, object] = this.objects[idx];\n      offsets[idx] = [ref.objectNumber, offset];\n      offset += object.sizeInBytes() + 1; // '\\n'\n    }\n    return offsets;\n  }\n}\n\nexport default PDFObjectStream;\n","import PDFCrossRefSection from 'src/core/document/PDFCrossRefSection';\nimport PDFHeader from 'src/core/document/PDFHeader';\nimport PDFTrailer from 'src/core/document/PDFTrailer';\nimport PDFTrailerDict from 'src/core/document/PDFTrailerDict';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFObjectStream from 'src/core/structures/PDFObjectStream';\nimport CharCodes from 'src/core/syntax/CharCodes';\nimport { copyStringIntoBuffer, waitForTick } from 'src/utils';\n\nexport interface SerializationInfo {\n  size: number;\n  header: PDFHeader;\n  indirectObjects: [PDFRef, PDFObject][];\n  xref?: PDFCrossRefSection;\n  trailerDict?: PDFTrailerDict;\n  trailer: PDFTrailer;\n}\n\nclass PDFWriter {\n  static forContext = (context: PDFContext, objectsPerTick: number) =>\n    new PDFWriter(context, objectsPerTick);\n\n  protected readonly context: PDFContext;\n\n  protected readonly objectsPerTick: number;\n  private parsedObjects = 0;\n\n  protected constructor(context: PDFContext, objectsPerTick: number) {\n    this.context = context;\n    this.objectsPerTick = objectsPerTick;\n  }\n\n  async serializeToBuffer(): Promise<Uint8Array> {\n    const { size, header, indirectObjects, xref, trailerDict, trailer } =\n      await this.computeBufferSize();\n\n    let offset = 0;\n    const buffer = new Uint8Array(size);\n\n    offset += header.copyBytesInto(buffer, offset);\n    buffer[offset++] = CharCodes.Newline;\n    buffer[offset++] = CharCodes.Newline;\n\n    for (let idx = 0, len = indirectObjects.length; idx < len; idx++) {\n      const [ref, object] = indirectObjects[idx];\n\n      const objectNumber = String(ref.objectNumber);\n      offset += copyStringIntoBuffer(objectNumber, buffer, offset);\n      buffer[offset++] = CharCodes.Space;\n\n      const generationNumber = String(ref.generationNumber);\n      offset += copyStringIntoBuffer(generationNumber, buffer, offset);\n      buffer[offset++] = CharCodes.Space;\n\n      buffer[offset++] = CharCodes.o;\n      buffer[offset++] = CharCodes.b;\n      buffer[offset++] = CharCodes.j;\n      buffer[offset++] = CharCodes.Newline;\n\n      offset += object.copyBytesInto(buffer, offset);\n\n      buffer[offset++] = CharCodes.Newline;\n      buffer[offset++] = CharCodes.e;\n      buffer[offset++] = CharCodes.n;\n      buffer[offset++] = CharCodes.d;\n      buffer[offset++] = CharCodes.o;\n      buffer[offset++] = CharCodes.b;\n      buffer[offset++] = CharCodes.j;\n      buffer[offset++] = CharCodes.Newline;\n      buffer[offset++] = CharCodes.Newline;\n\n      const n =\n        object instanceof PDFObjectStream ? object.getObjectsCount() : 1;\n      if (this.shouldWaitForTick(n)) await waitForTick();\n    }\n\n    if (xref) {\n      offset += xref.copyBytesInto(buffer, offset);\n      buffer[offset++] = CharCodes.Newline;\n    }\n\n    if (trailerDict) {\n      offset += trailerDict.copyBytesInto(buffer, offset);\n      buffer[offset++] = CharCodes.Newline;\n      buffer[offset++] = CharCodes.Newline;\n    }\n\n    offset += trailer.copyBytesInto(buffer, offset);\n\n    return buffer;\n  }\n\n  protected computeIndirectObjectSize([ref, object]: [\n    PDFRef,\n    PDFObject\n  ]): number {\n    const refSize = ref.sizeInBytes() + 3; // 'R' -> 'obj\\n'\n    const objectSize = object.sizeInBytes() + 9; // '\\nendobj\\n\\n'\n    return refSize + objectSize;\n  }\n\n  protected createTrailerDict(): PDFDict {\n    return this.context.obj({\n      Size: this.context.largestObjectNumber + 1,\n      Root: this.context.trailerInfo.Root,\n      Encrypt: this.context.trailerInfo.Encrypt,\n      Info: this.context.trailerInfo.Info,\n      ID: this.context.trailerInfo.ID,\n    });\n  }\n\n  protected async computeBufferSize(): Promise<SerializationInfo> {\n    const header = PDFHeader.forVersion(1, 7);\n\n    let size = header.sizeInBytes() + 2;\n\n    const xref = PDFCrossRefSection.create();\n\n    const indirectObjects = this.context.enumerateIndirectObjects();\n\n    for (let idx = 0, len = indirectObjects.length; idx < len; idx++) {\n      const indirectObject = indirectObjects[idx];\n      const [ref] = indirectObject;\n      xref.addEntry(ref, size);\n      size += this.computeIndirectObjectSize(indirectObject);\n      if (this.shouldWaitForTick(1)) await waitForTick();\n    }\n\n    const xrefOffset = size;\n    size += xref.sizeInBytes() + 1; // '\\n'\n\n    const trailerDict = PDFTrailerDict.of(this.createTrailerDict());\n    size += trailerDict.sizeInBytes() + 2; // '\\n\\n'\n\n    const trailer = PDFTrailer.forLastCrossRefSectionOffset(xrefOffset);\n    size += trailer.sizeInBytes();\n\n    return { size, header, indirectObjects, xref, trailerDict, trailer };\n  }\n\n  protected shouldWaitForTick = (n: number) => {\n    this.parsedObjects += n;\n    return this.parsedObjects % this.objectsPerTick === 0;\n  };\n}\n\nexport default PDFWriter;\n","import PDFObject from 'src/core/objects/PDFObject';\n\nclass PDFInvalidObject extends PDFObject {\n  static of = (data: Uint8Array) => new PDFInvalidObject(data);\n\n  private readonly data: Uint8Array;\n\n  private constructor(data: Uint8Array) {\n    super();\n    this.data = data;\n  }\n\n  clone(): PDFInvalidObject {\n    return PDFInvalidObject.of(this.data.slice());\n  }\n\n  toString(): string {\n    return `PDFInvalidObject(${this.data.length} bytes)`;\n  }\n\n  sizeInBytes(): number {\n    return this.data.length;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    const length = this.data.length;\n    for (let idx = 0; idx < length; idx++) {\n      buffer[offset++] = this.data[idx];\n    }\n    return length;\n  }\n}\n\nexport default PDFInvalidObject;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFFlateStream from 'src/core/structures/PDFFlateStream';\nimport { bytesFor, Cache, reverseArray, sizeInBytes, sum } from 'src/utils';\n\nexport enum EntryType {\n  Deleted = 0,\n  Uncompressed = 1,\n  Compressed = 2\n}\n\nexport interface DeletedEntry {\n  type: EntryType.Deleted;\n  ref: PDFRef;\n  nextFreeObjectNumber: number;\n}\n\nexport interface UncompressedEntry {\n  type: EntryType.Uncompressed;\n  ref: PDFRef;\n  offset: number;\n}\n\nexport interface CompressedEntry {\n  type: EntryType.Compressed;\n  ref: PDFRef;\n  objectStreamRef: PDFRef;\n  index: number;\n}\n\nexport type Entry = DeletedEntry | UncompressedEntry | CompressedEntry;\n\nexport type EntryTuple = [number, number, number];\n\n/**\n * Entries should be added using the [[addDeletedEntry]],\n * [[addUncompressedEntry]], and [[addCompressedEntry]] methods\n * **in order of ascending object number**.\n */\nclass PDFCrossRefStream extends PDFFlateStream {\n  static create = (dict: PDFDict, encode = true) => {\n    const stream = new PDFCrossRefStream(dict, [], encode);\n    stream.addDeletedEntry(PDFRef.of(0, 65535), 0);\n    return stream;\n  };\n\n  static of = (dict: PDFDict, entries: Entry[], encode = true) =>\n    new PDFCrossRefStream(dict, entries, encode);\n\n  private readonly entries: Entry[];\n  private readonly entryTuplesCache: Cache<EntryTuple[]>;\n  private readonly maxByteWidthsCache: Cache<[number, number, number]>;\n  private readonly indexCache: Cache<number[]>;\n\n  private constructor(dict: PDFDict, entries?: Entry[], encode = true) {\n    super(dict, encode);\n\n    this.entries = entries || [];\n    this.entryTuplesCache = Cache.populatedBy(this.computeEntryTuples);\n    this.maxByteWidthsCache = Cache.populatedBy(this.computeMaxEntryByteWidths);\n    this.indexCache = Cache.populatedBy(this.computeIndex);\n\n    dict.set(PDFName.of('Type'), PDFName.of('XRef'));\n  }\n\n  addDeletedEntry(ref: PDFRef, nextFreeObjectNumber: number) {\n    const type = EntryType.Deleted;\n    this.entries.push({ type, ref, nextFreeObjectNumber });\n    this.entryTuplesCache.invalidate();\n    this.maxByteWidthsCache.invalidate();\n    this.indexCache.invalidate();\n    this.contentsCache.invalidate();\n  }\n\n  addUncompressedEntry(ref: PDFRef, offset: number) {\n    const type = EntryType.Uncompressed;\n    this.entries.push({ type, ref, offset });\n    this.entryTuplesCache.invalidate();\n    this.maxByteWidthsCache.invalidate();\n    this.indexCache.invalidate();\n    this.contentsCache.invalidate();\n  }\n\n  addCompressedEntry(ref: PDFRef, objectStreamRef: PDFRef, index: number) {\n    const type = EntryType.Compressed;\n    this.entries.push({ type, ref, objectStreamRef, index });\n    this.entryTuplesCache.invalidate();\n    this.maxByteWidthsCache.invalidate();\n    this.indexCache.invalidate();\n    this.contentsCache.invalidate();\n  }\n\n  clone(context?: PDFContext): PDFCrossRefStream {\n    const { dict, entries, encode } = this;\n    return PDFCrossRefStream.of(dict.clone(context), entries.slice(), encode);\n  }\n\n  getContentsString(): string {\n    const entryTuples = this.entryTuplesCache.access();\n    const byteWidths = this.maxByteWidthsCache.access();\n    let value = '';\n\n    for (\n      let entryIdx = 0, entriesLen = entryTuples.length;\n      entryIdx < entriesLen;\n      entryIdx++\n    ) {\n      const [first, second, third] = entryTuples[entryIdx];\n\n      const firstBytes = reverseArray(bytesFor(first));\n      const secondBytes = reverseArray(bytesFor(second));\n      const thirdBytes = reverseArray(bytesFor(third));\n\n      for (let idx = byteWidths[0] - 1; idx >= 0; idx--) {\n        value += (firstBytes[idx] || 0).toString(2);\n      }\n      for (let idx = byteWidths[1] - 1; idx >= 0; idx--) {\n        value += (secondBytes[idx] || 0).toString(2);\n      }\n      for (let idx = byteWidths[2] - 1; idx >= 0; idx--) {\n        value += (thirdBytes[idx] || 0).toString(2);\n      }\n    }\n\n    return value;\n  }\n\n  getUnencodedContents(): Uint8Array {\n    const entryTuples = this.entryTuplesCache.access();\n    const byteWidths = this.maxByteWidthsCache.access();\n    const buffer = new Uint8Array(this.getUnencodedContentsSize());\n\n    let offset = 0;\n    for (\n      let entryIdx = 0, entriesLen = entryTuples.length;\n      entryIdx < entriesLen;\n      entryIdx++\n    ) {\n      const [first, second, third] = entryTuples[entryIdx];\n\n      const firstBytes = reverseArray(bytesFor(first));\n      const secondBytes = reverseArray(bytesFor(second));\n      const thirdBytes = reverseArray(bytesFor(third));\n\n      for (let idx = byteWidths[0] - 1; idx >= 0; idx--) {\n        buffer[offset++] = firstBytes[idx] || 0;\n      }\n      for (let idx = byteWidths[1] - 1; idx >= 0; idx--) {\n        buffer[offset++] = secondBytes[idx] || 0;\n      }\n      for (let idx = byteWidths[2] - 1; idx >= 0; idx--) {\n        buffer[offset++] = thirdBytes[idx] || 0;\n      }\n    }\n\n    return buffer;\n  }\n\n  getUnencodedContentsSize(): number {\n    const byteWidths = this.maxByteWidthsCache.access();\n    const entryWidth = sum(byteWidths);\n    return entryWidth * this.entries.length;\n  }\n\n  updateDict(): void {\n    super.updateDict();\n\n    const byteWidths = this.maxByteWidthsCache.access();\n    const index = this.indexCache.access();\n\n    const { context } = this.dict;\n    this.dict.set(PDFName.of('W'), context.obj(byteWidths));\n    this.dict.set(PDFName.of('Index'), context.obj(index));\n  }\n\n  // Returns an array of integer pairs for each subsection of the cross ref\n  // section, where each integer pair represents:\n  //   firstObjectNumber(OfSection), length(OfSection)\n  private computeIndex = (): number[] => {\n    const subsections: number[] = [];\n\n    let subsectionLength = 0;\n    for (let idx = 0, len = this.entries.length; idx < len; idx++) {\n      const currEntry = this.entries[idx];\n      const prevEntry = this.entries[idx - 1];\n\n      if (idx === 0) {\n        subsections.push(currEntry.ref.objectNumber);\n      } else if (currEntry.ref.objectNumber - prevEntry.ref.objectNumber > 1) {\n        subsections.push(subsectionLength);\n        subsections.push(currEntry.ref.objectNumber);\n        subsectionLength = 0;\n      }\n\n      subsectionLength += 1;\n    }\n    subsections.push(subsectionLength);\n\n    return subsections;\n  };\n\n  private computeEntryTuples = (): EntryTuple[] => {\n    const entryTuples: EntryTuple[] = new Array(this.entries.length);\n\n    for (let idx = 0, len = this.entries.length; idx < len; idx++) {\n      const entry = this.entries[idx];\n      if (entry.type === EntryType.Deleted) {\n        const { type, nextFreeObjectNumber, ref } = entry;\n        entryTuples[idx] = [type, nextFreeObjectNumber, ref.generationNumber];\n      }\n      if (entry.type === EntryType.Uncompressed) {\n        const { type, offset, ref } = entry;\n        entryTuples[idx] = [type, offset, ref.generationNumber];\n      }\n      if (entry.type === EntryType.Compressed) {\n        const { type, objectStreamRef, index } = entry;\n        entryTuples[idx] = [type, objectStreamRef.objectNumber, index];\n      }\n    }\n\n    return entryTuples;\n  };\n\n  private computeMaxEntryByteWidths = (): [number, number, number] => {\n    const entryTuples = this.entryTuplesCache.access();\n    const widths: [number, number, number] = [0, 0, 0];\n\n    for (let idx = 0, len = entryTuples.length; idx < len; idx++) {\n      const [first, second, third] = entryTuples[idx];\n\n      const firstSize = sizeInBytes(first);\n      const secondSize = sizeInBytes(second);\n      const thirdSize = sizeInBytes(third);\n\n      if (firstSize > widths[0]) widths[0] = firstSize;\n      if (secondSize > widths[1]) widths[1] = secondSize;\n      if (thirdSize > widths[2]) widths[2] = thirdSize;\n    }\n\n    return widths;\n  };\n}\n\nexport default PDFCrossRefStream;\n","import PDFHeader from 'src/core/document/PDFHeader';\nimport PDFTrailer from 'src/core/document/PDFTrailer';\nimport PDFInvalidObject from 'src/core/objects/PDFInvalidObject';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFStream from 'src/core/objects/PDFStream';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFCrossRefStream from 'src/core/structures/PDFCrossRefStream';\nimport PDFObjectStream from 'src/core/structures/PDFObjectStream';\nimport PDFWriter from 'src/core/writers/PDFWriter';\nimport { last, waitForTick } from 'src/utils';\n\nclass PDFStreamWriter extends PDFWriter {\n  static forContext = (\n    context: PDFContext,\n    objectsPerTick: number,\n    encodeStreams = true,\n    objectsPerStream = 50,\n  ) =>\n    new PDFStreamWriter(\n      context,\n      objectsPerTick,\n      encodeStreams,\n      objectsPerStream,\n    );\n\n  private readonly encodeStreams: boolean;\n  private readonly objectsPerStream: number;\n\n  private constructor(\n    context: PDFContext,\n    objectsPerTick: number,\n    encodeStreams: boolean,\n    objectsPerStream: number,\n  ) {\n    super(context, objectsPerTick);\n\n    this.encodeStreams = encodeStreams;\n    this.objectsPerStream = objectsPerStream;\n  }\n\n  protected async computeBufferSize() {\n    let objectNumber = this.context.largestObjectNumber + 1;\n\n    const header = PDFHeader.forVersion(1, 7);\n\n    let size = header.sizeInBytes() + 2;\n\n    const xrefStream = PDFCrossRefStream.create(\n      this.createTrailerDict(),\n      this.encodeStreams,\n    );\n\n    const uncompressedObjects: [PDFRef, PDFObject][] = [];\n    const compressedObjects: [PDFRef, PDFObject][][] = [];\n    const objectStreamRefs: PDFRef[] = [];\n\n    const indirectObjects = this.context.enumerateIndirectObjects();\n    for (let idx = 0, len = indirectObjects.length; idx < len; idx++) {\n      const indirectObject = indirectObjects[idx];\n      const [ref, object] = indirectObject;\n\n      const shouldNotCompress =\n        ref === this.context.trailerInfo.Encrypt ||\n        object instanceof PDFStream ||\n        object instanceof PDFInvalidObject ||\n        ref.generationNumber !== 0;\n\n      if (shouldNotCompress) {\n        uncompressedObjects.push(indirectObject);\n        xrefStream.addUncompressedEntry(ref, size);\n        size += this.computeIndirectObjectSize(indirectObject);\n        if (this.shouldWaitForTick(1)) await waitForTick();\n      } else {\n        let chunk = last(compressedObjects);\n        let objectStreamRef = last(objectStreamRefs);\n        if (!chunk || chunk.length % this.objectsPerStream === 0) {\n          chunk = [];\n          compressedObjects.push(chunk);\n          objectStreamRef = PDFRef.of(objectNumber++);\n          objectStreamRefs.push(objectStreamRef);\n        }\n        xrefStream.addCompressedEntry(ref, objectStreamRef, chunk.length);\n        chunk.push(indirectObject);\n      }\n    }\n\n    for (let idx = 0, len = compressedObjects.length; idx < len; idx++) {\n      const chunk = compressedObjects[idx];\n      const ref = objectStreamRefs[idx];\n\n      const objectStream = PDFObjectStream.withContextAndObjects(\n        this.context,\n        chunk,\n        this.encodeStreams,\n      );\n\n      xrefStream.addUncompressedEntry(ref, size);\n      size += this.computeIndirectObjectSize([ref, objectStream]);\n\n      uncompressedObjects.push([ref, objectStream]);\n\n      if (this.shouldWaitForTick(chunk.length)) await waitForTick();\n    }\n\n    const xrefStreamRef = PDFRef.of(objectNumber++);\n    xrefStream.dict.set(PDFName.of('Size'), PDFNumber.of(objectNumber));\n    xrefStream.addUncompressedEntry(xrefStreamRef, size);\n    const xrefOffset = size;\n    size += this.computeIndirectObjectSize([xrefStreamRef, xrefStream]);\n\n    uncompressedObjects.push([xrefStreamRef, xrefStream]);\n\n    const trailer = PDFTrailer.forLastCrossRefSectionOffset(xrefOffset);\n    size += trailer.sizeInBytes();\n\n    return { size, header, indirectObjects: uncompressedObjects, trailer };\n  }\n}\n\nexport default PDFStreamWriter;\n","import {\n  Encodings,\n  Font,\n  FontNames,\n  EncodingType,\n} from '@pdf-lib/standard-fonts';\n\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFContext from 'src/core/PDFContext';\nimport { toCodePoint, toHexString } from 'src/utils';\n\nexport interface Glyph {\n  code: number;\n  name: string;\n}\n\n/**\n * A note of thanks to the developers of https://github.com/foliojs/pdfkit, as\n * this class borrows from:\n *   https://github.com/foliojs/pdfkit/blob/f91bdd61c164a72ea06be1a43dc0a412afc3925f/lib/font/afm.coffee\n */\nclass StandardFontEmbedder {\n  static for = (fontName: FontNames, customName?: string) =>\n    new StandardFontEmbedder(fontName, customName);\n\n  readonly font: Font;\n  readonly encoding: EncodingType;\n  readonly fontName: string;\n  readonly customName: string | undefined;\n\n  private constructor(fontName: FontNames, customName?: string) {\n    // prettier-ignore\n    this.encoding = (\n      fontName === FontNames.ZapfDingbats ? Encodings.ZapfDingbats\n        : fontName === FontNames.Symbol       ? Encodings.Symbol\n          : Encodings.WinAnsi\n    );\n    this.font = Font.load(fontName);\n    this.fontName = this.font.FontName;\n    this.customName = customName;\n  }\n\n  /**\n   * Encode the JavaScript string into this font. (JavaScript encodes strings in\n   * Unicode, but standard fonts use either WinAnsi, ZapfDingbats, or Symbol\n   * encodings)\n   */\n  encodeText(text: string): PDFHexString {\n    const glyphs = this.encodeTextAsGlyphs(text);\n    const hexCodes = new Array(glyphs.length);\n    for (let idx = 0, len = glyphs.length; idx < len; idx++) {\n      hexCodes[idx] = toHexString(glyphs[idx].code);\n    }\n    return PDFHexString.of(hexCodes.join(''));\n  }\n\n  widthOfTextAtSize(text: string, size: number): number {\n    const glyphs = this.encodeTextAsGlyphs(text);\n    let totalWidth = 0;\n\n    for (let idx = 0, len = glyphs.length; idx < len; idx++) {\n      const left = glyphs[idx].name;\n      const right = (glyphs[idx + 1] || {}).name;\n      const kernAmount = this.font.getXAxisKerningForPair(left, right) || 0;\n      totalWidth += this.widthOfGlyph(left) + kernAmount;\n    }\n\n    const scale = size / 1000;\n    return totalWidth * scale;\n  }\n\n  heightOfFontAtSize(\n    size: number,\n    options: { descender?: boolean } = {},\n  ): number {\n    const { descender = true } = options;\n\n    const { Ascender, Descender, FontBBox } = this.font;\n    const yTop = Ascender || FontBBox[3];\n    const yBottom = Descender || FontBBox[1];\n\n    let height = yTop - yBottom;\n    if (!descender) height += Descender || 0;\n\n    return (height / 1000) * size;\n  }\n\n  sizeOfFontAtHeight(height: number): number {\n    const { Ascender, Descender, FontBBox } = this.font;\n    const yTop = Ascender || FontBBox[3];\n    const yBottom = Descender || FontBBox[1];\n    return (1000 * height) / (yTop - yBottom);\n  }\n\n  embedIntoContext(context: PDFContext, ref?: PDFRef): PDFRef {\n    const fontDict = context.obj({\n      Type: 'Font',\n      Subtype: 'Type1',\n      BaseFont: this.customName || this.fontName,\n\n      Encoding:\n        this.encoding === Encodings.WinAnsi ? 'WinAnsiEncoding' : undefined,\n    });\n\n    if (ref) {\n      context.assign(ref, fontDict);\n      return ref;\n    } else {\n      return context.register(fontDict);\n    }\n  }\n\n  private widthOfGlyph(glyphName: string): number {\n    // Default to 250 if font doesn't specify a width\n    return this.font.getWidthOfGlyph(glyphName) || 250;\n  }\n\n  private encodeTextAsGlyphs(text: string): Glyph[] {\n    const codePoints = Array.from(text);\n    const glyphs: Glyph[] = new Array(codePoints.length);\n    for (let idx = 0, len = codePoints.length; idx < len; idx++) {\n      const codePoint = toCodePoint(codePoints[idx])!;\n      glyphs[idx] = this.encoding.encodeUnicodeCodePoint(codePoint);\n    }\n    return glyphs;\n  }\n}\n\nexport default StandardFontEmbedder;\n","import PDFObject from 'src/core/objects/PDFObject';\nimport CharCodes from 'src/core/syntax/CharCodes';\nimport {\n  copyStringIntoBuffer,\n  toHexStringOfMinLength,\n  utf16Decode,\n  utf16Encode,\n  pdfDocEncodingDecode,\n  parseDate,\n  hasUtf16BOM,\n} from 'src/utils';\nimport { InvalidPDFDateStringError } from 'src/core/errors';\n\nclass PDFHexString extends PDFObject {\n  static of = (value: string) => new PDFHexString(value);\n\n  static fromText = (value: string) => {\n    const encoded = utf16Encode(value);\n\n    let hex = '';\n    for (let idx = 0, len = encoded.length; idx < len; idx++) {\n      hex += toHexStringOfMinLength(encoded[idx], 4);\n    }\n\n    return new PDFHexString(hex);\n  };\n\n  private readonly value: string;\n\n  constructor(value: string) {\n    super();\n    this.value = value;\n  }\n\n  asBytes(): Uint8Array {\n    // Append a zero if the number of digits is odd. See PDF spec 7.3.4.3\n    const hex = this.value + (this.value.length % 2 === 1 ? '0' : '');\n    const hexLength = hex.length;\n\n    const bytes = new Uint8Array(hex.length / 2);\n\n    let hexOffset = 0;\n    let bytesOffset = 0;\n\n    // Interpret each pair of hex digits as a single byte\n    while (hexOffset < hexLength) {\n      const byte = parseInt(hex.substring(hexOffset, hexOffset + 2), 16);\n      bytes[bytesOffset] = byte;\n\n      hexOffset += 2;\n      bytesOffset += 1;\n    }\n\n    return bytes;\n  }\n\n  decodeText(): string {\n    const bytes = this.asBytes();\n    if (hasUtf16BOM(bytes)) return utf16Decode(bytes);\n    return pdfDocEncodingDecode(bytes);\n  }\n\n  decodeDate(): Date {\n    const text = this.decodeText();\n    const date = parseDate(text);\n    if (!date) throw new InvalidPDFDateStringError(text);\n    return date;\n  }\n\n  asString(): string {\n    return this.value;\n  }\n\n  clone(): PDFHexString {\n    return PDFHexString.of(this.value);\n  }\n\n  toString(): string {\n    return `<${this.value}>`;\n  }\n\n  sizeInBytes(): number {\n    return this.value.length + 2;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    buffer[offset++] = CharCodes.LessThan;\n    offset += copyStringIntoBuffer(this.value, buffer, offset);\n    buffer[offset++] = CharCodes.GreaterThan;\n    return this.value.length + 2;\n  }\n}\n\nexport default PDFHexString;\n","import { Glyph } from 'src/types/fontkit';\n\nimport { toHexString, toHexStringOfMinLength } from 'src/utils';\nimport {\n  hasSurrogates,\n  highSurrogate,\n  isWithinBMP,\n  lowSurrogate,\n} from 'src/utils/unicode';\n\n/** [fontId, codePoint] */\ntype BfChar = [string, string];\n\n/** `glyphs` should be an array of unique glyphs */\nexport const createCmap = (glyphs: Glyph[], glyphId: (g?: Glyph) => number) => {\n  const bfChars: BfChar[] = new Array(glyphs.length);\n  for (let idx = 0, len = glyphs.length; idx < len; idx++) {\n    const glyph = glyphs[idx];\n    const id = cmapHexFormat(cmapHexString(glyphId(glyph)));\n    const unicode = cmapHexFormat(...glyph.codePoints.map(cmapCodePointFormat));\n    bfChars[idx] = [id, unicode];\n  }\n\n  return fillCmapTemplate(bfChars);\n};\n\n/* =============================== Templates ================================ */\n\nconst fillCmapTemplate = (bfChars: BfChar[]) => `\\\n/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange\n${bfChars.length} beginbfchar\n${bfChars.map(([glyphId, codePoint]) => `${glyphId} ${codePoint}`).join('\\n')}\nendbfchar\nendcmap\nCMapName currentdict /CMap defineresource pop\nend\nend\\\n`;\n\n/* =============================== Utilities ================================ */\n\nconst cmapHexFormat = (...values: string[]) => `<${values.join('')}>`;\n\nconst cmapHexString = (value: number) => toHexStringOfMinLength(value, 4);\n\nconst cmapCodePointFormat = (codePoint: number) => {\n  if (isWithinBMP(codePoint)) return cmapHexString(codePoint);\n\n  if (hasSurrogates(codePoint)) {\n    const hs = highSurrogate(codePoint);\n    const ls = lowSurrogate(codePoint);\n    return `${cmapHexString(hs)}${cmapHexString(ls)}`;\n  }\n\n  const hex = toHexString(codePoint);\n  const msg = `0x${hex} is not a valid UTF-8 or UTF-16 codepoint.`;\n  throw new Error(msg);\n};\n","import { Font } from 'src/types/fontkit';\n\nexport interface FontFlagOptions {\n  fixedPitch?: boolean;\n  serif?: boolean;\n  symbolic?: boolean;\n  script?: boolean;\n  nonsymbolic?: boolean;\n  italic?: boolean;\n  allCap?: boolean;\n  smallCap?: boolean;\n  forceBold?: boolean;\n}\n\n// prettier-ignore\nconst makeFontFlags = (options: FontFlagOptions) => {\n  let flags = 0;\n\n  const flipBit = (bit: number) => {\n    flags |= (1 << (bit - 1)); \n  };\n\n  if (options.fixedPitch)  flipBit(1);\n  if (options.serif)       flipBit(2);\n  if (options.symbolic)    flipBit(3);\n  if (options.script)      flipBit(4);\n  if (options.nonsymbolic) flipBit(6);\n  if (options.italic)      flipBit(7);\n  if (options.allCap)      flipBit(17);\n  if (options.smallCap)    flipBit(18);\n  if (options.forceBold)   flipBit(19);\n\n  return flags;\n};\n\n// From: https://github.com/foliojs/pdfkit/blob/83f5f7243172a017adcf6a7faa5547c55982c57b/lib/font/embedded.js#L123-L129\nexport const deriveFontFlags = (font: Font): number => {\n  const familyClass = font['OS/2'] ? font['OS/2'].sFamilyClass : 0;\n  const flags = makeFontFlags({\n    fixedPitch: font.post.isFixedPitch,\n    serif: 1 <= familyClass && familyClass <= 7,\n    symbolic: true, // Assume the font uses non-latin characters\n    script: familyClass === 10,\n    italic: font.head.macStyle.italic,\n  });\n  return flags;\n};\n","import PDFObject from 'src/core/objects/PDFObject';\nimport CharCodes from 'src/core/syntax/CharCodes';\nimport {\n  copyStringIntoBuffer,\n  padStart,\n  utf16Decode,\n  pdfDocEncodingDecode,\n  toCharCode,\n  parseDate,\n  hasUtf16BOM,\n} from 'src/utils';\nimport { InvalidPDFDateStringError } from 'src/core/errors';\n\nclass PDFString extends PDFObject {\n  // The PDF spec allows newlines and parens to appear directly within a literal\n  // string. These character _may_ be escaped. But they do not _have_ to be. So\n  // for simplicity, we will not bother escaping them.\n  static of = (value: string) => new PDFString(value);\n\n  static fromDate = (date: Date) => {\n    const year = padStart(String(date.getUTCFullYear()), 4, '0');\n    const month = padStart(String(date.getUTCMonth() + 1), 2, '0');\n    const day = padStart(String(date.getUTCDate()), 2, '0');\n    const hours = padStart(String(date.getUTCHours()), 2, '0');\n    const mins = padStart(String(date.getUTCMinutes()), 2, '0');\n    const secs = padStart(String(date.getUTCSeconds()), 2, '0');\n    return new PDFString(`D:${year}${month}${day}${hours}${mins}${secs}Z`);\n  };\n\n  private readonly value: string;\n\n  private constructor(value: string) {\n    super();\n    this.value = value;\n  }\n\n  asBytes(): Uint8Array {\n    const bytes: number[] = [];\n\n    let octal = '';\n    let escaped = false;\n\n    const pushByte = (byte?: number) => {\n      if (byte !== undefined) bytes.push(byte);\n      escaped = false;\n    };\n\n    for (let idx = 0, len = this.value.length; idx < len; idx++) {\n      const char = this.value[idx];\n      const byte = toCharCode(char);\n      const nextChar = this.value[idx + 1];\n      if (!escaped) {\n        if (byte === CharCodes.BackSlash) escaped = true;\n        else pushByte(byte);\n      } else {\n        if (byte === CharCodes.Newline) pushByte();\n        else if (byte === CharCodes.CarriageReturn) pushByte();\n        else if (byte === CharCodes.n) pushByte(CharCodes.Newline);\n        else if (byte === CharCodes.r) pushByte(CharCodes.CarriageReturn);\n        else if (byte === CharCodes.t) pushByte(CharCodes.Tab);\n        else if (byte === CharCodes.b) pushByte(CharCodes.Backspace);\n        else if (byte === CharCodes.f) pushByte(CharCodes.FormFeed);\n        else if (byte === CharCodes.LeftParen) pushByte(CharCodes.LeftParen);\n        else if (byte === CharCodes.RightParen) pushByte(CharCodes.RightParen);\n        else if (byte === CharCodes.Backspace) pushByte(CharCodes.BackSlash);\n        else if (byte >= CharCodes.Zero && byte <= CharCodes.Seven) {\n          octal += char;\n          if (octal.length === 3 || !(nextChar >= '0' && nextChar <= '7')) {\n            pushByte(parseInt(octal, 8));\n            octal = '';\n          }\n        } else {\n          pushByte(byte);\n        }\n      }\n    }\n\n    return new Uint8Array(bytes);\n  }\n\n  decodeText(): string {\n    const bytes = this.asBytes();\n    if (hasUtf16BOM(bytes)) return utf16Decode(bytes);\n    return pdfDocEncodingDecode(bytes);\n  }\n\n  decodeDate(): Date {\n    const text = this.decodeText();\n    const date = parseDate(text);\n    if (!date) throw new InvalidPDFDateStringError(text);\n    return date;\n  }\n\n  asString(): string {\n    return this.value;\n  }\n\n  clone(): PDFString {\n    return PDFString.of(this.value);\n  }\n\n  toString(): string {\n    return `(${this.value})`;\n  }\n\n  sizeInBytes(): number {\n    return this.value.length + 2;\n  }\n\n  copyBytesInto(buffer: Uint8Array, offset: number): number {\n    buffer[offset++] = CharCodes.LeftParen;\n    offset += copyStringIntoBuffer(this.value, buffer, offset);\n    buffer[offset++] = CharCodes.RightParen;\n    return this.value.length + 2;\n  }\n}\n\nexport default PDFString;\n","import { Font, Fontkit, Glyph, TypeFeatures } from 'src/types/fontkit';\n\nimport { createCmap } from 'src/core/embedders/CMap';\nimport { deriveFontFlags } from 'src/core/embedders/FontFlags';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFString from 'src/core/objects/PDFString';\nimport PDFContext from 'src/core/PDFContext';\nimport {\n  byAscendingId,\n  Cache,\n  sortedUniq,\n  toHexStringOfMinLength,\n} from 'src/utils';\n\n/**\n * A note of thanks to the developers of https://github.com/foliojs/pdfkit, as\n * this class borrows from:\n *   https://github.com/devongovett/pdfkit/blob/e71edab0dd4657b5a767804ba86c94c58d01fbca/lib/image/jpeg.coffee\n */\nclass CustomFontEmbedder {\n  static async for(\n    fontkit: Fontkit,\n    fontData: Uint8Array,\n    customName?: string,\n    fontFeatures?: TypeFeatures,\n  ) {\n    const font = await fontkit.create(fontData);\n    return new CustomFontEmbedder(font, fontData, customName, fontFeatures);\n  }\n\n  readonly font: Font;\n  readonly scale: number;\n  readonly fontData: Uint8Array;\n  readonly fontName: string;\n  readonly customName: string | undefined;\n  readonly fontFeatures: TypeFeatures | undefined;\n\n  protected baseFontName: string;\n  protected glyphCache: Cache<Glyph[]>;\n\n  protected constructor(\n    font: Font,\n    fontData: Uint8Array,\n    customName?: string,\n    fontFeatures?: TypeFeatures,\n  ) {\n    this.font = font;\n    this.scale = 1000 / this.font.unitsPerEm;\n    this.fontData = fontData;\n    this.fontName = this.font.postscriptName || 'Font';\n    this.customName = customName;\n    this.fontFeatures = fontFeatures;\n\n    this.baseFontName = '';\n    this.glyphCache = Cache.populatedBy(this.allGlyphsInFontSortedById);\n  }\n\n  /**\n   * Encode the JavaScript string into this font. (JavaScript encodes strings in\n   * Unicode, but embedded fonts use their own custom encodings)\n   */\n  encodeText(text: string): PDFHexString {\n    const { glyphs } = this.font.layout(text, this.fontFeatures);\n    const hexCodes = new Array(glyphs.length);\n    for (let idx = 0, len = glyphs.length; idx < len; idx++) {\n      hexCodes[idx] = toHexStringOfMinLength(glyphs[idx].id, 4);\n    }\n    return PDFHexString.of(hexCodes.join(''));\n  }\n\n  // The advanceWidth takes into account kerning automatically, so we don't\n  // have to do that manually like we do for the standard fonts.\n  widthOfTextAtSize(text: string, size: number): number {\n    const { glyphs } = this.font.layout(text, this.fontFeatures);\n    let totalWidth = 0;\n    for (let idx = 0, len = glyphs.length; idx < len; idx++) {\n      totalWidth += glyphs[idx].advanceWidth * this.scale;\n    }\n    const scale = size / 1000;\n    return totalWidth * scale;\n  }\n\n  heightOfFontAtSize(\n    size: number,\n    options: { descender?: boolean } = {},\n  ): number {\n    const { descender = true } = options;\n\n    const { ascent, descent, bbox } = this.font;\n    const yTop = (ascent || bbox.maxY) * this.scale;\n    const yBottom = (descent || bbox.minY) * this.scale;\n\n    let height = yTop - yBottom;\n    if (!descender) height -= Math.abs(descent) || 0;\n\n    return (height / 1000) * size;\n  }\n\n  sizeOfFontAtHeight(height: number): number {\n    const { ascent, descent, bbox } = this.font;\n    const yTop = (ascent || bbox.maxY) * this.scale;\n    const yBottom = (descent || bbox.minY) * this.scale;\n    return (1000 * height) / (yTop - yBottom);\n  }\n\n  embedIntoContext(context: PDFContext, ref?: PDFRef): Promise<PDFRef> {\n    this.baseFontName =\n      this.customName || context.addRandomSuffix(this.fontName);\n    return this.embedFontDict(context, ref);\n  }\n\n  protected async embedFontDict(\n    context: PDFContext,\n    ref?: PDFRef,\n  ): Promise<PDFRef> {\n    const cidFontDictRef = await this.embedCIDFontDict(context);\n    const unicodeCMapRef = this.embedUnicodeCmap(context);\n\n    const fontDict = context.obj({\n      Type: 'Font',\n      Subtype: 'Type0',\n      BaseFont: this.baseFontName,\n      Encoding: 'Identity-H',\n      DescendantFonts: [cidFontDictRef],\n      ToUnicode: unicodeCMapRef,\n    });\n\n    if (ref) {\n      context.assign(ref, fontDict);\n      return ref;\n    } else {\n      return context.register(fontDict);\n    }\n  }\n\n  protected isCFF(): boolean {\n    return this.font.cff;\n  }\n\n  protected async embedCIDFontDict(context: PDFContext): Promise<PDFRef> {\n    const fontDescriptorRef = await this.embedFontDescriptor(context);\n\n    const cidFontDict = context.obj({\n      Type: 'Font',\n      Subtype: this.isCFF() ? 'CIDFontType0' : 'CIDFontType2',\n      CIDToGIDMap: 'Identity',\n      BaseFont: this.baseFontName,\n      CIDSystemInfo: {\n        Registry: PDFString.of('Adobe'),\n        Ordering: PDFString.of('Identity'),\n        Supplement: 0,\n      },\n      FontDescriptor: fontDescriptorRef,\n      W: this.computeWidths(),\n    });\n\n    return context.register(cidFontDict);\n  }\n\n  protected async embedFontDescriptor(context: PDFContext): Promise<PDFRef> {\n    const fontStreamRef = await this.embedFontStream(context);\n\n    const { scale } = this;\n    const { italicAngle, ascent, descent, capHeight, xHeight } = this.font;\n    const { minX, minY, maxX, maxY } = this.font.bbox;\n\n    const fontDescriptor = context.obj({\n      Type: 'FontDescriptor',\n      FontName: this.baseFontName,\n      Flags: deriveFontFlags(this.font),\n      FontBBox: [minX * scale, minY * scale, maxX * scale, maxY * scale],\n      ItalicAngle: italicAngle,\n      Ascent: ascent * scale,\n      Descent: descent * scale,\n      CapHeight: (capHeight || ascent) * scale,\n      XHeight: (xHeight || 0) * scale,\n\n      // Not sure how to compute/find this, nor is anybody else really:\n      // https://stackoverflow.com/questions/35485179/stemv-value-of-the-truetype-font\n      StemV: 0,\n\n      [this.isCFF() ? 'FontFile3' : 'FontFile2']: fontStreamRef,\n    });\n\n    return context.register(fontDescriptor);\n  }\n\n  protected async serializeFont(): Promise<Uint8Array> {\n    return this.fontData;\n  }\n\n  protected async embedFontStream(context: PDFContext): Promise<PDFRef> {\n    const fontStream = context.flateStream(await this.serializeFont(), {\n      Subtype: this.isCFF() ? 'CIDFontType0C' : undefined,\n    });\n    return context.register(fontStream);\n  }\n\n  protected embedUnicodeCmap(context: PDFContext): PDFRef {\n    const cmap = createCmap(this.glyphCache.access(), this.glyphId.bind(this));\n    const cmapStream = context.flateStream(cmap);\n    return context.register(cmapStream);\n  }\n\n  protected glyphId(glyph?: Glyph): number {\n    return glyph ? glyph.id : -1;\n  }\n\n  protected computeWidths(): (number | number[])[] {\n    const glyphs = this.glyphCache.access();\n\n    const widths: (number | number[])[] = [];\n    let currSection: number[] = [];\n\n    for (let idx = 0, len = glyphs.length; idx < len; idx++) {\n      const currGlyph = glyphs[idx];\n      const prevGlyph = glyphs[idx - 1];\n\n      const currGlyphId = this.glyphId(currGlyph);\n      const prevGlyphId = this.glyphId(prevGlyph);\n\n      if (idx === 0) {\n        widths.push(currGlyphId);\n      } else if (currGlyphId - prevGlyphId !== 1) {\n        widths.push(currSection);\n        widths.push(currGlyphId);\n        currSection = [];\n      }\n\n      currSection.push(currGlyph.advanceWidth * this.scale);\n    }\n\n    widths.push(currSection);\n\n    return widths;\n  }\n\n  private allGlyphsInFontSortedById = (): Glyph[] => {\n    const glyphs: Glyph[] = new Array(this.font.characterSet.length);\n    for (let idx = 0, len = glyphs.length; idx < len; idx++) {\n      const codePoint = this.font.characterSet[idx];\n      glyphs[idx] = this.font.glyphForCodePoint(codePoint);\n    }\n    return sortedUniq(glyphs.sort(byAscendingId), (g) => g.id);\n  };\n}\n\nexport default CustomFontEmbedder;\n","import { Font, Fontkit, Glyph, Subset, TypeFeatures } from 'src/types/fontkit';\n\nimport CustomFontEmbedder from 'src/core/embedders/CustomFontEmbedder';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport { Cache, mergeUint8Arrays, toHexStringOfMinLength } from 'src/utils';\n\n/**\n * A note of thanks to the developers of https://github.com/foliojs/pdfkit, as\n * this class borrows from:\n *   https://github.com/devongovett/pdfkit/blob/e71edab0dd4657b5a767804ba86c94c58d01fbca/lib/image/jpeg.coffee\n */\nclass CustomFontSubsetEmbedder extends CustomFontEmbedder {\n  static async for(\n    fontkit: Fontkit,\n    fontData: Uint8Array,\n    customFontName?: string,\n    fontFeatures?: TypeFeatures,\n  ) {\n    const font = await fontkit.create(fontData);\n    return new CustomFontSubsetEmbedder(\n      font,\n      fontData,\n      customFontName,\n      fontFeatures,\n    );\n  }\n\n  private readonly subset: Subset;\n  private readonly glyphs: Glyph[];\n  private readonly glyphIdMap: Map<number, number>;\n\n  private constructor(\n    font: Font,\n    fontData: Uint8Array,\n    customFontName?: string,\n    fontFeatures?: TypeFeatures,\n  ) {\n    super(font, fontData, customFontName, fontFeatures);\n\n    this.subset = this.font.createSubset();\n    this.glyphs = [];\n    this.glyphCache = Cache.populatedBy(() => this.glyphs);\n    this.glyphIdMap = new Map();\n  }\n\n  encodeText(text: string): PDFHexString {\n    const { glyphs } = this.font.layout(text, this.fontFeatures);\n    const hexCodes = new Array(glyphs.length);\n\n    for (let idx = 0, len = glyphs.length; idx < len; idx++) {\n      const glyph = glyphs[idx];\n      const subsetGlyphId = this.subset.includeGlyph(glyph);\n\n      this.glyphs[subsetGlyphId - 1] = glyph;\n      this.glyphIdMap.set(glyph.id, subsetGlyphId);\n\n      hexCodes[idx] = toHexStringOfMinLength(subsetGlyphId, 4);\n    }\n\n    this.glyphCache.invalidate();\n    return PDFHexString.of(hexCodes.join(''));\n  }\n\n  protected isCFF(): boolean {\n    return (this.subset as any).cff;\n  }\n\n  protected glyphId(glyph?: Glyph): number {\n    return glyph ? this.glyphIdMap.get(glyph.id)! : -1;\n  }\n\n  protected serializeFont(): Promise<Uint8Array> {\n    return new Promise((resolve, reject) => {\n      const parts: Uint8Array[] = [];\n      this.subset\n        .encodeStream()\n        .on('data', (bytes) => parts.push(bytes))\n        .on('end', () => resolve(mergeUint8Arrays(parts)))\n        .on('error' as any, (err) => reject(err));\n    });\n  }\n}\n\nexport default CustomFontSubsetEmbedder;\n","import PDFString from 'src/core/objects/PDFString';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFRef from 'src/core/objects/PDFRef';\n\n/**\n * From the PDF-A3 specification, section **3.1. Requirements - General**.\n * See:\n * * https://www.pdfa.org/wp-content/uploads/2018/10/PDF20_AN002-AF.pdf\n */\nexport enum AFRelationship {\n  Source = 'Source',\n  Data = 'Data',\n  Alternative = 'Alternative',\n  Supplement = 'Supplement',\n  EncryptedPayload = 'EncryptedPayload',\n  FormData = 'EncryptedPayload',\n  Schema = 'Schema',\n  Unspecified = 'Unspecified'\n}\n\nexport interface EmbeddedFileOptions {\n  mimeType?: string;\n  description?: string;\n  creationDate?: Date;\n  modificationDate?: Date;\n  afRelationship?: AFRelationship;\n}\n\nclass FileEmbedder {\n  static for(\n    bytes: Uint8Array,\n    fileName: string,\n    options: EmbeddedFileOptions = {},\n  ) {\n    return new FileEmbedder(bytes, fileName, options);\n  }\n\n  private readonly fileData: Uint8Array;\n  readonly fileName: string;\n  readonly options: EmbeddedFileOptions;\n\n  private constructor(\n    fileData: Uint8Array,\n    fileName: string,\n    options: EmbeddedFileOptions = {},\n  ) {\n    this.fileData = fileData;\n    this.fileName = fileName;\n    this.options = options;\n  }\n\n  async embedIntoContext(context: PDFContext, ref?: PDFRef): Promise<PDFRef> {\n    const {\n      mimeType,\n      description,\n      creationDate,\n      modificationDate,\n      afRelationship,\n    } = this.options;\n\n    const embeddedFileStream = context.flateStream(this.fileData, {\n      Type: 'EmbeddedFile',\n      Subtype: mimeType ?? undefined,\n      Params: {\n        Size: this.fileData.length,\n        CreationDate: creationDate\n          ? PDFString.fromDate(creationDate)\n          : undefined,\n        ModDate: modificationDate\n          ? PDFString.fromDate(modificationDate)\n          : undefined,\n      },\n    });\n    const embeddedFileStreamRef = context.register(embeddedFileStream);\n\n    const fileSpecDict = context.obj({\n      Type: 'Filespec',\n      F: PDFString.of(this.fileName), // TODO: Assert that this is plain ASCII\n      UF: PDFHexString.fromText(this.fileName),\n      EF: { F: embeddedFileStreamRef },\n      Desc: description ? PDFHexString.fromText(description) : undefined,\n      AFRelationship: afRelationship ?? undefined,\n    });\n\n    if (ref) {\n      context.assign(ref, fileSpecDict);\n      return ref;\n    } else {\n      return context.register(fileSpecDict);\n    }\n  }\n}\n\nexport default FileEmbedder;\n","import PDFRef from 'src/core/objects/PDFRef';\nimport PDFContext from 'src/core/PDFContext';\n\n// prettier-ignore\nconst MARKERS = [\n  0xffc0, 0xffc1, 0xffc2,\n  0xffc3, 0xffc5, 0xffc6,\n  0xffc7, 0xffc8, 0xffc9,\n  0xffca, 0xffcb, 0xffcc,\n  0xffcd, 0xffce, 0xffcf,\n];\n\nenum ColorSpace {\n  DeviceGray = 'DeviceGray',\n  DeviceRGB = 'DeviceRGB',\n  DeviceCMYK = 'DeviceCMYK'\n}\n\nconst ChannelToColorSpace: { [idx: number]: ColorSpace | undefined } = {\n  1: ColorSpace.DeviceGray,\n  3: ColorSpace.DeviceRGB,\n  4: ColorSpace.DeviceCMYK,\n};\n\n/**\n * A note of thanks to the developers of https://github.com/foliojs/pdfkit, as\n * this class borrows from:\n *   https://github.com/foliojs/pdfkit/blob/a6af76467ce06bd6a2af4aa7271ccac9ff152a7d/lib/image/jpeg.js\n */\nclass JpegEmbedder {\n  static async for(imageData: Uint8Array) {\n    const dataView = new DataView(imageData.buffer);\n\n    const soi = dataView.getUint16(0);\n    if (soi !== 0xffd8) throw new Error('SOI not found in JPEG');\n\n    let pos = 2;\n    let marker: number;\n\n    while (pos < dataView.byteLength) {\n      marker = dataView.getUint16(pos);\n      pos += 2;\n      if (MARKERS.includes(marker)) break;\n      pos += dataView.getUint16(pos);\n    }\n\n    if (!MARKERS.includes(marker!)) throw new Error('Invalid JPEG');\n    pos += 2;\n\n    const bitsPerComponent = dataView.getUint8(pos++);\n    const height = dataView.getUint16(pos);\n    pos += 2;\n\n    const width = dataView.getUint16(pos);\n    pos += 2;\n\n    const channelByte = dataView.getUint8(pos++);\n    const channelName = ChannelToColorSpace[channelByte];\n\n    if (!channelName) throw new Error('Unknown JPEG channel.');\n\n    const colorSpace = channelName;\n\n    return new JpegEmbedder(\n      imageData,\n      bitsPerComponent,\n      width,\n      height,\n      colorSpace,\n    );\n  }\n\n  readonly bitsPerComponent: number;\n  readonly height: number;\n  readonly width: number;\n  readonly colorSpace: ColorSpace;\n\n  private readonly imageData: Uint8Array;\n\n  private constructor(\n    imageData: Uint8Array,\n    bitsPerComponent: number,\n    width: number,\n    height: number,\n    colorSpace: ColorSpace,\n  ) {\n    this.imageData = imageData;\n    this.bitsPerComponent = bitsPerComponent;\n    this.width = width;\n    this.height = height;\n    this.colorSpace = colorSpace;\n  }\n\n  async embedIntoContext(context: PDFContext, ref?: PDFRef): Promise<PDFRef> {\n    const xObject = context.stream(this.imageData, {\n      Type: 'XObject',\n      Subtype: 'Image',\n      BitsPerComponent: this.bitsPerComponent,\n      Width: this.width,\n      Height: this.height,\n      ColorSpace: this.colorSpace,\n      Filter: 'DCTDecode',\n\n      // CMYK JPEG streams in PDF are typically stored complemented,\n      // with 1 as 'off' and 0 as 'on' (PDF 32000-1:2008, 8.6.4.4).\n      //\n      // Standalone CMYK JPEG (usually exported by Photoshop) are\n      // stored inverse, with 0 as 'off' and 1 as 'on', like RGB.\n      //\n      // Applying a swap here as a hedge that most bytes passing\n      // through this method will benefit from it.\n      Decode:\n        this.colorSpace === ColorSpace.DeviceCMYK\n          ? [1, 0, 1, 0, 1, 0, 1, 0]\n          : undefined,\n    });\n\n    if (ref) {\n      context.assign(ref, xObject);\n      return ref;\n    } else {\n      return context.register(xObject);\n    }\n  }\n}\n\nexport default JpegEmbedder;\n","import UPNG from '@pdf-lib/upng';\n\nconst getImageType = (ctype: number) => {\n  if (ctype === 0) return PngType.Greyscale;\n  if (ctype === 2) return PngType.Truecolour;\n  if (ctype === 3) return PngType.IndexedColour;\n  if (ctype === 4) return PngType.GreyscaleWithAlpha;\n  if (ctype === 6) return PngType.TruecolourWithAlpha;\n  throw new Error(`Unknown color type: ${ctype}`);\n};\n\nconst splitAlphaChannel = (rgbaChannel: Uint8Array) => {\n  const pixelCount = Math.floor(rgbaChannel.length / 4);\n\n  const rgbChannel = new Uint8Array(pixelCount * 3);\n  const alphaChannel = new Uint8Array(pixelCount * 1);\n\n  let rgbaOffset = 0;\n  let rgbOffset = 0;\n  let alphaOffset = 0;\n\n  while (rgbaOffset < rgbaChannel.length) {\n    rgbChannel[rgbOffset++] = rgbaChannel[rgbaOffset++];\n    rgbChannel[rgbOffset++] = rgbaChannel[rgbaOffset++];\n    rgbChannel[rgbOffset++] = rgbaChannel[rgbaOffset++];\n    alphaChannel[alphaOffset++] = rgbaChannel[rgbaOffset++];\n  }\n\n  return { rgbChannel, alphaChannel };\n};\n\nexport enum PngType {\n  Greyscale = 'Greyscale',\n  Truecolour = 'Truecolour',\n  IndexedColour = 'IndexedColour',\n  GreyscaleWithAlpha = 'GreyscaleWithAlpha',\n  TruecolourWithAlpha = 'TruecolourWithAlpha'\n}\n\nexport class PNG {\n  static load = (pngData: Uint8Array) => new PNG(pngData);\n\n  readonly rgbChannel: Uint8Array;\n  readonly alphaChannel?: Uint8Array;\n  readonly type: PngType;\n  readonly width: number;\n  readonly height: number;\n  readonly bitsPerComponent: number;\n\n  private constructor(pngData: Uint8Array) {\n    let buffer: ArrayBuffer;\n    if (pngData.buffer instanceof ArrayBuffer) {\n      buffer = pngData.buffer;\n    } else {\n      buffer = new ArrayBuffer(pngData.byteLength);\n      new Uint8Array(buffer).set(pngData);\n    }\n\n    const upng = UPNG.decode(buffer);\n    const frames = UPNG.toRGBA8(upng);\n\n    if (frames.length > 1) throw new Error('Animated PNGs are not supported');\n\n    const frame = new Uint8Array(frames[0]);\n    const { rgbChannel, alphaChannel } = splitAlphaChannel(frame);\n\n    this.rgbChannel = rgbChannel;\n\n    const hasAlphaValues = alphaChannel.some((a) => a < 255);\n    if (hasAlphaValues) this.alphaChannel = alphaChannel;\n\n    this.type = getImageType(upng.ctype);\n\n    this.width = upng.width;\n    this.height = upng.height;\n    this.bitsPerComponent = 8;\n  }\n}\n","import PDFRef from 'src/core/objects/PDFRef';\nimport PDFContext from 'src/core/PDFContext';\nimport { PNG } from 'src/utils/png';\n\n/**\n * A note of thanks to the developers of https://github.com/foliojs/pdfkit, as\n * this class borrows from:\n *   https://github.com/devongovett/pdfkit/blob/e71edab0dd4657b5a767804ba86c94c58d01fbca/lib/image/png.coffee\n */\nclass PngEmbedder {\n  static async for(imageData: Uint8Array) {\n    const png = PNG.load(imageData);\n    return new PngEmbedder(png);\n  }\n\n  readonly bitsPerComponent: number;\n  readonly height: number;\n  readonly width: number;\n  readonly colorSpace: 'DeviceRGB';\n\n  private readonly image: PNG;\n\n  private constructor(png: PNG) {\n    this.image = png;\n    this.bitsPerComponent = png.bitsPerComponent;\n    this.width = png.width;\n    this.height = png.height;\n    this.colorSpace = 'DeviceRGB';\n  }\n\n  async embedIntoContext(context: PDFContext, ref?: PDFRef): Promise<PDFRef> {\n    const SMask = this.embedAlphaChannel(context);\n\n    const xObject = context.flateStream(this.image.rgbChannel, {\n      Type: 'XObject',\n      Subtype: 'Image',\n      BitsPerComponent: this.image.bitsPerComponent,\n      Width: this.image.width,\n      Height: this.image.height,\n      ColorSpace: this.colorSpace,\n      SMask,\n    });\n\n    if (ref) {\n      context.assign(ref, xObject);\n      return ref;\n    } else {\n      return context.register(xObject);\n    }\n  }\n\n  private embedAlphaChannel(context: PDFContext): PDFRef | undefined {\n    if (!this.image.alphaChannel) return undefined;\n\n    const xObject = context.flateStream(this.image.alphaChannel, {\n      Type: 'XObject',\n      Subtype: 'Image',\n      Height: this.image.height,\n      Width: this.image.width,\n      BitsPerComponent: this.image.bitsPerComponent,\n      ColorSpace: 'DeviceGray',\n      Decode: [0, 1],\n    });\n\n    return context.register(xObject);\n  }\n}\n\nexport default PngEmbedder;\n","/*\n * Copyright 2012 Mozilla Foundation\n *\n * The Stream class contained in this file is a TypeScript port of the\n * JavaScript Stream class in Mozilla's pdf.js project, made available\n * under the Apache 2.0 open source license.\n */\n\nexport interface StreamType {\n  isEmpty: boolean;\n  getByte(): number;\n  getUint16(): number;\n  getInt32(): number;\n  getBytes(\n    length: number,\n    forceClamped?: boolean,\n  ): Uint8Array | Uint8ClampedArray;\n  peekByte(): number;\n  peekBytes(\n    length: number,\n    forceClamped?: boolean,\n  ): Uint8Array | Uint8ClampedArray;\n  skip(n: number): void;\n  reset(): void;\n  makeSubStream(start: number, length: number): StreamType;\n  decode(): Uint8Array;\n}\n\nclass Stream implements StreamType {\n  private bytes: Uint8Array;\n  private start: number;\n  private pos: number;\n  private end: number;\n\n  constructor(buffer: Uint8Array, start?: number, length?: number) {\n    this.bytes = buffer;\n    this.start = start || 0;\n    this.pos = this.start;\n    this.end = !!start && !!length ? start + length : this.bytes.length;\n  }\n\n  get length() {\n    return this.end - this.start;\n  }\n\n  get isEmpty() {\n    return this.length === 0;\n  }\n\n  getByte() {\n    if (this.pos >= this.end) {\n      return -1;\n    }\n    return this.bytes[this.pos++];\n  }\n\n  getUint16() {\n    const b0 = this.getByte();\n    const b1 = this.getByte();\n    if (b0 === -1 || b1 === -1) {\n      return -1;\n    }\n    return (b0 << 8) + b1;\n  }\n\n  getInt32() {\n    const b0 = this.getByte();\n    const b1 = this.getByte();\n    const b2 = this.getByte();\n    const b3 = this.getByte();\n    return (b0 << 24) + (b1 << 16) + (b2 << 8) + b3;\n  }\n\n  // Returns subarray of original buffer, should only be read.\n  getBytes(length: number, forceClamped = false) {\n    const bytes = this.bytes;\n    const pos = this.pos;\n    const strEnd = this.end;\n\n    if (!length) {\n      const subarray = bytes.subarray(pos, strEnd);\n      // `this.bytes` is always a `Uint8Array` here.\n      return forceClamped ? new Uint8ClampedArray(subarray) : subarray;\n    } else {\n      let end = pos + length;\n      if (end > strEnd) {\n        end = strEnd;\n      }\n      this.pos = end;\n      const subarray = bytes.subarray(pos, end);\n      // `this.bytes` is always a `Uint8Array` here.\n      return forceClamped ? new Uint8ClampedArray(subarray) : subarray;\n    }\n  }\n\n  peekByte() {\n    const peekedByte = this.getByte();\n    this.pos--;\n    return peekedByte;\n  }\n\n  peekBytes(length: number, forceClamped = false) {\n    const bytes = this.getBytes(length, forceClamped);\n    this.pos -= bytes.length;\n    return bytes;\n  }\n\n  skip(n: number) {\n    if (!n) {\n      n = 1;\n    }\n    this.pos += n;\n  }\n\n  reset() {\n    this.pos = this.start;\n  }\n\n  moveStart() {\n    this.start = this.pos;\n  }\n\n  makeSubStream(start: number, length: number) {\n    return new Stream(this.bytes, start, length);\n  }\n\n  decode(): Uint8Array {\n    return this.bytes;\n  }\n}\n\nexport default Stream;\n","import { MethodNotImplementedError } from 'src/core/errors';\nimport Stream, { StreamType } from 'src/core/streams/Stream';\n\n/*\n * Copyright 2012 Mozilla Foundation\n *\n * The DecodeStream class contained in this file is a TypeScript port of the\n * JavaScript DecodeStream class in Mozilla's pdf.js project, made available\n * under the Apache 2.0 open source license.\n */\n\n// Lots of DecodeStreams are created whose buffers are never used.  For these\n// we share a single empty buffer. This is (a) space-efficient and (b) avoids\n// having special cases that would be required if we used |null| for an empty\n// buffer.\nconst emptyBuffer = new Uint8Array(0);\n\n/**\n * Super class for the decoding streams\n */\nclass DecodeStream implements StreamType {\n  protected bufferLength: number;\n  protected buffer: Uint8Array;\n  protected eof: boolean;\n\n  private pos: number;\n  private minBufferLength: number;\n\n  constructor(maybeMinBufferLength?: number) {\n    this.pos = 0;\n    this.bufferLength = 0;\n    this.eof = false;\n    this.buffer = emptyBuffer;\n    this.minBufferLength = 512;\n    if (maybeMinBufferLength) {\n      // Compute the first power of two that is as big as maybeMinBufferLength.\n      while (this.minBufferLength < maybeMinBufferLength) {\n        this.minBufferLength *= 2;\n      }\n    }\n  }\n\n  get isEmpty() {\n    while (!this.eof && this.bufferLength === 0) {\n      this.readBlock();\n    }\n    return this.bufferLength === 0;\n  }\n\n  getByte() {\n    const pos = this.pos;\n    while (this.bufferLength <= pos) {\n      if (this.eof) {\n        return -1;\n      }\n      this.readBlock();\n    }\n    return this.buffer[this.pos++];\n  }\n\n  getUint16() {\n    const b0 = this.getByte();\n    const b1 = this.getByte();\n    if (b0 === -1 || b1 === -1) {\n      return -1;\n    }\n    return (b0 << 8) + b1;\n  }\n\n  getInt32() {\n    const b0 = this.getByte();\n    const b1 = this.getByte();\n    const b2 = this.getByte();\n    const b3 = this.getByte();\n    return (b0 << 24) + (b1 << 16) + (b2 << 8) + b3;\n  }\n\n  getBytes(length: number, forceClamped = false) {\n    let end;\n    const pos = this.pos;\n\n    if (length) {\n      this.ensureBuffer(pos + length);\n      end = pos + length;\n\n      while (!this.eof && this.bufferLength < end) {\n        this.readBlock();\n      }\n      const bufEnd = this.bufferLength;\n      if (end > bufEnd) {\n        end = bufEnd;\n      }\n    } else {\n      while (!this.eof) {\n        this.readBlock();\n      }\n      end = this.bufferLength;\n    }\n\n    this.pos = end;\n    const subarray = this.buffer.subarray(pos, end);\n    // `this.buffer` is either a `Uint8Array` or `Uint8ClampedArray` here.\n    return forceClamped && !(subarray instanceof Uint8ClampedArray)\n      ? new Uint8ClampedArray(subarray)\n      : subarray;\n  }\n\n  peekByte() {\n    const peekedByte = this.getByte();\n    this.pos--;\n    return peekedByte;\n  }\n\n  peekBytes(length: number, forceClamped = false) {\n    const bytes = this.getBytes(length, forceClamped);\n    this.pos -= bytes.length;\n    return bytes;\n  }\n\n  skip(n: number) {\n    if (!n) {\n      n = 1;\n    }\n    this.pos += n;\n  }\n\n  reset() {\n    this.pos = 0;\n  }\n\n  makeSubStream(start: number, length: number /* dict */) {\n    const end = start + length;\n    while (this.bufferLength <= end && !this.eof) {\n      this.readBlock();\n    }\n    return new Stream(this.buffer, start, length /* dict */);\n  }\n\n  decode(): Uint8Array {\n    while (!this.eof) this.readBlock();\n    return this.buffer.subarray(0, this.bufferLength);\n  }\n\n  protected readBlock(): void {\n    throw new MethodNotImplementedError(this.constructor.name, 'readBlock');\n  }\n\n  protected ensureBuffer(requested: number) {\n    const buffer = this.buffer;\n    if (requested <= buffer.byteLength) {\n      return buffer;\n    }\n    let size = this.minBufferLength;\n    while (size < requested) {\n      size *= 2;\n    }\n    const buffer2 = new Uint8Array(size);\n    buffer2.set(buffer);\n    return (this.buffer = buffer2);\n  }\n\n  // getBaseStreams() {\n  //   if (this.str && this.str.getBaseStreams) {\n  //     return this.str.getBaseStreams();\n  //   }\n  //   return [];\n  // }\n}\n\nexport default DecodeStream;\n","/*\n * Copyright 2012 Mozilla Foundation\n *\n * The Ascii85Stream class contained in this file is a TypeScript port of the\n * JavaScript Ascii85Stream class in Mozilla's pdf.js project, made available\n * under the Apache 2.0 open source license.\n */\n\nimport DecodeStream from 'src/core/streams/DecodeStream';\nimport { StreamType } from 'src/core/streams/Stream';\n\nconst isSpace = (ch: number) =>\n  ch === 0x20 || ch === 0x09 || ch === 0x0d || ch === 0x0a;\n\nclass Ascii85Stream extends DecodeStream {\n  private stream: StreamType;\n  private input: Uint8Array;\n\n  constructor(stream: StreamType, maybeLength?: number) {\n    super(maybeLength);\n\n    this.stream = stream;\n    this.input = new Uint8Array(5);\n\n    // Most streams increase in size when decoded, but Ascii85 streams\n    // typically shrink by ~20%.\n    if (maybeLength) {\n      maybeLength = 0.8 * maybeLength;\n    }\n  }\n\n  protected readBlock() {\n    const TILDA_CHAR = 0x7e; // '~'\n    const Z_LOWER_CHAR = 0x7a; // 'z'\n    const EOF = -1;\n\n    const stream = this.stream;\n\n    let c = stream.getByte();\n    while (isSpace(c)) {\n      c = stream.getByte();\n    }\n\n    if (c === EOF || c === TILDA_CHAR) {\n      this.eof = true;\n      return;\n    }\n\n    const bufferLength = this.bufferLength;\n    let buffer;\n    let i;\n\n    // special code for z\n    if (c === Z_LOWER_CHAR) {\n      buffer = this.ensureBuffer(bufferLength + 4);\n      for (i = 0; i < 4; ++i) {\n        buffer[bufferLength + i] = 0;\n      }\n      this.bufferLength += 4;\n    } else {\n      const input = this.input;\n      input[0] = c;\n      for (i = 1; i < 5; ++i) {\n        c = stream.getByte();\n        while (isSpace(c)) {\n          c = stream.getByte();\n        }\n\n        input[i] = c;\n\n        if (c === EOF || c === TILDA_CHAR) {\n          break;\n        }\n      }\n      buffer = this.ensureBuffer(bufferLength + i - 1);\n      this.bufferLength += i - 1;\n\n      // partial ending;\n      if (i < 5) {\n        for (; i < 5; ++i) {\n          input[i] = 0x21 + 84;\n        }\n        this.eof = true;\n      }\n      let t = 0;\n      for (i = 0; i < 5; ++i) {\n        t = t * 85 + (input[i] - 0x21);\n      }\n\n      for (i = 3; i >= 0; --i) {\n        buffer[bufferLength + i] = t & 0xff;\n        t >>= 8;\n      }\n    }\n  }\n}\n\nexport default Ascii85Stream;\n","/*\n * Copyright 2012 Mozilla Foundation\n *\n * The AsciiHexStream class contained in this file is a TypeScript port of the\n * JavaScript AsciiHexStream class in Mozilla's pdf.js project, made available\n * under the Apache 2.0 open source license.\n */\n\nimport DecodeStream from 'src/core/streams/DecodeStream';\nimport { StreamType } from 'src/core/streams/Stream';\n\nclass AsciiHexStream extends DecodeStream {\n  private stream: StreamType;\n  private firstDigit: number;\n\n  constructor(stream: StreamType, maybeLength?: number) {\n    super(maybeLength);\n\n    this.stream = stream;\n\n    this.firstDigit = -1;\n\n    // Most streams increase in size when decoded, but AsciiHex streams shrink\n    // by 50%.\n    if (maybeLength) {\n      maybeLength = 0.5 * maybeLength;\n    }\n  }\n\n  protected readBlock() {\n    const UPSTREAM_BLOCK_SIZE = 8000;\n    const bytes = this.stream.getBytes(UPSTREAM_BLOCK_SIZE);\n    if (!bytes.length) {\n      this.eof = true;\n      return;\n    }\n\n    const maxDecodeLength = (bytes.length + 1) >> 1;\n    const buffer = this.ensureBuffer(this.bufferLength + maxDecodeLength);\n    let bufferLength = this.bufferLength;\n\n    let firstDigit = this.firstDigit;\n    for (let i = 0, ii = bytes.length; i < ii; i++) {\n      const ch = bytes[i];\n      let digit;\n      if (ch >= 0x30 && ch <= 0x39) {\n        // '0'-'9'\n        digit = ch & 0x0f;\n      } else if ((ch >= 0x41 && ch <= 0x46) || (ch >= 0x61 && ch <= 0x66)) {\n        // 'A'-'Z', 'a'-'z'\n        digit = (ch & 0x0f) + 9;\n      } else if (ch === 0x3e) {\n        // '>'\n        this.eof = true;\n        break;\n      } else {\n        // probably whitespace\n        continue; // ignoring\n      }\n      if (firstDigit < 0) {\n        firstDigit = digit;\n      } else {\n        buffer[bufferLength++] = (firstDigit << 4) | digit;\n        firstDigit = -1;\n      }\n    }\n    if (firstDigit >= 0 && this.eof) {\n      // incomplete byte\n      buffer[bufferLength++] = firstDigit << 4;\n      firstDigit = -1;\n    }\n    this.firstDigit = firstDigit;\n    this.bufferLength = bufferLength;\n  }\n}\n\nexport default AsciiHexStream;\n","/*\n * Copyright 1996-2003 Glyph & Cog, LLC\n *\n * The flate stream implementation contained in this file is a JavaScript port\n * of XPDF's implementation, made available under the Apache 2.0 open source\n * license.\n */\n\n/*\n * Copyright 2012 Mozilla Foundation\n *\n * The FlateStream class contained in this file is a TypeScript port of the\n * JavaScript FlateStream class in Mozilla's pdf.js project, made available\n * under the Apache 2.0 open source license.\n */\n\n/* tslint:disable  no-conditional-assignment */\nimport DecodeStream from 'src/core/streams/DecodeStream';\nimport { StreamType } from 'src/core/streams/Stream';\n\n// prettier-ignore\nconst codeLenCodeMap = new Int32Array([\n  16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15,\n]);\n\n// prettier-ignore\nconst lengthDecode = new Int32Array([\n  0x00003, 0x00004, 0x00005, 0x00006, 0x00007, 0x00008, 0x00009, 0x0000a,\n  0x1000b, 0x1000d, 0x1000f, 0x10011, 0x20013, 0x20017, 0x2001b, 0x2001f,\n  0x30023, 0x3002b, 0x30033, 0x3003b, 0x40043, 0x40053, 0x40063, 0x40073,\n  0x50083, 0x500a3, 0x500c3, 0x500e3, 0x00102, 0x00102, 0x00102,\n]);\n\n// prettier-ignore\nconst distDecode = new Int32Array([\n  0x00001, 0x00002, 0x00003, 0x00004, 0x10005, 0x10007, 0x20009, 0x2000d,\n  0x30011, 0x30019, 0x40021, 0x40031, 0x50041, 0x50061, 0x60081, 0x600c1,\n  0x70101, 0x70181, 0x80201, 0x80301, 0x90401, 0x90601, 0xa0801, 0xa0c01,\n  0xb1001, 0xb1801, 0xc2001, 0xc3001, 0xd4001, 0xd6001,\n]);\n\n// prettier-ignore\nconst fixedLitCodeTab = [new Int32Array([\n  0x70100, 0x80050, 0x80010, 0x80118, 0x70110, 0x80070, 0x80030, 0x900c0,\n  0x70108, 0x80060, 0x80020, 0x900a0, 0x80000, 0x80080, 0x80040, 0x900e0,\n  0x70104, 0x80058, 0x80018, 0x90090, 0x70114, 0x80078, 0x80038, 0x900d0,\n  0x7010c, 0x80068, 0x80028, 0x900b0, 0x80008, 0x80088, 0x80048, 0x900f0,\n  0x70102, 0x80054, 0x80014, 0x8011c, 0x70112, 0x80074, 0x80034, 0x900c8,\n  0x7010a, 0x80064, 0x80024, 0x900a8, 0x80004, 0x80084, 0x80044, 0x900e8,\n  0x70106, 0x8005c, 0x8001c, 0x90098, 0x70116, 0x8007c, 0x8003c, 0x900d8,\n  0x7010e, 0x8006c, 0x8002c, 0x900b8, 0x8000c, 0x8008c, 0x8004c, 0x900f8,\n  0x70101, 0x80052, 0x80012, 0x8011a, 0x70111, 0x80072, 0x80032, 0x900c4,\n  0x70109, 0x80062, 0x80022, 0x900a4, 0x80002, 0x80082, 0x80042, 0x900e4,\n  0x70105, 0x8005a, 0x8001a, 0x90094, 0x70115, 0x8007a, 0x8003a, 0x900d4,\n  0x7010d, 0x8006a, 0x8002a, 0x900b4, 0x8000a, 0x8008a, 0x8004a, 0x900f4,\n  0x70103, 0x80056, 0x80016, 0x8011e, 0x70113, 0x80076, 0x80036, 0x900cc,\n  0x7010b, 0x80066, 0x80026, 0x900ac, 0x80006, 0x80086, 0x80046, 0x900ec,\n  0x70107, 0x8005e, 0x8001e, 0x9009c, 0x70117, 0x8007e, 0x8003e, 0x900dc,\n  0x7010f, 0x8006e, 0x8002e, 0x900bc, 0x8000e, 0x8008e, 0x8004e, 0x900fc,\n  0x70100, 0x80051, 0x80011, 0x80119, 0x70110, 0x80071, 0x80031, 0x900c2,\n  0x70108, 0x80061, 0x80021, 0x900a2, 0x80001, 0x80081, 0x80041, 0x900e2,\n  0x70104, 0x80059, 0x80019, 0x90092, 0x70114, 0x80079, 0x80039, 0x900d2,\n  0x7010c, 0x80069, 0x80029, 0x900b2, 0x80009, 0x80089, 0x80049, 0x900f2,\n  0x70102, 0x80055, 0x80015, 0x8011d, 0x70112, 0x80075, 0x80035, 0x900ca,\n  0x7010a, 0x80065, 0x80025, 0x900aa, 0x80005, 0x80085, 0x80045, 0x900ea,\n  0x70106, 0x8005d, 0x8001d, 0x9009a, 0x70116, 0x8007d, 0x8003d, 0x900da,\n  0x7010e, 0x8006d, 0x8002d, 0x900ba, 0x8000d, 0x8008d, 0x8004d, 0x900fa,\n  0x70101, 0x80053, 0x80013, 0x8011b, 0x70111, 0x80073, 0x80033, 0x900c6,\n  0x70109, 0x80063, 0x80023, 0x900a6, 0x80003, 0x80083, 0x80043, 0x900e6,\n  0x70105, 0x8005b, 0x8001b, 0x90096, 0x70115, 0x8007b, 0x8003b, 0x900d6,\n  0x7010d, 0x8006b, 0x8002b, 0x900b6, 0x8000b, 0x8008b, 0x8004b, 0x900f6,\n  0x70103, 0x80057, 0x80017, 0x8011f, 0x70113, 0x80077, 0x80037, 0x900ce,\n  0x7010b, 0x80067, 0x80027, 0x900ae, 0x80007, 0x80087, 0x80047, 0x900ee,\n  0x70107, 0x8005f, 0x8001f, 0x9009e, 0x70117, 0x8007f, 0x8003f, 0x900de,\n  0x7010f, 0x8006f, 0x8002f, 0x900be, 0x8000f, 0x8008f, 0x8004f, 0x900fe,\n  0x70100, 0x80050, 0x80010, 0x80118, 0x70110, 0x80070, 0x80030, 0x900c1,\n  0x70108, 0x80060, 0x80020, 0x900a1, 0x80000, 0x80080, 0x80040, 0x900e1,\n  0x70104, 0x80058, 0x80018, 0x90091, 0x70114, 0x80078, 0x80038, 0x900d1,\n  0x7010c, 0x80068, 0x80028, 0x900b1, 0x80008, 0x80088, 0x80048, 0x900f1,\n  0x70102, 0x80054, 0x80014, 0x8011c, 0x70112, 0x80074, 0x80034, 0x900c9,\n  0x7010a, 0x80064, 0x80024, 0x900a9, 0x80004, 0x80084, 0x80044, 0x900e9,\n  0x70106, 0x8005c, 0x8001c, 0x90099, 0x70116, 0x8007c, 0x8003c, 0x900d9,\n  0x7010e, 0x8006c, 0x8002c, 0x900b9, 0x8000c, 0x8008c, 0x8004c, 0x900f9,\n  0x70101, 0x80052, 0x80012, 0x8011a, 0x70111, 0x80072, 0x80032, 0x900c5,\n  0x70109, 0x80062, 0x80022, 0x900a5, 0x80002, 0x80082, 0x80042, 0x900e5,\n  0x70105, 0x8005a, 0x8001a, 0x90095, 0x70115, 0x8007a, 0x8003a, 0x900d5,\n  0x7010d, 0x8006a, 0x8002a, 0x900b5, 0x8000a, 0x8008a, 0x8004a, 0x900f5,\n  0x70103, 0x80056, 0x80016, 0x8011e, 0x70113, 0x80076, 0x80036, 0x900cd,\n  0x7010b, 0x80066, 0x80026, 0x900ad, 0x80006, 0x80086, 0x80046, 0x900ed,\n  0x70107, 0x8005e, 0x8001e, 0x9009d, 0x70117, 0x8007e, 0x8003e, 0x900dd,\n  0x7010f, 0x8006e, 0x8002e, 0x900bd, 0x8000e, 0x8008e, 0x8004e, 0x900fd,\n  0x70100, 0x80051, 0x80011, 0x80119, 0x70110, 0x80071, 0x80031, 0x900c3,\n  0x70108, 0x80061, 0x80021, 0x900a3, 0x80001, 0x80081, 0x80041, 0x900e3,\n  0x70104, 0x80059, 0x80019, 0x90093, 0x70114, 0x80079, 0x80039, 0x900d3,\n  0x7010c, 0x80069, 0x80029, 0x900b3, 0x80009, 0x80089, 0x80049, 0x900f3,\n  0x70102, 0x80055, 0x80015, 0x8011d, 0x70112, 0x80075, 0x80035, 0x900cb,\n  0x7010a, 0x80065, 0x80025, 0x900ab, 0x80005, 0x80085, 0x80045, 0x900eb,\n  0x70106, 0x8005d, 0x8001d, 0x9009b, 0x70116, 0x8007d, 0x8003d, 0x900db,\n  0x7010e, 0x8006d, 0x8002d, 0x900bb, 0x8000d, 0x8008d, 0x8004d, 0x900fb,\n  0x70101, 0x80053, 0x80013, 0x8011b, 0x70111, 0x80073, 0x80033, 0x900c7,\n  0x70109, 0x80063, 0x80023, 0x900a7, 0x80003, 0x80083, 0x80043, 0x900e7,\n  0x70105, 0x8005b, 0x8001b, 0x90097, 0x70115, 0x8007b, 0x8003b, 0x900d7,\n  0x7010d, 0x8006b, 0x8002b, 0x900b7, 0x8000b, 0x8008b, 0x8004b, 0x900f7,\n  0x70103, 0x80057, 0x80017, 0x8011f, 0x70113, 0x80077, 0x80037, 0x900cf,\n  0x7010b, 0x80067, 0x80027, 0x900af, 0x80007, 0x80087, 0x80047, 0x900ef,\n  0x70107, 0x8005f, 0x8001f, 0x9009f, 0x70117, 0x8007f, 0x8003f, 0x900df,\n  0x7010f, 0x8006f, 0x8002f, 0x900bf, 0x8000f, 0x8008f, 0x8004f, 0x900ff,\n]), 9] as [Int32Array, number];\n\n// prettier-ignore\nconst fixedDistCodeTab = [new Int32Array([\n  0x50000, 0x50010, 0x50008, 0x50018, 0x50004, 0x50014, 0x5000c, 0x5001c,\n  0x50002, 0x50012, 0x5000a, 0x5001a, 0x50006, 0x50016, 0x5000e, 0x00000,\n  0x50001, 0x50011, 0x50009, 0x50019, 0x50005, 0x50015, 0x5000d, 0x5001d,\n  0x50003, 0x50013, 0x5000b, 0x5001b, 0x50007, 0x50017, 0x5000f, 0x00000,\n]), 5] as [Int32Array, number];\n\nclass FlateStream extends DecodeStream {\n  private stream: StreamType;\n  private codeSize: number;\n  private codeBuf: number;\n\n  constructor(stream: StreamType, maybeLength?: number) {\n    super(maybeLength);\n\n    this.stream = stream;\n\n    const cmf = stream.getByte();\n    const flg = stream.getByte();\n    if (cmf === -1 || flg === -1) {\n      throw new Error(`Invalid header in flate stream: ${cmf}, ${flg}`);\n    }\n    if ((cmf & 0x0f) !== 0x08) {\n      throw new Error(\n        `Unknown compression method in flate stream: ${cmf}, ${flg}`,\n      );\n    }\n    if (((cmf << 8) + flg) % 31 !== 0) {\n      throw new Error(`Bad FCHECK in flate stream: ${cmf}, ${flg}`);\n    }\n    if (flg & 0x20) {\n      throw new Error(`FDICT bit set in flate stream: ${cmf}, ${flg}`);\n    }\n\n    this.codeSize = 0;\n    this.codeBuf = 0;\n  }\n\n  protected readBlock() {\n    let buffer;\n    let len;\n    const str = this.stream;\n    // read block header\n    let hdr = this.getBits(3);\n    if (hdr & 1) {\n      this.eof = true;\n    }\n    hdr >>= 1;\n\n    if (hdr === 0) {\n      // uncompressed block\n      let b;\n\n      if ((b = str.getByte()) === -1) {\n        throw new Error('Bad block header in flate stream');\n      }\n      let blockLen = b;\n      if ((b = str.getByte()) === -1) {\n        throw new Error('Bad block header in flate stream');\n      }\n      blockLen |= b << 8;\n      if ((b = str.getByte()) === -1) {\n        throw new Error('Bad block header in flate stream');\n      }\n      let check = b;\n      if ((b = str.getByte()) === -1) {\n        throw new Error('Bad block header in flate stream');\n      }\n      check |= b << 8;\n      if (check !== (~blockLen & 0xffff) && (blockLen !== 0 || check !== 0)) {\n        // Ignoring error for bad \"empty\" block (see issue 1277)\n        throw new Error('Bad uncompressed block length in flate stream');\n      }\n\n      this.codeBuf = 0;\n      this.codeSize = 0;\n\n      const bufferLength = this.bufferLength;\n      buffer = this.ensureBuffer(bufferLength + blockLen);\n      const end = bufferLength + blockLen;\n      this.bufferLength = end;\n      if (blockLen === 0) {\n        if (str.peekByte() === -1) {\n          this.eof = true;\n        }\n      } else {\n        for (let n = bufferLength; n < end; ++n) {\n          if ((b = str.getByte()) === -1) {\n            this.eof = true;\n            break;\n          }\n          buffer[n] = b;\n        }\n      }\n      return;\n    }\n\n    let litCodeTable;\n    let distCodeTable;\n    if (hdr === 1) {\n      // compressed block, fixed codes\n      litCodeTable = fixedLitCodeTab;\n      distCodeTable = fixedDistCodeTab;\n    } else if (hdr === 2) {\n      // compressed block, dynamic codes\n      const numLitCodes = this.getBits(5) + 257;\n      const numDistCodes = this.getBits(5) + 1;\n      const numCodeLenCodes = this.getBits(4) + 4;\n\n      // build the code lengths code table\n      const codeLenCodeLengths = new Uint8Array(codeLenCodeMap.length);\n\n      let i;\n      for (i = 0; i < numCodeLenCodes; ++i) {\n        codeLenCodeLengths[codeLenCodeMap[i]] = this.getBits(3);\n      }\n      const codeLenCodeTab = this.generateHuffmanTable(codeLenCodeLengths);\n\n      // build the literal and distance code tables\n      len = 0;\n      i = 0;\n      const codes = numLitCodes + numDistCodes;\n      const codeLengths = new Uint8Array(codes);\n      let bitsLength;\n      let bitsOffset;\n      let what;\n      while (i < codes) {\n        const code = this.getCode(codeLenCodeTab);\n        if (code === 16) {\n          bitsLength = 2;\n          bitsOffset = 3;\n          what = len;\n        } else if (code === 17) {\n          bitsLength = 3;\n          bitsOffset = 3;\n          what = len = 0;\n        } else if (code === 18) {\n          bitsLength = 7;\n          bitsOffset = 11;\n          what = len = 0;\n        } else {\n          codeLengths[i++] = len = code;\n          continue;\n        }\n\n        let repeatLength = this.getBits(bitsLength) + bitsOffset;\n        while (repeatLength-- > 0) {\n          codeLengths[i++] = what;\n        }\n      }\n\n      litCodeTable = this.generateHuffmanTable(\n        codeLengths.subarray(0, numLitCodes),\n      );\n      distCodeTable = this.generateHuffmanTable(\n        codeLengths.subarray(numLitCodes, codes),\n      );\n    } else {\n      throw new Error('Unknown block type in flate stream');\n    }\n\n    buffer = this.buffer;\n    let limit = buffer ? buffer.length : 0;\n    let pos = this.bufferLength;\n    while (true) {\n      let code1 = this.getCode(litCodeTable);\n      if (code1 < 256) {\n        if (pos + 1 >= limit) {\n          buffer = this.ensureBuffer(pos + 1);\n          limit = buffer.length;\n        }\n        buffer[pos++] = code1;\n        continue;\n      }\n      if (code1 === 256) {\n        this.bufferLength = pos;\n        return;\n      }\n      code1 -= 257;\n      code1 = lengthDecode[code1];\n      let code2 = code1 >> 16;\n      if (code2 > 0) {\n        code2 = this.getBits(code2);\n      }\n      len = (code1 & 0xffff) + code2;\n      code1 = this.getCode(distCodeTable);\n      code1 = distDecode[code1];\n      code2 = code1 >> 16;\n      if (code2 > 0) {\n        code2 = this.getBits(code2);\n      }\n      const dist = (code1 & 0xffff) + code2;\n      if (pos + len >= limit) {\n        buffer = this.ensureBuffer(pos + len);\n        limit = buffer.length;\n      }\n      for (let k = 0; k < len; ++k, ++pos) {\n        buffer[pos] = buffer[pos - dist];\n      }\n    }\n  }\n\n  private getBits(bits: number) {\n    const str = this.stream;\n    let codeSize = this.codeSize;\n    let codeBuf = this.codeBuf;\n\n    let b;\n    while (codeSize < bits) {\n      if ((b = str.getByte()) === -1) {\n        throw new Error('Bad encoding in flate stream');\n      }\n      codeBuf |= b << codeSize;\n      codeSize += 8;\n    }\n    b = codeBuf & ((1 << bits) - 1);\n    this.codeBuf = codeBuf >> bits;\n    this.codeSize = codeSize -= bits;\n\n    return b;\n  }\n\n  private getCode(table: [Int32Array, number]) {\n    const str = this.stream;\n    const codes = table[0];\n    const maxLen = table[1];\n    let codeSize = this.codeSize;\n    let codeBuf = this.codeBuf;\n\n    let b;\n    while (codeSize < maxLen) {\n      if ((b = str.getByte()) === -1) {\n        // premature end of stream. code might however still be valid.\n        // codeSize < codeLen check below guards against incomplete codeVal.\n        break;\n      }\n      codeBuf |= b << codeSize;\n      codeSize += 8;\n    }\n    const code = codes[codeBuf & ((1 << maxLen) - 1)];\n    if (typeof codes === 'number') {\n      console.log('FLATE:', code);\n    }\n    const codeLen = code >> 16;\n    const codeVal = code & 0xffff;\n    if (codeLen < 1 || codeSize < codeLen) {\n      throw new Error('Bad encoding in flate stream');\n    }\n    this.codeBuf = codeBuf >> codeLen;\n    this.codeSize = codeSize - codeLen;\n    return codeVal;\n  }\n\n  private generateHuffmanTable(lengths: Uint8Array): [Int32Array, number] {\n    const n = lengths.length;\n\n    // find max code length\n    let maxLen = 0;\n    let i;\n    for (i = 0; i < n; ++i) {\n      if (lengths[i] > maxLen) {\n        maxLen = lengths[i];\n      }\n    }\n\n    // build the table\n    const size = 1 << maxLen;\n    const codes = new Int32Array(size);\n    for (\n      let len = 1, code = 0, skip = 2;\n      len <= maxLen;\n      ++len, code <<= 1, skip <<= 1\n    ) {\n      for (let val = 0; val < n; ++val) {\n        if (lengths[val] === len) {\n          // bit-reverse the code\n          let code2 = 0;\n          let t = code;\n          for (i = 0; i < len; ++i) {\n            code2 = (code2 << 1) | (t & 1);\n            t >>= 1;\n          }\n\n          // fill the table entries\n          for (i = code2; i < size; i += skip) {\n            codes[i] = (len << 16) | val;\n          }\n          ++code;\n        }\n      }\n    }\n\n    return [codes, maxLen];\n  }\n}\n\nexport default FlateStream;\n","/*\n * Copyright 2012 Mozilla Foundation\n *\n * The LZWStream class contained in this file is a TypeScript port of the\n * JavaScript LZWStream class in Mozilla's pdf.js project, made available\n * under the Apache 2.0 open source license.\n */\n\nimport DecodeStream from 'src/core/streams/DecodeStream';\nimport { StreamType } from 'src/core/streams/Stream';\n\nclass LZWStream extends DecodeStream {\n  private stream: StreamType;\n  private cachedData: number;\n  private bitsCached: number;\n  private lzwState?: {\n    earlyChange: 0 | 1;\n    codeLength: number;\n    nextCode: number;\n    dictionaryValues: Uint8Array;\n    dictionaryLengths: Uint16Array;\n    dictionaryPrevCodes: Uint16Array;\n    currentSequence: Uint8Array;\n    currentSequenceLength: number;\n    prevCode?: number | null;\n  };\n\n  constructor(\n    stream: StreamType,\n    maybeLength: number | undefined,\n    earlyChange: 0 | 1,\n  ) {\n    super(maybeLength);\n\n    this.stream = stream;\n    this.cachedData = 0;\n    this.bitsCached = 0;\n\n    const maxLzwDictionarySize = 4096;\n    const lzwState = {\n      earlyChange,\n      codeLength: 9,\n      nextCode: 258,\n      dictionaryValues: new Uint8Array(maxLzwDictionarySize),\n      dictionaryLengths: new Uint16Array(maxLzwDictionarySize),\n      dictionaryPrevCodes: new Uint16Array(maxLzwDictionarySize),\n      currentSequence: new Uint8Array(maxLzwDictionarySize),\n      currentSequenceLength: 0,\n    };\n    for (let i = 0; i < 256; ++i) {\n      lzwState.dictionaryValues[i] = i;\n      lzwState.dictionaryLengths[i] = 1;\n    }\n    this.lzwState = lzwState;\n  }\n\n  protected readBlock() {\n    const blockSize = 512;\n\n    let estimatedDecodedSize = blockSize * 2;\n    const decodedSizeDelta = blockSize;\n    let i;\n    let j;\n    let q;\n\n    const lzwState = this.lzwState;\n    if (!lzwState) {\n      return; // eof was found\n    }\n\n    const earlyChange = lzwState.earlyChange;\n    let nextCode = lzwState.nextCode;\n    const dictionaryValues = lzwState.dictionaryValues;\n    const dictionaryLengths = lzwState.dictionaryLengths;\n    const dictionaryPrevCodes = lzwState.dictionaryPrevCodes;\n    let codeLength = lzwState.codeLength;\n    let prevCode = lzwState.prevCode;\n    const currentSequence = lzwState.currentSequence;\n    let currentSequenceLength = lzwState.currentSequenceLength;\n\n    let decodedLength = 0;\n    let currentBufferLength = this.bufferLength;\n    let buffer = this.ensureBuffer(this.bufferLength + estimatedDecodedSize);\n\n    for (i = 0; i < blockSize; i++) {\n      const code = this.readBits(codeLength);\n      const hasPrev = currentSequenceLength > 0;\n      if (!code || code < 256) {\n        currentSequence[0] = code as number;\n        currentSequenceLength = 1;\n      } else if (code >= 258) {\n        if (code < nextCode) {\n          currentSequenceLength = dictionaryLengths[code];\n          for (j = currentSequenceLength - 1, q = code; j >= 0; j--) {\n            currentSequence[j] = dictionaryValues[q];\n            q = dictionaryPrevCodes[q];\n          }\n        } else {\n          currentSequence[currentSequenceLength++] = currentSequence[0];\n        }\n      } else if (code === 256) {\n        codeLength = 9;\n        nextCode = 258;\n        currentSequenceLength = 0;\n        continue;\n      } else {\n        this.eof = true;\n        delete this.lzwState;\n        break;\n      }\n\n      if (hasPrev) {\n        dictionaryPrevCodes[nextCode] = prevCode as number;\n        dictionaryLengths[nextCode] = dictionaryLengths[prevCode as number] + 1;\n        dictionaryValues[nextCode] = currentSequence[0];\n        nextCode++;\n        codeLength =\n          (nextCode + earlyChange) & (nextCode + earlyChange - 1)\n            ? codeLength\n            : Math.min(\n              Math.log(nextCode + earlyChange) / 0.6931471805599453 + 1,\n              12,\n            ) | 0;\n      }\n      prevCode = code;\n\n      decodedLength += currentSequenceLength;\n      if (estimatedDecodedSize < decodedLength) {\n        do {\n          estimatedDecodedSize += decodedSizeDelta;\n        } while (estimatedDecodedSize < decodedLength);\n        buffer = this.ensureBuffer(this.bufferLength + estimatedDecodedSize);\n      }\n      for (j = 0; j < currentSequenceLength; j++) {\n        buffer[currentBufferLength++] = currentSequence[j];\n      }\n    }\n    lzwState.nextCode = nextCode;\n    lzwState.codeLength = codeLength;\n    lzwState.prevCode = prevCode;\n    lzwState.currentSequenceLength = currentSequenceLength;\n\n    this.bufferLength = currentBufferLength;\n  }\n\n  private readBits(n: number) {\n    let bitsCached = this.bitsCached;\n    let cachedData = this.cachedData;\n    while (bitsCached < n) {\n      const c = this.stream.getByte();\n      if (c === -1) {\n        this.eof = true;\n        return null;\n      }\n      cachedData = (cachedData << 8) | c;\n      bitsCached += 8;\n    }\n    this.bitsCached = bitsCached -= n;\n    this.cachedData = cachedData;\n    return (cachedData >>> bitsCached) & ((1 << n) - 1);\n  }\n}\n\nexport default LZWStream;\n","/*\n * Copyright 2012 Mozilla Foundation\n *\n * The RunLengthStream class contained in this file is a TypeScript port of the\n * JavaScript RunLengthStream class in Mozilla's pdf.js project, made available\n * under the Apache 2.0 open source license.\n */\n\nimport DecodeStream from 'src/core/streams/DecodeStream';\nimport { StreamType } from 'src/core/streams/Stream';\n\nclass RunLengthStream extends DecodeStream {\n  private stream: StreamType;\n\n  constructor(stream: StreamType, maybeLength?: number) {\n    super(maybeLength);\n    this.stream = stream;\n  }\n\n  protected readBlock() {\n    // The repeatHeader has following format. The first byte defines type of run\n    // and amount of bytes to repeat/copy: n = 0 through 127 - copy next n bytes\n    // (in addition to the second byte from the header), n = 129 through 255 -\n    // duplicate the second byte from the header (257 - n) times, n = 128 - end.\n    const repeatHeader = this.stream.getBytes(2);\n    if (!repeatHeader || repeatHeader.length < 2 || repeatHeader[0] === 128) {\n      this.eof = true;\n      return;\n    }\n\n    let buffer;\n    let bufferLength = this.bufferLength;\n    let n = repeatHeader[0];\n    if (n < 128) {\n      // copy n bytes\n      buffer = this.ensureBuffer(bufferLength + n + 1);\n      buffer[bufferLength++] = repeatHeader[1];\n      if (n > 0) {\n        const source = this.stream.getBytes(n);\n        buffer.set(source, bufferLength);\n        bufferLength += n;\n      }\n    } else {\n      n = 257 - n;\n      const b = repeatHeader[1];\n      buffer = this.ensureBuffer(bufferLength + n + 1);\n      for (let i = 0; i < n; i++) {\n        buffer[bufferLength++] = b;\n      }\n    }\n    this.bufferLength = bufferLength;\n  }\n}\n\nexport default RunLengthStream;\n","import {\n  UnexpectedObjectTypeError,\n  UnsupportedEncodingError,\n} from 'src/core/errors';\nimport PDFArray from 'src/core/objects/PDFArray';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNull from 'src/core/objects/PDFNull';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFRawStream from 'src/core/objects/PDFRawStream';\nimport Ascii85Stream from 'src/core/streams/Ascii85Stream';\nimport AsciiHexStream from 'src/core/streams/AsciiHexStream';\nimport FlateStream from 'src/core/streams/FlateStream';\nimport LZWStream from 'src/core/streams/LZWStream';\nimport RunLengthStream from 'src/core/streams/RunLengthStream';\nimport Stream, { StreamType } from 'src/core/streams/Stream';\n\nconst decodeStream = (\n  stream: StreamType,\n  encoding: PDFName,\n  params: undefined | typeof PDFNull | PDFDict,\n) => {\n  if (encoding === PDFName.of('FlateDecode')) {\n    return new FlateStream(stream);\n  }\n  if (encoding === PDFName.of('LZWDecode')) {\n    let earlyChange = 1;\n    if (params instanceof PDFDict) {\n      const EarlyChange = params.lookup(PDFName.of('EarlyChange'));\n      if (EarlyChange instanceof PDFNumber) {\n        earlyChange = EarlyChange.asNumber();\n      }\n    }\n    return new LZWStream(stream, undefined, earlyChange as 0 | 1);\n  }\n  if (encoding === PDFName.of('ASCII85Decode')) {\n    return new Ascii85Stream(stream);\n  }\n  if (encoding === PDFName.of('ASCIIHexDecode')) {\n    return new AsciiHexStream(stream);\n  }\n  if (encoding === PDFName.of('RunLengthDecode')) {\n    return new RunLengthStream(stream);\n  }\n  throw new UnsupportedEncodingError(encoding.asString());\n};\n\nexport const decodePDFRawStream = ({ dict, contents }: PDFRawStream) => {\n  let stream: StreamType = new Stream(contents);\n\n  const Filter = dict.lookup(PDFName.of('Filter'));\n  const DecodeParms = dict.lookup(PDFName.of('DecodeParms'));\n\n  if (Filter instanceof PDFName) {\n    stream = decodeStream(\n      stream,\n      Filter,\n      DecodeParms as PDFDict | typeof PDFNull | undefined,\n    );\n  } else if (Filter instanceof PDFArray) {\n    for (let idx = 0, len = Filter.size(); idx < len; idx++) {\n      stream = decodeStream(\n        stream,\n        Filter.lookup(idx, PDFName),\n        DecodeParms && (DecodeParms as PDFArray).lookupMaybe(idx, PDFDict),\n      );\n    }\n  } else if (Filter) {\n    throw new UnexpectedObjectTypeError([PDFName, PDFArray], Filter);\n  }\n\n  return stream;\n};\n","import {\n  MissingPageContentsEmbeddingError,\n  UnrecognizedStreamTypeError,\n} from 'src/core/errors';\nimport PDFArray from 'src/core/objects/PDFArray';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFRawStream from 'src/core/objects/PDFRawStream';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFStream from 'src/core/objects/PDFStream';\nimport PDFContext from 'src/core/PDFContext';\nimport { decodePDFRawStream } from 'src/core/streams/decode';\nimport PDFContentStream from 'src/core/structures/PDFContentStream';\nimport PDFPageLeaf from 'src/core/structures/PDFPageLeaf';\nimport CharCodes from 'src/core/syntax/CharCodes';\nimport { TransformationMatrix } from 'src/types/matrix';\nimport { mergeIntoTypedArray } from 'src/utils';\n\n/**\n * Represents a page bounding box.\n * Usually `left` and `bottom` are 0 and right, top are equal\n * to width, height if you want to clip to the whole page.\n *\n *       y\n *       ^\n *       | +--------+ (width,height)\n *       | |        |\n *       | |  Page  |\n *       | |        |\n *       | |        |\n * (0,0) | +--------+\n *       +----------> x\n */\nexport interface PageBoundingBox {\n  left: number /** The left of the bounding box */;\n  bottom: number /** The bottom of the bounding box */;\n  right: number /** The right of the bounding box */;\n  top: number /** The top of the bounding box */;\n}\n\nconst fullPageBoundingBox = (page: PDFPageLeaf) => {\n  const mediaBox = page.MediaBox();\n\n  const width =\n    mediaBox.lookup(2, PDFNumber).asNumber() -\n    mediaBox.lookup(0, PDFNumber).asNumber();\n\n  const height =\n    mediaBox.lookup(3, PDFNumber).asNumber() -\n    mediaBox.lookup(1, PDFNumber).asNumber();\n\n  return { left: 0, bottom: 0, right: width, top: height };\n};\n\n// Returns the identity matrix, modified to position the content of the given\n// bounding box at (0, 0).\nconst boundingBoxAdjustedMatrix = (\n  bb: PageBoundingBox,\n): TransformationMatrix => [1, 0, 0, 1, -bb.left, -bb.bottom];\n\nclass PDFPageEmbedder {\n  static async for(\n    page: PDFPageLeaf,\n    boundingBox?: PageBoundingBox,\n    transformationMatrix?: TransformationMatrix,\n  ) {\n    return new PDFPageEmbedder(page, boundingBox, transformationMatrix);\n  }\n\n  readonly width: number;\n  readonly height: number;\n  readonly boundingBox: PageBoundingBox;\n  readonly transformationMatrix: TransformationMatrix;\n\n  private readonly page: PDFPageLeaf;\n\n  private constructor(\n    page: PDFPageLeaf,\n    boundingBox?: PageBoundingBox,\n    transformationMatrix?: TransformationMatrix,\n  ) {\n    this.page = page;\n\n    const bb = boundingBox ?? fullPageBoundingBox(page);\n\n    this.width = bb.right - bb.left;\n    this.height = bb.top - bb.bottom;\n    this.boundingBox = bb;\n    this.transformationMatrix =\n      transformationMatrix ?? boundingBoxAdjustedMatrix(bb);\n  }\n\n  async embedIntoContext(context: PDFContext, ref?: PDFRef): Promise<PDFRef> {\n    const { Contents, Resources } = this.page.normalizedEntries();\n\n    if (!Contents) throw new MissingPageContentsEmbeddingError();\n    const decodedContents = this.decodeContents(Contents);\n\n    const { left, bottom, right, top } = this.boundingBox;\n    const xObject = context.flateStream(decodedContents, {\n      Type: 'XObject',\n      Subtype: 'Form',\n      FormType: 1,\n      BBox: [left, bottom, right, top],\n      Matrix: this.transformationMatrix,\n      Resources,\n    });\n\n    if (ref) {\n      context.assign(ref, xObject);\n      return ref;\n    } else {\n      return context.register(xObject);\n    }\n  }\n\n  // `contents` is an array of streams which are merged to include them in the XObject.\n  // This methods extracts each stream and joins them with a newline character.\n  private decodeContents(contents: PDFArray) {\n    const newline = Uint8Array.of(CharCodes.Newline);\n    const decodedContents: Uint8Array[] = [];\n\n    for (let idx = 0, len = contents.size(); idx < len; idx++) {\n      const stream = contents.lookup(idx, PDFStream);\n\n      let content: Uint8Array;\n      if (stream instanceof PDFRawStream) {\n        content = decodePDFRawStream(stream).decode();\n      } else if (stream instanceof PDFContentStream) {\n        content = stream.getUnencodedContents();\n      } else {\n        throw new UnrecognizedStreamTypeError(stream);\n      }\n\n      decodedContents.push(content, newline);\n    }\n\n    return mergeIntoTypedArray(...decodedContents);\n  }\n}\n\nexport default PDFPageEmbedder;\n","import PDFArray from 'src/core/objects/PDFArray';\nimport PDFBool from 'src/core/objects/PDFBool';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFContext from 'src/core/PDFContext';\nimport {\n  assertEachIs,\n  assertInteger,\n  assertIsOneOf,\n  assertRange,\n} from 'src/utils';\n\nconst asEnum = <T extends string | number, U extends { [key: string]: T }>(\n  rawValue: T | undefined,\n  enumType: U,\n): U[keyof U] | undefined => {\n  if (rawValue === undefined) return undefined;\n  return enumType[rawValue];\n};\n\nexport enum NonFullScreenPageMode {\n  /**\n   * After exiting FullScreen mode, neither the document outline nor thumbnail\n   * images should be visible.\n   */\n  UseNone = 'UseNone',\n\n  /** After exiting FullScreen mode, the document outline should be visible. */\n  UseOutlines = 'UseOutlines',\n\n  /** After exiting FullScreen mode, thumbnail images should be visible. */\n  UseThumbs = 'UseThumbs',\n\n  /**\n   * After exiting FullScreen mode, the optional content group panel should be\n   * visible.\n   */\n  UseOC = 'UseOC'\n}\n\nexport enum ReadingDirection {\n  /** The predominant reading order is Left to Right. */\n  L2R = 'L2R',\n\n  /**\n   * The predominant reading order is Right to left (including vertical writing\n   * systems, such as Chinese, Japanese and Korean).\n   */\n  R2L = 'R2L'\n}\n\nexport enum PrintScaling {\n  /** No page scaling. */\n  None = 'None',\n\n  /* Use the PDF reader's default print scaling. */\n  AppDefault = 'AppDefault'\n}\n\nexport enum Duplex {\n  /** The PDF reader should print single-sided. */\n  Simplex = 'Simplex',\n\n  /**\n   * The PDF reader should print double sided and flip on the short edge of the\n   * sheet.\n   */\n  DuplexFlipShortEdge = 'DuplexFlipShortEdge',\n\n  /**\n   * The PDF reader should print double sided and flip on the long edge of the\n   * sheet.\n   */\n  DuplexFlipLongEdge = 'DuplexFlipLongEdge'\n}\n\ntype BoolViewerPrefKey =\n  | 'HideToolbar'\n  | 'HideMenubar'\n  | 'HideWindowUI'\n  | 'FitWindow'\n  | 'CenterWindow'\n  | 'DisplayDocTitle'\n  | 'PickTrayByPDFSize';\ntype NameViewerPrefKey =\n  | 'NonFullScreenPageMode'\n  | 'Direction'\n  | 'PrintScaling'\n  | 'Duplex';\n\ninterface PageRange {\n  start: number;\n  end: number;\n}\n\nclass ViewerPreferences {\n  /** @ignore */\n  readonly dict: PDFDict;\n\n  /** @ignore */\n  static fromDict = (dict: PDFDict): ViewerPreferences =>\n    new ViewerPreferences(dict);\n\n  /** @ignore */\n  static create = (context: PDFContext) => {\n    const dict = context.obj({});\n    return new ViewerPreferences(dict);\n  };\n\n  /** @ignore */\n  protected constructor(dict: PDFDict) {\n    this.dict = dict;\n  }\n\n  protected lookupBool(key: BoolViewerPrefKey): PDFBool | undefined {\n    const returnObj = this.dict.lookup(PDFName.of(key));\n    if (returnObj instanceof PDFBool) return returnObj;\n    return undefined;\n  }\n\n  protected lookupName(key: NameViewerPrefKey): PDFName | undefined {\n    const returnObj = this.dict.lookup(PDFName.of(key));\n    if (returnObj instanceof PDFName) return returnObj;\n    return undefined;\n  }\n\n  /** @ignore */\n  HideToolbar(): PDFBool | undefined {\n    return this.lookupBool('HideToolbar');\n  }\n\n  /** @ignore */\n  HideMenubar(): PDFBool | undefined {\n    return this.lookupBool('HideMenubar');\n  }\n\n  /** @ignore */\n  HideWindowUI(): PDFBool | undefined {\n    return this.lookupBool('HideWindowUI');\n  }\n\n  /** @ignore */\n  FitWindow(): PDFBool | undefined {\n    return this.lookupBool('FitWindow');\n  }\n\n  /** @ignore */\n  CenterWindow(): PDFBool | undefined {\n    return this.lookupBool('CenterWindow');\n  }\n\n  /** @ignore */\n  DisplayDocTitle(): PDFBool | undefined {\n    return this.lookupBool('DisplayDocTitle');\n  }\n\n  /** @ignore */\n  NonFullScreenPageMode(): PDFName | undefined {\n    return this.lookupName('NonFullScreenPageMode');\n  }\n\n  /** @ignore */\n  Direction(): PDFName | undefined {\n    return this.lookupName('Direction');\n  }\n\n  /** @ignore */\n  PrintScaling(): PDFName | undefined {\n    return this.lookupName('PrintScaling');\n  }\n\n  /** @ignore */\n  Duplex(): PDFName | undefined {\n    return this.lookupName('Duplex');\n  }\n\n  /** @ignore */\n  PickTrayByPDFSize(): PDFBool | undefined {\n    return this.lookupBool('PickTrayByPDFSize');\n  }\n\n  /** @ignore */\n  PrintPageRange(): PDFArray | undefined {\n    const PrintPageRange = this.dict.lookup(PDFName.of('PrintPageRange'));\n    if (PrintPageRange instanceof PDFArray) return PrintPageRange;\n    return undefined;\n  }\n\n  /** @ignore */\n  NumCopies(): PDFNumber | undefined {\n    const NumCopies = this.dict.lookup(PDFName.of('NumCopies'));\n    if (NumCopies instanceof PDFNumber) return NumCopies;\n    return undefined;\n  }\n\n  /**\n   * Returns `true` if PDF readers should hide the toolbar menus when displaying\n   * this document.\n   * @returns Whether or not toolbars should be hidden.\n   */\n  getHideToolbar(): boolean {\n    return this.HideToolbar()?.asBoolean() ?? false;\n  }\n\n  /**\n   * Returns `true` if PDF readers should hide the menu bar when displaying this\n   * document.\n   * @returns Whether or not the menu bar should be hidden.\n   */\n  getHideMenubar(): boolean {\n    return this.HideMenubar()?.asBoolean() ?? false;\n  }\n\n  /**\n   * Returns `true` if PDF readers should hide the user interface elements in\n   * the document's window (such as scroll bars and navigation controls),\n   * leaving only the document's contents displayed.\n   * @returns Whether or not user interface elements should be hidden.\n   */\n  getHideWindowUI(): boolean {\n    return this.HideWindowUI()?.asBoolean() ?? false;\n  }\n\n  /**\n   * Returns `true` if PDF readers should resize the document's window to fit\n   * the size of the first displayed page.\n   * @returns Whether or not the window should be resized to fit.\n   */\n  getFitWindow(): boolean {\n    return this.FitWindow()?.asBoolean() ?? false;\n  }\n\n  /**\n   * Returns `true` if PDF readers should position the document's window in the\n   * center of the screen.\n   * @returns Whether or not to center the document window.\n   */\n  getCenterWindow(): boolean {\n    return this.CenterWindow()?.asBoolean() ?? false;\n  }\n\n  /**\n   * Returns `true` if the window's title bar should display the document\n   * `Title`, taken from the document metadata (see [[PDFDocument.getTitle]]).\n   * Returns `false` if the title bar should instead display the filename of the\n   * PDF file.\n   * @returns Whether to display the document title.\n   */\n  getDisplayDocTitle(): boolean {\n    return this.DisplayDocTitle()?.asBoolean() ?? false;\n  }\n\n  /**\n   * Returns the page mode, which tells the PDF reader how to display the\n   * document after exiting full-screen mode.\n   * @returns The page mode after exiting full-screen mode.\n   */\n  getNonFullScreenPageMode(): NonFullScreenPageMode {\n    const mode = this.NonFullScreenPageMode()?.decodeText();\n    return asEnum(mode, NonFullScreenPageMode) ?? NonFullScreenPageMode.UseNone;\n  }\n\n  /**\n   * Returns the predominant reading order for text.\n   * @returns The text reading order.\n   */\n  getReadingDirection(): ReadingDirection {\n    const direction = this.Direction()?.decodeText();\n    return asEnum(direction, ReadingDirection) ?? ReadingDirection.L2R;\n  }\n\n  /**\n   * Returns the page scaling option that the PDF reader should select when the\n   * print dialog is displayed.\n   * @returns The page scaling option.\n   */\n  getPrintScaling(): PrintScaling {\n    const scaling = this.PrintScaling()?.decodeText();\n    return asEnum(scaling, PrintScaling) ?? PrintScaling.AppDefault;\n  }\n\n  /**\n   * Returns the paper handling option that should be used when printing the\n   * file from the print dialog.\n   * @returns The paper handling option.\n   */\n  getDuplex(): Duplex | undefined {\n    const duplex = this.Duplex()?.decodeText();\n    return asEnum(duplex, Duplex);\n  }\n\n  /**\n   * Returns `true` if the PDF page size should be used to select the input\n   * paper tray.\n   * @returns Whether or not the PDF page size should be used to select the\n   *          input paper tray.\n   */\n  getPickTrayByPDFSize(): boolean | undefined {\n    return this.PickTrayByPDFSize()?.asBoolean();\n  }\n\n  /**\n   * Returns an array of page number ranges, which are the values used to\n   * initialize the print dialog box when the file is printed. Each range\n   * specifies the first (`start`) and last (`end`) pages in a sub-range of\n   * pages to be printed. The first page of the PDF file is denoted by 0.\n   * For example:\n   * ```js\n   * const viewerPrefs = pdfDoc.catalog.getOrCreateViewerPreferences()\n   * const includesPage3 = viewerPrefs\n   *   .getPrintRanges()\n   *   .some(pr => pr.start =< 2 && pr.end >= 2)\n   * if (includesPage3) console.log('printRange includes page 3')\n   * ```\n   * @returns An array of objects, each with the properties `start` and `end`,\n   *          denoting page indices. If not, specified an empty array is\n   *          returned.\n   */\n  getPrintPageRange(): PageRange[] {\n    const rng = this.PrintPageRange();\n    if (!rng) return [];\n\n    const pageRanges: PageRange[] = [];\n    for (let i = 0; i < rng.size(); i += 2) {\n      // Despite the spec clearly stating that \"The first page of the PDF file\n      // shall be donoted by 1\", several test PDFs (spec 1.7) created in\n      // Acrobat XI 11.0 and also read with Reader DC 2020.013 indicate this is\n      // actually a 0 based index.\n      const start = rng.lookup(i, PDFNumber).asNumber();\n      const end = rng.lookup(i + 1, PDFNumber).asNumber();\n      pageRanges.push({ start, end });\n    }\n\n    return pageRanges;\n  }\n\n  /**\n   * Returns the number of copies to be printed when the print dialog is opened\n   * for this document.\n   * @returns The default number of copies to be printed.\n   */\n  getNumCopies(): number {\n    return this.NumCopies()?.asNumber() ?? 1;\n  }\n\n  /**\n   * Choose whether the PDF reader's toolbars should be hidden while the\n   * document is active.\n   * @param hideToolbar `true` if the toolbar should be hidden.\n   */\n  setHideToolbar(hideToolbar: boolean) {\n    const HideToolbar = this.dict.context.obj(hideToolbar);\n    this.dict.set(PDFName.of('HideToolbar'), HideToolbar);\n  }\n\n  /**\n   * Choose whether the PDF reader's menu bar should be hidden while the\n   * document is active.\n   * @param hideMenubar `true` if the menu bar should be hidden.\n   */\n  setHideMenubar(hideMenubar: boolean) {\n    const HideMenubar = this.dict.context.obj(hideMenubar);\n    this.dict.set(PDFName.of('HideMenubar'), HideMenubar);\n  }\n\n  /**\n   * Choose whether the PDF reader should hide user interface elements in the\n   * document's window (such as scroll bars and navigation controls), leaving\n   * only the document's contents displayed.\n   * @param hideWindowUI `true` if the user interface elements should be hidden.\n   */\n  setHideWindowUI(hideWindowUI: boolean) {\n    const HideWindowUI = this.dict.context.obj(hideWindowUI);\n    this.dict.set(PDFName.of('HideWindowUI'), HideWindowUI);\n  }\n\n  /**\n   * Choose whether the PDF reader should resize the document's window to fit\n   * the size of the first displayed page.\n   * @param fitWindow `true` if the window should be resized.\n   */\n  setFitWindow(fitWindow: boolean) {\n    const FitWindow = this.dict.context.obj(fitWindow);\n    this.dict.set(PDFName.of('FitWindow'), FitWindow);\n  }\n\n  /**\n   * Choose whether the PDF reader should position the document's window in the\n   * center of the screen.\n   * @param centerWindow `true` if the window should be centered.\n   */\n  setCenterWindow(centerWindow: boolean) {\n    const CenterWindow = this.dict.context.obj(centerWindow);\n    this.dict.set(PDFName.of('CenterWindow'), CenterWindow);\n  }\n\n  /**\n   * Choose whether the window's title bar should display the document `Title`\n   * taken from the document metadata (see [[PDFDocument.setTitle]]). If\n   * `false`, the title bar should instead display the PDF filename.\n   * @param displayTitle `true` if the document title should be displayed.\n   */\n  setDisplayDocTitle(displayTitle: boolean) {\n    const DisplayDocTitle = this.dict.context.obj(displayTitle);\n    this.dict.set(PDFName.of('DisplayDocTitle'), DisplayDocTitle);\n  }\n\n  /**\n   * Choose how the PDF reader should display the document upon exiting\n   * full-screen mode. This entry is meaningful only if the value of the\n   * `PageMode` entry in the document's [[PDFCatalog]] is `FullScreen`.\n   *\n   * For example:\n   * ```js\n   * import { PDFDocument, NonFullScreenPageMode, PDFName } from 'pdf-lib'\n   *\n   * const pdfDoc = await PDFDocument.create()\n   *\n   * // Set the PageMode\n   * pdfDoc.catalog.set(PDFName.of('PageMode'),PDFName.of('FullScreen'))\n   *\n   * // Set what happens when full-screen is closed\n   * const viewerPrefs = pdfDoc.catalog.getOrCreateViewerPreferences()\n   * viewerPrefs.setNonFullScreenPageMode(NonFullScreenPageMode.UseOutlines)\n   * ```\n   *\n   * @param nonFullScreenPageMode How the document should be displayed upon\n   *                              exiting full screen mode.\n   */\n  setNonFullScreenPageMode(nonFullScreenPageMode: NonFullScreenPageMode) {\n    assertIsOneOf(\n      nonFullScreenPageMode,\n      'nonFullScreenPageMode',\n      NonFullScreenPageMode,\n    );\n    const mode = PDFName.of(nonFullScreenPageMode);\n    this.dict.set(PDFName.of('NonFullScreenPageMode'), mode);\n  }\n\n  /**\n   * Choose the predominant reading order for text.\n   *\n   * This entry has no direct effect on the document's contents or page\n   * numbering, but may be used to determine the relative positioning of pages\n   * when displayed side by side or printed n-up.\n   *\n   * For example:\n   * ```js\n   * import { PDFDocument, ReadingDirection } from 'pdf-lib'\n   *\n   * const pdfDoc = await PDFDocument.create()\n   * const viewerPrefs = pdfDoc.catalog.getOrCreateViewerPreferences()\n   * viewerPrefs.setReadingDirection(ReadingDirection.R2L)\n   * ```\n   *\n   * @param readingDirection The reading order for text.\n   */\n  setReadingDirection(readingDirection: ReadingDirection) {\n    assertIsOneOf(readingDirection, 'readingDirection', ReadingDirection);\n    const direction = PDFName.of(readingDirection);\n    this.dict.set(PDFName.of('Direction'), direction);\n  }\n\n  /**\n   * Choose the page scaling option that should be selected when a print dialog\n   * is displayed for this document.\n   *\n   * For example:\n   * ```js\n   * import { PDFDocument, PrintScaling } from 'pdf-lib'\n   *\n   * const pdfDoc = await PDFDocument.create()\n   * const viewerPrefs = pdfDoc.catalog.getOrCreateViewerPreferences()\n   * viewerPrefs.setPrintScaling(PrintScaling.None)\n   * ```\n   *\n   * @param printScaling The print scaling option.\n   */\n  setPrintScaling(printScaling: PrintScaling) {\n    assertIsOneOf(printScaling, 'printScaling', PrintScaling);\n    const scaling = PDFName.of(printScaling);\n    this.dict.set(PDFName.of('PrintScaling'), scaling);\n  }\n\n  /**\n   * Choose the paper handling option that should be selected by default in the\n   * print dialog.\n   *\n   * For example:\n   * ```js\n   * import { PDFDocument, Duplex } from 'pdf-lib'\n   *\n   * const pdfDoc = await PDFDocument.create()\n   * const viewerPrefs = pdfDoc.catalog.getOrCreateViewerPreferences()\n   * viewerPrefs.setDuplex(Duplex.DuplexFlipShortEdge)\n   * ```\n   *\n   * @param duplex The double or single sided printing option.\n   */\n  setDuplex(duplex: Duplex) {\n    assertIsOneOf(duplex, 'duplex', Duplex);\n    const dup = PDFName.of(duplex);\n    this.dict.set(PDFName.of('Duplex'), dup);\n  }\n\n  /**\n   * Choose whether the PDF document's page size should be used to select the\n   * input paper tray when printing. This setting influences only the preset\n   * values used to populate the print dialog presented by a PDF reader.\n   *\n   * If PickTrayByPDFSize is true, the check box in the print dialog associated\n   * with input paper tray should be checked. This setting has no effect on\n   * operating systems that do not provide the ability to pick the input tray\n   * by size.\n   *\n   * @param pickTrayByPDFSize `true` if the document's page size should be used\n   *                          to select the input paper tray.\n   */\n  setPickTrayByPDFSize(pickTrayByPDFSize: boolean) {\n    const PickTrayByPDFSize = this.dict.context.obj(pickTrayByPDFSize);\n    this.dict.set(PDFName.of('PickTrayByPDFSize'), PickTrayByPDFSize);\n  }\n\n  /**\n   * Choose the page numbers used to initialize the print dialog box when the\n   * file is printed. The first page of the PDF file is denoted by 0.\n   *\n   * For example:\n   * ```js\n   * import { PDFDocument } from 'pdf-lib'\n   *\n   * const pdfDoc = await PDFDocument.create()\n   * const viewerPrefs = pdfDoc.catalog.getOrCreateViewerPreferences()\n   *\n   * // We can set the default print range to only the first page\n   * viewerPrefs.setPrintPageRange({ start: 0, end: 0 })\n   *\n   * // Or we can supply noncontiguous ranges (e.g. pages 1, 3, and 5-7)\n   * viewerPrefs.setPrintPageRange([\n   *   { start: 0, end: 0 },\n   *   { start: 2, end: 2 },\n   *   { start: 4, end: 6 },\n   * ])\n   * ```\n   *\n   * @param printPageRange An object or array of objects, each with the\n   *                       properties `start` and `end`, denoting a range of\n   *                       page indices.\n   */\n  setPrintPageRange(printPageRange: PageRange[] | PageRange) {\n    if (!Array.isArray(printPageRange)) printPageRange = [printPageRange];\n\n    const flatRange: number[] = [];\n    for (let idx = 0, len = printPageRange.length; idx < len; idx++) {\n      flatRange.push(printPageRange[idx].start);\n      flatRange.push(printPageRange[idx].end);\n    }\n\n    assertEachIs(flatRange, 'printPageRange', ['number']);\n\n    const pageRanges = this.dict.context.obj(flatRange);\n    this.dict.set(PDFName.of('PrintPageRange'), pageRanges);\n  }\n\n  /**\n   * Choose the default number of copies to be printed when the print dialog is\n   * opened for this file.\n   * @param numCopies The default number of copies.\n   */\n  setNumCopies(numCopies: number) {\n    assertRange(numCopies, 'numCopies', 1, Number.MAX_VALUE);\n    assertInteger(numCopies, 'numCopies');\n    const NumCopies = this.dict.context.obj(numCopies);\n    this.dict.set(PDFName.of('NumCopies'), NumCopies);\n  }\n}\n\nexport default ViewerPreferences;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport PDFString from 'src/core/objects/PDFString';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFArray from 'src/core/objects/PDFArray';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport { findLastMatch } from 'src/utils';\nimport { MissingDAEntryError, MissingTfOperatorError } from 'src/core/errors';\n\n// Examples:\n//   `/Helv 12 Tf` -> ['Helv', '12']\n//   `/HeBo 8.00 Tf` -> ['HeBo', '8.00']\n//   `/HeBo Tf` -> ['HeBo', undefined]\nconst tfRegex =\n  /\\/([^\\0\\t\\n\\f\\r\\ ]+)[\\0\\t\\n\\f\\r\\ ]*(\\d*\\.\\d+|\\d+)?[\\0\\t\\n\\f\\r\\ ]+Tf/;\n\nclass PDFAcroField {\n  readonly dict: PDFDict;\n  readonly ref: PDFRef;\n\n  protected constructor(dict: PDFDict, ref: PDFRef) {\n    this.dict = dict;\n    this.ref = ref;\n  }\n\n  T(): PDFString | PDFHexString | undefined {\n    return this.dict.lookupMaybe(PDFName.of('T'), PDFString, PDFHexString);\n  }\n\n  Ff(): PDFNumber | undefined {\n    const numberOrRef = this.getInheritableAttribute(PDFName.of('Ff'));\n    return this.dict.context.lookupMaybe(numberOrRef, PDFNumber);\n  }\n\n  V(): PDFObject | undefined {\n    const valueOrRef = this.getInheritableAttribute(PDFName.of('V'));\n    return this.dict.context.lookup(valueOrRef);\n  }\n\n  Kids(): PDFArray | undefined {\n    return this.dict.lookupMaybe(PDFName.of('Kids'), PDFArray);\n  }\n\n  // Parent(): PDFDict | undefined {\n  //   return this.dict.lookupMaybe(PDFName.of('Parent'), PDFDict);\n  // }\n\n  DA(): PDFString | PDFHexString | undefined {\n    const da = this.dict.lookup(PDFName.of('DA'));\n    if (da instanceof PDFString || da instanceof PDFHexString) return da;\n    return undefined;\n  }\n\n  setKids(kids: PDFObject[]) {\n    this.dict.set(PDFName.of('Kids'), this.dict.context.obj(kids));\n  }\n\n  getParent(): PDFAcroField | undefined {\n    // const parent = this.Parent();\n    // if (!parent) return undefined;\n    // return new PDFAcroField(parent);\n\n    const parentRef = this.dict.get(PDFName.of('Parent'));\n    if (parentRef instanceof PDFRef) {\n      const parent = this.dict.lookup(PDFName.of('Parent'), PDFDict);\n      return new PDFAcroField(parent, parentRef);\n    }\n\n    return undefined;\n  }\n\n  setParent(parent: PDFRef | undefined) {\n    if (!parent) this.dict.delete(PDFName.of('Parent'));\n    else this.dict.set(PDFName.of('Parent'), parent);\n  }\n\n  getFullyQualifiedName(): string | undefined {\n    const parent = this.getParent();\n    if (!parent) return this.getPartialName();\n    return `${parent.getFullyQualifiedName()}.${this.getPartialName()}`;\n  }\n\n  getPartialName(): string | undefined {\n    return this.T()?.decodeText();\n  }\n\n  setPartialName(partialName: string | undefined) {\n    if (!partialName) this.dict.delete(PDFName.of('T'));\n    else this.dict.set(PDFName.of('T'), PDFHexString.fromText(partialName));\n  }\n\n  setDefaultAppearance(appearance: string) {\n    this.dict.set(PDFName.of('DA'), PDFString.of(appearance));\n  }\n\n  getDefaultAppearance(): string | undefined {\n    const DA = this.DA();\n\n    if (DA instanceof PDFHexString) {\n      return DA.decodeText();\n    }\n\n    return DA?.asString();\n  }\n\n  setFontSize(fontSize: number) {\n    const name = this.getFullyQualifiedName() ?? '';\n\n    const da = this.getDefaultAppearance();\n    if (!da) throw new MissingDAEntryError(name);\n\n    const daMatch = findLastMatch(da, tfRegex);\n    if (!daMatch.match) throw new MissingTfOperatorError(name);\n\n    const daStart = da.slice(0, daMatch.pos - daMatch.match[0].length);\n    const daEnd = daMatch.pos <= da.length ? da.slice(daMatch.pos) : '';\n    const fontName = daMatch.match[1];\n    const modifiedDa = `${daStart} /${fontName} ${fontSize} Tf ${daEnd}`;\n\n    this.setDefaultAppearance(modifiedDa);\n  }\n\n  getFlags(): number {\n    return this.Ff()?.asNumber() ?? 0;\n  }\n\n  setFlags(flags: number) {\n    this.dict.set(PDFName.of('Ff'), PDFNumber.of(flags));\n  }\n\n  hasFlag(flag: number): boolean {\n    const flags = this.getFlags();\n    return (flags & flag) !== 0;\n  }\n\n  setFlag(flag: number) {\n    const flags = this.getFlags();\n    this.setFlags(flags | flag);\n  }\n\n  clearFlag(flag: number) {\n    const flags = this.getFlags();\n    this.setFlags(flags & ~flag);\n  }\n\n  setFlagTo(flag: number, enable: boolean) {\n    if (enable) this.setFlag(flag);\n    else this.clearFlag(flag);\n  }\n\n  getInheritableAttribute(name: PDFName): PDFObject | undefined {\n    let attribute: PDFObject | undefined;\n    this.ascend((node) => {\n      if (!attribute) attribute = node.dict.get(name);\n    });\n    return attribute;\n  }\n\n  ascend(visitor: (node: PDFAcroField) => any): void {\n    visitor(this);\n    const parent = this.getParent();\n    if (parent) parent.ascend(visitor);\n  }\n}\n\nexport default PDFAcroField;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNumber from 'src/core/objects/PDFNumber';\n\n// TODO: Also handle the `/S` and `/D` entries\nclass BorderStyle {\n  readonly dict: PDFDict;\n\n  static fromDict = (dict: PDFDict): BorderStyle => new BorderStyle(dict);\n\n  protected constructor(dict: PDFDict) {\n    this.dict = dict;\n  }\n\n  W(): PDFNumber | undefined {\n    const W = this.dict.lookup(PDFName.of('W'));\n    if (W instanceof PDFNumber) return W;\n    return undefined;\n  }\n\n  getWidth(): number | undefined {\n    return this.W()?.asNumber() ?? 1;\n  }\n\n  setWidth(width: number) {\n    const W = this.dict.context.obj(width);\n    this.dict.set(PDFName.of('W'), W);\n  }\n}\n\nexport default BorderStyle;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFStream from 'src/core/objects/PDFStream';\nimport PDFArray from 'src/core/objects/PDFArray';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFNumber from 'src/core/objects/PDFNumber';\n\nclass PDFAnnotation {\n  readonly dict: PDFDict;\n\n  static fromDict = (dict: PDFDict): PDFAnnotation => new PDFAnnotation(dict);\n\n  protected constructor(dict: PDFDict) {\n    this.dict = dict;\n  }\n\n  // This is technically required by the PDF spec\n  Rect(): PDFArray | undefined {\n    return this.dict.lookup(PDFName.of('Rect'), PDFArray);\n  }\n\n  AP(): PDFDict | undefined {\n    return this.dict.lookupMaybe(PDFName.of('AP'), PDFDict);\n  }\n\n  F(): PDFNumber | undefined {\n    const numberOrRef = this.dict.lookup(PDFName.of('F'));\n    return this.dict.context.lookupMaybe(numberOrRef, PDFNumber);\n  }\n\n  getRectangle(): { x: number; y: number; width: number; height: number } {\n    const Rect = this.Rect();\n    return Rect?.asRectangle() ?? { x: 0, y: 0, width: 0, height: 0 };\n  }\n\n  setRectangle(rect: { x: number; y: number; width: number; height: number }) {\n    const { x, y, width, height } = rect;\n    const Rect = this.dict.context.obj([x, y, x + width, y + height]);\n    this.dict.set(PDFName.of('Rect'), Rect);\n  }\n\n  getAppearanceState(): PDFName | undefined {\n    const AS = this.dict.lookup(PDFName.of('AS'));\n    if (AS instanceof PDFName) return AS;\n    return undefined;\n  }\n\n  setAppearanceState(state: PDFName) {\n    this.dict.set(PDFName.of('AS'), state);\n  }\n\n  setAppearances(appearances: PDFDict) {\n    this.dict.set(PDFName.of('AP'), appearances);\n  }\n\n  ensureAP(): PDFDict {\n    let AP = this.AP();\n    if (!AP) {\n      AP = this.dict.context.obj({});\n      this.dict.set(PDFName.of('AP'), AP);\n    }\n    return AP;\n  }\n\n  getNormalAppearance(): PDFRef | PDFDict {\n    const AP = this.ensureAP();\n    const N = AP.get(PDFName.of('N'));\n    if (N instanceof PDFRef || N instanceof PDFDict) return N;\n\n    throw new Error(`Unexpected N type: ${N?.constructor.name}`);\n  }\n\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n  setNormalAppearance(appearance: PDFRef | PDFDict) {\n    const AP = this.ensureAP();\n    AP.set(PDFName.of('N'), appearance);\n  }\n\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n  setRolloverAppearance(appearance: PDFRef | PDFDict) {\n    const AP = this.ensureAP();\n    AP.set(PDFName.of('R'), appearance);\n  }\n\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n  setDownAppearance(appearance: PDFRef | PDFDict) {\n    const AP = this.ensureAP();\n    AP.set(PDFName.of('D'), appearance);\n  }\n\n  removeRolloverAppearance() {\n    const AP = this.AP();\n    AP?.delete(PDFName.of('R'));\n  }\n\n  removeDownAppearance() {\n    const AP = this.AP();\n    AP?.delete(PDFName.of('D'));\n  }\n\n  getAppearances():\n    | {\n      normal: PDFStream | PDFDict;\n      rollover?: PDFStream | PDFDict;\n      down?: PDFStream | PDFDict;\n    }\n    | undefined {\n    const AP = this.AP();\n\n    if (!AP) return undefined;\n\n    const N = AP.lookup(PDFName.of('N'), PDFDict, PDFStream);\n    const R = AP.lookupMaybe(PDFName.of('R'), PDFDict, PDFStream);\n    const D = AP.lookupMaybe(PDFName.of('D'), PDFDict, PDFStream);\n\n    return { normal: N, rollover: R, down: D };\n  }\n\n  getFlags(): number {\n    return this.F()?.asNumber() ?? 0;\n  }\n\n  setFlags(flags: number) {\n    this.dict.set(PDFName.of('F'), PDFNumber.of(flags));\n  }\n\n  hasFlag(flag: number): boolean {\n    const flags = this.getFlags();\n    return (flags & flag) !== 0;\n  }\n\n  setFlag(flag: number) {\n    const flags = this.getFlags();\n    this.setFlags(flags | flag);\n  }\n\n  clearFlag(flag: number) {\n    const flags = this.getFlags();\n    this.setFlags(flags & ~flag);\n  }\n\n  setFlagTo(flag: number, enable: boolean) {\n    if (enable) this.setFlag(flag);\n    else this.clearFlag(flag);\n  }\n}\n\nexport default PDFAnnotation;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFArray from 'src/core/objects/PDFArray';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFString from 'src/core/objects/PDFString';\n\nclass AppearanceCharacteristics {\n  readonly dict: PDFDict;\n\n  static fromDict = (dict: PDFDict): AppearanceCharacteristics =>\n    new AppearanceCharacteristics(dict);\n\n  protected constructor(dict: PDFDict) {\n    this.dict = dict;\n  }\n\n  R(): PDFNumber | undefined {\n    const R = this.dict.lookup(PDFName.of('R'));\n    if (R instanceof PDFNumber) return R;\n    return undefined;\n  }\n\n  BC(): PDFArray | undefined {\n    const BC = this.dict.lookup(PDFName.of('BC'));\n    if (BC instanceof PDFArray) return BC;\n    return undefined;\n  }\n\n  BG(): PDFArray | undefined {\n    const BG = this.dict.lookup(PDFName.of('BG'));\n    if (BG instanceof PDFArray) return BG;\n    return undefined;\n  }\n\n  CA(): PDFHexString | PDFString | undefined {\n    const CA = this.dict.lookup(PDFName.of('CA'));\n    if (CA instanceof PDFHexString || CA instanceof PDFString) return CA;\n    return undefined;\n  }\n\n  RC(): PDFHexString | PDFString | undefined {\n    const RC = this.dict.lookup(PDFName.of('RC'));\n    if (RC instanceof PDFHexString || RC instanceof PDFString) return RC;\n    return undefined;\n  }\n\n  AC(): PDFHexString | PDFString | undefined {\n    const AC = this.dict.lookup(PDFName.of('AC'));\n    if (AC instanceof PDFHexString || AC instanceof PDFString) return AC;\n    return undefined;\n  }\n\n  getRotation(): number | undefined {\n    return this.R()?.asNumber();\n  }\n\n  getBorderColor(): number[] | undefined {\n    const BC = this.BC();\n\n    if (!BC) return undefined;\n\n    const components: number[] = [];\n    for (let idx = 0, len = BC?.size(); idx < len; idx++) {\n      const component = BC.get(idx);\n      if (component instanceof PDFNumber) components.push(component.asNumber());\n    }\n\n    return components;\n  }\n\n  getBackgroundColor(): number[] | undefined {\n    const BG = this.BG();\n\n    if (!BG) return undefined;\n\n    const components: number[] = [];\n    for (let idx = 0, len = BG?.size(); idx < len; idx++) {\n      const component = BG.get(idx);\n      if (component instanceof PDFNumber) components.push(component.asNumber());\n    }\n\n    return components;\n  }\n\n  getCaptions(): { normal?: string; rollover?: string; down?: string } {\n    const CA = this.CA();\n    const RC = this.RC();\n    const AC = this.AC();\n\n    return {\n      normal: CA?.decodeText(),\n      rollover: RC?.decodeText(),\n      down: AC?.decodeText(),\n    };\n  }\n\n  setRotation(rotation: number) {\n    const R = this.dict.context.obj(rotation);\n    this.dict.set(PDFName.of('R'), R);\n  }\n\n  setBorderColor(color: number[]) {\n    const BC = this.dict.context.obj(color);\n    this.dict.set(PDFName.of('BC'), BC);\n  }\n\n  setBackgroundColor(color: number[]) {\n    const BG = this.dict.context.obj(color);\n    this.dict.set(PDFName.of('BG'), BG);\n  }\n\n  setCaptions(captions: { normal: string; rollover?: string; down?: string }) {\n    const CA = PDFHexString.fromText(captions.normal);\n    this.dict.set(PDFName.of('CA'), CA);\n\n    if (captions.rollover) {\n      const RC = PDFHexString.fromText(captions.rollover);\n      this.dict.set(PDFName.of('RC'), RC);\n    } else {\n      this.dict.delete(PDFName.of('RC'));\n    }\n\n    if (captions.down) {\n      const AC = PDFHexString.fromText(captions.down);\n      this.dict.set(PDFName.of('AC'), AC);\n    } else {\n      this.dict.delete(PDFName.of('AC'));\n    }\n  }\n}\n\nexport default AppearanceCharacteristics;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFString from 'src/core/objects/PDFString';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFContext from 'src/core/PDFContext';\nimport BorderStyle from 'src/core/annotation/BorderStyle';\nimport PDFAnnotation from 'src/core/annotation/PDFAnnotation';\nimport AppearanceCharacteristics from 'src/core/annotation/AppearanceCharacteristics';\n\nclass PDFWidgetAnnotation extends PDFAnnotation {\n  static fromDict = (dict: PDFDict): PDFWidgetAnnotation =>\n    new PDFWidgetAnnotation(dict);\n\n  static create = (context: PDFContext, parent: PDFRef) => {\n    const dict = context.obj({\n      Type: 'Annot',\n      Subtype: 'Widget',\n      Rect: [0, 0, 0, 0],\n      Parent: parent,\n    });\n    return new PDFWidgetAnnotation(dict);\n  };\n\n  MK(): PDFDict | undefined {\n    const MK = this.dict.lookup(PDFName.of('MK'));\n    if (MK instanceof PDFDict) return MK;\n    return undefined;\n  }\n\n  BS(): PDFDict | undefined {\n    const BS = this.dict.lookup(PDFName.of('BS'));\n    if (BS instanceof PDFDict) return BS;\n    return undefined;\n  }\n\n  DA(): PDFString | PDFHexString | undefined {\n    const da = this.dict.lookup(PDFName.of('DA'));\n    if (da instanceof PDFString || da instanceof PDFHexString) return da;\n    return undefined;\n  }\n\n  P(): PDFRef | undefined {\n    const P = this.dict.get(PDFName.of('P'));\n    if (P instanceof PDFRef) return P;\n    return undefined;\n  }\n\n  setP(page: PDFRef) {\n    this.dict.set(PDFName.of('P'), page);\n  }\n\n  setDefaultAppearance(appearance: string) {\n    this.dict.set(PDFName.of('DA'), PDFString.of(appearance));\n  }\n\n  getDefaultAppearance(): string | undefined {\n    const DA = this.DA();\n\n    if (DA instanceof PDFHexString) {\n      return DA.decodeText();\n    }\n\n    return DA?.asString();\n  }\n\n  getAppearanceCharacteristics(): AppearanceCharacteristics | undefined {\n    const MK = this.MK();\n    if (MK) return AppearanceCharacteristics.fromDict(MK);\n    return undefined;\n  }\n\n  getOrCreateAppearanceCharacteristics(): AppearanceCharacteristics {\n    const MK = this.MK();\n    if (MK) return AppearanceCharacteristics.fromDict(MK);\n\n    const ac = AppearanceCharacteristics.fromDict(this.dict.context.obj({}));\n    this.dict.set(PDFName.of('MK'), ac.dict);\n    return ac;\n  }\n\n  getBorderStyle(): BorderStyle | undefined {\n    const BS = this.BS();\n    if (BS) return BorderStyle.fromDict(BS);\n    return undefined;\n  }\n\n  getOrCreateBorderStyle(): BorderStyle {\n    const BS = this.BS();\n    if (BS) return BorderStyle.fromDict(BS);\n\n    const bs = BorderStyle.fromDict(this.dict.context.obj({}));\n    this.dict.set(PDFName.of('BS'), bs.dict);\n    return bs;\n  }\n\n  getOnValue(): PDFName | undefined {\n    const normal = this.getAppearances()?.normal;\n\n    if (normal instanceof PDFDict) {\n      const keys = normal.keys();\n      for (let idx = 0, len = keys.length; idx < len; idx++) {\n        const key = keys[idx];\n        if (key !== PDFName.of('Off')) return key;\n      }\n    }\n\n    return undefined;\n  }\n}\n\nexport default PDFWidgetAnnotation;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFAcroField from 'src/core/acroform/PDFAcroField';\nimport PDFWidgetAnnotation from 'src/core/annotation/PDFWidgetAnnotation';\nimport { IndexOutOfBoundsError } from 'src/core/errors';\n\nclass PDFAcroTerminal extends PDFAcroField {\n  static fromDict = (dict: PDFDict, ref: PDFRef) =>\n    new PDFAcroTerminal(dict, ref);\n\n  FT(): PDFName {\n    const nameOrRef = this.getInheritableAttribute(PDFName.of('FT'));\n    return this.dict.context.lookup(nameOrRef, PDFName);\n  }\n\n  getWidgets(): PDFWidgetAnnotation[] {\n    const kidDicts = this.Kids();\n\n    // This field is itself a widget\n    if (!kidDicts) return [PDFWidgetAnnotation.fromDict(this.dict)];\n\n    // This field's kids are its widgets\n    const widgets = new Array<PDFWidgetAnnotation>(kidDicts.size());\n    for (let idx = 0, len = kidDicts.size(); idx < len; idx++) {\n      const dict = kidDicts.lookup(idx, PDFDict);\n      widgets[idx] = PDFWidgetAnnotation.fromDict(dict);\n    }\n\n    return widgets;\n  }\n\n  addWidget(ref: PDFRef) {\n    const { Kids } = this.normalizedEntries();\n    Kids.push(ref);\n  }\n\n  removeWidget(idx: number) {\n    const kidDicts = this.Kids();\n\n    if (!kidDicts) {\n      // This field is itself a widget\n      if (idx !== 0) throw new IndexOutOfBoundsError(idx, 0, 0);\n      this.setKids([]);\n    } else {\n      // This field's kids are its widgets\n      if (idx < 0 || idx > kidDicts.size()) {\n        throw new IndexOutOfBoundsError(idx, 0, kidDicts.size());\n      }\n      kidDicts.remove(idx);\n    }\n  }\n\n  normalizedEntries() {\n    let Kids = this.Kids();\n\n    // If this field is itself a widget (because it was only rendered once in\n    // the document, so the field and widget properties were merged) then we\n    // add itself to the `Kids` array. The alternative would be to try\n    // splitting apart the widget properties and creating a separate object\n    // for them.\n    if (!Kids) {\n      Kids = this.dict.context.obj([this.ref]);\n      this.dict.set(PDFName.of('Kids'), Kids);\n    }\n\n    return { Kids };\n  }\n}\n\nexport default PDFAcroTerminal;\n","import PDFObject from 'src/core/objects/PDFObject';\nimport PDFString from 'src/core/objects/PDFString';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFArray from 'src/core/objects/PDFArray';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFAcroTerminal from 'src/core/acroform/PDFAcroTerminal';\nimport { IndexOutOfBoundsError } from 'src/core/errors';\n\nclass PDFAcroButton extends PDFAcroTerminal {\n  Opt(): PDFString | PDFHexString | PDFArray | undefined {\n    return this.dict.lookupMaybe(\n      PDFName.of('Opt'),\n      PDFString,\n      PDFHexString,\n      PDFArray,\n    );\n  }\n\n  setOpt(opt: PDFObject[]) {\n    this.dict.set(PDFName.of('Opt'), this.dict.context.obj(opt));\n  }\n\n  getExportValues(): (PDFString | PDFHexString)[] | undefined {\n    const opt = this.Opt();\n\n    if (!opt) return undefined;\n\n    if (opt instanceof PDFString || opt instanceof PDFHexString) {\n      return [opt];\n    }\n\n    const values: (PDFString | PDFHexString)[] = [];\n    for (let idx = 0, len = opt.size(); idx < len; idx++) {\n      const value = opt.lookup(idx);\n      if (value instanceof PDFString || value instanceof PDFHexString) {\n        values.push(value);\n      }\n    }\n\n    return values;\n  }\n\n  removeExportValue(idx: number) {\n    const opt = this.Opt();\n\n    if (!opt) return;\n\n    if (opt instanceof PDFString || opt instanceof PDFHexString) {\n      if (idx !== 0) throw new IndexOutOfBoundsError(idx, 0, 0);\n      this.setOpt([]);\n    } else {\n      if (idx < 0 || idx > opt.size()) {\n        throw new IndexOutOfBoundsError(idx, 0, opt.size());\n      }\n      opt.remove(idx);\n    }\n  }\n\n  // Enforce use use of /Opt even if it isn't strictly necessary\n  normalizeExportValues() {\n    const exportValues = this.getExportValues() ?? [];\n\n    const Opt: (PDFString | PDFHexString)[] = [];\n\n    const widgets = this.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      const exportVal =\n        exportValues[idx] ??\n        PDFHexString.fromText(widget.getOnValue()?.decodeText() ?? '');\n      Opt.push(exportVal);\n    }\n\n    this.setOpt(Opt);\n  }\n\n  /**\n   * Reuses existing opt if one exists with the same value (assuming\n   * `useExistingIdx` is `true`). Returns index of existing (or new) opt.\n   */\n  addOpt(opt: PDFHexString | PDFString, useExistingOptIdx: boolean): number {\n    this.normalizeExportValues();\n\n    const optText = opt.decodeText();\n\n    let existingIdx: number | undefined;\n    if (useExistingOptIdx) {\n      const exportValues = this.getExportValues() ?? [];\n      for (let idx = 0, len = exportValues.length; idx < len; idx++) {\n        const exportVal = exportValues[idx];\n        if (exportVal.decodeText() === optText) existingIdx = idx;\n      }\n    }\n\n    const Opt = this.Opt() as PDFArray;\n    Opt.push(opt);\n\n    return existingIdx ?? Opt.size() - 1;\n  }\n\n  addWidgetWithOpt(\n    widget: PDFRef,\n    opt: PDFHexString | PDFString,\n    useExistingOptIdx: boolean,\n  ) {\n    const optIdx = this.addOpt(opt, useExistingOptIdx);\n    const apStateValue = PDFName.of(String(optIdx));\n    this.addWidget(widget);\n    return apStateValue;\n  }\n}\n\nexport default PDFAcroButton;\n","import PDFContext from 'src/core/PDFContext';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFAcroButton from 'src/core/acroform/PDFAcroButton';\nimport { InvalidAcroFieldValueError } from 'src/core/errors';\n\nclass PDFAcroCheckBox extends PDFAcroButton {\n  static fromDict = (dict: PDFDict, ref: PDFRef) =>\n    new PDFAcroCheckBox(dict, ref);\n\n  static create = (context: PDFContext) => {\n    const dict = context.obj({\n      FT: 'Btn',\n      Kids: [],\n    });\n    const ref = context.register(dict);\n    return new PDFAcroCheckBox(dict, ref);\n  };\n\n  setValue(value: PDFName) {\n    const onValue = this.getOnValue() ?? PDFName.of('Yes');\n    if (value !== onValue && value !== PDFName.of('Off')) {\n      throw new InvalidAcroFieldValueError();\n    }\n\n    this.dict.set(PDFName.of('V'), value);\n\n    const widgets = this.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      const state = widget.getOnValue() === value ? value : PDFName.of('Off');\n      widget.setAppearanceState(state);\n    }\n  }\n\n  getValue(): PDFName {\n    const v = this.V();\n    if (v instanceof PDFName) return v;\n    return PDFName.of('Off');\n  }\n\n  getOnValue(): PDFName | undefined {\n    const [widget] = this.getWidgets();\n    return widget?.getOnValue();\n  }\n}\n\nexport default PDFAcroCheckBox;\n","const flag = (bitIndex: number) => 1 << bitIndex;\n\n/** From PDF spec table 221 */\nexport enum AcroFieldFlags {\n  /**\n   * If set, the user may not change the value of the field. Any associated\n   * widget annotations will not interact with the user; that is, they will not\n   * respond to mouse clicks or change their appearance in response to mouse\n   * motions. This flag is useful for fields whose values are computed or\n   * imported from a database.\n   */\n  ReadOnly = flag(1 - 1),\n\n  /**\n   * If set, the field shall have a value at the time it is exported by a\n   * submit-form action (see 12.7.5.2, \"Submit-Form Action\").\n   */\n  Required = flag(2 - 1),\n\n  /**\n   * If set, the field shall not be exported by a submit-form action\n   * (see 12.7.5.2, \"Submit-Form Action\").\n   */\n  NoExport = flag(3 - 1)\n}\n\n/** From PDF spec table 226 */\nexport enum AcroButtonFlags {\n  /**\n   * (Radio buttons only) If set, exactly one radio button shall be selected at\n   * all times; selecting the currently selected button has no effect. If clear,\n   * clicking the selected button deselects it, leaving no button selected.\n   */\n  NoToggleToOff = flag(15 - 1),\n\n  /**\n   * If set, the field is a set of radio buttons; if clear, the field is a check\n   * box. This flag may be set only if the Pushbutton flag is clear.\n   */\n  Radio = flag(16 - 1),\n\n  /**\n   * If set, the field is a pushbutton that does not retain a permanent value.\n   */\n  PushButton = flag(17 - 1),\n\n  /**\n   * If set, a group of radio buttons within a radio button field that use the\n   * same value for the on state will turn on and off in unison; that is if one\n   * is checked, they are all checked. If clear, the buttons are mutually\n   * exclusive (the same behavior as HTML radio buttons).\n   */\n  RadiosInUnison = flag(26 - 1)\n}\n\n/** From PDF spec table 228 */\nexport enum AcroTextFlags {\n  /**\n   * If set, the field may contain multiple lines of text; if clear, the field's\n   * text shall be restricted to a single line.\n   */\n  Multiline = flag(13 - 1),\n\n  /**\n   * If set, the field is intended for entering a secure password that should\n   * not be echoed visibly to the screen. Characters typed from the keyboard\n   * shall instead be echoed in some unreadable form, such as asterisks or\n   * bullet characters.\n   * > NOTE   To protect password confidentiality, readers should never store\n   * >        the value of the text field in the PDF file if this flag is set.\n   */\n  Password = flag(14 - 1),\n\n  /**\n   * If set, the text entered in the field represents the pathname of a file\n   * whose contents shall be submitted as the value of the field.\n   */\n  FileSelect = flag(21 - 1),\n\n  /**\n   * If set, text entered in the field shall not be spell-checked.\n   */\n  DoNotSpellCheck = flag(23 - 1),\n\n  /**\n   * If set, the field shall not scroll (horizontally for single-line fields,\n   * vertically for multiple-line fields) to accommodate more text than fits\n   * within its annotation rectangle. Once the field is full, no further text\n   * shall be accepted for interactive form filling; for non-interactive form\n   * filling, the filler should take care not to add more character than will\n   * visibly fit in the defined area.\n   */\n  DoNotScroll = flag(24 - 1),\n\n  /**\n   * May be set only if the MaxLen entry is present in the text field dictionary\n   * (see Table 229) and if the Multiline, Password, and FileSelect flags are\n   * clear. If set, the field shall be automatically divided into as many\n   * equally spaced positions, or combs, as the value of MaxLen, and the text\n   * is laid out into those combs.\n   */\n  Comb = flag(25 - 1),\n\n  /**\n   * If set, the value of this field shall be a rich text string\n   * (see 12.7.3.4, \"Rich Text Strings\"). If the field has a value, the RV\n   * entry of the field dictionary (Table 222) shall specify the rich text\n   * string.\n   */\n  RichText = flag(26 - 1)\n}\n\n/** From PDF spec table 230 */\nexport enum AcroChoiceFlags {\n  /**\n   * If set, the field is a combo box; if clear, the field is a list box.\n   */\n  Combo = flag(18 - 1),\n\n  /**\n   * If set, the combo box shall include an editable text box as well as a\n   * drop-down list; if clear, it shall include only a drop-down list. This\n   * flag shall be used only if the Combo flag is set.\n   */\n  Edit = flag(19 - 1),\n\n  /**\n   * If set, the field's option items shall be sorted alphabetically. This flag\n   * is intended for use by writers, not by readers. Conforming readers shall\n   * display the options in the order in which they occur in the Opt array\n   * (see Table 231).\n   */\n  Sort = flag(20 - 1),\n\n  /**\n   * If set, more than one of the field's option items may be selected\n   * simultaneously; if clear, at most one item shall be selected.\n   */\n  MultiSelect = flag(22 - 1),\n\n  /**\n   * If set, text entered in the field shall not be spell-checked. This flag\n   * shall not be used unless the Combo and Edit flags are both set.\n   */\n  DoNotSpellCheck = flag(23 - 1),\n\n  /**\n   * If set, the new value shall be committed as soon as a selection is made\n   * (commonly with the pointing device). In this case, supplying a value for\n   * a field involves three actions: selecting the field for fill-in,\n   * selecting a choice for the fill-in value, and leaving that field, which\n   * finalizes or \"commits\" the data choice and triggers any actions associated\n   * with the entry or changing of this data. If this flag is on, then\n   * processing does not wait for leaving the field action to occur, but\n   * immediately proceeds to the third step.\n   *\n   * This option enables applications to perform an action once a selection is\n   * made, without requiring the user to exit the field. If clear, the new\n   * value is not committed until the user exits the field.\n   */\n  CommitOnSelChange = flag(27 - 1)\n}\n","import PDFAcroTerminal from 'src/core/acroform/PDFAcroTerminal';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFString from 'src/core/objects/PDFString';\nimport PDFArray from 'src/core/objects/PDFArray';\nimport PDFName from 'src/core/objects/PDFName';\nimport { AcroChoiceFlags } from 'src/core/acroform/flags';\nimport {\n  InvalidAcroFieldValueError,\n  MultiSelectValueError,\n} from 'src/core/errors';\n\nclass PDFAcroChoice extends PDFAcroTerminal {\n  setValues(values: (PDFString | PDFHexString)[]) {\n    if (\n      this.hasFlag(AcroChoiceFlags.Combo) &&\n      !this.hasFlag(AcroChoiceFlags.Edit) &&\n      !this.valuesAreValid(values)\n    ) {\n      throw new InvalidAcroFieldValueError();\n    }\n\n    if (values.length === 0) {\n      this.dict.delete(PDFName.of('V'));\n    }\n    if (values.length === 1) {\n      this.dict.set(PDFName.of('V'), values[0]);\n    }\n    if (values.length > 1) {\n      if (!this.hasFlag(AcroChoiceFlags.MultiSelect)) {\n        throw new MultiSelectValueError();\n      }\n      this.dict.set(PDFName.of('V'), this.dict.context.obj(values));\n    }\n\n    this.updateSelectedIndices(values);\n  }\n\n  valuesAreValid(values: (PDFString | PDFHexString)[]): boolean {\n    const options = this.getOptions();\n    for (let idx = 0, len = values.length; idx < len; idx++) {\n      const val = values[idx].decodeText();\n      if (!options.find((o) => val === (o.display || o.value).decodeText())) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  updateSelectedIndices(values: (PDFString | PDFHexString)[]) {\n    if (values.length > 1) {\n      const indices = new Array<number>(values.length);\n      const options = this.getOptions();\n      for (let idx = 0, len = values.length; idx < len; idx++) {\n        const val = values[idx].decodeText();\n        indices[idx] = options.findIndex(\n          (o) => val === (o.display || o.value).decodeText(),\n        );\n      }\n      this.dict.set(PDFName.of('I'), this.dict.context.obj(indices.sort()));\n    } else {\n      this.dict.delete(PDFName.of('I'));\n    }\n  }\n\n  getValues(): (PDFString | PDFHexString)[] {\n    const v = this.V();\n\n    if (v instanceof PDFString || v instanceof PDFHexString) return [v];\n\n    if (v instanceof PDFArray) {\n      const values: (PDFString | PDFHexString)[] = [];\n\n      for (let idx = 0, len = v.size(); idx < len; idx++) {\n        const value = v.lookup(idx);\n        if (value instanceof PDFString || value instanceof PDFHexString) {\n          values.push(value);\n        }\n      }\n\n      return values;\n    }\n\n    return [];\n  }\n\n  Opt(): PDFArray | PDFString | PDFHexString | undefined {\n    return this.dict.lookupMaybe(\n      PDFName.of('Opt'),\n      PDFString,\n      PDFHexString,\n      PDFArray,\n    );\n  }\n\n  setOptions(\n    options: {\n      value: PDFString | PDFHexString;\n      display?: PDFString | PDFHexString;\n    }[],\n  ) {\n    const newOpt = new Array<PDFArray>(options.length);\n    for (let idx = 0, len = options.length; idx < len; idx++) {\n      const { value, display } = options[idx];\n      newOpt[idx] = this.dict.context.obj([value, display || value]);\n    }\n    this.dict.set(PDFName.of('Opt'), this.dict.context.obj(newOpt));\n  }\n\n  getOptions(): {\n    value: PDFString | PDFHexString;\n    display: PDFString | PDFHexString;\n  }[] {\n    const Opt = this.Opt();\n\n    // Not supposed to happen - Opt _should_ always be `PDFArray | undefined`\n    if (Opt instanceof PDFString || Opt instanceof PDFHexString) {\n      return [{ value: Opt, display: Opt }];\n    }\n\n    if (Opt instanceof PDFArray) {\n      const res: {\n        value: PDFString | PDFHexString;\n        display: PDFString | PDFHexString;\n      }[] = [];\n\n      for (let idx = 0, len = Opt.size(); idx < len; idx++) {\n        const item = Opt.lookup(idx);\n\n        // If `item` is a string, use that as both the export and text value\n        if (item instanceof PDFString || item instanceof PDFHexString) {\n          res.push({ value: item, display: item });\n        }\n\n        // If `item` is an array of one, treat it the same as just a string,\n        // if it's an array of two then `item[0]` is the export value and\n        // `item[1]` is the text value\n        if (item instanceof PDFArray) {\n          if (item.size() > 0) {\n            const first = item.lookup(0, PDFString, PDFHexString);\n            const second = item.lookupMaybe(1, PDFString, PDFHexString);\n            res.push({ value: first, display: second || first });\n          }\n        }\n      }\n\n      return res;\n    }\n\n    return [];\n  }\n}\n\nexport default PDFAcroChoice;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport PDFAcroChoice from 'src/core/acroform/PDFAcroChoice';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport { AcroChoiceFlags } from 'src/core/acroform/flags';\n\nclass PDFAcroComboBox extends PDFAcroChoice {\n  static fromDict = (dict: PDFDict, ref: PDFRef) =>\n    new PDFAcroComboBox(dict, ref);\n\n  static create = (context: PDFContext) => {\n    const dict = context.obj({\n      FT: 'Ch',\n      Ff: AcroChoiceFlags.Combo,\n      Kids: [],\n    });\n    const ref = context.register(dict);\n    return new PDFAcroComboBox(dict, ref);\n  };\n}\n\nexport default PDFAcroComboBox;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFAcroField from 'src/core/acroform/PDFAcroField';\n\nclass PDFAcroNonTerminal extends PDFAcroField {\n  static fromDict = (dict: PDFDict, ref: PDFRef) =>\n    new PDFAcroNonTerminal(dict, ref);\n\n  static create = (context: PDFContext) => {\n    const dict = context.obj({});\n    const ref = context.register(dict);\n    return new PDFAcroNonTerminal(dict, ref);\n  };\n\n  addField(field: PDFRef) {\n    const { Kids } = this.normalizedEntries();\n    Kids?.push(field);\n  }\n\n  normalizedEntries() {\n    let Kids = this.Kids();\n\n    if (!Kids) {\n      Kids = this.dict.context.obj([]);\n      this.dict.set(PDFName.of('Kids'), Kids);\n    }\n\n    return { Kids };\n  }\n}\n\nexport default PDFAcroNonTerminal;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFAcroTerminal from 'src/core/acroform/PDFAcroTerminal';\n\nclass PDFAcroSignature extends PDFAcroTerminal {\n  static fromDict = (dict: PDFDict, ref: PDFRef) =>\n    new PDFAcroSignature(dict, ref);\n}\n\nexport default PDFAcroSignature;\n","import PDFContext from 'src/core/PDFContext';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFString from 'src/core/objects/PDFString';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFAcroTerminal from 'src/core/acroform/PDFAcroTerminal';\n\nclass PDFAcroText extends PDFAcroTerminal {\n  static fromDict = (dict: PDFDict, ref: PDFRef) => new PDFAcroText(dict, ref);\n\n  static create = (context: PDFContext) => {\n    const dict = context.obj({\n      FT: 'Tx',\n      Kids: [],\n    });\n    const ref = context.register(dict);\n    return new PDFAcroText(dict, ref);\n  };\n\n  MaxLen(): PDFNumber | undefined {\n    const maxLen = this.dict.lookup(PDFName.of('MaxLen'));\n    if (maxLen instanceof PDFNumber) return maxLen;\n    return undefined;\n  }\n\n  Q(): PDFNumber | undefined {\n    const q = this.dict.lookup(PDFName.of('Q'));\n    if (q instanceof PDFNumber) return q;\n    return undefined;\n  }\n\n  setMaxLength(maxLength: number) {\n    this.dict.set(PDFName.of('MaxLen'), PDFNumber.of(maxLength));\n  }\n\n  removeMaxLength() {\n    this.dict.delete(PDFName.of('MaxLen'));\n  }\n\n  getMaxLength(): number | undefined {\n    return this.MaxLen()?.asNumber();\n  }\n\n  setQuadding(quadding: 0 | 1 | 2) {\n    this.dict.set(PDFName.of('Q'), PDFNumber.of(quadding));\n  }\n\n  getQuadding(): number | undefined {\n    return this.Q()?.asNumber();\n  }\n\n  setValue(value: PDFHexString | PDFString) {\n    this.dict.set(PDFName.of('V'), value);\n\n    // const widgets = this.getWidgets();\n    // for (let idx = 0, len = widgets.length; idx < len; idx++) {\n    //   const widget = widgets[idx];\n    //   const state = widget.getOnValue() === value ? value : PDFName.of('Off');\n    //   widget.setAppearanceState(state);\n    // }\n  }\n\n  removeValue() {\n    this.dict.delete(PDFName.of('V'));\n  }\n\n  getValue(): PDFString | PDFHexString | undefined {\n    const v = this.V();\n    if (v instanceof PDFString || v instanceof PDFHexString) return v;\n    return undefined;\n  }\n}\n\nexport default PDFAcroText;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport PDFAcroButton from 'src/core/acroform/PDFAcroButton';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport { AcroButtonFlags } from 'src/core/acroform/flags';\n\nclass PDFAcroPushButton extends PDFAcroButton {\n  static fromDict = (dict: PDFDict, ref: PDFRef) =>\n    new PDFAcroPushButton(dict, ref);\n\n  static create = (context: PDFContext) => {\n    const dict = context.obj({\n      FT: 'Btn',\n      Ff: AcroButtonFlags.PushButton,\n      Kids: [],\n    });\n    const ref = context.register(dict);\n    return new PDFAcroPushButton(dict, ref);\n  };\n}\n\nexport default PDFAcroPushButton;\n","import PDFRef from 'src/core/objects/PDFRef';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFAcroButton from 'src/core/acroform/PDFAcroButton';\nimport PDFContext from 'src/core/PDFContext';\nimport { AcroButtonFlags } from 'src/core/acroform/flags';\nimport { InvalidAcroFieldValueError } from 'src/core/errors';\n\nclass PDFAcroRadioButton extends PDFAcroButton {\n  static fromDict = (dict: PDFDict, ref: PDFRef) =>\n    new PDFAcroRadioButton(dict, ref);\n\n  static create = (context: PDFContext) => {\n    const dict = context.obj({\n      FT: 'Btn',\n      Ff: AcroButtonFlags.Radio,\n      Kids: [],\n    });\n    const ref = context.register(dict);\n    return new PDFAcroRadioButton(dict, ref);\n  };\n\n  setValue(value: PDFName) {\n    const onValues = this.getOnValues();\n    if (!onValues.includes(value) && value !== PDFName.of('Off')) {\n      throw new InvalidAcroFieldValueError();\n    }\n\n    this.dict.set(PDFName.of('V'), value);\n\n    const widgets = this.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      const state = widget.getOnValue() === value ? value : PDFName.of('Off');\n      widget.setAppearanceState(state);\n    }\n  }\n\n  getValue(): PDFName {\n    const v = this.V();\n    if (v instanceof PDFName) return v;\n    return PDFName.of('Off');\n  }\n\n  getOnValues(): PDFName[] {\n    const widgets = this.getWidgets();\n\n    const onValues: PDFName[] = [];\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const onValue = widgets[idx].getOnValue();\n      if (onValue) onValues.push(onValue);\n    }\n\n    return onValues;\n  }\n}\n\nexport default PDFAcroRadioButton;\n","import PDFDict from 'src/core/objects/PDFDict';\nimport PDFAcroChoice from 'src/core/acroform/PDFAcroChoice';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFRef from 'src/core/objects/PDFRef';\n\nclass PDFAcroListBox extends PDFAcroChoice {\n  static fromDict = (dict: PDFDict, ref: PDFRef) =>\n    new PDFAcroListBox(dict, ref);\n\n  static create = (context: PDFContext) => {\n    const dict = context.obj({\n      FT: 'Ch',\n      Kids: [],\n    });\n    const ref = context.register(dict);\n    return new PDFAcroListBox(dict, ref);\n  };\n}\n\nexport default PDFAcroListBox;\n","import PDFObject from 'src/core/objects/PDFObject';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFArray from 'src/core/objects/PDFArray';\nimport PDFRef from 'src/core/objects/PDFRef';\n\nimport PDFAcroField from 'src/core/acroform/PDFAcroField';\nimport PDFAcroTerminal from 'src/core/acroform/PDFAcroTerminal';\nimport PDFAcroNonTerminal from 'src/core/acroform/PDFAcroNonTerminal';\nimport PDFAcroButton from 'src/core/acroform/PDFAcroButton';\nimport PDFAcroSignature from 'src/core/acroform/PDFAcroSignature';\nimport PDFAcroChoice from 'src/core/acroform/PDFAcroChoice';\nimport PDFAcroText from 'src/core/acroform/PDFAcroText';\nimport PDFAcroPushButton from 'src/core/acroform/PDFAcroPushButton';\nimport PDFAcroRadioButton from 'src/core/acroform/PDFAcroRadioButton';\nimport PDFAcroCheckBox from 'src/core/acroform/PDFAcroCheckBox';\nimport PDFAcroComboBox from 'src/core/acroform/PDFAcroComboBox';\nimport PDFAcroListBox from 'src/core/acroform/PDFAcroListBox';\nimport { AcroButtonFlags, AcroChoiceFlags } from 'src/core/acroform/flags';\n\nexport const createPDFAcroFields = (\n  kidDicts?: PDFArray,\n): [PDFAcroField, PDFRef][] => {\n  if (!kidDicts) return [];\n\n  const kids: [PDFAcroField, PDFRef][] = [];\n  for (let idx = 0, len = kidDicts.size(); idx < len; idx++) {\n    const ref = kidDicts.get(idx);\n    const dict = kidDicts.lookup(idx);\n    // if (dict instanceof PDFDict) kids.push(PDFAcroField.fromDict(dict));\n    if (ref instanceof PDFRef && dict instanceof PDFDict) {\n      kids.push([createPDFAcroField(dict, ref), ref]);\n    }\n  }\n\n  return kids;\n};\n\nexport const createPDFAcroField = (\n  dict: PDFDict,\n  ref: PDFRef,\n): PDFAcroField => {\n  const isNonTerminal = isNonTerminalAcroField(dict);\n  if (isNonTerminal) return PDFAcroNonTerminal.fromDict(dict, ref);\n  return createPDFAcroTerminal(dict, ref);\n};\n\n// TODO: Maybe just check if the dict is *not* a widget? That might be better.\n\n// According to the PDF spec:\n//\n//   > A field's children in the hierarchy may also include widget annotations\n//   > that define its appearance on the page. A field that has children that\n//   > are fields is called a non-terminal field. A field that does not have\n//   > children that are fields is called a terminal field.\n//\n// The spec is not entirely clear about how to determine whether a given\n// dictionary represents an acrofield or a widget annotation. So we will assume\n// that a dictionary is an acrofield if it is a member of the `/Kids` array\n// and it contains a `/T` entry (widgets do not have `/T` entries). This isn't\n// a bullet proof solution, because the `/T` entry is technically defined as\n// optional for acrofields by the PDF spec. But in practice all acrofields seem\n// to have a `/T` entry defined.\nconst isNonTerminalAcroField = (dict: PDFDict): boolean => {\n  const kids = dict.lookup(PDFName.of('Kids'));\n\n  if (kids instanceof PDFArray) {\n    for (let idx = 0, len = kids.size(); idx < len; idx++) {\n      const kid = kids.lookup(idx);\n      const kidIsField = kid instanceof PDFDict && kid.has(PDFName.of('T'));\n      if (kidIsField) return true;\n    }\n  }\n\n  return false;\n};\n\nconst createPDFAcroTerminal = (dict: PDFDict, ref: PDFRef): PDFAcroTerminal => {\n  const ftNameOrRef = getInheritableAttribute(dict, PDFName.of('FT'));\n  const type = dict.context.lookup(ftNameOrRef, PDFName);\n\n  if (type === PDFName.of('Btn')) return createPDFAcroButton(dict, ref);\n  if (type === PDFName.of('Ch')) return createPDFAcroChoice(dict, ref);\n  if (type === PDFName.of('Tx')) return PDFAcroText.fromDict(dict, ref);\n  if (type === PDFName.of('Sig')) return PDFAcroSignature.fromDict(dict, ref);\n\n  // We should never reach this line. But there are a lot of weird PDFs out\n  // there. So, just to be safe, we'll try to handle things gracefully instead\n  // of throwing an error.\n  return PDFAcroTerminal.fromDict(dict, ref);\n};\n\nconst createPDFAcroButton = (dict: PDFDict, ref: PDFRef): PDFAcroButton => {\n  const ffNumberOrRef = getInheritableAttribute(dict, PDFName.of('Ff'));\n  const ffNumber = dict.context.lookupMaybe(ffNumberOrRef, PDFNumber);\n  const flags = ffNumber?.asNumber() ?? 0;\n\n  if (flagIsSet(flags, AcroButtonFlags.PushButton)) {\n    return PDFAcroPushButton.fromDict(dict, ref);\n  } else if (flagIsSet(flags, AcroButtonFlags.Radio)) {\n    return PDFAcroRadioButton.fromDict(dict, ref);\n  } else {\n    return PDFAcroCheckBox.fromDict(dict, ref);\n  }\n};\n\nconst createPDFAcroChoice = (dict: PDFDict, ref: PDFRef): PDFAcroChoice => {\n  const ffNumberOrRef = getInheritableAttribute(dict, PDFName.of('Ff'));\n  const ffNumber = dict.context.lookupMaybe(ffNumberOrRef, PDFNumber);\n  const flags = ffNumber?.asNumber() ?? 0;\n\n  if (flagIsSet(flags, AcroChoiceFlags.Combo)) {\n    return PDFAcroComboBox.fromDict(dict, ref);\n  } else {\n    return PDFAcroListBox.fromDict(dict, ref);\n  }\n};\n\nconst flagIsSet = (flags: number, flag: number): boolean =>\n  (flags & flag) !== 0;\n\nconst getInheritableAttribute = (startNode: PDFDict, name: PDFName) => {\n  let attribute: PDFObject | undefined;\n  ascend(startNode, (node) => {\n    if (!attribute) attribute = node.get(name);\n  });\n  return attribute;\n};\n\nconst ascend = (startNode: PDFDict, visitor: (node: PDFDict) => any) => {\n  visitor(startNode);\n  const Parent = startNode.lookupMaybe(PDFName.of('Parent'), PDFDict);\n  if (Parent) ascend(Parent, visitor);\n};\n","import PDFContext from 'src/core/PDFContext';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFArray from 'src/core/objects/PDFArray';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFAcroField from 'src/core/acroform/PDFAcroField';\nimport PDFAcroNonTerminal from 'src/core/acroform/PDFAcroNonTerminal';\nimport {\n  createPDFAcroField,\n  createPDFAcroFields,\n} from 'src/core/acroform/utils';\n\nclass PDFAcroForm {\n  readonly dict: PDFDict;\n\n  static fromDict = (dict: PDFDict) => new PDFAcroForm(dict);\n\n  static create = (context: PDFContext) => {\n    const dict = context.obj({ Fields: [] });\n    return new PDFAcroForm(dict);\n  };\n\n  private constructor(dict: PDFDict) {\n    this.dict = dict;\n  }\n\n  Fields(): PDFArray | undefined {\n    const fields = this.dict.lookup(PDFName.of('Fields'));\n    if (fields instanceof PDFArray) return fields;\n    return undefined;\n  }\n\n  getFields(): [PDFAcroField, PDFRef][] {\n    const { Fields } = this.normalizedEntries();\n\n    const fields = new Array(Fields.size());\n    for (let idx = 0, len = Fields.size(); idx < len; idx++) {\n      const ref = Fields.get(idx) as PDFRef;\n      const dict = Fields.lookup(idx, PDFDict);\n      fields[idx] = [createPDFAcroField(dict, ref), ref];\n    }\n\n    return fields;\n  }\n\n  getAllFields(): [PDFAcroField, PDFRef][] {\n    const allFields: [PDFAcroField, PDFRef][] = [];\n\n    const pushFields = (fields?: [PDFAcroField, PDFRef][]) => {\n      if (!fields) return;\n      for (let idx = 0, len = fields.length; idx < len; idx++) {\n        const field = fields[idx];\n        allFields.push(field);\n        const [fieldModel] = field;\n        if (fieldModel instanceof PDFAcroNonTerminal) {\n          pushFields(createPDFAcroFields(fieldModel.Kids()));\n        }\n      }\n    };\n\n    pushFields(this.getFields());\n\n    return allFields;\n  }\n\n  addField(field: PDFRef) {\n    const { Fields } = this.normalizedEntries();\n    Fields?.push(field);\n  }\n\n  removeField(field: PDFAcroField): void {\n    const parent = field.getParent();\n    const fields =\n      parent === undefined ? this.normalizedEntries().Fields : parent.Kids();\n\n    const index = fields?.indexOf(field.ref);\n    if (fields === undefined || index === undefined) {\n      throw new Error(\n        `Tried to remove inexistent field ${field.getFullyQualifiedName()}`,\n      );\n    }\n\n    fields.remove(index);\n\n    if (parent !== undefined && fields.size() === 0) {\n      this.removeField(parent);\n    }\n  }\n\n  normalizedEntries() {\n    let Fields = this.Fields();\n\n    if (!Fields) {\n      Fields = this.dict.context.obj([]);\n      this.dict.set(PDFName.of('Fields'), Fields);\n    }\n\n    return { Fields };\n  }\n}\n\nexport default PDFAcroForm;\n","import PDFDict, { DictMap } from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFPageTree from 'src/core/structures/PDFPageTree';\nimport { PDFAcroForm } from 'src/core/acroform';\nimport ViewerPreferences from '../interactive/ViewerPreferences';\n\nclass PDFCatalog extends PDFDict {\n  static withContextAndPages = (\n    context: PDFContext,\n    pages: PDFPageTree | PDFRef,\n  ) => {\n    const dict = new Map();\n    dict.set(PDFName.of('Type'), PDFName.of('Catalog'));\n    dict.set(PDFName.of('Pages'), pages);\n    return new PDFCatalog(dict, context);\n  };\n\n  static fromMapWithContext = (map: DictMap, context: PDFContext) =>\n    new PDFCatalog(map, context);\n\n  Pages(): PDFPageTree {\n    return this.lookup(PDFName.of('Pages'), PDFDict) as PDFPageTree;\n  }\n\n  AcroForm(): PDFDict | undefined {\n    return this.lookupMaybe(PDFName.of('AcroForm'), PDFDict);\n  }\n\n  getAcroForm(): PDFAcroForm | undefined {\n    const dict = this.AcroForm();\n    if (!dict) return undefined;\n    return PDFAcroForm.fromDict(dict);\n  }\n\n  getOrCreateAcroForm(): PDFAcroForm {\n    let acroForm = this.getAcroForm();\n    if (!acroForm) {\n      acroForm = PDFAcroForm.create(this.context);\n      const acroFormRef = this.context.register(acroForm.dict);\n      this.set(PDFName.of('AcroForm'), acroFormRef);\n    }\n    return acroForm;\n  }\n\n  ViewerPreferences(): PDFDict | undefined {\n    return this.lookupMaybe(PDFName.of('ViewerPreferences'), PDFDict);\n  }\n\n  getViewerPreferences(): ViewerPreferences | undefined {\n    const dict = this.ViewerPreferences();\n    if (!dict) return undefined;\n    return ViewerPreferences.fromDict(dict);\n  }\n\n  getOrCreateViewerPreferences(): ViewerPreferences {\n    let viewerPrefs = this.getViewerPreferences();\n    if (!viewerPrefs) {\n      viewerPrefs = ViewerPreferences.create(this.context);\n      const viewerPrefsRef = this.context.register(viewerPrefs.dict);\n      this.set(PDFName.of('ViewerPreferences'), viewerPrefsRef);\n    }\n    return viewerPrefs;\n  }\n\n  /**\n   * Inserts the given ref as a leaf node of this catalog's page tree at the\n   * specified index (zero-based). Also increments the `Count` of each node in\n   * the page tree hierarchy to accomodate the new page.\n   *\n   * Returns the ref of the PDFPageTree node into which `leafRef` was inserted.\n   */\n  insertLeafNode(leafRef: PDFRef, index: number): PDFRef {\n    const pagesRef = this.get(PDFName.of('Pages')) as PDFRef;\n    const maybeParentRef = this.Pages().insertLeafNode(leafRef, index);\n    return maybeParentRef || pagesRef;\n  }\n\n  removeLeafNode(index: number): void {\n    this.Pages().removeLeafNode(index);\n  }\n}\n\nexport default PDFCatalog;\n","import PDFArray from 'src/core/objects/PDFArray';\nimport PDFDict, { DictMap } from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFPageLeaf from 'src/core/structures/PDFPageLeaf';\nimport { InvalidTargetIndexError, CorruptPageTreeError } from 'src/core/errors';\n\nexport type TreeNode = PDFPageTree | PDFPageLeaf;\n\nclass PDFPageTree extends PDFDict {\n  static withContext = (context: PDFContext, parent?: PDFRef) => {\n    const dict = new Map();\n    dict.set(PDFName.of('Type'), PDFName.of('Pages'));\n    dict.set(PDFName.of('Kids'), context.obj([]));\n    dict.set(PDFName.of('Count'), context.obj(0));\n    if (parent) dict.set(PDFName.of('Parent'), parent);\n    return new PDFPageTree(dict, context);\n  };\n\n  static fromMapWithContext = (map: DictMap, context: PDFContext) =>\n    new PDFPageTree(map, context);\n\n  Parent(): PDFPageTree | undefined {\n    return this.lookup(PDFName.of('Parent')) as PDFPageTree | undefined;\n  }\n\n  Kids(): PDFArray {\n    return this.lookup(PDFName.of('Kids'), PDFArray);\n  }\n\n  Count(): PDFNumber {\n    return this.lookup(PDFName.of('Count'), PDFNumber);\n  }\n\n  pushTreeNode(treeRef: PDFRef): void {\n    const Kids = this.Kids();\n    Kids.push(treeRef);\n  }\n\n  pushLeafNode(leafRef: PDFRef): void {\n    const Kids = this.Kids();\n    this.insertLeafKid(Kids.size(), leafRef);\n  }\n\n  /**\n   * Inserts the given ref as a leaf node of this page tree at the specified\n   * index (zero-based). Also increments the `Count` of each page tree in the\n   * hierarchy to accomodate the new page.\n   *\n   * Returns the ref of the PDFPageTree node into which `leafRef` was inserted,\n   * or `undefined` if it was inserted into the root node (the PDFPageTree upon\n   * which the method was first called).\n   */\n  insertLeafNode(leafRef: PDFRef, targetIndex: number): PDFRef | undefined {\n    const Kids = this.Kids();\n    const Count = this.Count().asNumber();\n\n    if (targetIndex > Count) {\n      throw new InvalidTargetIndexError(targetIndex, Count);\n    }\n\n    let leafsRemainingUntilTarget = targetIndex;\n    for (let idx = 0, len = Kids.size(); idx < len; idx++) {\n      if (leafsRemainingUntilTarget === 0) {\n        // Insert page and return\n        this.insertLeafKid(idx, leafRef);\n        return undefined;\n      }\n\n      const kidRef = Kids.get(idx) as PDFRef;\n      const kid = this.context.lookup(kidRef);\n\n      if (kid instanceof PDFPageTree) {\n        if (kid.Count().asNumber() > leafsRemainingUntilTarget) {\n          // Dig in\n          return (\n            kid.insertLeafNode(leafRef, leafsRemainingUntilTarget) || kidRef\n          );\n        } else {\n          // Move on\n          leafsRemainingUntilTarget -= kid.Count().asNumber();\n        }\n      }\n\n      if (kid instanceof PDFPageLeaf) {\n        // Move on\n        leafsRemainingUntilTarget -= 1;\n      }\n    }\n\n    if (leafsRemainingUntilTarget === 0) {\n      // Insert page at the end and return\n      this.insertLeafKid(Kids.size(), leafRef);\n      return undefined;\n    }\n\n    // Should never get here if `targetIndex` is valid\n    throw new CorruptPageTreeError(targetIndex, 'insertLeafNode');\n  }\n\n  /**\n   * Removes the leaf node at the specified index (zero-based) from this page\n   * tree. Also decrements the `Count` of each page tree in the hierarchy to\n   * account for the removed page.\n   *\n   * If `prune` is true, then intermediate tree nodes will be removed from the\n   * tree if they contain 0 children after the leaf node is removed.\n   */\n  removeLeafNode(targetIndex: number, prune = true): void {\n    const Kids = this.Kids();\n    const Count = this.Count().asNumber();\n\n    if (targetIndex >= Count) {\n      throw new InvalidTargetIndexError(targetIndex, Count);\n    }\n\n    let leafsRemainingUntilTarget = targetIndex;\n    for (let idx = 0, len = Kids.size(); idx < len; idx++) {\n      const kidRef = Kids.get(idx) as PDFRef;\n      const kid = this.context.lookup(kidRef);\n\n      if (kid instanceof PDFPageTree) {\n        if (kid.Count().asNumber() > leafsRemainingUntilTarget) {\n          // Dig in\n          kid.removeLeafNode(leafsRemainingUntilTarget, prune);\n          if (prune && kid.Kids().size() === 0) Kids.remove(idx);\n          return;\n        } else {\n          // Move on\n          leafsRemainingUntilTarget -= kid.Count().asNumber();\n        }\n      }\n\n      if (kid instanceof PDFPageLeaf) {\n        if (leafsRemainingUntilTarget === 0) {\n          // Remove page and return\n          this.removeKid(idx);\n          return;\n        } else {\n          // Move on\n          leafsRemainingUntilTarget -= 1;\n        }\n      }\n    }\n\n    // Should never get here if `targetIndex` is valid\n    throw new CorruptPageTreeError(targetIndex, 'removeLeafNode');\n  }\n\n  ascend(visitor: (node: PDFPageTree) => any): void {\n    visitor(this);\n    const Parent = this.Parent();\n    if (Parent) Parent.ascend(visitor);\n  }\n\n  /** Performs a Post-Order traversal of this page tree */\n  traverse(visitor: (node: TreeNode, ref: PDFRef) => any): void {\n    const Kids = this.Kids();\n    for (let idx = 0, len = Kids.size(); idx < len; idx++) {\n      const kidRef = Kids.get(idx) as PDFRef;\n      const kid = this.context.lookup(kidRef) as TreeNode;\n      if (kid instanceof PDFPageTree) kid.traverse(visitor);\n      visitor(kid, kidRef);\n    }\n  }\n\n  private insertLeafKid(kidIdx: number, leafRef: PDFRef): void {\n    const Kids = this.Kids();\n\n    this.ascend((node) => {\n      const newCount = node.Count().asNumber() + 1;\n      node.set(PDFName.of('Count'), PDFNumber.of(newCount));\n    });\n\n    Kids.insert(kidIdx, leafRef);\n  }\n\n  private removeKid(kidIdx: number): void {\n    const Kids = this.Kids();\n\n    const kid = Kids.lookup(kidIdx);\n    if (kid instanceof PDFPageLeaf) {\n      this.ascend((node) => {\n        const newCount = node.Count().asNumber() - 1;\n        node.set(PDFName.of('Count'), PDFNumber.of(newCount));\n      });\n    }\n\n    Kids.remove(kidIdx);\n  }\n}\n\nexport default PDFPageTree;\n","import CharCodes from 'src/core/syntax/CharCodes';\n\nexport const IsDigit = new Uint8Array(256);\n\nIsDigit[CharCodes.Zero] = 1;\nIsDigit[CharCodes.One] = 1;\nIsDigit[CharCodes.Two] = 1;\nIsDigit[CharCodes.Three] = 1;\nIsDigit[CharCodes.Four] = 1;\nIsDigit[CharCodes.Five] = 1;\nIsDigit[CharCodes.Six] = 1;\nIsDigit[CharCodes.Seven] = 1;\nIsDigit[CharCodes.Eight] = 1;\nIsDigit[CharCodes.Nine] = 1;\n\nexport const IsNumericPrefix = new Uint8Array(256);\n\nIsNumericPrefix[CharCodes.Period] = 1;\nIsNumericPrefix[CharCodes.Plus] = 1;\nIsNumericPrefix[CharCodes.Minus] = 1;\n\nexport const IsNumeric = new Uint8Array(256);\n\nfor (let idx = 0, len = 256; idx < len; idx++) {\n  IsNumeric[idx] = IsDigit[idx] || IsNumericPrefix[idx] ? 1 : 0;\n}\n","import { NumberParsingError } from 'src/core/errors';\nimport ByteStream from 'src/core/parser/ByteStream';\nimport CharCodes from 'src/core/syntax/CharCodes';\nimport { IsDigit, IsNumeric } from 'src/core/syntax/Numeric';\nimport { IsWhitespace } from 'src/core/syntax/Whitespace';\nimport { charFromCode } from 'src/utils';\n\nconst { Newline, CarriageReturn } = CharCodes;\n\n// TODO: Throw error if eof is reached before finishing object parse...\nclass BaseParser {\n  protected readonly bytes: ByteStream;\n  protected readonly capNumbers: boolean;\n\n  constructor(bytes: ByteStream, capNumbers = false) {\n    this.bytes = bytes;\n    this.capNumbers = capNumbers;\n  }\n\n  protected parseRawInt(): number {\n    let value = '';\n\n    while (!this.bytes.done()) {\n      const byte = this.bytes.peek();\n      if (!IsDigit[byte]) break;\n      value += charFromCode(this.bytes.next());\n    }\n\n    const numberValue = Number(value);\n\n    if (!value || !isFinite(numberValue)) {\n      throw new NumberParsingError(this.bytes.position(), value);\n    }\n\n    return numberValue;\n  }\n\n  // TODO: Maybe handle exponential format?\n  // TODO: Compare performance of string concatenation to charFromCode(...bytes)\n  protected parseRawNumber(): number {\n    let value = '';\n\n    // Parse integer-part, the leading (+ | - | . | 0-9)\n    while (!this.bytes.done()) {\n      const byte = this.bytes.peek();\n      if (!IsNumeric[byte]) break;\n      value += charFromCode(this.bytes.next());\n      if (byte === CharCodes.Period) break;\n    }\n\n    // Parse decimal-part, the trailing (0-9)\n    while (!this.bytes.done()) {\n      const byte = this.bytes.peek();\n      if (!IsDigit[byte]) break;\n      value += charFromCode(this.bytes.next());\n    }\n\n    const numberValue = Number(value);\n\n    if (!value || !isFinite(numberValue)) {\n      throw new NumberParsingError(this.bytes.position(), value);\n    }\n\n    if (numberValue > Number.MAX_SAFE_INTEGER) {\n      if (this.capNumbers) {\n        const msg = `Parsed number that is too large for some PDF readers: ${value}, using Number.MAX_SAFE_INTEGER instead.`;\n        console.warn(msg);\n        return Number.MAX_SAFE_INTEGER;\n      } else {\n        const msg = `Parsed number that is too large for some PDF readers: ${value}, not capping.`;\n        console.warn(msg);\n      }\n    }\n\n    return numberValue;\n  }\n\n  protected skipWhitespace(): void {\n    while (!this.bytes.done() && IsWhitespace[this.bytes.peek()]) {\n      this.bytes.next();\n    }\n  }\n\n  protected skipLine(): void {\n    while (!this.bytes.done()) {\n      const byte = this.bytes.peek();\n      if (byte === Newline || byte === CarriageReturn) return;\n      this.bytes.next();\n    }\n  }\n\n  protected skipComment(): boolean {\n    if (this.bytes.peek() !== CharCodes.Percent) return false;\n    while (!this.bytes.done()) {\n      const byte = this.bytes.peek();\n      if (byte === Newline || byte === CarriageReturn) return true;\n      this.bytes.next();\n    }\n    return true;\n  }\n\n  protected skipWhitespaceAndComments(): void {\n    this.skipWhitespace();\n    while (this.skipComment()) this.skipWhitespace();\n  }\n\n  protected matchKeyword(keyword: number[]): boolean {\n    const initialOffset = this.bytes.offset();\n    for (let idx = 0, len = keyword.length; idx < len; idx++) {\n      if (this.bytes.done() || this.bytes.next() !== keyword[idx]) {\n        this.bytes.moveTo(initialOffset);\n        return false;\n      }\n    }\n    return true;\n  }\n}\n\nexport default BaseParser;\n","import { NextByteAssertionError } from 'src/core/errors';\nimport PDFRawStream from 'src/core/objects/PDFRawStream';\nimport { decodePDFRawStream } from 'src/core/streams/decode';\nimport CharCodes from 'src/core/syntax/CharCodes';\n\n// TODO: See how line/col tracking affects performance\nclass ByteStream {\n  static of = (bytes: Uint8Array) => new ByteStream(bytes);\n\n  static fromPDFRawStream = (rawStream: PDFRawStream) =>\n    ByteStream.of(decodePDFRawStream(rawStream).decode());\n\n  private readonly bytes: Uint8Array;\n  private readonly length: number;\n\n  private idx = 0;\n  private line = 0;\n  private column = 0;\n\n  constructor(bytes: Uint8Array) {\n    this.bytes = bytes;\n    this.length = this.bytes.length;\n  }\n\n  moveTo(offset: number): void {\n    this.idx = offset;\n  }\n\n  next(): number {\n    const byte = this.bytes[this.idx++];\n    if (byte === CharCodes.Newline) {\n      this.line += 1;\n      this.column = 0;\n    } else {\n      this.column += 1;\n    }\n    return byte;\n  }\n\n  assertNext(expected: number): number {\n    if (this.peek() !== expected) {\n      throw new NextByteAssertionError(this.position(), expected, this.peek());\n    }\n    return this.next();\n  }\n\n  peek(): number {\n    return this.bytes[this.idx];\n  }\n\n  peekAhead(steps: number) {\n    return this.bytes[this.idx + steps];\n  }\n\n  peekAt(offset: number) {\n    return this.bytes[offset];\n  }\n\n  done(): boolean {\n    return this.idx >= this.length;\n  }\n\n  offset(): number {\n    return this.idx;\n  }\n\n  slice(start: number, end: number): Uint8Array {\n    return this.bytes.slice(start, end);\n  }\n\n  position(): { line: number; column: number; offset: number } {\n    return { line: this.line, column: this.column, offset: this.idx };\n  }\n}\n\nexport default ByteStream;\n","import CharCodes from 'src/core/syntax/CharCodes';\n\nconst { Space, CarriageReturn, Newline } = CharCodes;\n\nconst stream = [\n  CharCodes.s,\n  CharCodes.t,\n  CharCodes.r,\n  CharCodes.e,\n  CharCodes.a,\n  CharCodes.m,\n];\n\nconst endstream = [\n  CharCodes.e,\n  CharCodes.n,\n  CharCodes.d,\n  CharCodes.s,\n  CharCodes.t,\n  CharCodes.r,\n  CharCodes.e,\n  CharCodes.a,\n  CharCodes.m,\n];\n\nexport const Keywords = {\n  header: [\n    CharCodes.Percent,\n    CharCodes.P,\n    CharCodes.D,\n    CharCodes.F,\n    CharCodes.Dash,\n  ],\n  eof: [\n    CharCodes.Percent,\n    CharCodes.Percent,\n    CharCodes.E,\n    CharCodes.O,\n    CharCodes.F,\n  ],\n  obj: [CharCodes.o, CharCodes.b, CharCodes.j],\n  endobj: [\n    CharCodes.e,\n    CharCodes.n,\n    CharCodes.d,\n    CharCodes.o,\n    CharCodes.b,\n    CharCodes.j,\n  ],\n  xref: [CharCodes.x, CharCodes.r, CharCodes.e, CharCodes.f],\n  trailer: [\n    CharCodes.t,\n    CharCodes.r,\n    CharCodes.a,\n    CharCodes.i,\n    CharCodes.l,\n    CharCodes.e,\n    CharCodes.r,\n  ],\n  startxref: [\n    CharCodes.s,\n    CharCodes.t,\n    CharCodes.a,\n    CharCodes.r,\n    CharCodes.t,\n    CharCodes.x,\n    CharCodes.r,\n    CharCodes.e,\n    CharCodes.f,\n  ],\n  true: [CharCodes.t, CharCodes.r, CharCodes.u, CharCodes.e],\n  false: [CharCodes.f, CharCodes.a, CharCodes.l, CharCodes.s, CharCodes.e],\n  null: [CharCodes.n, CharCodes.u, CharCodes.l, CharCodes.l],\n  stream,\n  streamEOF1: [...stream, Space, CarriageReturn, Newline],\n  streamEOF2: [...stream, CarriageReturn, Newline],\n  streamEOF3: [...stream, CarriageReturn],\n  streamEOF4: [...stream, Newline],\n  endstream,\n  EOF1endstream: [CarriageReturn, Newline, ...endstream],\n  EOF2endstream: [CarriageReturn, ...endstream],\n  EOF3endstream: [Newline, ...endstream],\n};\n","import {\n  PDFObjectParsingError,\n  PDFStreamParsingError,\n  Position,\n  UnbalancedParenthesisError,\n} from 'src/core/errors';\nimport PDFArray from 'src/core/objects/PDFArray';\nimport PDFBool from 'src/core/objects/PDFBool';\nimport PDFDict, { DictMap } from 'src/core/objects/PDFDict';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNull from 'src/core/objects/PDFNull';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFRawStream from 'src/core/objects/PDFRawStream';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFStream from 'src/core/objects/PDFStream';\nimport PDFString from 'src/core/objects/PDFString';\nimport BaseParser from 'src/core/parser/BaseParser';\nimport ByteStream from 'src/core/parser/ByteStream';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFCatalog from 'src/core/structures/PDFCatalog';\nimport PDFPageLeaf from 'src/core/structures/PDFPageLeaf';\nimport PDFPageTree from 'src/core/structures/PDFPageTree';\nimport CharCodes from 'src/core/syntax/CharCodes';\nimport { IsDelimiter } from 'src/core/syntax/Delimiters';\nimport { Keywords } from 'src/core/syntax/Keywords';\nimport { IsDigit, IsNumeric } from 'src/core/syntax/Numeric';\nimport { IsWhitespace } from 'src/core/syntax/Whitespace';\nimport { charFromCode } from 'src/utils';\n\n// TODO: Throw error if eof is reached before finishing object parse...\nclass PDFObjectParser extends BaseParser {\n  static forBytes = (\n    bytes: Uint8Array,\n    context: PDFContext,\n    capNumbers?: boolean,\n  ) => new PDFObjectParser(ByteStream.of(bytes), context, capNumbers);\n\n  static forByteStream = (\n    byteStream: ByteStream,\n    context: PDFContext,\n    capNumbers = false,\n  ) => new PDFObjectParser(byteStream, context, capNumbers);\n\n  protected readonly context: PDFContext;\n\n  constructor(byteStream: ByteStream, context: PDFContext, capNumbers = false) {\n    super(byteStream, capNumbers);\n    this.context = context;\n  }\n\n  // TODO: Is it possible to reduce duplicate parsing for ref lookaheads?\n  parseObject(): PDFObject {\n    this.skipWhitespaceAndComments();\n\n    if (this.matchKeyword(Keywords.true)) return PDFBool.True;\n    if (this.matchKeyword(Keywords.false)) return PDFBool.False;\n    if (this.matchKeyword(Keywords.null)) return PDFNull;\n\n    const byte = this.bytes.peek();\n\n    if (\n      byte === CharCodes.LessThan &&\n      this.bytes.peekAhead(1) === CharCodes.LessThan\n    ) {\n      return this.parseDictOrStream();\n    }\n    if (byte === CharCodes.LessThan) return this.parseHexString();\n    if (byte === CharCodes.LeftParen) return this.parseString();\n    if (byte === CharCodes.ForwardSlash) return this.parseName();\n    if (byte === CharCodes.LeftSquareBracket) return this.parseArray();\n    if (IsNumeric[byte]) return this.parseNumberOrRef();\n\n    throw new PDFObjectParsingError(this.bytes.position(), byte);\n  }\n\n  protected parseNumberOrRef(): PDFNumber | PDFRef {\n    const firstNum = this.parseRawNumber();\n    this.skipWhitespaceAndComments();\n\n    const lookaheadStart = this.bytes.offset();\n    if (IsDigit[this.bytes.peek()]) {\n      const secondNum = this.parseRawNumber();\n      this.skipWhitespaceAndComments();\n      if (this.bytes.peek() === CharCodes.R) {\n        this.bytes.assertNext(CharCodes.R);\n        return PDFRef.of(firstNum, secondNum);\n      }\n    }\n\n    this.bytes.moveTo(lookaheadStart);\n    return PDFNumber.of(firstNum);\n  }\n\n  // TODO: Maybe update PDFHexString.of() logic to remove whitespace and validate input?\n  protected parseHexString(): PDFHexString {\n    let value = '';\n\n    this.bytes.assertNext(CharCodes.LessThan);\n    while (!this.bytes.done() && this.bytes.peek() !== CharCodes.GreaterThan) {\n      value += charFromCode(this.bytes.next());\n    }\n    this.bytes.assertNext(CharCodes.GreaterThan);\n\n    return PDFHexString.of(value);\n  }\n\n  protected parseString(): PDFString {\n    let nestingLvl = 0;\n    let isEscaped = false;\n    let value = '';\n\n    while (!this.bytes.done()) {\n      const byte = this.bytes.next();\n      value += charFromCode(byte);\n\n      // Check for unescaped parenthesis\n      if (!isEscaped) {\n        if (byte === CharCodes.LeftParen) nestingLvl += 1;\n        if (byte === CharCodes.RightParen) nestingLvl -= 1;\n      }\n\n      // Track whether current character is being escaped or not\n      if (byte === CharCodes.BackSlash) {\n        isEscaped = !isEscaped;\n      } else if (isEscaped) {\n        isEscaped = false;\n      }\n\n      // Once (if) the unescaped parenthesis balance out, return their contents\n      if (nestingLvl === 0) {\n        // Remove the outer parens so they aren't part of the contents\n        return PDFString.of(value.substring(1, value.length - 1));\n      }\n    }\n\n    throw new UnbalancedParenthesisError(this.bytes.position());\n  }\n\n  // TODO: Compare performance of string concatenation to charFromCode(...bytes)\n  // TODO: Maybe preallocate small Uint8Array if can use charFromCode?\n  protected parseName(): PDFName {\n    this.bytes.assertNext(CharCodes.ForwardSlash);\n\n    let name = '';\n    while (!this.bytes.done()) {\n      const byte = this.bytes.peek();\n      if (IsWhitespace[byte] || IsDelimiter[byte]) break;\n      name += charFromCode(byte);\n      this.bytes.next();\n    }\n\n    return PDFName.of(name);\n  }\n\n  protected parseArray(): PDFArray {\n    this.bytes.assertNext(CharCodes.LeftSquareBracket);\n    this.skipWhitespaceAndComments();\n\n    const pdfArray = PDFArray.withContext(this.context);\n    while (this.bytes.peek() !== CharCodes.RightSquareBracket) {\n      const element = this.parseObject();\n      pdfArray.push(element);\n      this.skipWhitespaceAndComments();\n    }\n    this.bytes.assertNext(CharCodes.RightSquareBracket);\n    return pdfArray;\n  }\n\n  protected parseDict(): PDFDict {\n    this.bytes.assertNext(CharCodes.LessThan);\n    this.bytes.assertNext(CharCodes.LessThan);\n    this.skipWhitespaceAndComments();\n\n    const dict: DictMap = new Map();\n\n    while (\n      !this.bytes.done() &&\n      this.bytes.peek() !== CharCodes.GreaterThan &&\n      this.bytes.peekAhead(1) !== CharCodes.GreaterThan\n    ) {\n      const key = this.parseName();\n      const value = this.parseObject();\n      dict.set(key, value);\n      this.skipWhitespaceAndComments();\n    }\n\n    this.skipWhitespaceAndComments();\n    this.bytes.assertNext(CharCodes.GreaterThan);\n    this.bytes.assertNext(CharCodes.GreaterThan);\n\n    const Type = dict.get(PDFName.of('Type'));\n\n    if (Type === PDFName.of('Catalog')) {\n      return PDFCatalog.fromMapWithContext(dict, this.context);\n    } else if (Type === PDFName.of('Pages')) {\n      return PDFPageTree.fromMapWithContext(dict, this.context);\n    } else if (Type === PDFName.of('Page')) {\n      return PDFPageLeaf.fromMapWithContext(dict, this.context);\n    } else {\n      return PDFDict.fromMapWithContext(dict, this.context);\n    }\n  }\n\n  protected parseDictOrStream(): PDFDict | PDFStream {\n    const startPos = this.bytes.position();\n\n    const dict = this.parseDict();\n\n    this.skipWhitespaceAndComments();\n\n    if (\n      !this.matchKeyword(Keywords.streamEOF1) &&\n      !this.matchKeyword(Keywords.streamEOF2) &&\n      !this.matchKeyword(Keywords.streamEOF3) &&\n      !this.matchKeyword(Keywords.streamEOF4) &&\n      !this.matchKeyword(Keywords.stream)\n    ) {\n      return dict;\n    }\n\n    const start = this.bytes.offset();\n    let end: number;\n\n    const Length = dict.get(PDFName.of('Length'));\n    if (Length instanceof PDFNumber) {\n      end = start + Length.asNumber();\n      this.bytes.moveTo(end);\n      this.skipWhitespaceAndComments();\n      if (!this.matchKeyword(Keywords.endstream)) {\n        this.bytes.moveTo(start);\n        end = this.findEndOfStreamFallback(startPos);\n      }\n    } else {\n      end = this.findEndOfStreamFallback(startPos);\n    }\n\n    const contents = this.bytes.slice(start, end);\n\n    return PDFRawStream.of(dict, contents);\n  }\n\n  protected findEndOfStreamFallback(startPos: Position) {\n    // Move to end of stream, while handling nested streams\n    let nestingLvl = 1;\n    let end = this.bytes.offset();\n\n    while (!this.bytes.done()) {\n      end = this.bytes.offset();\n\n      if (this.matchKeyword(Keywords.stream)) {\n        nestingLvl += 1;\n      } else if (\n        this.matchKeyword(Keywords.EOF1endstream) ||\n        this.matchKeyword(Keywords.EOF2endstream) ||\n        this.matchKeyword(Keywords.EOF3endstream) ||\n        this.matchKeyword(Keywords.endstream)\n      ) {\n        nestingLvl -= 1;\n      } else {\n        this.bytes.next();\n      }\n\n      if (nestingLvl === 0) break;\n    }\n\n    if (nestingLvl !== 0) throw new PDFStreamParsingError(startPos);\n\n    return end;\n  }\n}\n\nexport default PDFObjectParser;\n","import { ReparseError } from 'src/core/errors';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFRawStream from 'src/core/objects/PDFRawStream';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport ByteStream from 'src/core/parser/ByteStream';\nimport PDFObjectParser from 'src/core/parser/PDFObjectParser';\nimport { waitForTick } from 'src/utils';\n\nclass PDFObjectStreamParser extends PDFObjectParser {\n  static forStream = (\n    rawStream: PDFRawStream,\n    shouldWaitForTick?: () => boolean,\n  ) => new PDFObjectStreamParser(rawStream, shouldWaitForTick);\n\n  private alreadyParsed: boolean;\n  private readonly shouldWaitForTick: () => boolean;\n  private readonly firstOffset: number;\n  private readonly objectCount: number;\n\n  constructor(rawStream: PDFRawStream, shouldWaitForTick?: () => boolean) {\n    super(ByteStream.fromPDFRawStream(rawStream), rawStream.dict.context);\n\n    const { dict } = rawStream;\n\n    this.alreadyParsed = false;\n    this.shouldWaitForTick = shouldWaitForTick || (() => false);\n    this.firstOffset = dict.lookup(PDFName.of('First'), PDFNumber).asNumber();\n    this.objectCount = dict.lookup(PDFName.of('N'), PDFNumber).asNumber();\n  }\n\n  async parseIntoContext(): Promise<void> {\n    if (this.alreadyParsed) {\n      throw new ReparseError('PDFObjectStreamParser', 'parseIntoContext');\n    }\n    this.alreadyParsed = true;\n\n    const offsetsAndObjectNumbers = this.parseOffsetsAndObjectNumbers();\n    for (let idx = 0, len = offsetsAndObjectNumbers.length; idx < len; idx++) {\n      const { objectNumber, offset } = offsetsAndObjectNumbers[idx];\n      this.bytes.moveTo(this.firstOffset + offset);\n      const object = this.parseObject();\n      const ref = PDFRef.of(objectNumber, 0);\n      this.context.assign(ref, object);\n      if (this.shouldWaitForTick()) await waitForTick();\n    }\n  }\n\n  private parseOffsetsAndObjectNumbers(): {\n    objectNumber: number;\n    offset: number;\n  }[] {\n    const offsetsAndObjectNumbers = [];\n    for (let idx = 0, len = this.objectCount; idx < len; idx++) {\n      this.skipWhitespaceAndComments();\n      const objectNumber = this.parseRawInt();\n\n      this.skipWhitespaceAndComments();\n      const offset = this.parseRawInt();\n\n      offsetsAndObjectNumbers.push({ objectNumber, offset });\n    }\n    return offsetsAndObjectNumbers;\n  }\n}\n\nexport default PDFObjectStreamParser;\n","import { ReparseError } from 'src/core/errors';\nimport PDFArray from 'src/core/objects/PDFArray';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFNumber from 'src/core/objects/PDFNumber';\nimport PDFRawStream from 'src/core/objects/PDFRawStream';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport ByteStream from 'src/core/parser/ByteStream';\nimport PDFContext from 'src/core/PDFContext';\n\nexport interface Entry {\n  ref: PDFRef;\n  offset: number;\n  deleted: boolean;\n  inObjectStream: boolean;\n}\n\nclass PDFXRefStreamParser {\n  static forStream = (rawStream: PDFRawStream) =>\n    new PDFXRefStreamParser(rawStream);\n\n  private alreadyParsed: boolean;\n\n  private readonly dict: PDFDict;\n  private readonly context: PDFContext;\n  private readonly bytes: ByteStream;\n  private readonly subsections: {\n    firstObjectNumber: number;\n    length: number;\n  }[];\n  private readonly byteWidths: [number, number, number];\n\n  constructor(rawStream: PDFRawStream) {\n    this.alreadyParsed = false;\n\n    this.dict = rawStream.dict;\n    this.bytes = ByteStream.fromPDFRawStream(rawStream);\n    this.context = this.dict.context;\n\n    const Size = this.dict.lookup(PDFName.of('Size'), PDFNumber);\n\n    const Index = this.dict.lookup(PDFName.of('Index'));\n    if (Index instanceof PDFArray) {\n      this.subsections = [];\n      for (let idx = 0, len = Index.size(); idx < len; idx += 2) {\n        const firstObjectNumber = Index.lookup(idx + 0, PDFNumber).asNumber();\n        const length = Index.lookup(idx + 1, PDFNumber).asNumber();\n        this.subsections.push({ firstObjectNumber, length });\n      }\n    } else {\n      this.subsections = [{ firstObjectNumber: 0, length: Size.asNumber() }];\n    }\n\n    const W = this.dict.lookup(PDFName.of('W'), PDFArray);\n    this.byteWidths = [-1, -1, -1];\n    for (let idx = 0, len = W.size(); idx < len; idx++) {\n      this.byteWidths[idx] = W.lookup(idx, PDFNumber).asNumber();\n    }\n  }\n\n  parseIntoContext(): Entry[] {\n    if (this.alreadyParsed) {\n      throw new ReparseError('PDFXRefStreamParser', 'parseIntoContext');\n    }\n    this.alreadyParsed = true;\n\n    this.context.trailerInfo = {\n      Root: this.dict.get(PDFName.of('Root')),\n      Encrypt: this.dict.get(PDFName.of('Encrypt')),\n      Info: this.dict.get(PDFName.of('Info')),\n      ID: this.dict.get(PDFName.of('ID')),\n    };\n\n    const entries = this.parseEntries();\n\n    // for (let idx = 0, len = entries.length; idx < len; idx++) {\n    // const entry = entries[idx];\n    // if (entry.deleted) this.context.delete(entry.ref);\n    // }\n\n    return entries;\n  }\n\n  private parseEntries(): Entry[] {\n    const entries = [];\n    const [typeFieldWidth, offsetFieldWidth, genFieldWidth] = this.byteWidths;\n\n    for (\n      let subsectionIdx = 0, subsectionLen = this.subsections.length;\n      subsectionIdx < subsectionLen;\n      subsectionIdx++\n    ) {\n      const { firstObjectNumber, length } = this.subsections[subsectionIdx];\n\n      for (let objIdx = 0; objIdx < length; objIdx++) {\n        let type = 0;\n        for (let idx = 0, len = typeFieldWidth; idx < len; idx++) {\n          type = (type << 8) | this.bytes.next();\n        }\n\n        let offset = 0;\n        for (let idx = 0, len = offsetFieldWidth; idx < len; idx++) {\n          offset = (offset << 8) | this.bytes.next();\n        }\n\n        let generationNumber = 0;\n        for (let idx = 0, len = genFieldWidth; idx < len; idx++) {\n          generationNumber = (generationNumber << 8) | this.bytes.next();\n        }\n\n        // When the `type` field is absent, it defaults to 1\n        if (typeFieldWidth === 0) type = 1;\n\n        const objectNumber = firstObjectNumber + objIdx;\n        const entry = {\n          ref: PDFRef.of(objectNumber, generationNumber),\n          offset,\n          deleted: type === 0,\n          inObjectStream: type === 2,\n        };\n\n        entries.push(entry);\n      }\n    }\n\n    return entries;\n  }\n}\n\nexport default PDFXRefStreamParser;\n","import PDFCrossRefSection from 'src/core/document/PDFCrossRefSection';\nimport PDFHeader from 'src/core/document/PDFHeader';\nimport PDFTrailer from 'src/core/document/PDFTrailer';\nimport {\n  MissingKeywordError,\n  MissingPDFHeaderError,\n  PDFInvalidObjectParsingError,\n  ReparseError,\n  StalledParserError,\n} from 'src/core/errors';\nimport PDFDict from 'src/core/objects/PDFDict';\nimport PDFInvalidObject from 'src/core/objects/PDFInvalidObject';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFRawStream from 'src/core/objects/PDFRawStream';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport ByteStream from 'src/core/parser/ByteStream';\nimport PDFObjectParser from 'src/core/parser/PDFObjectParser';\nimport PDFObjectStreamParser from 'src/core/parser/PDFObjectStreamParser';\nimport PDFXRefStreamParser from 'src/core/parser/PDFXRefStreamParser';\nimport PDFContext from 'src/core/PDFContext';\nimport CharCodes from 'src/core/syntax/CharCodes';\nimport { Keywords } from 'src/core/syntax/Keywords';\nimport { IsDigit } from 'src/core/syntax/Numeric';\nimport { waitForTick } from 'src/utils';\n\nclass PDFParser extends PDFObjectParser {\n  static forBytesWithOptions = (\n    pdfBytes: Uint8Array,\n    objectsPerTick?: number,\n    throwOnInvalidObject?: boolean,\n    capNumbers?: boolean,\n  ) =>\n    new PDFParser(pdfBytes, objectsPerTick, throwOnInvalidObject, capNumbers);\n\n  private readonly objectsPerTick: number;\n  private readonly throwOnInvalidObject: boolean;\n  private alreadyParsed = false;\n  private parsedObjects = 0;\n\n  constructor(\n    pdfBytes: Uint8Array,\n    objectsPerTick = Infinity,\n    throwOnInvalidObject = false,\n    capNumbers = false,\n  ) {\n    super(ByteStream.of(pdfBytes), PDFContext.create(), capNumbers);\n    this.objectsPerTick = objectsPerTick;\n    this.throwOnInvalidObject = throwOnInvalidObject;\n  }\n\n  async parseDocument(): Promise<PDFContext> {\n    if (this.alreadyParsed) {\n      throw new ReparseError('PDFParser', 'parseDocument');\n    }\n    this.alreadyParsed = true;\n\n    this.context.header = this.parseHeader();\n\n    let prevOffset;\n    while (!this.bytes.done()) {\n      await this.parseDocumentSection();\n      const offset = this.bytes.offset();\n      if (offset === prevOffset) {\n        throw new StalledParserError(this.bytes.position());\n      }\n      prevOffset = offset;\n    }\n\n    this.maybeRecoverRoot();\n\n    if (this.context.lookup(PDFRef.of(0))) {\n      console.warn('Removing parsed object: 0 0 R');\n      this.context.delete(PDFRef.of(0));\n    }\n\n    return this.context;\n  }\n\n  private maybeRecoverRoot(): void {\n    const isValidCatalog = (obj?: PDFObject) =>\n      obj instanceof PDFDict &&\n      obj.lookup(PDFName.of('Type')) === PDFName.of('Catalog');\n\n    const catalog = this.context.lookup(this.context.trailerInfo.Root);\n\n    if (!isValidCatalog(catalog)) {\n      const indirectObjects = this.context.enumerateIndirectObjects();\n      for (let idx = 0, len = indirectObjects.length; idx < len; idx++) {\n        const [ref, object] = indirectObjects[idx];\n        if (isValidCatalog(object)) {\n          this.context.trailerInfo.Root = ref;\n        }\n      }\n    }\n  }\n\n  private parseHeader(): PDFHeader {\n    while (!this.bytes.done()) {\n      if (this.matchKeyword(Keywords.header)) {\n        const major = this.parseRawInt();\n        this.bytes.assertNext(CharCodes.Period);\n        const minor = this.parseRawInt();\n        const header = PDFHeader.forVersion(major, minor);\n        this.skipBinaryHeaderComment();\n        return header;\n      }\n      this.bytes.next();\n    }\n\n    throw new MissingPDFHeaderError(this.bytes.position());\n  }\n\n  private parseIndirectObjectHeader(): PDFRef {\n    this.skipWhitespaceAndComments();\n    const objectNumber = this.parseRawInt();\n\n    this.skipWhitespaceAndComments();\n    const generationNumber = this.parseRawInt();\n\n    this.skipWhitespaceAndComments();\n    if (!this.matchKeyword(Keywords.obj)) {\n      throw new MissingKeywordError(this.bytes.position(), Keywords.obj);\n    }\n\n    return PDFRef.of(objectNumber, generationNumber);\n  }\n\n  private matchIndirectObjectHeader(): boolean {\n    const initialOffset = this.bytes.offset();\n    try {\n      this.parseIndirectObjectHeader();\n      return true;\n    } catch (e) {\n      this.bytes.moveTo(initialOffset);\n      return false;\n    }\n  }\n\n  private shouldWaitForTick = () => {\n    this.parsedObjects += 1;\n    return this.parsedObjects % this.objectsPerTick === 0;\n  };\n\n  private async parseIndirectObject(): Promise<PDFRef> {\n    const ref = this.parseIndirectObjectHeader();\n\n    this.skipWhitespaceAndComments();\n    const object = this.parseObject();\n\n    this.skipWhitespaceAndComments();\n    // if (!this.matchKeyword(Keywords.endobj)) {\n    // throw new MissingKeywordError(this.bytes.position(), Keywords.endobj);\n    // }\n\n    // TODO: Log a warning if this fails...\n    this.matchKeyword(Keywords.endobj);\n\n    if (\n      object instanceof PDFRawStream &&\n      object.dict.lookup(PDFName.of('Type')) === PDFName.of('ObjStm')\n    ) {\n      await PDFObjectStreamParser.forStream(\n        object,\n        this.shouldWaitForTick,\n      ).parseIntoContext();\n    } else if (\n      object instanceof PDFRawStream &&\n      object.dict.lookup(PDFName.of('Type')) === PDFName.of('XRef')\n    ) {\n      PDFXRefStreamParser.forStream(object).parseIntoContext();\n    } else {\n      this.context.assign(ref, object);\n    }\n\n    return ref;\n  }\n\n  // TODO: Improve and clean this up\n  private tryToParseInvalidIndirectObject() {\n    const startPos = this.bytes.position();\n\n    const msg = `Trying to parse invalid object: ${JSON.stringify(startPos)})`;\n    if (this.throwOnInvalidObject) throw new Error(msg);\n    console.warn(msg);\n\n    const ref = this.parseIndirectObjectHeader();\n\n    console.warn(`Invalid object ref: ${ref}`);\n\n    this.skipWhitespaceAndComments();\n    const start = this.bytes.offset();\n\n    let failed = true;\n    while (!this.bytes.done()) {\n      if (this.matchKeyword(Keywords.endobj)) {\n        failed = false;\n      }\n      if (!failed) break;\n      this.bytes.next();\n    }\n\n    if (failed) throw new PDFInvalidObjectParsingError(startPos);\n\n    const end = this.bytes.offset() - Keywords.endobj.length;\n\n    const object = PDFInvalidObject.of(this.bytes.slice(start, end));\n    this.context.assign(ref, object);\n\n    return ref;\n  }\n\n  private async parseIndirectObjects(): Promise<void> {\n    this.skipWhitespaceAndComments();\n\n    while (!this.bytes.done() && IsDigit[this.bytes.peek()]) {\n      const initialOffset = this.bytes.offset();\n\n      try {\n        await this.parseIndirectObject();\n      } catch (e) {\n        // TODO: Add tracing/logging mechanism to track when this happens!\n        this.bytes.moveTo(initialOffset);\n        this.tryToParseInvalidIndirectObject();\n      }\n      this.skipWhitespaceAndComments();\n\n      // TODO: Can this be done only when needed, to avoid harming performance?\n      this.skipJibberish();\n\n      if (this.shouldWaitForTick()) await waitForTick();\n    }\n  }\n\n  private maybeParseCrossRefSection(): PDFCrossRefSection | void {\n    this.skipWhitespaceAndComments();\n    if (!this.matchKeyword(Keywords.xref)) return;\n    this.skipWhitespaceAndComments();\n\n    let objectNumber = -1;\n    const xref = PDFCrossRefSection.createEmpty();\n\n    while (!this.bytes.done() && IsDigit[this.bytes.peek()]) {\n      const firstInt = this.parseRawInt();\n      this.skipWhitespaceAndComments();\n\n      const secondInt = this.parseRawInt();\n      this.skipWhitespaceAndComments();\n\n      const byte = this.bytes.peek();\n      if (byte === CharCodes.n || byte === CharCodes.f) {\n        const ref = PDFRef.of(objectNumber, secondInt);\n        if (this.bytes.next() === CharCodes.n) {\n          xref.addEntry(ref, firstInt);\n        } else {\n          // this.context.delete(ref);\n          xref.addDeletedEntry(ref, firstInt);\n        }\n        objectNumber += 1;\n      } else {\n        objectNumber = firstInt;\n      }\n      this.skipWhitespaceAndComments();\n    }\n\n    return xref;\n  }\n\n  private maybeParseTrailerDict(): void {\n    this.skipWhitespaceAndComments();\n    if (!this.matchKeyword(Keywords.trailer)) return;\n    this.skipWhitespaceAndComments();\n\n    const dict = this.parseDict();\n\n    const { context } = this;\n    context.trailerInfo = {\n      Root: dict.get(PDFName.of('Root')) || context.trailerInfo.Root,\n      Encrypt: dict.get(PDFName.of('Encrypt')) || context.trailerInfo.Encrypt,\n      Info: dict.get(PDFName.of('Info')) || context.trailerInfo.Info,\n      ID: dict.get(PDFName.of('ID')) || context.trailerInfo.ID,\n    };\n  }\n\n  private maybeParseTrailer(): PDFTrailer | void {\n    this.skipWhitespaceAndComments();\n    if (!this.matchKeyword(Keywords.startxref)) return;\n    this.skipWhitespaceAndComments();\n\n    const offset = this.parseRawInt();\n\n    this.skipWhitespace();\n    this.matchKeyword(Keywords.eof);\n    this.skipWhitespaceAndComments();\n    this.matchKeyword(Keywords.eof);\n    this.skipWhitespaceAndComments();\n\n    return PDFTrailer.forLastCrossRefSectionOffset(offset);\n  }\n\n  private async parseDocumentSection(): Promise<void> {\n    await this.parseIndirectObjects();\n    this.maybeParseCrossRefSection();\n    this.maybeParseTrailerDict();\n    this.maybeParseTrailer();\n\n    // TODO: Can this be done only when needed, to avoid harming performance?\n    this.skipJibberish();\n  }\n\n  /**\n   * This operation is not necessary for valid PDF files. But some invalid PDFs\n   * contain jibberish in between indirect objects. This method is designed to\n   * skip past that jibberish, should it exist, until it reaches the next\n   * indirect object header, an xref table section, or the file trailer.\n   */\n  private skipJibberish(): void {\n    this.skipWhitespaceAndComments();\n    while (!this.bytes.done()) {\n      const initialOffset = this.bytes.offset();\n      const byte = this.bytes.peek();\n      const isAlphaNumeric = byte >= CharCodes.Space && byte <= CharCodes.Tilde;\n      if (isAlphaNumeric) {\n        if (\n          this.matchKeyword(Keywords.xref) ||\n          this.matchKeyword(Keywords.trailer) ||\n          this.matchKeyword(Keywords.startxref) ||\n          this.matchIndirectObjectHeader()\n        ) {\n          this.bytes.moveTo(initialOffset);\n          break;\n        }\n      }\n      this.bytes.next();\n    }\n  }\n\n  /**\n   * Skips the binary comment following a PDF header. The specification\n   * defines this binary comment (section 7.5.2 File Header) as a sequence of 4\n   * or more bytes that are 128 or greater, and which are preceded by a \"%\".\n   *\n   * This would imply that to strip out this binary comment, we could check for\n   * a sequence of bytes starting with \"%\", and remove all subsequent bytes that\n   * are 128 or greater. This works for many documents that properly comply with\n   * the spec. But in the wild, there are PDFs that omit the leading \"%\", and\n   * include bytes that are less than 128 (e.g. 0 or 1). So in order to parse\n   * these headers correctly, we just throw out all bytes leading up to the\n   * first indirect object header.\n   */\n  private skipBinaryHeaderComment(): void {\n    this.skipWhitespaceAndComments();\n    try {\n      const initialOffset = this.bytes.offset();\n      this.parseIndirectObjectHeader();\n      this.bytes.moveTo(initialOffset);\n    } catch (e) {\n      this.bytes.next();\n      this.skipWhitespaceAndComments();\n    }\n  }\n}\n\nexport default PDFParser;\n","const flag = (bitIndex: number) => 1 << bitIndex;\n\n/** From PDF spec table 165 */\nexport enum AnnotationFlags {\n  /**\n   * If set, do not display the annotation if it does not belong to one of the\n   * standard annotation types and no annotation handler is available. If clear,\n   * display such an unknown annotation using an appearance stream specified by\n   * its appearance dictionary, if any.\n   */\n  Invisible = flag(1 - 1),\n\n  /**\n   * If set, do not display or print the annotation or allow it to interact with\n   * the user, regardless of its annotation type or whether an annotation\n   * handler is available.\n   *\n   * In cases where screen space is limited, the ability to hide and show\n   * annotations selectively can be used in combination with appearance streams\n   * to display auxiliary pop-up information similar in function to online help\n   * systems.\n   */\n  Hidden = flag(2 - 1),\n\n  /**\n   * If set, print the annotation when the page is printed. If clear, never\n   * print the annotation, regardless of whether it is displayed on the screen.\n   *\n   * This can be useful for annotations representing interactive pushbuttons,\n   * which would serve no meaningful purpose on the printed page.\n   */\n  Print = flag(3 - 1),\n\n  /**\n   * If set, do not scale the annotation’s appearance to match the magnification\n   * of the page. The location of the annotation on the page (defined by the\n   * upper-left corner of its annotation rectangle) shall remain fixed,\n   * regardless of the page magnification.\n   */\n  NoZoom = flag(4 - 1),\n\n  /**\n   * If set, do not rotate the annotation’s appearance to match the rotation of\n   * the page. The upper-left corner of the annotation rectangle shall remain in\n   * a fixed location on the page, regardless of the page rotation.\n   */\n  NoRotate = flag(5 - 1),\n\n  /**\n   * If set, do not display the annotation on the screen or allow it to interact\n   * with the user. The annotation may be printed (depending on the setting of\n   * the Print flag) but should be considered hidden for purposes of on-screen\n   * display and user interaction.\n   */\n  NoView = flag(6 - 1),\n\n  /**\n   * If set, do not allow the annotation to interact with the user. The\n   * annotation may be displayed or printed (depending on the settings of the\n   * NoView and Print flags) but should not respond to mouse clicks or change\n   * its appearance in response to mouse motions.\n   *\n   * This flag shall be ignored for widget annotations; its function is\n   * subsumed by the ReadOnly flag of the associated form field.\n   */\n  ReadOnly = flag(7 - 1),\n\n  /**\n   * If set, do not allow the annotation to be deleted or its properties\n   * (including position and size) to be modified by the user. However, this\n   * flag does not restrict changes to the annotation’s contents, such as the\n   * value of a form field.\n   */\n  Locked = flag(8 - 1),\n\n  /**\n   * If set, invert the interpretation of the NoView flag for certain events.\n   *\n   * A typical use is to have an annotation that appears only when a mouse\n   * cursor is held over it.\n   */\n  ToggleNoView = flag(9 - 1),\n\n  /**\n   * If set, do not allow the contents of the annotation to be modified by the\n   * user. This flag does not restrict deletion of the annotation or changes to\n   * other annotation properties, such as position and size.\n   */\n  LockedContents = flag(10 - 1)\n}\n","import { PDFName, PDFNumber } from 'src/core';\n\nexport const asPDFName = (name: string | PDFName) =>\n  name instanceof PDFName ? name : PDFName.of(name);\n\nexport const asPDFNumber = (num: number | PDFNumber) =>\n  num instanceof PDFNumber ? num : PDFNumber.of(num);\n\nexport const asNumber = (num: number | PDFNumber) =>\n  num instanceof PDFNumber ? num.asNumber() : num;\n","import { assertIs, error } from 'src/utils';\n\nexport enum RotationTypes {\n  Degrees = 'degrees',\n  Radians = 'radians'\n}\n\nexport interface Radians {\n  type: RotationTypes.Radians;\n  angle: number;\n}\n\nexport interface Degrees {\n  type: RotationTypes.Degrees;\n  angle: number;\n}\n\nexport type Rotation = Radians | Degrees;\n\nexport const radians = (radianAngle: number): Radians => {\n  assertIs(radianAngle, 'radianAngle', ['number']);\n  return { type: RotationTypes.Radians, angle: radianAngle };\n};\n\nexport const degrees = (degreeAngle: number): Degrees => {\n  assertIs(degreeAngle, 'degreeAngle', ['number']);\n  return { type: RotationTypes.Degrees, angle: degreeAngle };\n};\n\nconst { Radians, Degrees } = RotationTypes;\n\nexport const degreesToRadians = (degree: number) => (degree * Math.PI) / 180;\nexport const radiansToDegrees = (radian: number) => (radian * 180) / Math.PI;\n\n// prettier-ignore\nexport const toRadians = (rotation: Rotation) => \n  rotation.type === Radians ? rotation.angle\n    : rotation.type === Degrees ? degreesToRadians(rotation.angle)\n      : error(`Invalid rotation: ${JSON.stringify(rotation)}`);\n\n// prettier-ignore\nexport const toDegrees = (rotation: Rotation) => \n  rotation.type === Radians ? radiansToDegrees(rotation.angle)\n    : rotation.type === Degrees ? rotation.angle\n      : error(`Invalid rotation: ${JSON.stringify(rotation)}`);\n\nexport const reduceRotation = (degreeAngle = 0) => {\n  const quadrants = (degreeAngle / 90) % 4;\n  if (quadrants === 0) return 0;\n  if (quadrants === 1) return 90;\n  if (quadrants === 2) return 180;\n  if (quadrants === 3) return 270;\n  return 0; // `degreeAngle` is not a multiple of 90\n};\n\nexport const adjustDimsForRotation = (\n  dims: { width: number; height: number },\n  degreeAngle = 0,\n) => {\n  const rotation = reduceRotation(degreeAngle);\n  return rotation === 90 || rotation === 270\n    ? { width: dims.height, height: dims.width }\n    : { width: dims.width, height: dims.height };\n};\n\nexport const rotateRectangle = (\n  rectangle: {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  },\n  borderWidth = 0,\n  degreeAngle = 0,\n) => {\n  const { x, y, width: w, height: h } = rectangle;\n\n  const r = reduceRotation(degreeAngle);\n  const b = borderWidth / 2;\n\n  // prettier-ignore\n  if (r === 0) return { x: x - b, y: y - b, width: w, height: h };\n  else if (r === 90) return { x: x - h + b, y: y - b, width: h, height: w };\n  else if (r === 180) return { x: x - w + b, y: y - h + b, width: w, height: h };\n  else if (r === 270) return { x: x - b, y: y - w + b, width: h, height: w };\n  else return { x: x - b, y: y - b, width: w, height: h };\n};\n","import { asNumber, asPDFName, asPDFNumber } from 'src/api/objects';\nimport { degreesToRadians } from 'src/api/rotations';\nimport {\n  PDFHexString,\n  PDFName,\n  PDFNumber,\n  PDFOperator,\n  PDFOperatorNames as Ops,\n} from 'src/core';\n\n/* ==================== Clipping Path Operators ==================== */\n\nexport const clip = () => PDFOperator.of(Ops.ClipNonZero);\nexport const clipEvenOdd = () => PDFOperator.of(Ops.ClipEvenOdd);\n\n/* ==================== Graphics State Operators ==================== */\n\nconst { cos, sin, tan } = Math;\n\nexport const concatTransformationMatrix = (\n  a: number | PDFNumber,\n  b: number | PDFNumber,\n  c: number | PDFNumber,\n  d: number | PDFNumber,\n  e: number | PDFNumber,\n  f: number | PDFNumber,\n) =>\n  PDFOperator.of(Ops.ConcatTransformationMatrix, [\n    asPDFNumber(a),\n    asPDFNumber(b),\n    asPDFNumber(c),\n    asPDFNumber(d),\n    asPDFNumber(e),\n    asPDFNumber(f),\n  ]);\n\nexport const translate = (xPos: number | PDFNumber, yPos: number | PDFNumber) =>\n  concatTransformationMatrix(1, 0, 0, 1, xPos, yPos);\n\nexport const scale = (xPos: number | PDFNumber, yPos: number | PDFNumber) =>\n  concatTransformationMatrix(xPos, 0, 0, yPos, 0, 0);\n\nexport const rotateRadians = (angle: number | PDFNumber) =>\n  concatTransformationMatrix(\n    cos(asNumber(angle)),\n    sin(asNumber(angle)),\n    -sin(asNumber(angle)),\n    cos(asNumber(angle)),\n    0,\n    0,\n  );\n\nexport const rotateDegrees = (angle: number | PDFNumber) =>\n  rotateRadians(degreesToRadians(asNumber(angle)));\n\nexport const skewRadians = (\n  xSkewAngle: number | PDFNumber,\n  ySkewAngle: number | PDFNumber,\n) =>\n  concatTransformationMatrix(\n    1,\n    tan(asNumber(xSkewAngle)),\n    tan(asNumber(ySkewAngle)),\n    1,\n    0,\n    0,\n  );\n\nexport const skewDegrees = (\n  xSkewAngle: number | PDFNumber,\n  ySkewAngle: number | PDFNumber,\n) =>\n  skewRadians(\n    degreesToRadians(asNumber(xSkewAngle)),\n    degreesToRadians(asNumber(ySkewAngle)),\n  );\n\nexport const setDashPattern = (\n  dashArray: (number | PDFNumber)[],\n  dashPhase: number | PDFNumber,\n) =>\n  PDFOperator.of(Ops.SetLineDashPattern, [\n    `[${dashArray.map(asPDFNumber).join(' ')}]`,\n    asPDFNumber(dashPhase),\n  ]);\n\nexport const restoreDashPattern = () => setDashPattern([], 0);\n\nexport enum LineCapStyle {\n  Butt = 0,\n  Round = 1,\n  Projecting = 2\n}\n\nexport const setLineCap = (style: LineCapStyle) =>\n  PDFOperator.of(Ops.SetLineCapStyle, [asPDFNumber(style)]);\n\nexport enum LineJoinStyle {\n  Miter = 0,\n  Round = 1,\n  Bevel = 2\n}\n\nexport const setLineJoin = (style: LineJoinStyle) =>\n  PDFOperator.of(Ops.SetLineJoinStyle, [asPDFNumber(style)]);\n\nexport const setGraphicsState = (state: string | PDFName) =>\n  PDFOperator.of(Ops.SetGraphicsStateParams, [asPDFName(state)]);\n\nexport const pushGraphicsState = () => PDFOperator.of(Ops.PushGraphicsState);\n\nexport const popGraphicsState = () => PDFOperator.of(Ops.PopGraphicsState);\n\nexport const setLineWidth = (width: number | PDFNumber) =>\n  PDFOperator.of(Ops.SetLineWidth, [asPDFNumber(width)]);\n\n/* ==================== Path Construction Operators ==================== */\n\nexport const appendBezierCurve = (\n  x1: number | PDFNumber,\n  y1: number | PDFNumber,\n  x2: number | PDFNumber,\n  y2: number | PDFNumber,\n  x3: number | PDFNumber,\n  y3: number | PDFNumber,\n) =>\n  PDFOperator.of(Ops.AppendBezierCurve, [\n    asPDFNumber(x1),\n    asPDFNumber(y1),\n    asPDFNumber(x2),\n    asPDFNumber(y2),\n    asPDFNumber(x3),\n    asPDFNumber(y3),\n  ]);\n\nexport const appendQuadraticCurve = (\n  x1: number | PDFNumber,\n  y1: number | PDFNumber,\n  x2: number | PDFNumber,\n  y2: number | PDFNumber,\n) =>\n  PDFOperator.of(Ops.CurveToReplicateInitialPoint, [\n    asPDFNumber(x1),\n    asPDFNumber(y1),\n    asPDFNumber(x2),\n    asPDFNumber(y2),\n  ]);\n\nexport const closePath = () => PDFOperator.of(Ops.ClosePath);\n\nexport const moveTo = (xPos: number | PDFNumber, yPos: number | PDFNumber) =>\n  PDFOperator.of(Ops.MoveTo, [asPDFNumber(xPos), asPDFNumber(yPos)]);\n\nexport const lineTo = (xPos: number | PDFNumber, yPos: number | PDFNumber) =>\n  PDFOperator.of(Ops.LineTo, [asPDFNumber(xPos), asPDFNumber(yPos)]);\n\n/**\n * @param xPos x coordinate for the lower left corner of the rectangle\n * @param yPos y coordinate for the lower left corner of the rectangle\n * @param width width of the rectangle\n * @param height height of the rectangle\n */\nexport const rectangle = (\n  xPos: number | PDFNumber,\n  yPos: number | PDFNumber,\n  width: number | PDFNumber,\n  height: number | PDFNumber,\n) =>\n  PDFOperator.of(Ops.AppendRectangle, [\n    asPDFNumber(xPos),\n    asPDFNumber(yPos),\n    asPDFNumber(width),\n    asPDFNumber(height),\n  ]);\n\n/**\n * @param xPos x coordinate for the lower left corner of the square\n * @param yPos y coordinate for the lower left corner of the square\n * @param size width and height of the square\n */\nexport const square = (xPos: number, yPos: number, size: number) =>\n  rectangle(xPos, yPos, size, size);\n\n/* ==================== Path Painting Operators ==================== */\n\nexport const stroke = () => PDFOperator.of(Ops.StrokePath);\n\nexport const fill = () => PDFOperator.of(Ops.FillNonZero);\n\nexport const fillAndStroke = () => PDFOperator.of(Ops.FillNonZeroAndStroke);\n\nexport const endPath = () => PDFOperator.of(Ops.EndPath);\n\n/* ==================== Text Positioning Operators ==================== */\n\nexport const nextLine = () => PDFOperator.of(Ops.NextLine);\n\nexport const moveText = (x: number | PDFNumber, y: number | PDFNumber) =>\n  PDFOperator.of(Ops.MoveText, [asPDFNumber(x), asPDFNumber(y)]);\n\n/* ==================== Text Showing Operators ==================== */\n\nexport const showText = (text: PDFHexString) =>\n  PDFOperator.of(Ops.ShowText, [text]);\n\n/* ==================== Text State Operators ==================== */\n\nexport const beginText = () => PDFOperator.of(Ops.BeginText);\nexport const endText = () => PDFOperator.of(Ops.EndText);\n\nexport const setFontAndSize = (\n  name: string | PDFName,\n  size: number | PDFNumber,\n) => PDFOperator.of(Ops.SetFontAndSize, [asPDFName(name), asPDFNumber(size)]);\n\nexport const setCharacterSpacing = (spacing: number | PDFNumber) =>\n  PDFOperator.of(Ops.SetCharacterSpacing, [asPDFNumber(spacing)]);\n\nexport const setWordSpacing = (spacing: number | PDFNumber) =>\n  PDFOperator.of(Ops.SetWordSpacing, [asPDFNumber(spacing)]);\n\n/** @param squeeze horizontal character spacing */\nexport const setCharacterSqueeze = (squeeze: number | PDFNumber) =>\n  PDFOperator.of(Ops.SetTextHorizontalScaling, [asPDFNumber(squeeze)]);\n\nexport const setLineHeight = (lineHeight: number | PDFNumber) =>\n  PDFOperator.of(Ops.SetTextLineHeight, [asPDFNumber(lineHeight)]);\n\nexport const setTextRise = (rise: number | PDFNumber) =>\n  PDFOperator.of(Ops.SetTextRise, [asPDFNumber(rise)]);\n\nexport enum TextRenderingMode {\n  Fill = 0,\n  Outline = 1,\n  FillAndOutline = 2,\n  Invisible = 3,\n  FillAndClip = 4,\n  OutlineAndClip = 5,\n  FillAndOutlineAndClip = 6,\n  Clip = 7\n}\n\nexport const setTextRenderingMode = (mode: TextRenderingMode) =>\n  PDFOperator.of(Ops.SetTextRenderingMode, [asPDFNumber(mode)]);\n\nexport const setTextMatrix = (\n  a: number | PDFNumber,\n  b: number | PDFNumber,\n  c: number | PDFNumber,\n  d: number | PDFNumber,\n  e: number | PDFNumber,\n  f: number | PDFNumber,\n) =>\n  PDFOperator.of(Ops.SetTextMatrix, [\n    asPDFNumber(a),\n    asPDFNumber(b),\n    asPDFNumber(c),\n    asPDFNumber(d),\n    asPDFNumber(e),\n    asPDFNumber(f),\n  ]);\n\nexport const rotateAndSkewTextRadiansAndTranslate = (\n  rotationAngle: number | PDFNumber,\n  xSkewAngle: number | PDFNumber,\n  ySkewAngle: number | PDFNumber,\n  x: number | PDFNumber,\n  y: number | PDFNumber,\n) =>\n  setTextMatrix(\n    cos(asNumber(rotationAngle)),\n    sin(asNumber(rotationAngle)) + tan(asNumber(xSkewAngle)),\n    -sin(asNumber(rotationAngle)) + tan(asNumber(ySkewAngle)),\n    cos(asNumber(rotationAngle)),\n    x,\n    y,\n  );\n\nexport const rotateAndSkewTextDegreesAndTranslate = (\n  rotationAngle: number | PDFNumber,\n  xSkewAngle: number | PDFNumber,\n  ySkewAngle: number | PDFNumber,\n  x: number | PDFNumber,\n  y: number | PDFNumber,\n) =>\n  rotateAndSkewTextRadiansAndTranslate(\n    degreesToRadians(asNumber(rotationAngle)),\n    degreesToRadians(asNumber(xSkewAngle)),\n    degreesToRadians(asNumber(ySkewAngle)),\n    x,\n    y,\n  );\n\n/* ==================== XObject Operator ==================== */\n\nexport const drawObject = (name: string | PDFName) =>\n  PDFOperator.of(Ops.DrawObject, [asPDFName(name)]);\n\n/* ==================== Color Operators ==================== */\n\nexport const setFillingGrayscaleColor = (gray: number | PDFNumber) =>\n  PDFOperator.of(Ops.NonStrokingColorGray, [asPDFNumber(gray)]);\n\nexport const setStrokingGrayscaleColor = (gray: number | PDFNumber) =>\n  PDFOperator.of(Ops.StrokingColorGray, [asPDFNumber(gray)]);\n\nexport const setFillingRgbColor = (\n  red: number | PDFNumber,\n  green: number | PDFNumber,\n  blue: number | PDFNumber,\n) =>\n  PDFOperator.of(Ops.NonStrokingColorRgb, [\n    asPDFNumber(red),\n    asPDFNumber(green),\n    asPDFNumber(blue),\n  ]);\n\nexport const setStrokingRgbColor = (\n  red: number | PDFNumber,\n  green: number | PDFNumber,\n  blue: number | PDFNumber,\n) =>\n  PDFOperator.of(Ops.StrokingColorRgb, [\n    asPDFNumber(red),\n    asPDFNumber(green),\n    asPDFNumber(blue),\n  ]);\n\nexport const setFillingCmykColor = (\n  cyan: number | PDFNumber,\n  magenta: number | PDFNumber,\n  yellow: number | PDFNumber,\n  key: number | PDFNumber,\n) =>\n  PDFOperator.of(Ops.NonStrokingColorCmyk, [\n    asPDFNumber(cyan),\n    asPDFNumber(magenta),\n    asPDFNumber(yellow),\n    asPDFNumber(key),\n  ]);\n\nexport const setStrokingCmykColor = (\n  cyan: number | PDFNumber,\n  magenta: number | PDFNumber,\n  yellow: number | PDFNumber,\n  key: number | PDFNumber,\n) =>\n  PDFOperator.of(Ops.StrokingColorCmyk, [\n    asPDFNumber(cyan),\n    asPDFNumber(magenta),\n    asPDFNumber(yellow),\n    asPDFNumber(key),\n  ]);\n\n/* ==================== Marked Content Operators ==================== */\n\nexport const beginMarkedContent = (tag: string | PDFName) =>\n  PDFOperator.of(Ops.BeginMarkedContent, [asPDFName(tag)]);\n\nexport const endMarkedContent = () => PDFOperator.of(Ops.EndMarkedContent);\n","import {\n  setFillingCmykColor,\n  setFillingGrayscaleColor,\n  setFillingRgbColor,\n  setStrokingCmykColor,\n  setStrokingGrayscaleColor,\n  setStrokingRgbColor,\n} from 'src/api/operators';\nimport { assertRange, error } from 'src/utils';\n\nexport enum ColorTypes {\n  Grayscale = 'Grayscale',\n  RGB = 'RGB',\n  CMYK = 'CMYK'\n}\n\nexport interface Grayscale {\n  type: ColorTypes.Grayscale;\n  gray: number;\n}\n\nexport interface RGB {\n  type: ColorTypes.RGB;\n  red: number;\n  green: number;\n  blue: number;\n}\n\nexport interface CMYK {\n  type: ColorTypes.CMYK;\n  cyan: number;\n  magenta: number;\n  yellow: number;\n  key: number;\n}\n\nexport type Color = Grayscale | RGB | CMYK;\n\nexport const grayscale = (gray: number): Grayscale => {\n  assertRange(gray, 'gray', 0.0, 1.0);\n  return { type: ColorTypes.Grayscale, gray };\n};\n\nexport const rgb = (red: number, green: number, blue: number): RGB => {\n  assertRange(red, 'red', 0, 1);\n  assertRange(green, 'green', 0, 1);\n  assertRange(blue, 'blue', 0, 1);\n  return { type: ColorTypes.RGB, red, green, blue };\n};\n\nexport const cmyk = (\n  cyan: number,\n  magenta: number,\n  yellow: number,\n  key: number,\n): CMYK => {\n  assertRange(cyan, 'cyan', 0, 1);\n  assertRange(magenta, 'magenta', 0, 1);\n  assertRange(yellow, 'yellow', 0, 1);\n  assertRange(key, 'key', 0, 1);\n  return { type: ColorTypes.CMYK, cyan, magenta, yellow, key };\n};\n\nconst { Grayscale, RGB, CMYK } = ColorTypes;\n\n// prettier-ignore\nexport const setFillingColor = (color: Color) => \n  color.type === Grayscale ? setFillingGrayscaleColor(color.gray)\n    : color.type === RGB       ? setFillingRgbColor(color.red, color.green, color.blue)\n      : color.type === CMYK      ? setFillingCmykColor(color.cyan, color.magenta, color.yellow, color.key)\n        : error(`Invalid color: ${JSON.stringify(color)}`);\n\n// prettier-ignore\nexport const setStrokingColor = (color: Color) => \n  color.type === Grayscale ? setStrokingGrayscaleColor(color.gray)\n    : color.type === RGB       ? setStrokingRgbColor(color.red, color.green, color.blue)\n      : color.type === CMYK      ? setStrokingCmykColor(color.cyan, color.magenta, color.yellow, color.key)\n        : error(`Invalid color: ${JSON.stringify(color)}`);\n\n// prettier-ignore\nexport const componentsToColor = (comps?: number[], scale = 1) => (\n  comps?.length === 1 ? grayscale(\n    comps[0] * scale,\n  )\n    : comps?.length === 3 ? rgb(\n      comps[0] * scale, \n      comps[1] * scale, \n      comps[2] * scale,\n    )\n      : comps?.length === 4 ? cmyk(\n        comps[0] * scale, \n        comps[1] * scale, \n        comps[2] * scale, \n        comps[3] * scale,\n      )\n        : undefined\n);\n\n// prettier-ignore\nexport const colorToComponents = (color: Color) =>\n  color.type === Grayscale ? [color.gray]\n    : color.type === RGB       ? [color.red, color.green, color.blue]\n      : color.type === CMYK      ? [color.cyan, color.magenta, color.yellow, color.key]\n        : error(`Invalid color: ${JSON.stringify(color)}`);\n","// Originated from pdfkit Copyright (c) 2014 Devon Govett\n// https://github.com/foliojs/pdfkit/blob/1e62e6ffe24b378eb890df507a47610f4c4a7b24/lib/path.js\n// MIT LICENSE\n// Updated for pdf-lib & TypeScript by Jeremy Messenger\n\nimport {\n  appendBezierCurve,\n  appendQuadraticCurve,\n  closePath,\n  lineTo,\n  moveTo,\n} from 'src/api/operators';\nimport { PDFOperator } from 'src/core';\n\nlet cx: number = 0;\nlet cy: number = 0;\nlet px: number | null = 0;\nlet py: number | null = 0;\nlet sx: number = 0;\nlet sy: number = 0;\n\nconst parameters = new Map<string, number>([\n  ['A', 7],\n  ['a', 7],\n  ['C', 6],\n  ['c', 6],\n  ['H', 1],\n  ['h', 1],\n  ['L', 2],\n  ['l', 2],\n  ['M', 2],\n  ['m', 2],\n  ['Q', 4],\n  ['q', 4],\n  ['S', 4],\n  ['s', 4],\n  ['T', 2],\n  ['t', 2],\n  ['V', 1],\n  ['v', 1],\n  ['Z', 0],\n  ['z', 0],\n]);\n\ninterface Cmd {\n  cmd?: string;\n  args: number[];\n}\n\nconst parse = (path: string) => {\n  let cmd;\n  const ret: Cmd[] = [];\n  let args: number[] = [];\n  let curArg = '';\n  let foundDecimal = false;\n  let params = 0;\n\n  for (const c of path) {\n    if (parameters.has(c)) {\n      params = parameters.get(c)!;\n      if (cmd) {\n        // save existing command\n        if (curArg.length > 0) {\n          args[args.length] = +curArg;\n        }\n        ret[ret.length] = { cmd, args };\n\n        args = [];\n        curArg = '';\n        foundDecimal = false;\n      }\n\n      cmd = c;\n    } else if (\n      [' ', ','].includes(c) ||\n      (c === '-' && curArg.length > 0 && curArg[curArg.length - 1] !== 'e') ||\n      (c === '.' && foundDecimal)\n    ) {\n      if (curArg.length === 0) {\n        continue;\n      }\n\n      if (args.length === params) {\n        // handle reused commands\n        ret[ret.length] = { cmd, args };\n        args = [+curArg];\n\n        // handle assumed commands\n        if (cmd === 'M') {\n          cmd = 'L';\n        }\n        if (cmd === 'm') {\n          cmd = 'l';\n        }\n      } else {\n        args[args.length] = +curArg;\n      }\n\n      foundDecimal = c === '.';\n\n      // fix for negative numbers or repeated decimals with no delimeter between commands\n      curArg = ['-', '.'].includes(c) ? c : '';\n    } else {\n      curArg += c;\n      if (c === '.') {\n        foundDecimal = true;\n      }\n    }\n  }\n\n  // add the last command\n  if (curArg.length > 0) {\n    if (args.length === params) {\n      // handle reused commands\n      ret[ret.length] = { cmd, args };\n      args = [+curArg];\n\n      // handle assumed commands\n      if (cmd === 'M') {\n        cmd = 'L';\n      }\n      if (cmd === 'm') {\n        cmd = 'l';\n      }\n    } else {\n      args[args.length] = +curArg;\n    }\n  }\n\n  ret[ret.length] = { cmd, args };\n\n  return ret;\n};\n\nconst apply = (commands: Cmd[]) => {\n  // current point, control point, and subpath starting point\n  cx = cy = px = py = sx = sy = 0;\n\n  // run the commands\n  let cmds: PDFOperator[] = [];\n  for (let i = 0; i < commands.length; i++) {\n    const c = commands[i];\n    if (c.cmd && typeof runners[c.cmd] === 'function') {\n      const cmd = runners[c.cmd](c.args);\n      if (Array.isArray(cmd)) {\n        cmds = cmds.concat(cmd);\n      } else {\n        cmds.push(cmd);\n      }\n    }\n  }\n  return cmds;\n};\n\ninterface CmdToOperatorsMap {\n  [cmd: string]: (a: number[]) => PDFOperator | PDFOperator[];\n}\n\nconst runners: CmdToOperatorsMap = {\n  M(a) {\n    cx = a[0];\n    cy = a[1];\n    px = py = null;\n    sx = cx;\n    sy = cy;\n    return moveTo(cx, cy);\n  },\n\n  m(a) {\n    cx += a[0];\n    cy += a[1];\n    px = py = null;\n    sx = cx;\n    sy = cy;\n    return moveTo(cx, cy);\n  },\n\n  C(a) {\n    cx = a[4];\n    cy = a[5];\n    px = a[2];\n    py = a[3];\n    return appendBezierCurve(a[0], a[1], a[2], a[3], a[4], a[5]);\n  },\n\n  c(a) {\n    const cmd = appendBezierCurve(\n      a[0] + cx,\n      a[1] + cy,\n      a[2] + cx,\n      a[3] + cy,\n      a[4] + cx,\n      a[5] + cy,\n    );\n    px = cx + a[2];\n    py = cy + a[3];\n    cx += a[4];\n    cy += a[5];\n    return cmd;\n  },\n\n  S(a) {\n    if (px === null || py === null) {\n      px = cx;\n      py = cy;\n    }\n\n    const cmd = appendBezierCurve(\n      cx - (px - cx),\n      cy - (py - cy),\n      a[0],\n      a[1],\n      a[2],\n      a[3],\n    );\n    px = a[0];\n    py = a[1];\n    cx = a[2];\n    cy = a[3];\n    return cmd;\n  },\n\n  s(a) {\n    if (px === null || py === null) {\n      px = cx;\n      py = cy;\n    }\n\n    const cmd = appendBezierCurve(\n      cx - (px - cx),\n      cy - (py - cy),\n      cx + a[0],\n      cy + a[1],\n      cx + a[2],\n      cy + a[3],\n    );\n    px = cx + a[0];\n    py = cy + a[1];\n    cx += a[2];\n    cy += a[3];\n    return cmd;\n  },\n\n  Q(a) {\n    px = a[0];\n    py = a[1];\n    cx = a[2];\n    cy = a[3];\n    return appendQuadraticCurve(a[0], a[1], cx, cy);\n  },\n\n  q(a) {\n    const cmd = appendQuadraticCurve(\n      a[0] + cx,\n      a[1] + cy,\n      a[2] + cx,\n      a[3] + cy,\n    );\n    px = cx + a[0];\n    py = cy + a[1];\n    cx += a[2];\n    cy += a[3];\n    return cmd;\n  },\n\n  T(a) {\n    if (px === null || py === null) {\n      px = cx;\n      py = cy;\n    } else {\n      px = cx - (px - cx);\n      py = cy - (py - cy);\n    }\n\n    const cmd = appendQuadraticCurve(px, py, a[0], a[1]);\n    px = cx - (px - cx);\n    py = cy - (py - cy);\n    cx = a[0];\n    cy = a[1];\n    return cmd;\n  },\n\n  t(a) {\n    if (px === null || py === null) {\n      px = cx;\n      py = cy;\n    } else {\n      px = cx - (px - cx);\n      py = cy - (py - cy);\n    }\n\n    const cmd = appendQuadraticCurve(px, py, cx + a[0], cy + a[1]);\n    cx += a[0];\n    cy += a[1];\n    return cmd;\n  },\n\n  A(a) {\n    const cmds = solveArc(cx, cy, a);\n    cx = a[5];\n    cy = a[6];\n    return cmds;\n  },\n\n  a(a) {\n    a[5] += cx;\n    a[6] += cy;\n    const cmds = solveArc(cx, cy, a);\n    cx = a[5];\n    cy = a[6];\n    return cmds;\n  },\n\n  L(a) {\n    cx = a[0];\n    cy = a[1];\n    px = py = null;\n    return lineTo(cx, cy);\n  },\n\n  l(a) {\n    cx += a[0];\n    cy += a[1];\n    px = py = null;\n    return lineTo(cx, cy);\n  },\n\n  H(a) {\n    cx = a[0];\n    px = py = null;\n    return lineTo(cx, cy);\n  },\n\n  h(a) {\n    cx += a[0];\n    px = py = null;\n    return lineTo(cx, cy);\n  },\n\n  V(a) {\n    cy = a[0];\n    px = py = null;\n    return lineTo(cx, cy);\n  },\n\n  v(a) {\n    cy += a[0];\n    px = py = null;\n    return lineTo(cx, cy);\n  },\n\n  Z() {\n    const cmd = closePath();\n    cx = sx;\n    cy = sy;\n    return cmd;\n  },\n\n  z() {\n    const cmd = closePath();\n    cx = sx;\n    cy = sy;\n    return cmd;\n  },\n};\n\nconst solveArc = (x: number, y: number, coords: number[]) => {\n  const [rx, ry, rot, large, sweep, ex, ey] = coords;\n  const segs = arcToSegments(ex, ey, rx, ry, large, sweep, rot, x, y);\n\n  const cmds: PDFOperator[] = [];\n  for (const seg of segs) {\n    const bez = segmentToBezier(...seg);\n    cmds.push(appendBezierCurve(...bez));\n  }\n  return cmds;\n};\n\ntype Segment = [number, number, number, number, number, number, number, number];\ntype Bezier = [number, number, number, number, number, number];\n\n// from Inkscape svgtopdf, thanks!\nconst arcToSegments = (\n  x: number,\n  y: number,\n  rx: number,\n  ry: number,\n  large: number,\n  sweep: number,\n  rotateX: number,\n  ox: number,\n  oy: number,\n) => {\n  const th = rotateX * (Math.PI / 180);\n  const sinTh = Math.sin(th);\n  const cosTh = Math.cos(th);\n  rx = Math.abs(rx);\n  ry = Math.abs(ry);\n  px = cosTh * (ox - x) * 0.5 + sinTh * (oy - y) * 0.5;\n  py = cosTh * (oy - y) * 0.5 - sinTh * (ox - x) * 0.5;\n  let pl = (px * px) / (rx * rx) + (py * py) / (ry * ry);\n  if (pl > 1) {\n    pl = Math.sqrt(pl);\n    rx *= pl;\n    ry *= pl;\n  }\n\n  const a00 = cosTh / rx;\n  const a01 = sinTh / rx;\n  const a10 = -sinTh / ry;\n  const a11 = cosTh / ry;\n  const x0 = a00 * ox + a01 * oy;\n  const y0 = a10 * ox + a11 * oy;\n  const x1 = a00 * x + a01 * y;\n  const y1 = a10 * x + a11 * y;\n\n  const d = (x1 - x0) * (x1 - x0) + (y1 - y0) * (y1 - y0);\n  let sfactorSq = 1 / d - 0.25;\n  if (sfactorSq < 0) {\n    sfactorSq = 0;\n  }\n  let sfactor = Math.sqrt(sfactorSq);\n  if (sweep === large) {\n    sfactor = -sfactor;\n  }\n\n  const xc = 0.5 * (x0 + x1) - sfactor * (y1 - y0);\n  const yc = 0.5 * (y0 + y1) + sfactor * (x1 - x0);\n\n  const th0 = Math.atan2(y0 - yc, x0 - xc);\n  const th1 = Math.atan2(y1 - yc, x1 - xc);\n\n  let thArc = th1 - th0;\n  if (thArc < 0 && sweep === 1) {\n    thArc += 2 * Math.PI;\n  } else if (thArc > 0 && sweep === 0) {\n    thArc -= 2 * Math.PI;\n  }\n\n  const segments = Math.ceil(Math.abs(thArc / (Math.PI * 0.5 + 0.001)));\n  const result: Segment[] = [];\n\n  for (let i = 0; i < segments; i++) {\n    const th2 = th0 + (i * thArc) / segments;\n    const th3 = th0 + ((i + 1) * thArc) / segments;\n    result[i] = [xc, yc, th2, th3, rx, ry, sinTh, cosTh];\n  }\n\n  return result;\n};\n\nconst segmentToBezier = (\n  cx1: number,\n  cy1: number,\n  th0: number,\n  th1: number,\n  rx: number,\n  ry: number,\n  sinTh: number,\n  cosTh: number,\n) => {\n  const a00 = cosTh * rx;\n  const a01 = -sinTh * ry;\n  const a10 = sinTh * rx;\n  const a11 = cosTh * ry;\n\n  const thHalf = 0.5 * (th1 - th0);\n  const t =\n    ((8 / 3) * Math.sin(thHalf * 0.5) * Math.sin(thHalf * 0.5)) /\n    Math.sin(thHalf);\n  const x1 = cx1 + Math.cos(th0) - t * Math.sin(th0);\n  const y1 = cy1 + Math.sin(th0) + t * Math.cos(th0);\n  const x3 = cx1 + Math.cos(th1);\n  const y3 = cy1 + Math.sin(th1);\n  const x2 = x3 + t * Math.sin(th1);\n  const y2 = y3 - t * Math.cos(th1);\n\n  const result: Bezier = [\n    a00 * x1 + a01 * y1,\n    a10 * x1 + a11 * y1,\n    a00 * x2 + a01 * y2,\n    a10 * x2 + a11 * y2,\n    a00 * x3 + a01 * y3,\n    a10 * x3 + a11 * y3,\n  ];\n  return result;\n};\n\nexport const svgPathToOperators = (path: string) => apply(parse(path));\n","import { Color, setFillingColor, setStrokingColor } from 'src/api/colors';\nimport {\n  beginText,\n  closePath,\n  drawObject,\n  endText,\n  fill,\n  fillAndStroke,\n  lineTo,\n  moveTo,\n  nextLine,\n  popGraphicsState,\n  pushGraphicsState,\n  rotateAndSkewTextRadiansAndTranslate,\n  rotateRadians,\n  scale,\n  setFontAndSize,\n  setLineHeight,\n  setLineWidth,\n  showText,\n  skewRadians,\n  stroke,\n  translate,\n  LineCapStyle,\n  setLineCap,\n  rotateDegrees,\n  setGraphicsState,\n  setDashPattern,\n  beginMarkedContent,\n  endMarkedContent,\n  clip,\n  endPath,\n  appendBezierCurve,\n} from 'src/api/operators';\nimport { Rotation, degrees, toRadians } from 'src/api/rotations';\nimport { svgPathToOperators } from 'src/api/svgPath';\nimport { PDFHexString, PDFName, PDFNumber, PDFOperator } from 'src/core';\nimport { asNumber } from 'src/api/objects';\n\nexport interface DrawTextOptions {\n  color: Color;\n  font: string | PDFName;\n  size: number | PDFNumber;\n  rotate: Rotation;\n  xSkew: Rotation;\n  ySkew: Rotation;\n  x: number | PDFNumber;\n  y: number | PDFNumber;\n  graphicsState?: string | PDFName;\n}\n\nexport const drawText = (\n  line: PDFHexString,\n  options: DrawTextOptions,\n): PDFOperator[] =>\n  [\n    pushGraphicsState(),\n    options.graphicsState && setGraphicsState(options.graphicsState),\n    beginText(),\n    setFillingColor(options.color),\n    setFontAndSize(options.font, options.size),\n    rotateAndSkewTextRadiansAndTranslate(\n      toRadians(options.rotate),\n      toRadians(options.xSkew),\n      toRadians(options.ySkew),\n      options.x,\n      options.y,\n    ),\n    showText(line),\n    endText(),\n    popGraphicsState(),\n  ].filter(Boolean) as PDFOperator[];\n\nexport interface DrawLinesOfTextOptions extends DrawTextOptions {\n  lineHeight: number | PDFNumber;\n}\n\nexport const drawLinesOfText = (\n  lines: PDFHexString[],\n  options: DrawLinesOfTextOptions,\n): PDFOperator[] => {\n  const operators = [\n    pushGraphicsState(),\n    options.graphicsState && setGraphicsState(options.graphicsState),\n    beginText(),\n    setFillingColor(options.color),\n    setFontAndSize(options.font, options.size),\n    setLineHeight(options.lineHeight),\n    rotateAndSkewTextRadiansAndTranslate(\n      toRadians(options.rotate),\n      toRadians(options.xSkew),\n      toRadians(options.ySkew),\n      options.x,\n      options.y,\n    ),\n  ].filter(Boolean) as PDFOperator[];\n\n  for (let idx = 0, len = lines.length; idx < len; idx++) {\n    operators.push(showText(lines[idx]), nextLine());\n  }\n\n  operators.push(endText(), popGraphicsState());\n  return operators;\n};\n\nexport const drawImage = (\n  name: string | PDFName,\n  options: {\n    x: number | PDFNumber;\n    y: number | PDFNumber;\n    width: number | PDFNumber;\n    height: number | PDFNumber;\n    rotate: Rotation;\n    xSkew: Rotation;\n    ySkew: Rotation;\n    graphicsState?: string | PDFName;\n  },\n): PDFOperator[] =>\n  [\n    pushGraphicsState(),\n    options.graphicsState && setGraphicsState(options.graphicsState),\n    translate(options.x, options.y),\n    rotateRadians(toRadians(options.rotate)),\n    scale(options.width, options.height),\n    skewRadians(toRadians(options.xSkew), toRadians(options.ySkew)),\n    drawObject(name),\n    popGraphicsState(),\n  ].filter(Boolean) as PDFOperator[];\n\nexport const drawPage = (\n  name: string | PDFName,\n  options: {\n    x: number | PDFNumber;\n    y: number | PDFNumber;\n    xScale: number | PDFNumber;\n    yScale: number | PDFNumber;\n    rotate: Rotation;\n    xSkew: Rotation;\n    ySkew: Rotation;\n    graphicsState?: string | PDFName;\n  },\n): PDFOperator[] =>\n  [\n    pushGraphicsState(),\n    options.graphicsState && setGraphicsState(options.graphicsState),\n    translate(options.x, options.y),\n    rotateRadians(toRadians(options.rotate)),\n    scale(options.xScale, options.yScale),\n    skewRadians(toRadians(options.xSkew), toRadians(options.ySkew)),\n    drawObject(name),\n    popGraphicsState(),\n  ].filter(Boolean) as PDFOperator[];\n\nexport const drawLine = (options: {\n  start: { x: number | PDFNumber; y: number | PDFNumber };\n  end: { x: number | PDFNumber; y: number | PDFNumber };\n  thickness: number | PDFNumber;\n  color: Color | undefined;\n  dashArray?: (number | PDFNumber)[];\n  dashPhase?: number | PDFNumber;\n  lineCap?: LineCapStyle;\n  graphicsState?: string | PDFName;\n}) =>\n  [\n    pushGraphicsState(),\n    options.graphicsState && setGraphicsState(options.graphicsState),\n    options.color && setStrokingColor(options.color),\n    setLineWidth(options.thickness),\n    setDashPattern(options.dashArray ?? [], options.dashPhase ?? 0),\n    moveTo(options.start.x, options.start.y),\n    options.lineCap && setLineCap(options.lineCap),\n    moveTo(options.start.x, options.start.y),\n    lineTo(options.end.x, options.end.y),\n    stroke(),\n    popGraphicsState(),\n  ].filter(Boolean) as PDFOperator[];\n\nexport const drawRectangle = (options: {\n  x: number | PDFNumber;\n  y: number | PDFNumber;\n  width: number | PDFNumber;\n  height: number | PDFNumber;\n  borderWidth: number | PDFNumber;\n  color: Color | undefined;\n  borderColor: Color | undefined;\n  rotate: Rotation;\n  xSkew: Rotation;\n  ySkew: Rotation;\n  borderLineCap?: LineCapStyle;\n  borderDashArray?: (number | PDFNumber)[];\n  borderDashPhase?: number | PDFNumber;\n  graphicsState?: string | PDFName;\n}) =>\n  [\n    pushGraphicsState(),\n    options.graphicsState && setGraphicsState(options.graphicsState),\n    options.color && setFillingColor(options.color),\n    options.borderColor && setStrokingColor(options.borderColor),\n    setLineWidth(options.borderWidth),\n    options.borderLineCap && setLineCap(options.borderLineCap),\n    setDashPattern(options.borderDashArray ?? [], options.borderDashPhase ?? 0),\n    translate(options.x, options.y),\n    rotateRadians(toRadians(options.rotate)),\n    skewRadians(toRadians(options.xSkew), toRadians(options.ySkew)),\n    moveTo(0, 0),\n    lineTo(0, options.height),\n    lineTo(options.width, options.height),\n    lineTo(options.width, 0),\n    closePath(),\n\n    // prettier-ignore\n    options.color && options.borderWidth ? fillAndStroke()\n      : options.color                      ? fill()\n        : options.borderColor                ? stroke()\n          : closePath(),\n\n    popGraphicsState(),\n  ].filter(Boolean) as PDFOperator[];\n\nconst KAPPA = 4.0 * ((Math.sqrt(2) - 1.0) / 3.0);\n\n/** @deprecated */\nexport const drawEllipsePath = (config: {\n  x: number | PDFNumber;\n  y: number | PDFNumber;\n  xScale: number | PDFNumber;\n  yScale: number | PDFNumber;\n}): PDFOperator[] => {\n  let x = asNumber(config.x);\n  let y = asNumber(config.y);\n  const xScale = asNumber(config.xScale);\n  const yScale = asNumber(config.yScale);\n\n  x -= xScale;\n  y -= yScale;\n\n  const ox = xScale * KAPPA;\n  const oy = yScale * KAPPA;\n  const xe = x + xScale * 2;\n  const ye = y + yScale * 2;\n  const xm = x + xScale;\n  const ym = y + yScale;\n\n  return [\n    pushGraphicsState(),\n    moveTo(x, ym),\n    appendBezierCurve(x, ym - oy, xm - ox, y, xm, y),\n    appendBezierCurve(xm + ox, y, xe, ym - oy, xe, ym),\n    appendBezierCurve(xe, ym + oy, xm + ox, ye, xm, ye),\n    appendBezierCurve(xm - ox, ye, x, ym + oy, x, ym),\n    popGraphicsState(),\n  ];\n};\n\nconst drawEllipseCurves = (config: {\n  x: number | PDFNumber;\n  y: number | PDFNumber;\n  xScale: number | PDFNumber;\n  yScale: number | PDFNumber;\n  rotate: Rotation;\n}): PDFOperator[] => {\n  const centerX = asNumber(config.x);\n  const centerY = asNumber(config.y);\n  const xScale = asNumber(config.xScale);\n  const yScale = asNumber(config.yScale);\n\n  const x = -xScale;\n  const y = -yScale;\n\n  const ox = xScale * KAPPA;\n  const oy = yScale * KAPPA;\n  const xe = x + xScale * 2;\n  const ye = y + yScale * 2;\n  const xm = x + xScale;\n  const ym = y + yScale;\n\n  return [\n    translate(centerX, centerY),\n    rotateRadians(toRadians(config.rotate)),\n    moveTo(x, ym),\n    appendBezierCurve(x, ym - oy, xm - ox, y, xm, y),\n    appendBezierCurve(xm + ox, y, xe, ym - oy, xe, ym),\n    appendBezierCurve(xe, ym + oy, xm + ox, ye, xm, ye),\n    appendBezierCurve(xm - ox, ye, x, ym + oy, x, ym),\n  ];\n};\n\nexport const drawEllipse = (options: {\n  x: number | PDFNumber;\n  y: number | PDFNumber;\n  xScale: number | PDFNumber;\n  yScale: number | PDFNumber;\n  rotate?: Rotation;\n  color: Color | undefined;\n  borderColor: Color | undefined;\n  borderWidth: number | PDFNumber;\n  borderDashArray?: (number | PDFNumber)[];\n  borderDashPhase?: number | PDFNumber;\n  graphicsState?: string | PDFName;\n  borderLineCap?: LineCapStyle;\n}) =>\n  [\n    pushGraphicsState(),\n    options.graphicsState && setGraphicsState(options.graphicsState),\n    options.color && setFillingColor(options.color),\n    options.borderColor && setStrokingColor(options.borderColor),\n    setLineWidth(options.borderWidth),\n    options.borderLineCap && setLineCap(options.borderLineCap),\n    setDashPattern(options.borderDashArray ?? [], options.borderDashPhase ?? 0),\n\n    // The `drawEllipsePath` branch is only here for backwards compatibility.\n    // See https://github.com/Hopding/pdf-lib/pull/511#issuecomment-667685655.\n    ...(options.rotate === undefined\n      ? drawEllipsePath({\n        x: options.x,\n        y: options.y,\n        xScale: options.xScale,\n        yScale: options.yScale,\n      })\n      : drawEllipseCurves({\n        x: options.x,\n        y: options.y,\n        xScale: options.xScale,\n        yScale: options.yScale,\n        rotate: options.rotate ?? degrees(0),\n      })),\n\n    // prettier-ignore\n    options.color && options.borderWidth ? fillAndStroke()\n      : options.color                      ? fill()\n        : options.borderColor                ? stroke()\n          : closePath(),\n\n    popGraphicsState(),\n  ].filter(Boolean) as PDFOperator[];\n\nexport const drawSvgPath = (\n  path: string,\n  options: {\n    x: number | PDFNumber;\n    y: number | PDFNumber;\n    rotate?: Rotation;\n    scale: number | PDFNumber | undefined;\n    color: Color | undefined;\n    borderColor: Color | undefined;\n    borderWidth: number | PDFNumber;\n    borderDashArray?: (number | PDFNumber)[];\n    borderDashPhase?: number | PDFNumber;\n    borderLineCap?: LineCapStyle;\n    graphicsState?: string | PDFName;\n  },\n) =>\n  [\n    pushGraphicsState(),\n    options.graphicsState && setGraphicsState(options.graphicsState),\n\n    translate(options.x, options.y),\n    rotateRadians(toRadians(options.rotate ?? degrees(0))),\n\n    // SVG path Y axis is opposite pdf-lib's\n    options.scale ? scale(options.scale, -options.scale) : scale(1, -1),\n\n    options.color && setFillingColor(options.color),\n    options.borderColor && setStrokingColor(options.borderColor),\n    options.borderWidth && setLineWidth(options.borderWidth),\n    options.borderLineCap && setLineCap(options.borderLineCap),\n\n    setDashPattern(options.borderDashArray ?? [], options.borderDashPhase ?? 0),\n\n    ...svgPathToOperators(path),\n\n    // prettier-ignore\n    options.color && options.borderWidth ? fillAndStroke()\n      : options.color                      ? fill()\n        : options.borderColor                ? stroke()\n          : closePath(),\n\n    popGraphicsState(),\n  ].filter(Boolean) as PDFOperator[];\n\nexport const drawCheckMark = (options: {\n  x: number | PDFNumber;\n  y: number | PDFNumber;\n  size: number | PDFNumber;\n  thickness: number | PDFNumber;\n  color: Color | undefined;\n}) => {\n  const size = asNumber(options.size);\n\n  /*********************** Define Check Mark Points ***************************/\n  // A check mark is defined by three points in some coordinate space. Here, we\n  // define these points in a unit coordinate system, where the range of the x\n  // and y axis are both [-1, 1].\n  //\n  // Note that we do not hard code `p1y` in case we wish to change the\n  // size/shape of the check mark in the future. We want the check mark to\n  // always form a right angle. This means that the dot product between (p1-p2)\n  // and (p3-p2) should be zero:\n  //\n  //   (p1x-p2x) * (p3x-p2x) + (p1y-p2y) * (p3y-p2y) = 0\n  //\n  // We can now rejigger this equation to solve for `p1y`:\n  //\n  //   (p1y-p2y) * (p3y-p2y) = -((p1x-p2x) * (p3x-p2x))\n  //   (p1y-p2y) = -((p1x-p2x) * (p3x-p2x)) / (p3y-p2y)\n  //   p1y = -((p1x-p2x) * (p3x-p2x)) / (p3y-p2y) + p2y\n  //\n  // Thanks to my friend Joel Walker (https://github.com/JWalker1995) for\n  // devising the above equation and unit coordinate system approach!\n\n  // (x, y) coords of the check mark's bottommost point\n  const p2x = -1 + 0.75;\n  const p2y = -1 + 0.51;\n\n  // (x, y) coords of the check mark's topmost point\n  const p3y = 1 - 0.525;\n  const p3x = 1 - 0.31;\n\n  // (x, y) coords of the check mark's center (vertically) point\n  const p1x = -1 + 0.325;\n  const p1y = -((p1x - p2x) * (p3x - p2x)) / (p3y - p2y) + p2y;\n  /****************************************************************************/\n\n  return [\n    pushGraphicsState(),\n    options.color && setStrokingColor(options.color),\n    setLineWidth(options.thickness),\n\n    translate(options.x, options.y),\n    moveTo(p1x * size, p1y * size),\n    lineTo(p2x * size, p2y * size),\n    lineTo(p3x * size, p3y * size),\n\n    stroke(),\n    popGraphicsState(),\n  ].filter(Boolean) as PDFOperator[];\n};\n\n// prettier-ignore\nexport const rotateInPlace = (options: {\n  width: number | PDFNumber;\n  height: number | PDFNumber;\n  rotation: 0 | 90 | 180 | 270;\n}) =>\n  options.rotation === 0 ? [\n    translate(0, 0),\n    rotateDegrees(0),\n  ]\n    : options.rotation === 90 ? [\n      translate(options.width, 0),\n      rotateDegrees(90),\n    ]\n      : options.rotation === 180 ? [\n        translate(options.width, options.height),\n        rotateDegrees(180),\n      ]\n        : options.rotation === 270 ? [\n          translate(0, options.height),\n          rotateDegrees(270),\n        ]\n          : []; // Invalid rotation - noop\n\nexport const drawCheckBox = (options: {\n  x: number | PDFNumber;\n  y: number | PDFNumber;\n  width: number | PDFNumber;\n  height: number | PDFNumber;\n  thickness: number | PDFNumber;\n  borderWidth: number | PDFNumber;\n  markColor: Color | undefined;\n  color: Color | undefined;\n  borderColor: Color | undefined;\n  filled: boolean;\n}) => {\n  const outline = drawRectangle({\n    x: options.x,\n    y: options.y,\n    width: options.width,\n    height: options.height,\n    borderWidth: options.borderWidth,\n    color: options.color,\n    borderColor: options.borderColor,\n    rotate: degrees(0),\n    xSkew: degrees(0),\n    ySkew: degrees(0),\n  });\n\n  if (!options.filled) return outline;\n\n  const width = asNumber(options.width);\n  const height = asNumber(options.height);\n\n  const checkMarkSize = Math.min(width, height) / 2;\n\n  const checkMark = drawCheckMark({\n    x: width / 2,\n    y: height / 2,\n    size: checkMarkSize,\n    thickness: options.thickness,\n    color: options.markColor,\n  });\n\n  return [pushGraphicsState(), ...outline, ...checkMark, popGraphicsState()];\n};\n\nexport const drawRadioButton = (options: {\n  x: number | PDFNumber;\n  y: number | PDFNumber;\n  width: number | PDFNumber;\n  height: number | PDFNumber;\n  borderWidth: number | PDFNumber;\n  dotColor: Color | undefined;\n  color: Color | undefined;\n  borderColor: Color | undefined;\n  filled: boolean;\n}) => {\n  const width = asNumber(options.width);\n  const height = asNumber(options.height);\n\n  const outlineScale = Math.min(width, height) / 2;\n\n  const outline = drawEllipse({\n    x: options.x,\n    y: options.y,\n    xScale: outlineScale,\n    yScale: outlineScale,\n    color: options.color,\n    borderColor: options.borderColor,\n    borderWidth: options.borderWidth,\n  });\n\n  if (!options.filled) return outline;\n\n  const dot = drawEllipse({\n    x: options.x,\n    y: options.y,\n    xScale: outlineScale * 0.45,\n    yScale: outlineScale * 0.45,\n    color: options.dotColor,\n    borderColor: undefined,\n    borderWidth: 0,\n  });\n\n  return [pushGraphicsState(), ...outline, ...dot, popGraphicsState()];\n};\n\nexport const drawButton = (options: {\n  x: number | PDFNumber;\n  y: number | PDFNumber;\n  width: number | PDFNumber;\n  height: number | PDFNumber;\n  borderWidth: number | PDFNumber;\n  color: Color | undefined;\n  borderColor: Color | undefined;\n  textLines: { encoded: PDFHexString; x: number; y: number }[];\n  textColor: Color;\n  font: string | PDFName;\n  fontSize: number | PDFNumber;\n}) => {\n  const x = asNumber(options.x);\n  const y = asNumber(options.y);\n  const width = asNumber(options.width);\n  const height = asNumber(options.height);\n\n  const background = drawRectangle({\n    x,\n    y,\n    width,\n    height,\n    borderWidth: options.borderWidth,\n    color: options.color,\n    borderColor: options.borderColor,\n    rotate: degrees(0),\n    xSkew: degrees(0),\n    ySkew: degrees(0),\n  });\n\n  const lines = drawTextLines(options.textLines, {\n    color: options.textColor,\n    font: options.font,\n    size: options.fontSize,\n    rotate: degrees(0),\n    xSkew: degrees(0),\n    ySkew: degrees(0),\n  });\n\n  return [pushGraphicsState(), ...background, ...lines, popGraphicsState()];\n};\n\nexport interface DrawTextLinesOptions {\n  color: Color;\n  font: string | PDFName;\n  size: number | PDFNumber;\n  rotate: Rotation;\n  xSkew: Rotation;\n  ySkew: Rotation;\n}\n\nexport const drawTextLines = (\n  lines: { encoded: PDFHexString; x: number; y: number }[],\n  options: DrawTextLinesOptions,\n): PDFOperator[] => {\n  const operators = [\n    beginText(),\n    setFillingColor(options.color),\n    setFontAndSize(options.font, options.size),\n  ];\n\n  for (let idx = 0, len = lines.length; idx < len; idx++) {\n    const { encoded, x, y } = lines[idx];\n    operators.push(\n      rotateAndSkewTextRadiansAndTranslate(\n        toRadians(options.rotate),\n        toRadians(options.xSkew),\n        toRadians(options.ySkew),\n        x,\n        y,\n      ),\n      showText(encoded),\n    );\n  }\n\n  operators.push(endText());\n\n  return operators;\n};\n\nexport const drawTextField = (options: {\n  x: number | PDFNumber;\n  y: number | PDFNumber;\n  width: number | PDFNumber;\n  height: number | PDFNumber;\n  borderWidth: number | PDFNumber;\n  color: Color | undefined;\n  borderColor: Color | undefined;\n  textLines: { encoded: PDFHexString; x: number; y: number }[];\n  textColor: Color;\n  font: string | PDFName;\n  fontSize: number | PDFNumber;\n  padding: number | PDFNumber;\n}) => {\n  const x = asNumber(options.x);\n  const y = asNumber(options.y);\n  const width = asNumber(options.width);\n  const height = asNumber(options.height);\n  const borderWidth = asNumber(options.borderWidth);\n  const padding = asNumber(options.padding);\n\n  const clipX = x + borderWidth / 2 + padding;\n  const clipY = y + borderWidth / 2 + padding;\n  const clipWidth = width - (borderWidth / 2 + padding) * 2;\n  const clipHeight = height - (borderWidth / 2 + padding) * 2;\n\n  const clippingArea = [\n    moveTo(clipX, clipY),\n    lineTo(clipX, clipY + clipHeight),\n    lineTo(clipX + clipWidth, clipY + clipHeight),\n    lineTo(clipX + clipWidth, clipY),\n    closePath(),\n    clip(),\n    endPath(),\n  ];\n\n  const background = drawRectangle({\n    x,\n    y,\n    width,\n    height,\n    borderWidth: options.borderWidth,\n    color: options.color,\n    borderColor: options.borderColor,\n    rotate: degrees(0),\n    xSkew: degrees(0),\n    ySkew: degrees(0),\n  });\n\n  const lines = drawTextLines(options.textLines, {\n    color: options.textColor,\n    font: options.font,\n    size: options.fontSize,\n    rotate: degrees(0),\n    xSkew: degrees(0),\n    ySkew: degrees(0),\n  });\n\n  const markedContent = [\n    beginMarkedContent('Tx'),\n    pushGraphicsState(),\n    ...lines,\n    popGraphicsState(),\n    endMarkedContent(),\n  ];\n\n  return [\n    pushGraphicsState(),\n    ...background,\n    ...clippingArea,\n    ...markedContent,\n    popGraphicsState(),\n  ];\n};\n\nexport const drawOptionList = (options: {\n  x: number | PDFNumber;\n  y: number | PDFNumber;\n  width: number | PDFNumber;\n  height: number | PDFNumber;\n  borderWidth: number | PDFNumber;\n  color: Color | undefined;\n  borderColor: Color | undefined;\n  textLines: { encoded: PDFHexString; x: number; y: number; height: number }[];\n  textColor: Color;\n  font: string | PDFName;\n  fontSize: number | PDFNumber;\n  lineHeight: number | PDFNumber;\n  selectedLines: number[];\n  selectedColor: Color;\n  padding: number | PDFNumber;\n}) => {\n  const x = asNumber(options.x);\n  const y = asNumber(options.y);\n  const width = asNumber(options.width);\n  const height = asNumber(options.height);\n  const lineHeight = asNumber(options.lineHeight);\n  const borderWidth = asNumber(options.borderWidth);\n  const padding = asNumber(options.padding);\n\n  const clipX = x + borderWidth / 2 + padding;\n  const clipY = y + borderWidth / 2 + padding;\n  const clipWidth = width - (borderWidth / 2 + padding) * 2;\n  const clipHeight = height - (borderWidth / 2 + padding) * 2;\n\n  const clippingArea = [\n    moveTo(clipX, clipY),\n    lineTo(clipX, clipY + clipHeight),\n    lineTo(clipX + clipWidth, clipY + clipHeight),\n    lineTo(clipX + clipWidth, clipY),\n    closePath(),\n    clip(),\n    endPath(),\n  ];\n\n  const background = drawRectangle({\n    x,\n    y,\n    width,\n    height,\n    borderWidth: options.borderWidth,\n    color: options.color,\n    borderColor: options.borderColor,\n    rotate: degrees(0),\n    xSkew: degrees(0),\n    ySkew: degrees(0),\n  });\n\n  const highlights: PDFOperator[] = [];\n  for (let idx = 0, len = options.selectedLines.length; idx < len; idx++) {\n    const line = options.textLines[options.selectedLines[idx]];\n    highlights.push(\n      ...drawRectangle({\n        x: line.x - padding,\n        y: line.y - (lineHeight - line.height) / 2,\n        width: width - borderWidth,\n        height: line.height + (lineHeight - line.height) / 2,\n        borderWidth: 0,\n        color: options.selectedColor,\n        borderColor: undefined,\n        rotate: degrees(0),\n        xSkew: degrees(0),\n        ySkew: degrees(0),\n      }),\n    );\n  }\n\n  const lines = drawTextLines(options.textLines, {\n    color: options.textColor,\n    font: options.font,\n    size: options.fontSize,\n    rotate: degrees(0),\n    xSkew: degrees(0),\n    ySkew: degrees(0),\n  });\n\n  const markedContent = [\n    beginMarkedContent('Tx'),\n    pushGraphicsState(),\n    ...lines,\n    popGraphicsState(),\n    endMarkedContent(),\n  ];\n\n  return [\n    pushGraphicsState(),\n    ...background,\n    ...highlights,\n    ...clippingArea,\n    ...markedContent,\n    popGraphicsState(),\n  ];\n};\n","// tslint:disable: max-classes-per-file\n\n// TODO: Include link to documentation with example\nexport class EncryptedPDFError extends Error {\n  constructor() {\n    const msg =\n      'Input document to `PDFDocument.load` is encrypted. You can use `PDFDocument.load(..., { ignoreEncryption: true })` if you wish to load the document anyways.';\n    super(msg);\n  }\n}\n\n// TODO: Include link to documentation with example\nexport class FontkitNotRegisteredError extends Error {\n  constructor() {\n    const msg =\n      'Input to `PDFDocument.embedFont` was a custom font, but no `fontkit` instance was found. You must register a `fontkit` instance with `PDFDocument.registerFontkit(...)` before embedding custom fonts.';\n    super(msg);\n  }\n}\n\n// TODO: Include link to documentation with example\nexport class ForeignPageError extends Error {\n  constructor() {\n    const msg =\n      'A `page` passed to `PDFDocument.addPage` or `PDFDocument.insertPage` was from a different (foreign) PDF document. If you want to copy pages from one PDFDocument to another, you must use `PDFDocument.copyPages(...)` to copy the pages before adding or inserting them.';\n    super(msg);\n  }\n}\n\n// TODO: Include link to documentation with example\nexport class RemovePageFromEmptyDocumentError extends Error {\n  constructor() {\n    const msg =\n      'PDFDocument has no pages so `PDFDocument.removePage` cannot be called';\n    super(msg);\n  }\n}\n\nexport class NoSuchFieldError extends Error {\n  constructor(name: string) {\n    const msg = `PDFDocument has no form field with the name \"${name}\"`;\n    super(msg);\n  }\n}\n\nexport class UnexpectedFieldTypeError extends Error {\n  constructor(name: string, expected: any, actual: any) {\n    const expectedType = expected?.name;\n    const actualType = actual?.constructor?.name ?? actual;\n    const msg =\n      `Expected field \"${name}\" to be of type ${expectedType}, ` +\n      `but it is actually of type ${actualType}`;\n    super(msg);\n  }\n}\n\nexport class MissingOnValueCheckError extends Error {\n  constructor(onValue: any) {\n    const msg = `Failed to select check box due to missing onValue: \"${onValue}\"`;\n    super(msg);\n  }\n}\n\nexport class FieldAlreadyExistsError extends Error {\n  constructor(name: string) {\n    const msg = `A field already exists with the specified name: \"${name}\"`;\n    super(msg);\n  }\n}\n\nexport class InvalidFieldNamePartError extends Error {\n  constructor(namePart: string) {\n    const msg = `Field name contains invalid component: \"${namePart}\"`;\n    super(msg);\n  }\n}\n\nexport class FieldExistsAsNonTerminalError extends Error {\n  constructor(name: string) {\n    const msg = `A non-terminal field already exists with the specified name: \"${name}\"`;\n    super(msg);\n  }\n}\n\nexport class RichTextFieldReadError extends Error {\n  constructor(fieldName: string) {\n    const msg = `Reading rich text fields is not supported: Attempted to read rich text field: ${fieldName}`;\n    super(msg);\n  }\n}\n\nexport class CombedTextLayoutError extends Error {\n  constructor(lineLength: number, cellCount: number) {\n    const msg = `Failed to layout combed text as lineLength=${lineLength} is greater than cellCount=${cellCount}`;\n    super(msg);\n  }\n}\n\nexport class ExceededMaxLengthError extends Error {\n  constructor(textLength: number, maxLength: number, name: string) {\n    const msg = `Attempted to set text with length=${textLength} for TextField with maxLength=${maxLength} and name=${name}`;\n    super(msg);\n  }\n}\n\nexport class InvalidMaxLengthError extends Error {\n  constructor(textLength: number, maxLength: number, name: string) {\n    const msg = `Attempted to set maxLength=${maxLength}, which is less than ${textLength}, the length of this field's current value (name=${name})`;\n    super(msg);\n  }\n}\n","export enum TextAlignment {\n  Left = 0,\n  Center = 1,\n  Right = 2\n}\n","import PDFFont from 'src/api/PDFFont';\nimport { CombedTextLayoutError } from 'src/api/errors';\nimport { TextAlignment } from 'src/api/text/alignment';\n\nimport { PDFHexString } from 'src/core';\nimport {\n  cleanText,\n  lineSplit,\n  mergeLines,\n  charAtIndex,\n  charSplit,\n} from 'src/utils';\n\nexport interface TextPosition {\n  text: string;\n  encoded: PDFHexString;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\nexport interface LayoutBounds {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\nconst MIN_FONT_SIZE = 4;\nconst MAX_FONT_SIZE = 500;\n\nconst computeFontSize = (\n  lines: string[],\n  font: PDFFont,\n  bounds: LayoutBounds,\n  multiline: boolean = false,\n) => {\n  let fontSize = MIN_FONT_SIZE;\n\n  while (fontSize < MAX_FONT_SIZE) {\n    let linesUsed = 0;\n\n    for (\n      let lineIdx = 0, lineLen = lines.length;\n      lineIdx < lineLen;\n      lineIdx++\n    ) {\n      linesUsed += 1;\n\n      const line = lines[lineIdx];\n      const words = line.split(' ');\n\n      // Layout the words using the current `fontSize`, line wrapping\n      // whenever we reach the end of the current line.\n      let spaceInLineRemaining = bounds.width;\n      for (let idx = 0, len = words.length; idx < len; idx++) {\n        const isLastWord = idx === len - 1;\n        const word = isLastWord ? words[idx] : words[idx] + ' ';\n        const widthOfWord = font.widthOfTextAtSize(word, fontSize);\n        spaceInLineRemaining -= widthOfWord;\n        if (spaceInLineRemaining <= 0) {\n          linesUsed += 1;\n          spaceInLineRemaining = bounds.width - widthOfWord;\n        }\n      }\n    }\n\n    // Return if we exceeded the allowed width\n    if (!multiline && linesUsed > lines.length) return fontSize - 1;\n\n    const height = font.heightAtSize(fontSize);\n    const lineHeight = height + height * 0.2;\n    const totalHeight = lineHeight * linesUsed;\n\n    // Return if we exceeded the allowed height\n    if (totalHeight > Math.abs(bounds.height)) return fontSize - 1;\n\n    fontSize += 1;\n  }\n\n  return fontSize;\n};\n\nconst computeCombedFontSize = (\n  line: string,\n  font: PDFFont,\n  bounds: LayoutBounds,\n  cellCount: number,\n) => {\n  const cellWidth = bounds.width / cellCount;\n  const cellHeight = bounds.height;\n\n  let fontSize = MIN_FONT_SIZE;\n\n  const chars = charSplit(line);\n  while (fontSize < MAX_FONT_SIZE) {\n    for (let idx = 0, len = chars.length; idx < len; idx++) {\n      const c = chars[idx];\n      const tooLong = font.widthOfTextAtSize(c, fontSize) > cellWidth * 0.75;\n      if (tooLong) return fontSize - 1;\n    }\n\n    const height = font.heightAtSize(fontSize, { descender: false });\n    if (height > cellHeight) return fontSize - 1;\n\n    fontSize += 1;\n  }\n\n  return fontSize;\n};\n\nexport interface LayoutTextOptions {\n  alignment: TextAlignment;\n  fontSize?: number;\n  font: PDFFont;\n  bounds: LayoutBounds;\n}\n\nexport interface MultilineTextLayout {\n  bounds: LayoutBounds;\n  lines: TextPosition[];\n  fontSize: number;\n  lineHeight: number;\n}\n\nconst lastIndexOfWhitespace = (line: string) => {\n  for (let idx = line.length; idx > 0; idx--) {\n    if (/\\s/.test(line[idx])) return idx;\n  }\n  return undefined;\n};\n\nconst splitOutLines = (\n  input: string,\n  maxWidth: number,\n  font: PDFFont,\n  fontSize: number,\n) => {\n  let lastWhitespaceIdx = input.length;\n  while (lastWhitespaceIdx > 0) {\n    const line = input.substring(0, lastWhitespaceIdx);\n    const encoded = font.encodeText(line);\n    const width = font.widthOfTextAtSize(line, fontSize);\n    if (width < maxWidth) {\n      const remainder = input.substring(lastWhitespaceIdx) || undefined;\n      return { line, encoded, width, remainder };\n    }\n    lastWhitespaceIdx = lastIndexOfWhitespace(line) ?? 0;\n  }\n\n  // We were unable to split the input enough to get a chunk that would fit\n  // within the specified `maxWidth` so we'll just return everything\n  return {\n    line: input,\n    encoded: font.encodeText(input),\n    width: font.widthOfTextAtSize(input, fontSize),\n    remainder: undefined,\n  };\n};\n\nexport const layoutMultilineText = (\n  text: string,\n  { alignment, fontSize, font, bounds }: LayoutTextOptions,\n): MultilineTextLayout => {\n  const lines = lineSplit(cleanText(text));\n\n  if (fontSize === undefined || fontSize === 0) {\n    fontSize = computeFontSize(lines, font, bounds, true);\n  }\n  const height = font.heightAtSize(fontSize);\n  const lineHeight = height + height * 0.2;\n\n  const textLines: TextPosition[] = [];\n\n  let minX = bounds.x;\n  let minY = bounds.y;\n  let maxX = bounds.x + bounds.width;\n  let maxY = bounds.y + bounds.height;\n\n  let y = bounds.y + bounds.height;\n  for (let idx = 0, len = lines.length; idx < len; idx++) {\n    let prevRemainder: string | undefined = lines[idx];\n    while (prevRemainder !== undefined) {\n      const { line, encoded, width, remainder } = splitOutLines(\n        prevRemainder,\n        bounds.width,\n        font,\n        fontSize,\n      );\n\n      // prettier-ignore\n      const x = (\n        alignment === TextAlignment.Left   ? bounds.x\n          : alignment === TextAlignment.Center ? bounds.x + (bounds.width / 2) - (width / 2)\n            : alignment === TextAlignment.Right  ? bounds.x + bounds.width - width\n              : bounds.x\n      );\n\n      y -= lineHeight;\n\n      if (x < minX) minX = x;\n      if (y < minY) minY = y;\n      if (x + width > maxX) maxX = x + width;\n      if (y + height > maxY) maxY = y + height;\n\n      textLines.push({ text: line, encoded, width, height, x, y });\n\n      // Only trim lines that we had to split ourselves. So we won't trim lines\n      // that the user provided themselves with whitespace.\n      prevRemainder = remainder?.trim();\n    }\n  }\n\n  return {\n    fontSize,\n    lineHeight,\n    lines: textLines,\n    bounds: {\n      x: minX,\n      y: minY,\n      width: maxX - minX,\n      height: maxY - minY,\n    },\n  };\n};\n\nexport interface LayoutCombedTextOptions {\n  fontSize?: number;\n  font: PDFFont;\n  bounds: LayoutBounds;\n  cellCount: number;\n}\n\nexport interface CombedTextLayout {\n  bounds: LayoutBounds;\n  cells: TextPosition[];\n  fontSize: number;\n}\n\nexport const layoutCombedText = (\n  text: string,\n  { fontSize, font, bounds, cellCount }: LayoutCombedTextOptions,\n): CombedTextLayout => {\n  const line = mergeLines(cleanText(text));\n\n  if (line.length > cellCount) {\n    throw new CombedTextLayoutError(line.length, cellCount);\n  }\n\n  if (fontSize === undefined || fontSize === 0) {\n    fontSize = computeCombedFontSize(line, font, bounds, cellCount);\n  }\n\n  const cellWidth = bounds.width / cellCount;\n\n  const height = font.heightAtSize(fontSize, { descender: false });\n  const y = bounds.y + (bounds.height / 2 - height / 2);\n\n  const cells: TextPosition[] = [];\n\n  let minX = bounds.x;\n  let minY = bounds.y;\n  let maxX = bounds.x + bounds.width;\n  let maxY = bounds.y + bounds.height;\n\n  let cellOffset = 0;\n  let charOffset = 0;\n  while (cellOffset < cellCount) {\n    const [char, charLength] = charAtIndex(line, charOffset);\n\n    const encoded = font.encodeText(char);\n    const width = font.widthOfTextAtSize(char, fontSize);\n\n    const cellCenter = bounds.x + (cellWidth * cellOffset + cellWidth / 2);\n    const x = cellCenter - width / 2;\n\n    if (x < minX) minX = x;\n    if (y < minY) minY = y;\n    if (x + width > maxX) maxX = x + width;\n    if (y + height > maxY) maxY = y + height;\n\n    cells.push({ text: line, encoded, width, height, x, y });\n\n    cellOffset += 1;\n    charOffset += charLength;\n  }\n\n  return {\n    fontSize,\n    cells,\n    bounds: {\n      x: minX,\n      y: minY,\n      width: maxX - minX,\n      height: maxY - minY,\n    },\n  };\n};\n\nexport interface LayoutSinglelineTextOptions {\n  alignment: TextAlignment;\n  fontSize?: number;\n  font: PDFFont;\n  bounds: LayoutBounds;\n}\n\nexport interface SinglelineTextLayout {\n  bounds: LayoutBounds;\n  line: TextPosition;\n  fontSize: number;\n}\n\nexport const layoutSinglelineText = (\n  text: string,\n  { alignment, fontSize, font, bounds }: LayoutSinglelineTextOptions,\n): SinglelineTextLayout => {\n  const line = mergeLines(cleanText(text));\n\n  if (fontSize === undefined || fontSize === 0) {\n    fontSize = computeFontSize([line], font, bounds);\n  }\n\n  const encoded = font.encodeText(line);\n  const width = font.widthOfTextAtSize(line, fontSize);\n  const height = font.heightAtSize(fontSize, { descender: false });\n\n  // prettier-ignore\n  const x = (\n    alignment === TextAlignment.Left   ? bounds.x\n      : alignment === TextAlignment.Center ? bounds.x + (bounds.width / 2) - (width / 2)\n        : alignment === TextAlignment.Right  ? bounds.x + bounds.width - width\n          : bounds.x\n  );\n\n  const y = bounds.y + (bounds.height / 2 - height / 2);\n\n  return {\n    fontSize,\n    line: { text: line, encoded, width, height, x, y },\n    bounds: { x, y, width, height },\n  };\n};\n","import { PDFOperator, PDFWidgetAnnotation } from 'src/core';\nimport PDFFont from 'src/api/PDFFont';\nimport PDFButton from 'src/api/form/PDFButton';\nimport PDFCheckBox from 'src/api/form/PDFCheckBox';\nimport PDFDropdown from 'src/api/form/PDFDropdown';\nimport PDFField from 'src/api/form/PDFField';\nimport PDFOptionList from 'src/api/form/PDFOptionList';\nimport PDFRadioGroup from 'src/api/form/PDFRadioGroup';\nimport PDFSignature from 'src/api/form/PDFSignature';\nimport PDFTextField from 'src/api/form/PDFTextField';\nimport {\n  drawCheckBox,\n  rotateInPlace,\n  drawRadioButton,\n  drawButton,\n  drawTextField,\n  drawOptionList,\n} from 'src/api/operations';\nimport {\n  rgb,\n  componentsToColor,\n  setFillingColor,\n  grayscale,\n  cmyk,\n  Color,\n} from 'src/api/colors';\nimport { reduceRotation, adjustDimsForRotation } from 'src/api/rotations';\nimport {\n  layoutMultilineText,\n  layoutCombedText,\n  TextPosition,\n  layoutSinglelineText,\n} from 'src/api/text/layout';\nimport { TextAlignment } from 'src/api/text/alignment';\nimport { setFontAndSize } from 'src/api/operators';\nimport { findLastMatch } from 'src/utils';\n\n/*********************** Appearance Provider Types ****************************/\n\ntype CheckBoxAppearanceProvider = (\n  checkBox: PDFCheckBox,\n  widget: PDFWidgetAnnotation,\n) => AppearanceOrMapping<{\n  on: PDFOperator[];\n  off: PDFOperator[];\n}>;\n\ntype RadioGroupAppearanceProvider = (\n  radioGroup: PDFRadioGroup,\n  widget: PDFWidgetAnnotation,\n) => AppearanceOrMapping<{\n  on: PDFOperator[];\n  off: PDFOperator[];\n}>;\n\ntype ButtonAppearanceProvider = (\n  button: PDFButton,\n  widget: PDFWidgetAnnotation,\n  font: PDFFont,\n) => AppearanceOrMapping<PDFOperator[]>;\n\ntype DropdownAppearanceProvider = (\n  dropdown: PDFDropdown,\n  widget: PDFWidgetAnnotation,\n  font: PDFFont,\n) => AppearanceOrMapping<PDFOperator[]>;\n\ntype OptionListAppearanceProvider = (\n  optionList: PDFOptionList,\n  widget: PDFWidgetAnnotation,\n  font: PDFFont,\n) => AppearanceOrMapping<PDFOperator[]>;\n\ntype TextFieldAppearanceProvider = (\n  textField: PDFTextField,\n  widget: PDFWidgetAnnotation,\n  font: PDFFont,\n) => AppearanceOrMapping<PDFOperator[]>;\n\ntype SignatureAppearanceProvider = (\n  signature: PDFSignature,\n  widget: PDFWidgetAnnotation,\n  font: PDFFont,\n) => AppearanceOrMapping<PDFOperator[]>;\n\n/******************* Appearance Provider Utility Types ************************/\n\nexport type AppearanceMapping<T> = { normal: T; rollover?: T; down?: T };\n\ntype AppearanceOrMapping<T> = T | AppearanceMapping<T>;\n\n// prettier-ignore\nexport type AppearanceProviderFor<T extends PDFField> = \n  T extends PDFCheckBox   ? CheckBoxAppearanceProvider\n    : T extends PDFRadioGroup ? RadioGroupAppearanceProvider\n      : T extends PDFButton     ? ButtonAppearanceProvider\n        : T extends PDFDropdown   ? DropdownAppearanceProvider\n          : T extends PDFOptionList ? OptionListAppearanceProvider\n            : T extends PDFTextField  ? TextFieldAppearanceProvider\n              : T extends PDFSignature  ? SignatureAppearanceProvider\n                : never;\n\n/********************* Appearance Provider Functions **************************/\n\nexport const normalizeAppearance = <T>(\n  appearance: T | AppearanceMapping<T>,\n): AppearanceMapping<T> => {\n  if (\n    typeof appearance === 'object' &&\n    appearance !== null &&\n    'normal' in appearance\n  ) {\n    return appearance;\n  }\n  return { normal: appearance };\n};\n\n// Examples:\n//   `/Helv 12 Tf` -> ['/Helv 12 Tf', 'Helv', '12']\n//   `/HeBo 8.00 Tf` -> ['/HeBo 8 Tf', 'HeBo', '8.00']\nconst tfRegex =\n  /\\/([^\\0\\t\\n\\f\\r\\ ]+)[\\0\\t\\n\\f\\r\\ ]+(\\d*\\.\\d+|\\d+)[\\0\\t\\n\\f\\r\\ ]+Tf/;\n\nconst getDefaultFontSize = (field: {\n  getDefaultAppearance(): string | undefined;\n}) => {\n  const da = field.getDefaultAppearance() ?? '';\n  const daMatch = findLastMatch(da, tfRegex).match ?? [];\n  const defaultFontSize = Number(daMatch[2]);\n  return isFinite(defaultFontSize) ? defaultFontSize : undefined;\n};\n\n// Examples:\n//   `0.3 g` -> ['0.3', 'g']\n//   `0.3 1 .3 rg` -> ['0.3', '1', '.3', 'rg']\n//   `0.3 1 .3 0 k` -> ['0.3', '1', '.3', '0', 'k']\nconst colorRegex =\n  /(\\d*\\.\\d+|\\d+)[\\0\\t\\n\\f\\r\\ ]*(\\d*\\.\\d+|\\d+)?[\\0\\t\\n\\f\\r\\ ]*(\\d*\\.\\d+|\\d+)?[\\0\\t\\n\\f\\r\\ ]*(\\d*\\.\\d+|\\d+)?[\\0\\t\\n\\f\\r\\ ]+(g|rg|k)/; // eslint-disable-line @stylistic/max-len\n\nconst getDefaultColor = (field: {\n  getDefaultAppearance(): string | undefined;\n}) => {\n  const da = field.getDefaultAppearance() ?? '';\n  const daMatch = findLastMatch(da, colorRegex).match;\n\n  const [, c1, c2, c3, c4, colorSpace] = daMatch ?? [];\n\n  if (colorSpace === 'g' && c1) {\n    return grayscale(Number(c1));\n  }\n  if (colorSpace === 'rg' && c1 && c2 && c3) {\n    return rgb(Number(c1), Number(c2), Number(c3));\n  }\n  if (colorSpace === 'k' && c1 && c2 && c3 && c4) {\n    return cmyk(Number(c1), Number(c2), Number(c3), Number(c4));\n  }\n\n  return undefined;\n};\n\nconst updateDefaultAppearance = (\n  field: { setDefaultAppearance(appearance: string): void },\n  color: Color,\n  font?: PDFFont,\n  fontSize: number = 0,\n) => {\n  const da = [\n    setFillingColor(color).toString(),\n    setFontAndSize(font?.name ?? 'dummy__noop', fontSize).toString(),\n  ].join('\\n');\n  field.setDefaultAppearance(da);\n};\n\nexport const defaultCheckBoxAppearanceProvider: AppearanceProviderFor<\n  PDFCheckBox\n> = (checkBox, widget) => {\n  // The `/DA` entry can be at the widget or field level - so we handle both\n  const widgetColor = getDefaultColor(widget);\n  const fieldColor = getDefaultColor(checkBox.acroField);\n\n  const rectangle = widget.getRectangle();\n  const ap = widget.getAppearanceCharacteristics();\n  const bs = widget.getBorderStyle();\n\n  const borderWidth = bs?.getWidth() ?? 0;\n  const rotation = reduceRotation(ap?.getRotation());\n  const { width, height } = adjustDimsForRotation(rectangle, rotation);\n\n  const rotate = rotateInPlace({ ...rectangle, rotation });\n\n  const black = rgb(0, 0, 0);\n  const borderColor = componentsToColor(ap?.getBorderColor()) ?? black;\n  const normalBackgroundColor = componentsToColor(ap?.getBackgroundColor());\n  const downBackgroundColor = componentsToColor(ap?.getBackgroundColor(), 0.8);\n\n  // Update color\n  const textColor = widgetColor ?? fieldColor ?? black;\n  if (widgetColor) {\n    updateDefaultAppearance(widget, textColor);\n  } else {\n    updateDefaultAppearance(checkBox.acroField, textColor);\n  }\n\n  const options = {\n    x: 0 + borderWidth / 2,\n    y: 0 + borderWidth / 2,\n    width: width - borderWidth,\n    height: height - borderWidth,\n    thickness: 1.5,\n    borderWidth,\n    borderColor,\n    markColor: textColor,\n  };\n\n  return {\n    normal: {\n      on: [\n        ...rotate,\n        ...drawCheckBox({\n          ...options,\n          color: normalBackgroundColor,\n          filled: true,\n        }),\n      ],\n      off: [\n        ...rotate,\n        ...drawCheckBox({\n          ...options,\n          color: normalBackgroundColor,\n          filled: false,\n        }),\n      ],\n    },\n    down: {\n      on: [\n        ...rotate,\n        ...drawCheckBox({\n          ...options,\n          color: downBackgroundColor,\n          filled: true,\n        }),\n      ],\n      off: [\n        ...rotate,\n        ...drawCheckBox({\n          ...options,\n          color: downBackgroundColor,\n          filled: false,\n        }),\n      ],\n    },\n  };\n};\n\nexport const defaultRadioGroupAppearanceProvider: AppearanceProviderFor<\n  PDFRadioGroup\n> = (radioGroup, widget) => {\n  // The `/DA` entry can be at the widget or field level - so we handle both\n  const widgetColor = getDefaultColor(widget);\n  const fieldColor = getDefaultColor(radioGroup.acroField);\n\n  const rectangle = widget.getRectangle();\n  const ap = widget.getAppearanceCharacteristics();\n  const bs = widget.getBorderStyle();\n\n  const borderWidth = bs?.getWidth() ?? 0;\n  const rotation = reduceRotation(ap?.getRotation());\n  const { width, height } = adjustDimsForRotation(rectangle, rotation);\n\n  const rotate = rotateInPlace({ ...rectangle, rotation });\n\n  const black = rgb(0, 0, 0);\n  const borderColor = componentsToColor(ap?.getBorderColor()) ?? black;\n  const normalBackgroundColor = componentsToColor(ap?.getBackgroundColor());\n  const downBackgroundColor = componentsToColor(ap?.getBackgroundColor(), 0.8);\n\n  // Update color\n  const textColor = widgetColor ?? fieldColor ?? black;\n  if (widgetColor) {\n    updateDefaultAppearance(widget, textColor);\n  } else {\n    updateDefaultAppearance(radioGroup.acroField, textColor);\n  }\n\n  const options = {\n    x: width / 2,\n    y: height / 2,\n    width: width - borderWidth,\n    height: height - borderWidth,\n    borderWidth,\n    borderColor,\n    dotColor: textColor,\n  };\n\n  return {\n    normal: {\n      on: [\n        ...rotate,\n        ...drawRadioButton({\n          ...options,\n          color: normalBackgroundColor,\n          filled: true,\n        }),\n      ],\n      off: [\n        ...rotate,\n        ...drawRadioButton({\n          ...options,\n          color: normalBackgroundColor,\n          filled: false,\n        }),\n      ],\n    },\n    down: {\n      on: [\n        ...rotate,\n        ...drawRadioButton({\n          ...options,\n          color: downBackgroundColor,\n          filled: true,\n        }),\n      ],\n      off: [\n        ...rotate,\n        ...drawRadioButton({\n          ...options,\n          color: downBackgroundColor,\n          filled: false,\n        }),\n      ],\n    },\n  };\n};\n\nexport const defaultButtonAppearanceProvider: AppearanceProviderFor<\n  PDFButton\n> = (button, widget, font) => {\n  // The `/DA` entry can be at the widget or field level - so we handle both\n  const widgetColor = getDefaultColor(widget);\n  const fieldColor = getDefaultColor(button.acroField);\n  const widgetFontSize = getDefaultFontSize(widget);\n  const fieldFontSize = getDefaultFontSize(button.acroField);\n\n  const rectangle = widget.getRectangle();\n  const ap = widget.getAppearanceCharacteristics();\n  const bs = widget.getBorderStyle();\n  const captions = ap?.getCaptions();\n  const normalText = captions?.normal ?? '';\n  const downText = captions?.down ?? normalText ?? '';\n\n  const borderWidth = bs?.getWidth() ?? 0;\n  const rotation = reduceRotation(ap?.getRotation());\n  const { width, height } = adjustDimsForRotation(rectangle, rotation);\n\n  const rotate = rotateInPlace({ ...rectangle, rotation });\n\n  const black = rgb(0, 0, 0);\n\n  const borderColor = componentsToColor(ap?.getBorderColor());\n  const normalBackgroundColor = componentsToColor(ap?.getBackgroundColor());\n  const downBackgroundColor = componentsToColor(ap?.getBackgroundColor(), 0.8);\n\n  const bounds = {\n    x: borderWidth,\n    y: borderWidth,\n    width: width - borderWidth * 2,\n    height: height - borderWidth * 2,\n  };\n  const normalLayout = layoutSinglelineText(normalText, {\n    alignment: TextAlignment.Center,\n    fontSize: widgetFontSize ?? fieldFontSize,\n    font,\n    bounds,\n  });\n  const downLayout = layoutSinglelineText(downText, {\n    alignment: TextAlignment.Center,\n    fontSize: widgetFontSize ?? fieldFontSize,\n    font,\n    bounds,\n  });\n\n  // Update font size and color\n  const fontSize = Math.min(normalLayout.fontSize, downLayout.fontSize);\n  const textColor = widgetColor ?? fieldColor ?? black;\n  if (widgetColor || widgetFontSize !== undefined) {\n    updateDefaultAppearance(widget, textColor, font, fontSize);\n  } else {\n    updateDefaultAppearance(button.acroField, textColor, font, fontSize);\n  }\n\n  const options = {\n    x: 0 + borderWidth / 2,\n    y: 0 + borderWidth / 2,\n    width: width - borderWidth,\n    height: height - borderWidth,\n    borderWidth,\n    borderColor,\n    textColor,\n    font: font.name,\n    fontSize,\n  };\n\n  return {\n    normal: [\n      ...rotate,\n      ...drawButton({\n        ...options,\n        color: normalBackgroundColor,\n        textLines: [normalLayout.line],\n      }),\n    ],\n    down: [\n      ...rotate,\n      ...drawButton({\n        ...options,\n        color: downBackgroundColor,\n        textLines: [downLayout.line],\n      }),\n    ],\n  };\n};\n\nexport const defaultTextFieldAppearanceProvider: AppearanceProviderFor<\n  PDFTextField\n> = (textField, widget, font) => {\n  // The `/DA` entry can be at the widget or field level - so we handle both\n  const widgetColor = getDefaultColor(widget);\n  const fieldColor = getDefaultColor(textField.acroField);\n  const widgetFontSize = getDefaultFontSize(widget);\n  const fieldFontSize = getDefaultFontSize(textField.acroField);\n\n  const rectangle = widget.getRectangle();\n  const ap = widget.getAppearanceCharacteristics();\n  const bs = widget.getBorderStyle();\n  const text = textField.getText() ?? '';\n\n  const borderWidth = bs?.getWidth() ?? 0;\n  const rotation = reduceRotation(ap?.getRotation());\n  const { width, height } = adjustDimsForRotation(rectangle, rotation);\n\n  const rotate = rotateInPlace({ ...rectangle, rotation });\n\n  const black = rgb(0, 0, 0);\n\n  const borderColor = componentsToColor(ap?.getBorderColor());\n  const normalBackgroundColor = componentsToColor(ap?.getBackgroundColor());\n\n  let textLines: TextPosition[];\n  let fontSize: number;\n\n  const padding = textField.isCombed() ? 0 : 1;\n  const bounds = {\n    x: borderWidth + padding,\n    y: borderWidth + padding,\n    width: width - (borderWidth + padding) * 2,\n    height: height - (borderWidth + padding) * 2,\n  };\n  if (textField.isMultiline()) {\n    const layout = layoutMultilineText(text, {\n      alignment: textField.getAlignment(),\n      fontSize: widgetFontSize ?? fieldFontSize,\n      font,\n      bounds,\n    });\n    textLines = layout.lines;\n    fontSize = layout.fontSize;\n  } else if (textField.isCombed()) {\n    const layout = layoutCombedText(text, {\n      fontSize: widgetFontSize ?? fieldFontSize,\n      font,\n      bounds,\n      cellCount: textField.getMaxLength() ?? 0,\n    });\n    textLines = layout.cells;\n    fontSize = layout.fontSize;\n  } else {\n    const layout = layoutSinglelineText(text, {\n      alignment: textField.getAlignment(),\n      fontSize: widgetFontSize ?? fieldFontSize,\n      font,\n      bounds,\n    });\n    textLines = [layout.line];\n    fontSize = layout.fontSize;\n  }\n\n  // Update font size and color\n  const textColor = widgetColor ?? fieldColor ?? black;\n  if (widgetColor || widgetFontSize !== undefined) {\n    updateDefaultAppearance(widget, textColor, font, fontSize);\n  } else {\n    updateDefaultAppearance(textField.acroField, textColor, font, fontSize);\n  }\n\n  const options = {\n    x: 0 + borderWidth / 2,\n    y: 0 + borderWidth / 2,\n    width: width - borderWidth,\n    height: height - borderWidth,\n    borderWidth: borderWidth ?? 0,\n    borderColor,\n    textColor,\n    font: font.name,\n    fontSize,\n    color: normalBackgroundColor,\n    textLines,\n    padding,\n  };\n\n  return [...rotate, ...drawTextField(options)];\n};\n\nexport const defaultDropdownAppearanceProvider: AppearanceProviderFor<\n  PDFDropdown\n> = (dropdown, widget, font) => {\n  // The `/DA` entry can be at the widget or field level - so we handle both\n  const widgetColor = getDefaultColor(widget);\n  const fieldColor = getDefaultColor(dropdown.acroField);\n  const widgetFontSize = getDefaultFontSize(widget);\n  const fieldFontSize = getDefaultFontSize(dropdown.acroField);\n\n  const rectangle = widget.getRectangle();\n  const ap = widget.getAppearanceCharacteristics();\n  const bs = widget.getBorderStyle();\n  const text = dropdown.getSelected()[0] ?? '';\n\n  const borderWidth = bs?.getWidth() ?? 0;\n  const rotation = reduceRotation(ap?.getRotation());\n  const { width, height } = adjustDimsForRotation(rectangle, rotation);\n\n  const rotate = rotateInPlace({ ...rectangle, rotation });\n\n  const black = rgb(0, 0, 0);\n\n  const borderColor = componentsToColor(ap?.getBorderColor());\n  const normalBackgroundColor = componentsToColor(ap?.getBackgroundColor());\n\n  const padding = 1;\n  const bounds = {\n    x: borderWidth + padding,\n    y: borderWidth + padding,\n    width: width - (borderWidth + padding) * 2,\n    height: height - (borderWidth + padding) * 2,\n  };\n  const { line, fontSize } = layoutSinglelineText(text, {\n    alignment: TextAlignment.Left,\n    fontSize: widgetFontSize ?? fieldFontSize,\n    font,\n    bounds,\n  });\n\n  // Update font size and color\n  const textColor = widgetColor ?? fieldColor ?? black;\n  if (widgetColor || widgetFontSize !== undefined) {\n    updateDefaultAppearance(widget, textColor, font, fontSize);\n  } else {\n    updateDefaultAppearance(dropdown.acroField, textColor, font, fontSize);\n  }\n\n  const options = {\n    x: 0 + borderWidth / 2,\n    y: 0 + borderWidth / 2,\n    width: width - borderWidth,\n    height: height - borderWidth,\n    borderWidth: borderWidth ?? 0,\n    borderColor,\n    textColor,\n    font: font.name,\n    fontSize,\n    color: normalBackgroundColor,\n    textLines: [line],\n    padding,\n  };\n\n  return [...rotate, ...drawTextField(options)];\n};\n\nexport const defaultOptionListAppearanceProvider: AppearanceProviderFor<\n  PDFOptionList\n> = (optionList, widget, font) => {\n  // The `/DA` entry can be at the widget or field level - so we handle both\n  const widgetColor = getDefaultColor(widget);\n  const fieldColor = getDefaultColor(optionList.acroField);\n  const widgetFontSize = getDefaultFontSize(widget);\n  const fieldFontSize = getDefaultFontSize(optionList.acroField);\n\n  const rectangle = widget.getRectangle();\n  const ap = widget.getAppearanceCharacteristics();\n  const bs = widget.getBorderStyle();\n\n  const borderWidth = bs?.getWidth() ?? 0;\n  const rotation = reduceRotation(ap?.getRotation());\n  const { width, height } = adjustDimsForRotation(rectangle, rotation);\n\n  const rotate = rotateInPlace({ ...rectangle, rotation });\n\n  const black = rgb(0, 0, 0);\n\n  const borderColor = componentsToColor(ap?.getBorderColor());\n  const normalBackgroundColor = componentsToColor(ap?.getBackgroundColor());\n\n  const options = optionList.getOptions();\n  const selected = optionList.getSelected();\n\n  if (optionList.isSorted()) options.sort();\n\n  let text = '';\n  for (let idx = 0, len = options.length; idx < len; idx++) {\n    text += options[idx];\n    if (idx < len - 1) text += '\\n';\n  }\n\n  const padding = 1;\n  const bounds = {\n    x: borderWidth + padding,\n    y: borderWidth + padding,\n    width: width - (borderWidth + padding) * 2,\n    height: height - (borderWidth + padding) * 2,\n  };\n  const { lines, fontSize, lineHeight } = layoutMultilineText(text, {\n    alignment: TextAlignment.Left,\n    fontSize: widgetFontSize ?? fieldFontSize,\n    font,\n    bounds,\n  });\n\n  const selectedLines: number[] = [];\n  for (let idx = 0, len = lines.length; idx < len; idx++) {\n    const line = lines[idx];\n    if (selected.includes(line.text)) selectedLines.push(idx);\n  }\n\n  const blue = rgb(153 / 255, 193 / 255, 218 / 255);\n\n  // Update font size and color\n  const textColor = widgetColor ?? fieldColor ?? black;\n  if (widgetColor || widgetFontSize !== undefined) {\n    updateDefaultAppearance(widget, textColor, font, fontSize);\n  } else {\n    updateDefaultAppearance(optionList.acroField, textColor, font, fontSize);\n  }\n\n  return [\n    ...rotate,\n    ...drawOptionList({\n      x: 0 + borderWidth / 2,\n      y: 0 + borderWidth / 2,\n      width: width - borderWidth,\n      height: height - borderWidth,\n      borderWidth: borderWidth ?? 0,\n      borderColor,\n      textColor,\n      font: font.name,\n      fontSize,\n      color: normalBackgroundColor,\n      textLines: lines,\n      lineHeight,\n      selectedColor: blue,\n      selectedLines,\n      padding,\n    }),\n  ];\n};\n","import Embeddable from 'src/api/Embeddable';\nimport PDFDocument from 'src/api/PDFDocument';\nimport { PDFPageEmbedder, PDFRef } from 'src/core';\nimport { assertIs } from 'src/utils';\n\n/**\n * Represents a PDF page that has been embedded in a [[PDFDocument]].\n */\nexport default class PDFEmbeddedPage implements Embeddable {\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFDocument.embedPdf]] and\n   * > [[PDFDocument.embedPage]] methods, which will create instances of\n   * > [[PDFEmbeddedPage]] for you.\n   *\n   * Create an instance of [[PDFEmbeddedPage]] from an existing ref and embedder\n   *\n   * @param ref The unique reference for this embedded page.\n   * @param doc The document to which the embedded page will belong.\n   * @param embedder The embedder that will be used to embed the page.\n   */\n  static of = (ref: PDFRef, doc: PDFDocument, embedder: PDFPageEmbedder) =>\n    new PDFEmbeddedPage(ref, doc, embedder);\n\n  /** The unique reference assigned to this embedded page within the document. */\n  readonly ref: PDFRef;\n\n  /** The document to which this embedded page belongs. */\n  readonly doc: PDFDocument;\n\n  /** The width of this page in pixels. */\n  readonly width: number;\n\n  /** The height of this page in pixels. */\n  readonly height: number;\n\n  private alreadyEmbedded = false;\n  private readonly embedder: PDFPageEmbedder;\n\n  private constructor(\n    ref: PDFRef,\n    doc: PDFDocument,\n    embedder: PDFPageEmbedder,\n  ) {\n    assertIs(ref, 'ref', [[PDFRef, 'PDFRef']]);\n    assertIs(doc, 'doc', [[PDFDocument, 'PDFDocument']]);\n    assertIs(embedder, 'embedder', [[PDFPageEmbedder, 'PDFPageEmbedder']]);\n\n    this.ref = ref;\n    this.doc = doc;\n    this.width = embedder.width;\n    this.height = embedder.height;\n\n    this.embedder = embedder;\n  }\n\n  /**\n   * Compute the width and height of this page after being scaled by the\n   * given `factor`. For example:\n   * ```js\n   * embeddedPage.width  // => 500\n   * embeddedPage.height // => 250\n   *\n   * const scaled = embeddedPage.scale(0.5)\n   * scaled.width  // => 250\n   * scaled.height // => 125\n   * ```\n   * This operation is often useful before drawing a page with\n   * [[PDFPage.drawPage]] to compute the `width` and `height` options.\n   * @param factor The factor by which this page should be scaled.\n   * @returns The width and height of the page after being scaled.\n   */\n  scale(factor: number) {\n    assertIs(factor, 'factor', ['number']);\n    return { width: this.width * factor, height: this.height * factor };\n  }\n\n  /**\n   * Get the width and height of this page. For example:\n   * ```js\n   * const { width, height } = embeddedPage.size()\n   * ```\n   * @returns The width and height of the page.\n   */\n  size() {\n    return this.scale(1);\n  }\n\n  /**\n   * > **NOTE:** You probably don't need to call this method directly. The\n   * > [[PDFDocument.save]] and [[PDFDocument.saveAsBase64]] methods will\n   * > automatically ensure all embeddable pages get embedded.\n   *\n   * Embed this embeddable page in its document.\n   *\n   * @returns Resolves when the embedding is complete.\n   */\n  async embed(): Promise<void> {\n    if (!this.alreadyEmbedded) {\n      await this.embedder.embedIntoContext(this.doc.context, this.ref);\n      this.alreadyEmbedded = true;\n    }\n  }\n}\n","import Embeddable from 'src/api//Embeddable';\nimport PDFDocument from 'src/api/PDFDocument';\nimport {\n  CustomFontEmbedder,\n  PDFHexString,\n  PDFRef,\n  StandardFontEmbedder,\n} from 'src/core';\nimport { assertIs, assertOrUndefined } from 'src/utils';\n\nexport type FontEmbedder = CustomFontEmbedder | StandardFontEmbedder;\n\n/**\n * Represents a font that has been embedded in a [[PDFDocument]].\n */\nexport default class PDFFont implements Embeddable {\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFDocument.embedFont]] and\n   * > [[PDFDocument.embedStandardFont]] methods, which will create instances\n   * > of [[PDFFont]] for you.\n   *\n   * Create an instance of [[PDFFont]] from an existing ref and embedder\n   *\n   * @param ref The unique reference for this font.\n   * @param doc The document to which the font will belong.\n   * @param embedder The embedder that will be used to embed the font.\n   */\n  static of = (ref: PDFRef, doc: PDFDocument, embedder: FontEmbedder) =>\n    new PDFFont(ref, doc, embedder);\n\n  /** The unique reference assigned to this font within the document. */\n  readonly ref: PDFRef;\n\n  /** The document to which this font belongs. */\n  readonly doc: PDFDocument;\n\n  /** The name of this font. */\n  readonly name: string;\n\n  private modified = true;\n  private readonly embedder: FontEmbedder;\n\n  private constructor(ref: PDFRef, doc: PDFDocument, embedder: FontEmbedder) {\n    assertIs(ref, 'ref', [[PDFRef, 'PDFRef']]);\n    assertIs(doc, 'doc', [[PDFDocument, 'PDFDocument']]);\n    assertIs(embedder, 'embedder', [\n      [CustomFontEmbedder, 'CustomFontEmbedder'],\n      [StandardFontEmbedder, 'StandardFontEmbedder'],\n    ]);\n\n    this.ref = ref;\n    this.doc = doc;\n    this.name = embedder.fontName;\n\n    this.embedder = embedder;\n  }\n\n  /**\n   * > **NOTE:** You probably don't need to call this method directly. The\n   * > [[PDFPage.drawText]] method will automatically encode the text it is\n   * > given.\n   *\n   * Encodes a string of text in this font.\n   *\n   * @param text The text to be encoded.\n   * @returns The encoded text as a hex string.\n   */\n  encodeText(text: string): PDFHexString {\n    assertIs(text, 'text', ['string']);\n    this.modified = true;\n    return this.embedder.encodeText(text);\n  }\n\n  /**\n   * Measure the width of a string of text drawn in this font at a given size.\n   * For example:\n   * ```js\n   * const width = font.widthOfTextAtSize('Foo Bar Qux Baz', 36)\n   * ```\n   * @param text The string of text to be measured.\n   * @param size The font size to be used for this measurement.\n   * @returns The width of the string of text when drawn in this font at the\n   *          given size.\n   */\n  widthOfTextAtSize(text: string, size: number): number {\n    assertIs(text, 'text', ['string']);\n    assertIs(size, 'size', ['number']);\n    return this.embedder.widthOfTextAtSize(text, size);\n  }\n\n  /**\n   * Measure the height of this font at a given size. For example:\n   * ```js\n   * const height = font.heightAtSize(24)\n   * ```\n   *\n   * The `options.descender` value controls whether or not the font's\n   * descender is included in the height calculation.\n   *\n   * @param size The font size to be used for this measurement.\n   * @param options The options to be used when computing this measurement.\n   * @returns The height of this font at the given size.\n   */\n  heightAtSize(size: number, options?: { descender?: boolean }): number {\n    assertIs(size, 'size', ['number']);\n    assertOrUndefined(options?.descender, 'options.descender', ['boolean']);\n    return this.embedder.heightOfFontAtSize(size, {\n      descender: options?.descender ?? true,\n    });\n  }\n\n  /**\n   * Compute the font size at which this font is a given height. For example:\n   * ```js\n   * const fontSize = font.sizeAtHeight(12)\n   * ```\n   * @param height The height to be used for this calculation.\n   * @returns The font size at which this font is the given height.\n   */\n  sizeAtHeight(height: number): number {\n    assertIs(height, 'height', ['number']);\n    return this.embedder.sizeOfFontAtHeight(height);\n  }\n\n  /**\n   * Get the set of unicode code points that can be represented by this font.\n   * @returns The set of unicode code points supported by this font.\n   */\n  getCharacterSet(): number[] {\n    if (this.embedder instanceof StandardFontEmbedder) {\n      return this.embedder.encoding.supportedCodePoints;\n    } else {\n      return this.embedder.font.characterSet;\n    }\n  }\n\n  /**\n   * > **NOTE:** You probably don't need to call this method directly. The\n   * > [[PDFDocument.save]] and [[PDFDocument.saveAsBase64]] methods will\n   * > automatically ensure all fonts get embedded.\n   *\n   * Embed this font in its document.\n   *\n   * @returns Resolves when the embedding is complete.\n   */\n  async embed(): Promise<void> {\n    // TODO: Cleanup orphan embedded objects if a font is embedded multiple times...\n    if (this.modified) {\n      await this.embedder.embedIntoContext(this.doc.context, this.ref);\n      this.modified = false;\n    }\n  }\n}\n","import Embeddable from 'src/api/Embeddable';\nimport PDFDocument from 'src/api/PDFDocument';\nimport { JpegEmbedder, PDFRef, PngEmbedder } from 'src/core';\nimport { assertIs } from 'src/utils';\n\nexport type ImageEmbedder = JpegEmbedder | PngEmbedder;\n\n/**\n * Represents an image that has been embedded in a [[PDFDocument]].\n */\nexport default class PDFImage implements Embeddable {\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFDocument.embedPng]] and [[PDFDocument.embedJpg]]\n   * > methods, which will create instances of [[PDFImage]] for you.\n   *\n   * Create an instance of [[PDFImage]] from an existing ref and embedder\n   *\n   * @param ref The unique reference for this image.\n   * @param doc The document to which the image will belong.\n   * @param embedder The embedder that will be used to embed the image.\n   */\n  static of = (ref: PDFRef, doc: PDFDocument, embedder: ImageEmbedder) =>\n    new PDFImage(ref, doc, embedder);\n\n  /** The unique reference assigned to this image within the document. */\n  readonly ref: PDFRef;\n\n  /** The document to which this image belongs. */\n  readonly doc: PDFDocument;\n\n  /** The width of this image in pixels. */\n  readonly width: number;\n\n  /** The height of this image in pixels. */\n  readonly height: number;\n\n  private embedder: ImageEmbedder | undefined;\n  private embedTask: Promise<PDFRef> | undefined;\n\n  private constructor(ref: PDFRef, doc: PDFDocument, embedder: ImageEmbedder) {\n    assertIs(ref, 'ref', [[PDFRef, 'PDFRef']]);\n    assertIs(doc, 'doc', [[PDFDocument, 'PDFDocument']]);\n    assertIs(embedder, 'embedder', [\n      [JpegEmbedder, 'JpegEmbedder'],\n      [PngEmbedder, 'PngEmbedder'],\n    ]);\n\n    this.ref = ref;\n    this.doc = doc;\n    this.width = embedder.width;\n    this.height = embedder.height;\n\n    this.embedder = embedder;\n  }\n\n  /**\n   * Compute the width and height of this image after being scaled by the\n   * given `factor`. For example:\n   * ```js\n   * image.width  // => 500\n   * image.height // => 250\n   *\n   * const scaled = image.scale(0.5)\n   * scaled.width  // => 250\n   * scaled.height // => 125\n   * ```\n   * This operation is often useful before drawing an image with\n   * [[PDFPage.drawImage]] to compute the `width` and `height` options.\n   * @param factor The factor by which this image should be scaled.\n   * @returns The width and height of the image after being scaled.\n   */\n  scale(factor: number) {\n    assertIs(factor, 'factor', ['number']);\n    return { width: this.width * factor, height: this.height * factor };\n  }\n\n  /**\n   * Get the width and height of this image after scaling it as large as\n   * possible while maintaining its aspect ratio and not exceeding the\n   * specified `width` and `height`. For example:\n   * ```\n   * image.width  // => 500\n   * image.height // => 250\n   *\n   * const scaled = image.scaleToFit(750, 1000)\n   * scaled.width  // => 750\n   * scaled.height // => 375\n   * ```\n   * The `width` and `height` parameters can also be thought of as the width\n   * and height of a box that the scaled image must fit within.\n   * @param width The bounding box's width.\n   * @param height The bounding box's height.\n   * @returns The width and height of the image after being scaled.\n   */\n  scaleToFit(width: number, height: number) {\n    assertIs(width, 'width', ['number']);\n    assertIs(height, 'height', ['number']);\n\n    const imgWidthScale = width / this.width;\n    const imgHeightScale = height / this.height;\n    const scale = Math.min(imgWidthScale, imgHeightScale);\n\n    return this.scale(scale);\n  }\n\n  /**\n   * Get the width and height of this image. For example:\n   * ```js\n   * const { width, height } = image.size()\n   * ```\n   * @returns The width and height of the image.\n   */\n  size() {\n    return this.scale(1);\n  }\n\n  /**\n   * > **NOTE:** You probably don't need to call this method directly. The\n   * > [[PDFDocument.save]] and [[PDFDocument.saveAsBase64]] methods will\n   * > automatically ensure all images get embedded.\n   *\n   * Embed this image in its document.\n   *\n   * @returns Resolves when the embedding is complete.\n   */\n  async embed(): Promise<void> {\n    if (!this.embedder) return;\n\n    // The image should only be embedded once. If there's a pending embed\n    // operation then wait on it. Otherwise we need to start the embed.\n    if (!this.embedTask) {\n      const { doc, ref } = this;\n      this.embedTask = this.embedder.embedIntoContext(doc.context, ref);\n    }\n    await this.embedTask;\n\n    // We clear `this.embedder` so that the indirectly referenced image data\n    // can be garbage collected, thus avoiding a memory leak.\n    // See https://github.com/Hopding/pdf-lib/pull/1032/files.\n    this.embedder = undefined;\n  }\n}\n","export enum ImageAlignment {\n  Left = 0,\n  Center = 1,\n  Right = 2\n}\n","import PDFDocument from 'src/api/PDFDocument';\nimport PDFFont from 'src/api/PDFFont';\nimport { AppearanceMapping } from 'src/api/form/appearances';\nimport { Color, colorToComponents, setFillingColor } from 'src/api/colors';\nimport {\n  Rotation,\n  toDegrees,\n  rotateRectangle,\n  reduceRotation,\n  adjustDimsForRotation,\n  degrees,\n} from 'src/api/rotations';\n\nimport {\n  PDFRef,\n  PDFWidgetAnnotation,\n  PDFOperator,\n  PDFName,\n  PDFDict,\n  MethodNotImplementedError,\n  AcroFieldFlags,\n  PDFAcroTerminal,\n  AnnotationFlags,\n} from 'src/core';\nimport { assertIs, assertMultiple, assertOrUndefined } from 'src/utils';\nimport { ImageAlignment } from '../image';\nimport PDFImage from '../PDFImage';\nimport { drawImage, rotateInPlace } from '../operations';\n\nexport interface FieldAppearanceOptions {\n  x?: number;\n  y?: number;\n  width?: number;\n  height?: number;\n  textColor?: Color;\n  backgroundColor?: Color;\n  borderColor?: Color;\n  borderWidth?: number;\n  rotate?: Rotation;\n  font?: PDFFont;\n  hidden?: boolean;\n}\n\nexport const assertFieldAppearanceOptions = (\n  options?: FieldAppearanceOptions,\n) => {\n  assertOrUndefined(options?.x, 'options.x', ['number']);\n  assertOrUndefined(options?.y, 'options.y', ['number']);\n  assertOrUndefined(options?.width, 'options.width', ['number']);\n  assertOrUndefined(options?.height, 'options.height', ['number']);\n  assertOrUndefined(options?.textColor, 'options.textColor', [\n    [Object, 'Color'],\n  ]);\n  assertOrUndefined(options?.backgroundColor, 'options.backgroundColor', [\n    [Object, 'Color'],\n  ]);\n  assertOrUndefined(options?.borderColor, 'options.borderColor', [\n    [Object, 'Color'],\n  ]);\n  assertOrUndefined(options?.borderWidth, 'options.borderWidth', ['number']);\n  assertOrUndefined(options?.rotate, 'options.rotate', [[Object, 'Rotation']]);\n};\n\n/**\n * Represents a field of a [[PDFForm]].\n *\n * This class is effectively abstract. All fields in a [[PDFForm]] will\n * actually be an instance of a subclass of this class.\n *\n * Note that each field in a PDF is represented by a single field object.\n * However, a given field object may be rendered at multiple locations within\n * the document (across one or more pages). The rendering of a field is\n * controlled by its widgets. Each widget causes its field to be displayed at a\n * particular location in the document.\n *\n * Most of the time each field in a PDF has only a single widget, and thus is\n * only rendered once. However, if a field is rendered multiple times, it will\n * have multiple widgets - one for each location it is rendered.\n *\n * This abstraction of field objects and widgets is defined in the PDF\n * specification and dictates how PDF files store fields and where they are\n * to be rendered.\n */\nexport default class PDFField {\n  /** The low-level PDFAcroTerminal wrapped by this field. */\n  readonly acroField: PDFAcroTerminal;\n\n  /** The unique reference assigned to this field within the document. */\n  readonly ref: PDFRef;\n\n  /** The document to which this field belongs. */\n  readonly doc: PDFDocument;\n\n  protected constructor(\n    acroField: PDFAcroTerminal,\n    ref: PDFRef,\n    doc: PDFDocument,\n  ) {\n    assertIs(acroField, 'acroField', [[PDFAcroTerminal, 'PDFAcroTerminal']]);\n    assertIs(ref, 'ref', [[PDFRef, 'PDFRef']]);\n    assertIs(doc, 'doc', [[PDFDocument, 'PDFDocument']]);\n\n    this.acroField = acroField;\n    this.ref = ref;\n    this.doc = doc;\n  }\n\n  /**\n   * Get the fully qualified name of this field. For example:\n   * ```js\n   * const fields = form.getFields()\n   * fields.forEach(field => {\n   *   const name = field.getName()\n   *   console.log('Field name:', name)\n   * })\n   * ```\n   * Note that PDF fields are structured as a tree. Each field is the\n   * descendent of a series of ancestor nodes all the way up to the form node,\n   * which is always the root of the tree. Each node in the tree (except for\n   * the form node) has a partial name. Partial names can be composed of any\n   * unicode characters except a period (`.`). The fully qualified name of a\n   * field is composed of the partial names of all its ancestors joined\n   * with periods. This means that splitting the fully qualified name on\n   * periods and taking the last element of the resulting array will give you\n   * the partial name of a specific field.\n   * @returns The fully qualified name of this field.\n   */\n  getName(): string {\n    return this.acroField.getFullyQualifiedName() ?? '';\n  }\n\n  /**\n   * Returns `true` if this field is read only. This means that PDF readers\n   * will not allow users to interact with the field or change its value. See\n   * [[PDFField.enableReadOnly]] and [[PDFField.disableReadOnly]].\n   * For example:\n   * ```js\n   * const field = form.getField('some.field')\n   * if (field.isReadOnly()) console.log('Read only is enabled')\n   * ```\n   * @returns Whether or not this is a read only field.\n   */\n  isReadOnly(): boolean {\n    return this.acroField.hasFlag(AcroFieldFlags.ReadOnly);\n  }\n\n  /**\n   * Prevent PDF readers from allowing users to interact with this field or\n   * change its value. The field will not respond to mouse or keyboard input.\n   * For example:\n   * ```js\n   * const field = form.getField('some.field')\n   * field.enableReadOnly()\n   * ```\n   * Useful for fields whose values are computed, imported from a database, or\n   * prefilled by software before being displayed to the user.\n   */\n  enableReadOnly() {\n    this.acroField.setFlagTo(AcroFieldFlags.ReadOnly, true);\n  }\n\n  /**\n   * Allow users to interact with this field and change its value in PDF\n   * readers via mouse and keyboard input. For example:\n   * ```js\n   * const field = form.getField('some.field')\n   * field.disableReadOnly()\n   * ```\n   */\n  disableReadOnly() {\n    this.acroField.setFlagTo(AcroFieldFlags.ReadOnly, false);\n  }\n\n  /**\n   * Returns `true` if this field must have a value when the form is submitted.\n   * See [[PDFField.enableRequired]] and [[PDFField.disableRequired]].\n   * For example:\n   * ```js\n   * const field = form.getField('some.field')\n   * if (field.isRequired()) console.log('Field is required')\n   * ```\n   * @returns Whether or not this field is required.\n   */\n  isRequired(): boolean {\n    return this.acroField.hasFlag(AcroFieldFlags.Required);\n  }\n\n  /**\n   * Require this field to have a value when the form is submitted.\n   * For example:\n   * ```js\n   * const field = form.getField('some.field')\n   * field.enableRequired()\n   * ```\n   */\n  enableRequired() {\n    this.acroField.setFlagTo(AcroFieldFlags.Required, true);\n  }\n\n  /**\n   * Do not require this field to have a value when the form is submitted.\n   * For example:\n   * ```js\n   * const field = form.getField('some.field')\n   * field.disableRequired()\n   * ```\n   */\n  disableRequired() {\n    this.acroField.setFlagTo(AcroFieldFlags.Required, false);\n  }\n\n  /**\n   * Returns `true` if this field's value should be exported when the form is\n   * submitted. See [[PDFField.enableExporting]] and\n   * [[PDFField.disableExporting]].\n   * For example:\n   * ```js\n   * const field = form.getField('some.field')\n   * if (field.isExported()) console.log('Exporting is enabled')\n   * ```\n   * @returns Whether or not this field's value should be exported.\n   */\n  isExported(): boolean {\n    return !this.acroField.hasFlag(AcroFieldFlags.NoExport);\n  }\n\n  /**\n   * Indicate that this field's value should be exported when the form is\n   * submitted in a PDF reader. For example:\n   * ```js\n   * const field = form.getField('some.field')\n   * field.enableExporting()\n   * ```\n   */\n  enableExporting() {\n    this.acroField.setFlagTo(AcroFieldFlags.NoExport, false);\n  }\n\n  /**\n   * Indicate that this field's value should **not** be exported when the form\n   * is submitted in a PDF reader. For example:\n   * ```js\n   * const field = form.getField('some.field')\n   * field.disableExporting()\n   * ```\n   */\n  disableExporting() {\n    this.acroField.setFlagTo(AcroFieldFlags.NoExport, true);\n  }\n\n  /** @ignore */\n  needsAppearancesUpdate(): boolean {\n    throw new MethodNotImplementedError(\n      this.constructor.name,\n      'needsAppearancesUpdate',\n    );\n  }\n\n  /** @ignore */\n  defaultUpdateAppearances(_font: PDFFont) {\n    throw new MethodNotImplementedError(\n      this.constructor.name,\n      'defaultUpdateAppearances',\n    );\n  }\n\n  protected markAsDirty() {\n    this.doc.getForm().markFieldAsDirty(this.ref);\n  }\n\n  protected markAsClean() {\n    this.doc.getForm().markFieldAsClean(this.ref);\n  }\n\n  protected isDirty(): boolean {\n    return this.doc.getForm().fieldIsDirty(this.ref);\n  }\n\n  protected createWidget(options: {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n    textColor?: Color;\n    backgroundColor?: Color;\n    borderColor?: Color;\n    borderWidth: number;\n    rotate: Rotation;\n    caption?: string;\n    hidden?: boolean;\n    page?: PDFRef;\n  }): PDFWidgetAnnotation {\n    const textColor = options.textColor;\n    const backgroundColor = options.backgroundColor;\n    const borderColor = options.borderColor;\n    const borderWidth = options.borderWidth;\n    const degreesAngle = toDegrees(options.rotate);\n    const caption = options.caption;\n    const x = options.x;\n    const y = options.y;\n    const width = options.width + borderWidth;\n    const height = options.height + borderWidth;\n    const hidden = Boolean(options.hidden);\n    const pageRef = options.page;\n\n    assertMultiple(degreesAngle, 'degreesAngle', 90);\n\n    // Create a widget for this field\n    const widget = PDFWidgetAnnotation.create(this.doc.context, this.ref);\n\n    // Set widget properties\n    const rect = rotateRectangle(\n      { x, y, width, height },\n      borderWidth,\n      degreesAngle,\n    );\n    widget.setRectangle(rect);\n\n    if (pageRef) widget.setP(pageRef);\n\n    const ac = widget.getOrCreateAppearanceCharacteristics();\n    if (backgroundColor) {\n      ac.setBackgroundColor(colorToComponents(backgroundColor));\n    }\n    ac.setRotation(degreesAngle);\n    if (caption) ac.setCaptions({ normal: caption });\n    if (borderColor) ac.setBorderColor(colorToComponents(borderColor));\n\n    const bs = widget.getOrCreateBorderStyle();\n    if (borderWidth !== undefined) bs.setWidth(borderWidth);\n\n    widget.setFlagTo(AnnotationFlags.Print, true);\n    widget.setFlagTo(AnnotationFlags.Hidden, hidden);\n    widget.setFlagTo(AnnotationFlags.Invisible, false);\n\n    // Set acrofield properties\n    if (textColor) {\n      const da = this.acroField.getDefaultAppearance() ?? '';\n      const newDa = da + '\\n' + setFillingColor(textColor).toString();\n      this.acroField.setDefaultAppearance(newDa);\n    }\n\n    return widget;\n  }\n\n  protected updateWidgetAppearanceWithFont(\n    widget: PDFWidgetAnnotation,\n    font: PDFFont,\n    { normal, rollover, down }: AppearanceMapping<PDFOperator[]>,\n  ) {\n    this.updateWidgetAppearances(widget, {\n      normal: this.createAppearanceStream(widget, normal, font),\n      rollover: rollover && this.createAppearanceStream(widget, rollover, font),\n      down: down && this.createAppearanceStream(widget, down, font),\n    });\n  }\n\n  protected updateOnOffWidgetAppearance(\n    widget: PDFWidgetAnnotation,\n    onValue: PDFName,\n    {\n      normal,\n      rollover,\n      down,\n    }: AppearanceMapping<{ on: PDFOperator[]; off: PDFOperator[] }>,\n  ) {\n    this.updateWidgetAppearances(widget, {\n      normal: this.createAppearanceDict(widget, normal, onValue),\n      rollover:\n        rollover && this.createAppearanceDict(widget, rollover, onValue),\n      down: down && this.createAppearanceDict(widget, down, onValue),\n    });\n  }\n\n  protected updateWidgetAppearances(\n    widget: PDFWidgetAnnotation,\n    { normal, rollover, down }: AppearanceMapping<PDFRef | PDFDict>,\n  ) {\n    widget.setNormalAppearance(normal);\n\n    if (rollover) {\n      widget.setRolloverAppearance(rollover);\n    } else {\n      widget.removeRolloverAppearance();\n    }\n\n    if (down) {\n      widget.setDownAppearance(down);\n    } else {\n      widget.removeDownAppearance();\n    }\n  }\n\n  // // TODO: Do we need to do this...?\n  // private foo(font: PDFFont, dict: PDFDict) {\n  //   if (!dict.lookup(PDFName.of('DR'))) {\n  //     dict.set(PDFName.of('DR'), dict.context.obj({}));\n  //   }\n  //   const DR = dict.lookup(PDFName.of('DR'), PDFDict);\n\n  //   if (!DR.lookup(PDFName.of('Font'))) {\n  //     DR.set(PDFName.of('Font'), dict.context.obj({}));\n  //   }\n  //   const Font = DR.lookup(PDFName.of('Font'), PDFDict);\n\n  //   Font.set(PDFName.of(font.name), font.ref);\n  // }\n\n  private createAppearanceStream(\n    widget: PDFWidgetAnnotation,\n    appearance: PDFOperator[],\n    font?: PDFFont,\n  ): PDFRef {\n    const { context } = this.acroField.dict;\n    const { width, height } = widget.getRectangle();\n\n    // TODO: Do we need to do this...?\n    // if (font) {\n    //   this.foo(font, widget.dict);\n    //   this.foo(font, this.doc.getForm().acroForm.dict);\n    // }\n    // END TODO\n\n    const Resources = font && { Font: { [font.name]: font.ref } };\n    const stream = context.formXObject(appearance, {\n      Resources,\n      BBox: context.obj([0, 0, width, height]),\n      Matrix: context.obj([1, 0, 0, 1, 0, 0]),\n    });\n    const streamRef = context.register(stream);\n\n    return streamRef;\n  }\n\n  /**\n   * Create a FormXObject of the supplied image and add it to context.\n   * The FormXObject size is calculated based on the widget (including\n   * the alignment).\n   * @param widget The widget that should display the image.\n   * @param alignment The alignment of the image.\n   * @param image The image that should be displayed.\n   * @returns The ref for the FormXObject that was added to the context.\n   */\n  protected createImageAppearanceStream(\n    widget: PDFWidgetAnnotation,\n    image: PDFImage,\n    alignment: ImageAlignment,\n  ): PDFRef {\n    // NOTE: This implementation doesn't handle image borders.\n    // NOTE: Acrobat seems to resize the image (maybe even skewing its aspect\n    //       ratio) to fit perfectly within the widget's rectangle. This method\n    //       does not currently do that. Should there be an option for that?\n\n    const { context } = this.acroField.dict;\n\n    const rectangle = widget.getRectangle();\n    const ap = widget.getAppearanceCharacteristics();\n    const bs = widget.getBorderStyle();\n\n    const borderWidth = bs?.getWidth() ?? 0;\n    const rotation = reduceRotation(ap?.getRotation());\n\n    const rotate = rotateInPlace({ ...rectangle, rotation });\n\n    const adj = adjustDimsForRotation(rectangle, rotation);\n    const imageDims = image.scaleToFit(\n      adj.width - borderWidth * 2,\n      adj.height - borderWidth * 2,\n    );\n\n    // Support borders on images and maybe other properties\n    const options = {\n      x: borderWidth,\n      y: borderWidth,\n      width: imageDims.width,\n      height: imageDims.height,\n      //\n      rotate: degrees(0),\n      xSkew: degrees(0),\n      ySkew: degrees(0),\n    };\n\n    if (alignment === ImageAlignment.Center) {\n      options.x += (adj.width - borderWidth * 2) / 2 - imageDims.width / 2;\n      options.y += (adj.height - borderWidth * 2) / 2 - imageDims.height / 2;\n    } else if (alignment === ImageAlignment.Right) {\n      options.x = adj.width - borderWidth - imageDims.width;\n      options.y = adj.height - borderWidth - imageDims.height;\n    }\n\n    const imageName = this.doc.context.addRandomSuffix('Image', 10);\n    const appearance = [...rotate, ...drawImage(imageName, options)];\n    ////////////\n\n    const Resources = { XObject: { [imageName]: image.ref } };\n    const stream = context.formXObject(appearance, {\n      Resources,\n      BBox: context.obj([0, 0, rectangle.width, rectangle.height]),\n      Matrix: context.obj([1, 0, 0, 1, 0, 0]),\n    });\n\n    return context.register(stream);\n  }\n\n  private createAppearanceDict(\n    widget: PDFWidgetAnnotation,\n    appearance: { on: PDFOperator[]; off: PDFOperator[] },\n    onValue: PDFName,\n  ): PDFDict {\n    const { context } = this.acroField.dict;\n\n    const onStreamRef = this.createAppearanceStream(widget, appearance.on);\n    const offStreamRef = this.createAppearanceStream(widget, appearance.off);\n\n    const appearanceDict = context.obj({});\n    appearanceDict.set(onValue, onStreamRef);\n    appearanceDict.set(PDFName.of('Off'), offStreamRef);\n\n    return appearanceDict;\n  }\n}\n","import PDFDocument from 'src/api/PDFDocument';\nimport PDFPage from 'src/api/PDFPage';\nimport {\n  AppearanceProviderFor,\n  normalizeAppearance,\n  defaultCheckBoxAppearanceProvider,\n} from 'src/api/form/appearances';\nimport { rgb } from 'src/api/colors';\nimport { degrees } from 'src/api/rotations';\nimport PDFField, {\n  FieldAppearanceOptions,\n  assertFieldAppearanceOptions,\n} from 'src/api/form/PDFField';\n\nimport {\n  PDFName,\n  PDFRef,\n  PDFDict,\n  PDFAcroCheckBox,\n  PDFWidgetAnnotation,\n} from 'src/core';\nimport { assertIs, assertOrUndefined } from 'src/utils';\n\n/**\n * Represents a check box field of a [[PDFForm]].\n *\n * [[PDFCheckBox]] fields are interactive boxes that users can click with their\n * mouse. This type of [[PDFField]] has two states: `on` and `off`. The purpose\n * of a check box is to enable users to select from one or more options, where\n * each option is represented by a single check box. Check boxes are typically\n * square in shape and display a check mark when they are in the `on` state.\n */\nexport default class PDFCheckBox extends PDFField {\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFForm.getCheckBox]] method, which will create an\n   * > instance of [[PDFCheckBox]] for you.\n   *\n   * Create an instance of [[PDFCheckBox]] from an existing acroCheckBox and ref\n   *\n   * @param acroCheckBox The underlying `PDFAcroCheckBox` for this check box.\n   * @param ref The unique reference for this check box.\n   * @param doc The document to which this check box will belong.\n   */\n  static of = (acroCheckBox: PDFAcroCheckBox, ref: PDFRef, doc: PDFDocument) =>\n    new PDFCheckBox(acroCheckBox, ref, doc);\n\n  /** The low-level PDFAcroCheckBox wrapped by this check box. */\n  readonly acroField: PDFAcroCheckBox;\n\n  private constructor(\n    acroCheckBox: PDFAcroCheckBox,\n    ref: PDFRef,\n    doc: PDFDocument,\n  ) {\n    super(acroCheckBox, ref, doc);\n\n    assertIs(acroCheckBox, 'acroCheckBox', [\n      [PDFAcroCheckBox, 'PDFAcroCheckBox'],\n    ]);\n\n    this.acroField = acroCheckBox;\n  }\n\n  /**\n   * Mark this check box. This operation is analogous to a human user clicking\n   * a check box to fill it in a PDF reader. This method will update the\n   * underlying state of the check box field to indicate it has been selected.\n   * PDF libraries and readers will be able to extract this value from the\n   * saved document and determine that it was selected.\n   *\n   * For example:\n   * ```js\n   * const checkBox = form.getCheckBox('some.checkBox.field')\n   * checkBox.check()\n   * ```\n   *\n   * This method will mark this check box as dirty, causing its appearance\n   * streams to be updated when either [[PDFDocument.save]] or\n   * [[PDFForm.updateFieldAppearances]] is called. The updated appearance\n   * streams will display a check mark inside the widgets of this check box\n   * field.\n   */\n  check() {\n    const onValue = this.acroField.getOnValue() ?? PDFName.of('Yes');\n    this.markAsDirty();\n    this.acroField.setValue(onValue);\n  }\n\n  /**\n   * Clears this check box. This operation is analogous to a human user clicking\n   * a check box to unmark it in a PDF reader. This method will update the\n   * underlying state of the check box field to indicate it has been deselected.\n   * PDF libraries and readers will be able to extract this value from the\n   * saved document and determine that it was not selected.\n   *\n   * For example:\n   * ```js\n   * const checkBox = form.getCheckBox('some.checkBox.field')\n   * checkBox.uncheck()\n   * ```\n   *\n   * This method will mark this check box as dirty. See [[PDFCheckBox.check]]\n   * for more details about what this means.\n   */\n  uncheck() {\n    this.markAsDirty();\n    this.acroField.setValue(PDFName.of('Off'));\n  }\n\n  /**\n   * Returns `true` if this check box is selected (either by a human user via\n   * a PDF reader, or else programmatically via software). For example:\n   * ```js\n   * const checkBox = form.getCheckBox('some.checkBox.field')\n   * if (checkBox.isChecked()) console.log('check box is selected')\n   * ```\n   * @returns Whether or not this check box is selected.\n   */\n  isChecked(): boolean {\n    const onValue = this.acroField.getOnValue();\n    return !!onValue && onValue === this.acroField.getValue();\n  }\n\n  /**\n   * Show this check box on the specified page. For example:\n   * ```js\n   * const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const page = pdfDoc.addPage()\n   *\n   * const form = pdfDoc.getForm()\n   * const checkBox = form.createCheckBox('some.checkBox.field')\n   *\n   * checkBox.addToPage(page, {\n   *   x: 50,\n   *   y: 75,\n   *   width: 25,\n   *   height: 25,\n   *   textColor: rgb(1, 0, 0),\n   *   backgroundColor: rgb(0, 1, 0),\n   *   borderColor: rgb(0, 0, 1),\n   *   borderWidth: 2,\n   *   rotate: degrees(90),\n   * })\n   * ```\n   * This will create a new widget for this check box field.\n   * @param page The page to which this check box widget should be added.\n   * @param options The options to be used when adding this check box widget.\n   */\n  addToPage(page: PDFPage, options?: FieldAppearanceOptions) {\n    assertIs(page, 'page', [[PDFPage, 'PDFPage']]);\n    assertFieldAppearanceOptions(options);\n\n    if (!options) options = {};\n\n    if (!('textColor' in options)) options.textColor = rgb(0, 0, 0);\n    if (!('backgroundColor' in options)) options.backgroundColor = rgb(1, 1, 1);\n    if (!('borderColor' in options)) options.borderColor = rgb(0, 0, 0);\n    if (!('borderWidth' in options)) options.borderWidth = 1;\n\n    // Create a widget for this check box\n    const widget = this.createWidget({\n      x: options.x ?? 0,\n      y: options.y ?? 0,\n      width: options.width ?? 50,\n      height: options.height ?? 50,\n      textColor: options.textColor,\n      backgroundColor: options.backgroundColor,\n      borderColor: options.borderColor,\n      borderWidth: options.borderWidth ?? 0,\n      rotate: options.rotate ?? degrees(0),\n      hidden: options.hidden,\n      page: page.ref,\n    });\n    const widgetRef = this.doc.context.register(widget.dict);\n\n    // Add widget to this field\n    this.acroField.addWidget(widgetRef);\n\n    // Set appearance streams for widget\n    widget.setAppearanceState(PDFName.of('Off'));\n    this.updateWidgetAppearance(widget, PDFName.of('Yes'));\n\n    // Add widget to the given page\n    page.node.addAnnot(widgetRef);\n  }\n\n  /**\n   * Returns `true` if any of this check box's widgets do not have an\n   * appearance stream for its current state. For example:\n   * ```js\n   * const checkBox = form.getCheckBox('some.checkBox.field')\n   * if (checkBox.needsAppearancesUpdate()) console.log('Needs update')\n   * ```\n   * @returns Whether or not this check box needs an appearance update.\n   */\n  needsAppearancesUpdate(): boolean {\n    const widgets = this.acroField.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      const state = widget.getAppearanceState();\n      const normal = widget.getAppearances()?.normal;\n\n      if (!(normal instanceof PDFDict)) return true;\n      if (state && !normal.has(state)) return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Update the appearance streams for each of this check box's widgets using\n   * the default appearance provider for check boxes. For example:\n   * ```js\n   * const checkBox = form.getCheckBox('some.checkBox.field')\n   * checkBox.defaultUpdateAppearances()\n   * ```\n   */\n  defaultUpdateAppearances() {\n    this.updateAppearances();\n  }\n\n  /**\n   * Update the appearance streams for each of this check box's widgets using\n   * the given appearance provider. If no `provider` is passed, the default\n   * appearance provider for check boxs will be used. For example:\n   * ```js\n   * const checkBox = form.getCheckBox('some.checkBox.field')\n   * checkBox.updateAppearances((field, widget) => {\n   *   ...\n   *   return {\n   *     normal: { on: drawCheckBox(...), off: drawCheckBox(...) },\n   *     down: { on: drawCheckBox(...), off: drawCheckBox(...) },\n   *   }\n   * })\n   * ```\n   * @param provider Optionally, the appearance provider to be used for\n   *                 generating the contents of the appearance streams.\n   */\n  updateAppearances(provider?: AppearanceProviderFor<PDFCheckBox>) {\n    assertOrUndefined(provider, 'provider', [Function]);\n\n    const widgets = this.acroField.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      const onValue = widget.getOnValue() ?? PDFName.of('Yes');\n      if (!onValue) continue;\n      this.updateWidgetAppearance(widget, onValue, provider);\n    }\n    this.markAsClean();\n  }\n\n  private updateWidgetAppearance(\n    widget: PDFWidgetAnnotation,\n    onValue: PDFName,\n    provider?: AppearanceProviderFor<PDFCheckBox>,\n  ) {\n    const apProvider = provider ?? defaultCheckBoxAppearanceProvider;\n    const appearances = normalizeAppearance(apProvider(this, widget));\n    this.updateOnOffWidgetAppearance(widget, onValue, appearances);\n  }\n}\n","import PDFDocument from 'src/api/PDFDocument';\nimport PDFPage from 'src/api/PDFPage';\nimport PDFFont from 'src/api/PDFFont';\nimport PDFField, {\n  FieldAppearanceOptions,\n  assertFieldAppearanceOptions,\n} from 'src/api/form/PDFField';\nimport {\n  AppearanceProviderFor,\n  normalizeAppearance,\n  defaultDropdownAppearanceProvider,\n} from 'src/api/form/appearances';\nimport { rgb } from 'src/api/colors';\nimport { degrees } from 'src/api/rotations';\n\nimport {\n  PDFHexString,\n  PDFRef,\n  PDFString,\n  PDFStream,\n  PDFWidgetAnnotation,\n  PDFAcroComboBox,\n  AcroChoiceFlags,\n} from 'src/core';\nimport { assertIs, assertOrUndefined, assertPositive } from 'src/utils';\n\n/**\n * Represents a dropdown field of a [[PDFForm]].\n *\n * [[PDFDropdown]] fields are interactive text boxes that display a single\n * element (the currently selected value). The purpose of a dropdown is to\n * enable users to select a single option from a set of possible options. Users\n * can click on a dropdown to view the full list of options it provides.\n * Clicking on an option in the list will cause it to be selected and displayed\n * in the dropdown's text box. Some dropdowns allow users to enter text\n * directly into the box from their keyboard, rather than only being allowed to\n * choose an option from the list (see [[PDFDropdown.isEditable]]).\n */\nexport default class PDFDropdown extends PDFField {\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFForm.getDropdown]] method, which will create an\n   * > instance of [[PDFDropdown]] for you.\n   *\n   * Create an instance of [[PDFDropdown]] from an existing acroComboBox and ref\n   *\n   * @param acroComboBox The underlying `PDFAcroComboBox` for this dropdown.\n   * @param ref The unique reference for this dropdown.\n   * @param doc The document to which this dropdown will belong.\n   */\n  static of = (acroComboBox: PDFAcroComboBox, ref: PDFRef, doc: PDFDocument) =>\n    new PDFDropdown(acroComboBox, ref, doc);\n\n  /** The low-level PDFAcroComboBox wrapped by this dropdown. */\n  readonly acroField: PDFAcroComboBox;\n\n  private constructor(\n    acroComboBox: PDFAcroComboBox,\n    ref: PDFRef,\n    doc: PDFDocument,\n  ) {\n    super(acroComboBox, ref, doc);\n\n    assertIs(acroComboBox, 'acroComboBox', [\n      [PDFAcroComboBox, 'PDFAcroComboBox'],\n    ]);\n\n    this.acroField = acroComboBox;\n  }\n\n  /**\n   * Get the list of available options for this dropdown. These options will be\n   * displayed to users who click on this dropdown in a PDF reader.\n   * For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * const options = dropdown.getOptions()\n   * console.log('Dropdown options:', options)\n   * ```\n   * @returns The options for this dropdown.\n   */\n  getOptions(): string[] {\n    const rawOptions = this.acroField.getOptions();\n\n    const options = new Array<string>(rawOptions.length);\n    for (let idx = 0, len = options.length; idx < len; idx++) {\n      const { display, value } = rawOptions[idx];\n      options[idx] = (display ?? value).decodeText();\n    }\n\n    return options;\n  }\n\n  /**\n   * Get the selected options for this dropdown. These are the values that were\n   * selected by a human user via a PDF reader, or programatically via\n   * software.\n   * For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * const selections = dropdown.getSelected()\n   * console.log('Dropdown selections:', selections)\n   * ```\n   * > **NOTE:** Note that PDF readers only display one selected option when\n   * > rendering dropdowns. However, the PDF specification does allow for\n   * > multiple values to be selected in a dropdown. As such, the `pdf-lib`\n   * > API supports this. However, in most cases the array returned by this\n   * > method will contain only a single element (or no elements).\n   * @returns The selected options in this dropdown.\n   */\n  getSelected(): string[] {\n    const values = this.acroField.getValues();\n\n    const selected = new Array<string>(values.length);\n    for (let idx = 0, len = values.length; idx < len; idx++) {\n      selected[idx] = values[idx].decodeText();\n    }\n\n    return selected;\n  }\n\n  /**\n   * Set the list of options that are available for this dropdown. These are\n   * the values that will be available for users to select when they view this\n   * dropdown in a PDF reader. Note that preexisting options for this dropdown\n   * will be removed. Only the values passed as `options` will be available to\n   * select.\n   * For example:\n   * ```js\n   * const dropdown = form.getDropdown('planets.dropdown')\n   * dropdown.setOptions(['Earth', 'Mars', 'Pluto', 'Venus'])\n   * ```\n   * @param options The options that should be available in this dropdown.\n   */\n  setOptions(options: string[]) {\n    assertIs(options, 'options', [Array]);\n\n    const optionObjects = new Array<{ value: PDFHexString }>(options.length);\n    for (let idx = 0, len = options.length; idx < len; idx++) {\n      optionObjects[idx] = { value: PDFHexString.fromText(options[idx]) };\n    }\n    this.acroField.setOptions(optionObjects);\n  }\n\n  /**\n   * Add to the list of options that are available for this dropdown. Users\n   * will be able to select these values in a PDF reader. In addition to the\n   * values passed as `options`, any preexisting options for this dropdown will\n   * still be available for users to select.\n   * For example:\n   * ```js\n   * const dropdown = form.getDropdown('rockets.dropdown')\n   * dropdown.addOptions(['Saturn IV', 'Falcon Heavy'])\n   * ```\n   * @param options New options that should be available in this dropdown.\n   */\n  addOptions(options: string | string[]) {\n    assertIs(options, 'options', ['string', Array]);\n\n    const optionsArr = Array.isArray(options) ? options : [options];\n\n    const existingOptions: {\n      value: PDFString | PDFHexString;\n      display?: PDFString | PDFHexString;\n    }[] = this.acroField.getOptions();\n\n    const newOptions = new Array<{ value: PDFHexString }>(optionsArr.length);\n    for (let idx = 0, len = optionsArr.length; idx < len; idx++) {\n      newOptions[idx] = { value: PDFHexString.fromText(optionsArr[idx]) };\n    }\n\n    this.acroField.setOptions(existingOptions.concat(newOptions));\n  }\n\n  /**\n   * Select one or more values for this dropdown. This operation is analogous\n   * to a human user opening the dropdown in a PDF reader and clicking on a\n   * value to select it. This method will update the underlying state of the\n   * dropdown to indicate which values have been selected. PDF libraries and\n   * readers will be able to extract these values from the saved document and\n   * determine which values were selected.\n   *\n   * For example:\n   * ```js\n   * const dropdown = form.getDropdown('best.superhero.dropdown')\n   * dropdown.select('One Punch Man')\n   * ```\n   *\n   * This method will mark this dropdown as dirty, causing its appearance\n   * streams to be updated when either [[PDFDocument.save]] or\n   * [[PDFForm.updateFieldAppearances]] is called. The updated streams will\n   * display the selected option inside the widgets of this dropdown.\n   *\n   * **IMPORTANT:** The default font used to update appearance streams is\n   * [[StandardFonts.Helvetica]]. Note that this is a WinAnsi font. This means\n   * that encoding errors will be thrown if the selected option for this field\n   * contains characters outside the WinAnsi character set (the latin alphabet).\n   *\n   * Embedding a custom font and passing it to\n   * [[PDFForm.updateFieldAppearances]] or [[PDFDropdown.updateAppearances]]\n   * allows you to generate appearance streams with characters outside the\n   * latin alphabet (assuming the custom font supports them).\n   *\n   * Selecting an option that does not exist in this dropdown's option list\n   * (see [[PDFDropdown.getOptions]]) will enable editing on this dropdown\n   * (see [[PDFDropdown.enableEditing]]).\n   *\n   * > **NOTE:** PDF readers only display one selected option when rendering\n   * > dropdowns. However, the PDF specification does allow for multiple values\n   * > to be selected in a dropdown. As such, the `pdf-lib` API supports this.\n   * > However, it is not recommended to select more than one value with this\n   * > method, as only one will be visible. [[PDFOptionList]] fields are better\n   * > suited for displaying multiple selected values.\n   *\n   * @param options The options to be selected.\n   * @param merge Whether or not existing selections should be preserved.\n   */\n  select(options: string | string[], merge = false) {\n    assertIs(options, 'options', ['string', Array]);\n    assertIs(merge, 'merge', ['boolean']);\n\n    const optionsArr = Array.isArray(options) ? options : [options];\n\n    const validOptions = this.getOptions();\n    const hasCustomOption = optionsArr.find(\n      (option) => !validOptions.includes(option),\n    );\n    if (hasCustomOption) this.enableEditing();\n\n    this.markAsDirty();\n\n    if (optionsArr.length > 1 || (optionsArr.length === 1 && merge)) {\n      this.enableMultiselect();\n    }\n\n    const values = new Array<PDFHexString>(optionsArr.length);\n    for (let idx = 0, len = optionsArr.length; idx < len; idx++) {\n      values[idx] = PDFHexString.fromText(optionsArr[idx]);\n    }\n\n    if (merge) {\n      const existingValues = this.acroField.getValues();\n      this.acroField.setValues(existingValues.concat(values));\n    } else {\n      this.acroField.setValues(values);\n    }\n  }\n\n  /**\n   * Clear all selected values for this dropdown. This operation is equivalent\n   * to selecting an empty list. This method will update the underlying state\n   * of the dropdown to indicate that no values have been selected.\n   * For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * dropdown.clear()\n   * ```\n   * This method will mark this text field as dirty. See [[PDFDropdown.select]]\n   * for more details about what this means.\n   */\n  clear() {\n    this.markAsDirty();\n    this.acroField.setValues([]);\n  }\n\n  /**\n   * Set the font size for this field. Larger font sizes will result in larger\n   * text being displayed when PDF readers render this dropdown. Font sizes may\n   * be integer or floating point numbers. Supplying a negative font size will\n   * cause this method to throw an error.\n   *\n   * For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * dropdown.setFontSize(4)\n   * dropdown.setFontSize(15.7)\n   * ```\n   *\n   * > This method depends upon the existence of a default appearance\n   * > (`/DA`) string. If this field does not have a default appearance string,\n   * > or that string does not contain a font size (via the `Tf` operator),\n   * > then this method will throw an error.\n   *\n   * @param fontSize The font size to be used when rendering text in this field.\n   */\n  setFontSize(fontSize: number) {\n    assertPositive(fontSize, 'fontSize');\n    this.acroField.setFontSize(fontSize);\n    this.markAsDirty();\n  }\n\n  /**\n   * Returns `true` if users are allowed to edit the selected value of this\n   * dropdown directly and are not constrained by the list of available\n   * options. See [[PDFDropdown.enableEditing]] and\n   * [[PDFDropdown.disableEditing]]. For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * if (dropdown.isEditable()) console.log('Editing is enabled')\n   * ```\n   * @returns Whether or not this dropdown is editable.\n   */\n  isEditable(): boolean {\n    return this.acroField.hasFlag(AcroChoiceFlags.Edit);\n  }\n\n  /**\n   * Allow users to edit the selected value of this dropdown in PDF readers\n   * with their keyboard. This means that the selected value of this dropdown\n   * will not be constrained by the list of available options. However, if this\n   * dropdown has any available options, users will still be allowed to select\n   * from that list.\n   * For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * dropdown.enableEditing()\n   * ```\n   */\n  enableEditing() {\n    this.acroField.setFlagTo(AcroChoiceFlags.Edit, true);\n  }\n\n  /**\n   * Do not allow users to edit the selected value of this dropdown in PDF\n   * readers with their keyboard. This will constrain the selected value of\n   * this dropdown to the list of available options. Users will only be able\n   * to select an option from that list.\n   * For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * dropdown.disableEditing()\n   * ```\n   */\n  disableEditing() {\n    this.acroField.setFlagTo(AcroChoiceFlags.Edit, false);\n  }\n\n  /**\n   * Returns `true` if the option list of this dropdown is always displayed\n   * in alphabetical order, irrespective of the order in which the options\n   * were added to the dropdown. See [[PDFDropdown.enableSorting]] and\n   * [[PDFDropdown.disableSorting]]. For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * if (dropdown.isSorted()) console.log('Sorting is enabled')\n   * ```\n   * @returns Whether or not this dropdown's options are sorted.\n   */\n  isSorted(): boolean {\n    return this.acroField.hasFlag(AcroChoiceFlags.Sort);\n  }\n\n  /**\n   * Always display the option list of this dropdown in alphabetical order,\n   * irrespective of the order in which the options were added to this dropdown.\n   * For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * dropdown.enableSorting()\n   * ```\n   */\n  enableSorting() {\n    this.acroField.setFlagTo(AcroChoiceFlags.Sort, true);\n  }\n\n  /**\n   * Do not always display the option list of this dropdown in alphabetical\n   * order. Instead, display the options in whichever order they were added\n   * to the list. For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * dropdown.disableSorting()\n   * ```\n   */\n  disableSorting() {\n    this.acroField.setFlagTo(AcroChoiceFlags.Sort, false);\n  }\n\n  /**\n   * Returns `true` if multiple options can be selected from this dropdown's\n   * option list. See [[PDFDropdown.enableMultiselect]] and\n   * [[PDFDropdown.disableMultiselect]]. For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * if (dropdown.isMultiselect()) console.log('Multiselect is enabled')\n   * ```\n   * @returns Whether or not multiple options can be selected.\n   */\n  isMultiselect(): boolean {\n    return this.acroField.hasFlag(AcroChoiceFlags.MultiSelect);\n  }\n\n  /**\n   * Allow users to select more than one option from this dropdown's option\n   * list. For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * dropdown.enableMultiselect()\n   * ```\n   */\n  enableMultiselect() {\n    this.acroField.setFlagTo(AcroChoiceFlags.MultiSelect, true);\n  }\n\n  /**\n   * Do not allow users to select more than one option from this dropdown's\n   * option list. For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * dropdown.disableMultiselect()\n   * ```\n   */\n  disableMultiselect() {\n    this.acroField.setFlagTo(AcroChoiceFlags.MultiSelect, false);\n  }\n\n  /**\n   * Returns `true` if the selected option should be spell checked by PDF\n   * readers. Spell checking will only be performed if this dropdown allows\n   * editing (see [[PDFDropdown.isEditable]]). See\n   * [[PDFDropdown.enableSpellChecking]] and\n   * [[PDFDropdown.disableSpellChecking]]. For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * if (dropdown.isSpellChecked()) console.log('Spell checking is enabled')\n   * ```\n   * @returns Whether or not this dropdown can be spell checked.\n   */\n  isSpellChecked(): boolean {\n    return !this.acroField.hasFlag(AcroChoiceFlags.DoNotSpellCheck);\n  }\n\n  /**\n   * Allow PDF readers to spell check the selected option of this dropdown.\n   * For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * dropdown.enableSpellChecking()\n   * ```\n   */\n  enableSpellChecking() {\n    this.acroField.setFlagTo(AcroChoiceFlags.DoNotSpellCheck, false);\n  }\n\n  /**\n   * Do not allow PDF readers to spell check the selected option of this\n   * dropdown. For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * dropdown.disableSpellChecking()\n   * ```\n   */\n  disableSpellChecking() {\n    this.acroField.setFlagTo(AcroChoiceFlags.DoNotSpellCheck, true);\n  }\n\n  /**\n   * Returns `true` if the option selected by a user is stored, or \"committed\",\n   * when the user clicks the option. The alternative is that the user's\n   * selection is stored when the user leaves this dropdown field (by clicking\n   * outside of it - on another field, for example). See\n   * [[PDFDropdown.enableSelectOnClick]] and\n   * [[PDFDropdown.disableSelectOnClick]]. For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * if (dropdown.isSelectOnClick()) console.log('Select on click is enabled')\n   * ```\n   * @returns Whether or not options are selected immediately after they are\n   *          clicked.\n   */\n  isSelectOnClick(): boolean {\n    return this.acroField.hasFlag(AcroChoiceFlags.CommitOnSelChange);\n  }\n\n  /**\n   * Store the option selected by a user immediately after the user clicks the\n   * option. Do not wait for the user to leave this dropdown field (by clicking\n   * outside of it - on another field, for example). For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * dropdown.enableSelectOnClick()\n   * ```\n   */\n  enableSelectOnClick() {\n    this.acroField.setFlagTo(AcroChoiceFlags.CommitOnSelChange, true);\n  }\n\n  /**\n   * Wait to store the option selected by a user until they leave this dropdown\n   * field (by clicking outside of it - on another field, for example).\n   * For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * dropdown.disableSelectOnClick()\n   * ```\n   */\n  disableSelectOnClick() {\n    this.acroField.setFlagTo(AcroChoiceFlags.CommitOnSelChange, false);\n  }\n\n  /**\n   * Show this dropdown on the specified page. For example:\n   * ```js\n   * const ubuntuFont = await pdfDoc.embedFont(ubuntuFontBytes)\n   * const page = pdfDoc.addPage()\n   *\n   * const form = pdfDoc.getForm()\n   * const dropdown = form.createDropdown('best.gundam')\n   * dropdown.setOptions(['Exia', 'Dynames'])\n   * dropdown.select('Exia')\n   *\n   * dropdown.addToPage(page, {\n   *   x: 50,\n   *   y: 75,\n   *   width: 200,\n   *   height: 100,\n   *   textColor: rgb(1, 0, 0),\n   *   backgroundColor: rgb(0, 1, 0),\n   *   borderColor: rgb(0, 0, 1),\n   *   borderWidth: 2,\n   *   rotate: degrees(90),\n   *   font: ubuntuFont,\n   * })\n   * ```\n   * This will create a new widget for this dropdown field.\n   * @param page The page to which this dropdown widget should be added.\n   * @param options The options to be used when adding this dropdown widget.\n   */\n  addToPage(page: PDFPage, options?: FieldAppearanceOptions) {\n    assertIs(page, 'page', [[PDFPage, 'PDFPage']]);\n    assertFieldAppearanceOptions(options);\n\n    if (!options) options = {};\n\n    if (!('textColor' in options)) options.textColor = rgb(0, 0, 0);\n    if (!('backgroundColor' in options)) options.backgroundColor = rgb(1, 1, 1);\n    if (!('borderColor' in options)) options.borderColor = rgb(0, 0, 0);\n    if (!('borderWidth' in options)) options.borderWidth = 1;\n\n    // Create a widget for this dropdown\n    const widget = this.createWidget({\n      x: options.x ?? 0,\n      y: options.y ?? 0,\n      width: options.width ?? 200,\n      height: options.height ?? 50,\n      textColor: options.textColor,\n      backgroundColor: options.backgroundColor,\n      borderColor: options.borderColor,\n      borderWidth: options.borderWidth ?? 0,\n      rotate: options.rotate ?? degrees(0),\n      hidden: options.hidden,\n      page: page.ref,\n    });\n    const widgetRef = this.doc.context.register(widget.dict);\n\n    // Add widget to this field\n    this.acroField.addWidget(widgetRef);\n\n    // Set appearance streams for widget\n    const font = options.font ?? this.doc.getForm().getDefaultFont();\n    this.updateWidgetAppearance(widget, font);\n\n    // Add widget to the given page\n    page.node.addAnnot(widgetRef);\n  }\n\n  /**\n   * Returns `true` if this dropdown has been marked as dirty, or if any of\n   * this dropdown's widgets do not have an appearance stream. For example:\n   * ```js\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * if (dropdown.needsAppearancesUpdate()) console.log('Needs update')\n   * ```\n   * @returns Whether or not this dropdown needs an appearance update.\n   */\n  needsAppearancesUpdate(): boolean {\n    if (this.isDirty()) return true;\n\n    const widgets = this.acroField.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      const hasAppearances =\n        widget.getAppearances()?.normal instanceof PDFStream;\n      if (!hasAppearances) return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Update the appearance streams for each of this dropdown's widgets using\n   * the default appearance provider for dropdowns. For example:\n   * ```js\n   * const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * dropdown.defaultUpdateAppearances(helvetica)\n   * ```\n   * @param font The font to be used for creating the appearance streams.\n   */\n  defaultUpdateAppearances(font: PDFFont) {\n    assertIs(font, 'font', [[PDFFont, 'PDFFont']]);\n    this.updateAppearances(font);\n  }\n\n  /**\n   * Update the appearance streams for each of this dropdown's widgets using\n   * the given appearance provider. If no `provider` is passed, the default\n   * appearance provider for dropdowns will be used. For example:\n   * ```js\n   * const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const dropdown = form.getDropdown('some.dropdown.field')\n   * dropdown.updateAppearances(helvetica, (field, widget, font) => {\n   *   ...\n   *   return drawTextField(...)\n   * })\n   * ```\n   * @param font The font to be used for creating the appearance streams.\n   * @param provider Optionally, the appearance provider to be used for\n   *                 generating the contents of the appearance streams.\n   */\n  updateAppearances(\n    font: PDFFont,\n    provider?: AppearanceProviderFor<PDFDropdown>,\n  ) {\n    assertIs(font, 'font', [[PDFFont, 'PDFFont']]);\n    assertOrUndefined(provider, 'provider', [Function]);\n\n    const widgets = this.acroField.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      this.updateWidgetAppearance(widget, font, provider);\n    }\n    this.markAsClean();\n  }\n\n  // getOption(index: number): string {}\n  // getSelectedIndices(): number[] {}\n  // removeOptions(option: string | string[]) {}\n  // removeIndices(option: number[]) {}\n  // deselect(options: string | string[]) {}\n  // deselectIndices(optionIndices: number[]) {}\n\n  private updateWidgetAppearance(\n    widget: PDFWidgetAnnotation,\n    font: PDFFont,\n    provider?: AppearanceProviderFor<PDFDropdown>,\n  ) {\n    const apProvider = provider ?? defaultDropdownAppearanceProvider;\n    const appearances = normalizeAppearance(apProvider(this, widget, font));\n    this.updateWidgetAppearanceWithFont(widget, font, appearances);\n  }\n}\n","import PDFDocument from 'src/api/PDFDocument';\nimport PDFPage from 'src/api/PDFPage';\nimport PDFFont from 'src/api/PDFFont';\nimport PDFField, {\n  FieldAppearanceOptions,\n  assertFieldAppearanceOptions,\n} from 'src/api/form/PDFField';\nimport {\n  AppearanceProviderFor,\n  normalizeAppearance,\n  defaultOptionListAppearanceProvider,\n} from 'src/api/form/appearances';\nimport { rgb } from 'src/api/colors';\nimport { degrees } from 'src/api/rotations';\n\nimport {\n  PDFRef,\n  PDFHexString,\n  PDFString,\n  PDFStream,\n  PDFAcroListBox,\n  AcroChoiceFlags,\n  PDFWidgetAnnotation,\n} from 'src/core';\nimport {\n  assertIs,\n  assertIsSubset,\n  assertOrUndefined,\n  assertPositive,\n} from 'src/utils';\n\n/**\n * Represents an option list field of a [[PDFForm]].\n *\n * [[PDFOptionList]] fields are interactive lists of options. The purpose of an\n * option list is to enable users to select one or more options from a set of\n * possible options. Users are able to see the full set of options without\n * first having to click on the field (though scrolling may be necessary).\n * Clicking an option in the list will cause it to be selected and displayed\n * with a highlighted background. Some option lists allow users to select\n * more than one option (see [[PDFOptionList.isMultiselect]]).\n */\nexport default class PDFOptionList extends PDFField {\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFForm.getOptionList]] method, which will create\n   * > an instance of [[PDFOptionList]] for you.\n   *\n   * Create an instance of [[PDFOptionList]] from an existing acroListBox and\n   * ref\n   *\n   * @param acroComboBox The underlying `PDFAcroListBox` for this option list.\n   * @param ref The unique reference for this option list.\n   * @param doc The document to which this option list will belong.\n   */\n  static of = (acroListBox: PDFAcroListBox, ref: PDFRef, doc: PDFDocument) =>\n    new PDFOptionList(acroListBox, ref, doc);\n\n  /** The low-level PDFAcroListBox wrapped by this option list. */\n  readonly acroField: PDFAcroListBox;\n\n  private constructor(\n    acroListBox: PDFAcroListBox,\n    ref: PDFRef,\n    doc: PDFDocument,\n  ) {\n    super(acroListBox, ref, doc);\n\n    assertIs(acroListBox, 'acroListBox', [[PDFAcroListBox, 'PDFAcroListBox']]);\n\n    this.acroField = acroListBox;\n  }\n\n  /**\n   * Get the list of available options for this option list. These options will\n   * be displayed to users who view this option list in a PDF reader.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * const options = optionList.getOptions()\n   * console.log('Option List options:', options)\n   * ```\n   * @returns The options for this option list.\n   */\n  getOptions(): string[] {\n    const rawOptions = this.acroField.getOptions();\n\n    const options = new Array<string>(rawOptions.length);\n    for (let idx = 0, len = options.length; idx < len; idx++) {\n      const { display, value } = rawOptions[idx];\n      options[idx] = (display ?? value).decodeText();\n    }\n\n    return options;\n  }\n\n  /**\n   * Get the selected options for this option list. These are the values that\n   * were selected by a human user via a PDF reader, or programatically via\n   * software.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * const selections = optionList.getSelected()\n   * console.log('Option List selections:', selections)\n   * ```\n   * @returns The selected options for this option list.\n   */\n  getSelected(): string[] {\n    const values = this.acroField.getValues();\n\n    const selected = new Array<string>(values.length);\n    for (let idx = 0, len = values.length; idx < len; idx++) {\n      selected[idx] = values[idx].decodeText();\n    }\n\n    return selected;\n  }\n\n  /**\n   * Set the list of options that are available for this option list. These are\n   * the values that will be available for users to select when they view this\n   * option list in a PDF reader. Note that preexisting options for this\n   * option list will be removed. Only the values passed as `options` will be\n   * available to select.\n   *\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('planets.optionList')\n   * optionList.setOptions(['Earth', 'Mars', 'Pluto', 'Venus'])\n   * ```\n   *\n   * This method will mark this option list as dirty, causing its appearance\n   * streams to be updated when either [[PDFDocument.save]] or\n   * [[PDFForm.updateFieldAppearances]] is called. The updated streams will\n   * display the options this field contains inside the widgets of this text\n   * field (with selected options highlighted).\n   *\n   * **IMPORTANT:** The default font used to update appearance streams is\n   * [[StandardFonts.Helvetica]]. Note that this is a WinAnsi font. This means\n   * that encoding errors will be thrown if this field contains any options\n   * with characters outside the WinAnsi character set (the latin alphabet).\n   *\n   * Embedding a custom font and passing it to\n   * [[PDFForm.updateFieldAppearances]] or [[PDFOptionList.updateAppearances]]\n   * allows you to generate appearance streams with characters outside the\n   * latin alphabet (assuming the custom font supports them).\n   *\n   * @param options The options that should be available in this option list.\n   */\n  setOptions(options: string[]) {\n    assertIs(options, 'options', [Array]);\n\n    this.markAsDirty();\n    const optionObjects = new Array<{ value: PDFHexString }>(options.length);\n    for (let idx = 0, len = options.length; idx < len; idx++) {\n      optionObjects[idx] = { value: PDFHexString.fromText(options[idx]) };\n    }\n    this.acroField.setOptions(optionObjects);\n  }\n\n  /**\n   * Add to the list of options that are available for this option list. Users\n   * will be able to select these values in a PDF reader. In addition to the\n   * values passed as `options`, any preexisting options for this option list\n   * will still be available for users to select.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('rockets.optionList')\n   * optionList.addOptions(['Saturn IV', 'Falcon Heavy'])\n   * ```\n   * This method will mark this option list as dirty. See\n   * [[PDFOptionList.setOptions]] for more details about what this means.\n   * @param options New options that should be available in this option list.\n   */\n  addOptions(options: string | string[]) {\n    assertIs(options, 'options', ['string', Array]);\n\n    this.markAsDirty();\n\n    const optionsArr = Array.isArray(options) ? options : [options];\n\n    const existingOptions: {\n      value: PDFString | PDFHexString;\n      display?: PDFString | PDFHexString;\n    }[] = this.acroField.getOptions();\n\n    const newOptions = new Array<{ value: PDFHexString }>(optionsArr.length);\n    for (let idx = 0, len = optionsArr.length; idx < len; idx++) {\n      newOptions[idx] = { value: PDFHexString.fromText(optionsArr[idx]) };\n    }\n\n    this.acroField.setOptions(existingOptions.concat(newOptions));\n  }\n\n  /**\n   * Select one or more values for this option list. This operation is analogous\n   * to a human user opening the option list in a PDF reader and clicking on one\n   * or more values to select them. This method will update the underlying state\n   * of the option list to indicate which values have been selected. PDF\n   * libraries and readers will be able to extract these values from the saved\n   * document and determine which values were selected.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('best.superheroes.optionList')\n   * optionList.select(['One Punch Man', 'Iron Man'])\n   * ```\n   * This method will mark this option list as dirty. See\n   * [[PDFOptionList.setOptions]] for more details about what this means.\n   * @param options The options to be selected.\n   * @param merge Whether or not existing selections should be preserved.\n   */\n  select(options: string | string[], merge = false) {\n    assertIs(options, 'options', ['string', Array]);\n    assertIs(merge, 'merge', ['boolean']);\n\n    const optionsArr = Array.isArray(options) ? options : [options];\n\n    const validOptions = this.getOptions();\n    assertIsSubset(optionsArr, 'option', validOptions);\n\n    this.markAsDirty();\n\n    if (optionsArr.length > 1 || (optionsArr.length === 1 && merge)) {\n      this.enableMultiselect();\n    }\n\n    const values = new Array<PDFHexString>(optionsArr.length);\n    for (let idx = 0, len = optionsArr.length; idx < len; idx++) {\n      values[idx] = PDFHexString.fromText(optionsArr[idx]);\n    }\n\n    if (merge) {\n      const existingValues = this.acroField.getValues();\n      this.acroField.setValues(existingValues.concat(values));\n    } else {\n      this.acroField.setValues(values);\n    }\n  }\n\n  /**\n   * Clear all selected values for this option list. This operation is\n   * equivalent to selecting an empty list. This method will update the\n   * underlying state of the option list to indicate that no values have been\n   * selected.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.clear()\n   * ```\n   * This method will mark this option list as dirty. See\n   * [[PDFOptionList.setOptions]] for more details about what this means.\n   */\n  clear() {\n    this.markAsDirty();\n    this.acroField.setValues([]);\n  }\n\n  /**\n   * Set the font size for the text in this field. There needs to be a\n   * default appearance string (DA) set with a font value specified\n   * for this to work. For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.setFontSize(4);\n   * ```\n   * @param fontSize The font size to set the font to.\n   */\n\n  /**\n   * Set the font size for this field. Larger font sizes will result in larger\n   * text being displayed when PDF readers render this option list. Font sizes\n   * may be integer or floating point numbers. Supplying a negative font size\n   * will cause this method to throw an error.\n   *\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.setFontSize(4)\n   * optionList.setFontSize(15.7)\n   * ```\n   *\n   * > This method depends upon the existence of a default appearance\n   * > (`/DA`) string. If this field does not have a default appearance string,\n   * > or that string does not contain a font size (via the `Tf` operator),\n   * > then this method will throw an error.\n   *\n   * @param fontSize The font size to be used when rendering text in this field.\n   */\n  setFontSize(fontSize: number) {\n    assertPositive(fontSize, 'fontSize');\n    this.acroField.setFontSize(fontSize);\n    this.markAsDirty();\n  }\n\n  /**\n   * Returns `true` if the options of this option list are always displayed\n   * in alphabetical order, irrespective of the order in which the options\n   * were added to the option list. See [[PDFOptionList.enableSorting]] and\n   * [[PDFOptionList.disableSorting]]. For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * if (optionList.isSorted()) console.log('Sorting is enabled')\n   * ```\n   * @returns Whether or not this option list is sorted.\n   */\n  isSorted(): boolean {\n    return this.acroField.hasFlag(AcroChoiceFlags.Sort);\n  }\n\n  /**\n   * Always display the options of this option list in alphabetical order,\n   * irrespective of the order in which the options were added to this option\n   * list.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.enableSorting()\n   * ```\n   */\n  enableSorting() {\n    this.acroField.setFlagTo(AcroChoiceFlags.Sort, true);\n  }\n\n  /**\n   * Do not always display the options of this option list in alphabetical\n   * order. Instead, display the options in whichever order they were added\n   * to this option list. For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.disableSorting()\n   * ```\n   */\n  disableSorting() {\n    this.acroField.setFlagTo(AcroChoiceFlags.Sort, false);\n  }\n\n  /**\n   * Returns `true` if multiple options can be selected from this option list.\n   * See [[PDFOptionList.enableMultiselect]] and\n   * [[PDFOptionList.disableMultiselect]]. For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * if (optionList.isMultiselect()) console.log('Multiselect is enabled')\n   * ```\n   * @returns Whether or not multiple options can be selected.\n   */\n  isMultiselect(): boolean {\n    return this.acroField.hasFlag(AcroChoiceFlags.MultiSelect);\n  }\n\n  /**\n   * Allow users to select more than one option from this option list.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.enableMultiselect()\n   * ```\n   */\n  enableMultiselect() {\n    this.acroField.setFlagTo(AcroChoiceFlags.MultiSelect, true);\n  }\n\n  /**\n   * Do not allow users to select more than one option from this option list.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.disableMultiselect()\n   * ```\n   */\n  disableMultiselect() {\n    this.acroField.setFlagTo(AcroChoiceFlags.MultiSelect, false);\n  }\n\n  /**\n   * Returns `true` if the option selected by a user is stored, or \"committed\",\n   * when the user clicks the option. The alternative is that the user's\n   * selection is stored when the user leaves this option list field (by\n   * clicking outside of it - on another field, for example). See\n   * [[PDFOptionList.enableSelectOnClick]] and\n   * [[PDFOptionList.disableSelectOnClick]]. For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * if (optionList.isSelectOnClick()) console.log('Select on click is enabled')\n   * ```\n   * @returns Whether or not options are selected immediately after they are\n   *          clicked.\n   */\n  isSelectOnClick(): boolean {\n    return this.acroField.hasFlag(AcroChoiceFlags.CommitOnSelChange);\n  }\n\n  /**\n   * Store the option selected by a user immediately after the user clicks the\n   * option. Do not wait for the user to leave this option list field (by\n   * clicking outside of it - on another field, for example). For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.enableSelectOnClick()\n   * ```\n   */\n  enableSelectOnClick() {\n    this.acroField.setFlagTo(AcroChoiceFlags.CommitOnSelChange, true);\n  }\n\n  /**\n   * Wait to store the option selected by a user until they leave this option\n   * list field (by clicking outside of it - on another field, for example).\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.disableSelectOnClick()\n   * ```\n   */\n  disableSelectOnClick() {\n    this.acroField.setFlagTo(AcroChoiceFlags.CommitOnSelChange, false);\n  }\n\n  /**\n   * Show this option list on the specified page. For example:\n   * ```js\n   * const ubuntuFont = await pdfDoc.embedFont(ubuntuFontBytes)\n   * const page = pdfDoc.addPage()\n   *\n   * const form = pdfDoc.getForm()\n   * const optionList = form.createOptionList('best.gundams')\n   * optionList.setOptions(['Exia', 'Dynames', 'Kyrios', 'Virtue'])\n   * optionList.select(['Exia', 'Virtue'])\n   *\n   * optionList.addToPage(page, {\n   *   x: 50,\n   *   y: 75,\n   *   width: 200,\n   *   height: 100,\n   *   textColor: rgb(1, 0, 0),\n   *   backgroundColor: rgb(0, 1, 0),\n   *   borderColor: rgb(0, 0, 1),\n   *   borderWidth: 2,\n   *   rotate: degrees(90),\n   *   font: ubuntuFont,\n   * })\n   * ```\n   * This will create a new widget for this option list field.\n   * @param page The page to which this option list widget should be added.\n   * @param options The options to be used when adding this option list widget.\n   */\n  addToPage(page: PDFPage, options?: FieldAppearanceOptions) {\n    assertIs(page, 'page', [[PDFPage, 'PDFPage']]);\n    assertFieldAppearanceOptions(options);\n\n    if (!options) options = {};\n\n    if (!('textColor' in options)) options.textColor = rgb(0, 0, 0);\n    if (!('backgroundColor' in options)) options.backgroundColor = rgb(1, 1, 1);\n    if (!('borderColor' in options)) options.borderColor = rgb(0, 0, 0);\n    if (!('borderWidth' in options)) options.borderWidth = 1;\n\n    // Create a widget for this option list\n    const widget = this.createWidget({\n      x: options.x ?? 0,\n      y: options.y ?? 0,\n      width: options.width ?? 200,\n      height: options.height ?? 100,\n      textColor: options.textColor,\n      backgroundColor: options.backgroundColor,\n      borderColor: options.borderColor,\n      borderWidth: options.borderWidth ?? 0,\n      rotate: options.rotate ?? degrees(0),\n      hidden: options.hidden,\n      page: page.ref,\n    });\n    const widgetRef = this.doc.context.register(widget.dict);\n\n    // Add widget to this field\n    this.acroField.addWidget(widgetRef);\n\n    // Set appearance streams for widget\n    const font = options.font ?? this.doc.getForm().getDefaultFont();\n    this.updateWidgetAppearance(widget, font);\n\n    // Add widget to the given page\n    page.node.addAnnot(widgetRef);\n  }\n\n  /**\n   * Returns `true` if this option list has been marked as dirty, or if any of\n   * this option list's widgets do not have an appearance stream. For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * if (optionList.needsAppearancesUpdate()) console.log('Needs update')\n   * ```\n   * @returns Whether or not this option list needs an appearance update.\n   */\n  needsAppearancesUpdate(): boolean {\n    if (this.isDirty()) return true;\n\n    const widgets = this.acroField.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      const hasAppearances =\n        widget.getAppearances()?.normal instanceof PDFStream;\n      if (!hasAppearances) return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Update the appearance streams for each of this option list's widgets using\n   * the default appearance provider for option lists. For example:\n   * ```js\n   * const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.defaultUpdateAppearances(helvetica)\n   * ```\n   * @param font The font to be used for creating the appearance streams.\n   */\n  defaultUpdateAppearances(font: PDFFont) {\n    assertIs(font, 'font', [[PDFFont, 'PDFFont']]);\n    this.updateAppearances(font);\n  }\n\n  /**\n   * Update the appearance streams for each of this option list's widgets using\n   * the given appearance provider. If no `provider` is passed, the default\n   * appearance provider for option lists will be used. For example:\n   * ```js\n   * const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.updateAppearances(helvetica, (field, widget, font) => {\n   *   ...\n   *   return drawOptionList(...)\n   * })\n   * ```\n   * @param font The font to be used for creating the appearance streams.\n   * @param provider Optionally, the appearance provider to be used for\n   *                 generating the contents of the appearance streams.\n   */\n  updateAppearances(\n    font: PDFFont,\n    provider?: AppearanceProviderFor<PDFOptionList>,\n  ) {\n    assertIs(font, 'font', [[PDFFont, 'PDFFont']]);\n    assertOrUndefined(provider, 'provider', [Function]);\n\n    const widgets = this.acroField.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      this.updateWidgetAppearance(widget, font, provider);\n    }\n    this.markAsClean();\n  }\n\n  // getOption(index: number): string {}\n  // getSelectedIndices(): number[] {}\n  // removeOptions(option: string | string[]) {}\n  // removeIndices(option: number[]) {}\n  // deselect(options: string | string[]) {}\n  // deselectIndices(optionIndices: number[]) {}\n\n  private updateWidgetAppearance(\n    widget: PDFWidgetAnnotation,\n    font: PDFFont,\n    provider?: AppearanceProviderFor<PDFOptionList>,\n  ) {\n    const apProvider = provider ?? defaultOptionListAppearanceProvider;\n    const appearances = normalizeAppearance(apProvider(this, widget, font));\n    this.updateWidgetAppearanceWithFont(widget, font, appearances);\n  }\n}\n","import PDFDocument from 'src/api/PDFDocument';\nimport PDFPage from 'src/api/PDFPage';\nimport PDFField, {\n  FieldAppearanceOptions,\n  assertFieldAppearanceOptions,\n} from 'src/api/form/PDFField';\nimport {\n  AppearanceProviderFor,\n  normalizeAppearance,\n  defaultRadioGroupAppearanceProvider,\n} from 'src/api/form/appearances';\nimport { rgb } from 'src/api/colors';\nimport { degrees } from 'src/api/rotations';\n\nimport {\n  PDFName,\n  PDFRef,\n  PDFHexString,\n  PDFDict,\n  PDFWidgetAnnotation,\n  PDFAcroRadioButton,\n  AcroButtonFlags,\n} from 'src/core';\nimport { assertIs, assertOrUndefined, assertIsOneOf } from 'src/utils';\n\n/**\n * Represents a radio group field of a [[PDFForm]].\n *\n * [[PDFRadioGroup]] fields are collections of radio buttons. The purpose of a\n * radio group is to enable users to select one option from a set of mutually\n * exclusive choices. Each choice in a radio group is represented by a radio\n * button. Radio buttons each have two states: `on` and `off`. At most one\n * radio button in a group may be in the `on` state at any time. Users can\n * click on a radio button to select it (and thereby automatically deselect any\n * other radio button that might have already been selected). Some radio\n * groups allow users to toggle a selected radio button `off` by clicking on\n * it (see [[PDFRadioGroup.isOffToggleable]]).\n *\n * Note that some radio groups allow multiple radio buttons to be in the `on`\n * state at the same type **if** they represent the same underlying value (see\n * [[PDFRadioGroup.isMutuallyExclusive]]).\n */\nexport default class PDFRadioGroup extends PDFField {\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFForm.getOptionList]] method, which will create an\n   * > instance of [[PDFOptionList]] for you.\n   *\n   * Create an instance of [[PDFOptionList]] from an existing acroRadioButton\n   * and ref\n   *\n   * @param acroRadioButton The underlying `PDFAcroRadioButton` for this\n   *                        radio group.\n   * @param ref The unique reference for this radio group.\n   * @param doc The document to which this radio group will belong.\n   */\n  static of = (\n    acroRadioButton: PDFAcroRadioButton,\n    ref: PDFRef,\n    doc: PDFDocument,\n  ) => new PDFRadioGroup(acroRadioButton, ref, doc);\n\n  /** The low-level PDFAcroRadioButton wrapped by this radio group. */\n  readonly acroField: PDFAcroRadioButton;\n\n  private constructor(\n    acroRadioButton: PDFAcroRadioButton,\n    ref: PDFRef,\n    doc: PDFDocument,\n  ) {\n    super(acroRadioButton, ref, doc);\n\n    assertIs(acroRadioButton, 'acroRadioButton', [\n      [PDFAcroRadioButton, 'PDFAcroRadioButton'],\n    ]);\n\n    this.acroField = acroRadioButton;\n  }\n\n  /**\n   * Get the list of available options for this radio group. Each option is\n   * represented by a radio button. These radio buttons are displayed at\n   * various locations in the document, potentially on different pages (though\n   * typically they are stacked horizontally or vertically on the same page).\n   * For example:\n   * ```js\n   * const radioGroup = form.getRadioGroup('some.radioGroup.field')\n   * const options = radioGroup.getOptions()\n   * console.log('Radio Group options:', options)\n   * ```\n   * @returns The options for this radio group.\n   */\n  getOptions(): string[] {\n    const exportValues = this.acroField.getExportValues();\n    if (exportValues) {\n      const exportOptions = new Array<string>(exportValues.length);\n      for (let idx = 0, len = exportValues.length; idx < len; idx++) {\n        exportOptions[idx] = exportValues[idx].decodeText();\n      }\n      return exportOptions;\n    }\n\n    const onValues = this.acroField.getOnValues();\n    const onOptions = new Array<string>(onValues.length);\n    for (let idx = 0, len = onOptions.length; idx < len; idx++) {\n      onOptions[idx] = onValues[idx].decodeText();\n    }\n    return onOptions;\n  }\n\n  /**\n   * Get the selected option for this radio group. The selected option is\n   * represented by the radio button in this group that is turned on. At most\n   * one radio button in a group can be selected. If no buttons in this group\n   * are selected, `undefined` is returned.\n   * For example:\n   * ```js\n   * const radioGroup = form.getRadioGroup('some.radioGroup.field')\n   * const selected = radioGroup.getSelected()\n   * console.log('Selected radio button:', selected)\n   * ```\n   * @returns The selected option for this radio group.\n   */\n  getSelected(): string | undefined {\n    const value = this.acroField.getValue();\n    if (value === PDFName.of('Off')) return undefined;\n    const exportValues = this.acroField.getExportValues();\n    if (exportValues) {\n      const onValues = this.acroField.getOnValues();\n      for (let idx = 0, len = onValues.length; idx < len; idx++) {\n        if (onValues[idx] === value) return exportValues[idx].decodeText();\n      }\n    }\n    return value.decodeText();\n  }\n\n  // // TODO: Figure out why this seems to crash Acrobat. Maybe it's because we\n  // //       aren't removing the widget reference from the page's Annots?\n  // removeOption(option: string) {\n  //   assertIs(option, 'option', ['string']);\n  //   // TODO: Assert is valid `option`!\n\n  //   const onValues = this.acroField.getOnValues();\n  //   const exportValues = this.acroField.getExportValues();\n  //   if (exportValues) {\n  //     for (let idx = 0, len = exportValues.length; idx < len; idx++) {\n  //       if (exportValues[idx].decodeText() === option) {\n  //         this.acroField.removeWidget(idx);\n  //         this.acroField.removeExportValue(idx);\n  //       }\n  //     }\n  //   } else {\n  //     for (let idx = 0, len = onValues.length; idx < len; idx++) {\n  //       const value = onValues[idx];\n  //       if (value.decodeText() === option) {\n  //         this.acroField.removeWidget(idx);\n  //         this.acroField.removeExportValue(idx);\n  //       }\n  //     }\n  //   }\n  // }\n\n  /**\n   * Select an option for this radio group. This operation is analogous to a\n   * human user clicking one of the radio buttons in this group via a PDF\n   * reader to toggle it on. This method will update the underlying state of\n   * the radio group to indicate which option has been selected. PDF libraries\n   * and readers will be able to extract this value from the saved document and\n   * determine which option was selected.\n   *\n   * For example:\n   * ```js\n   * const radioGroup = form.getRadioGroup('best.superhero.radioGroup')\n   * radioGroup.select('One Punch Man')\n   * ```\n   *\n   * This method will mark this radio group as dirty, causing its appearance\n   * streams to be updated when either [[PDFDocument.save]] or\n   * [[PDFForm.updateFieldAppearances]] is called. The updated appearance\n   * streams will display a dot inside the widget of this check box field\n   * that represents the selected option.\n   *\n   * @param option The option to be selected.\n   */\n  select(option: string) {\n    assertIs(option, 'option', ['string']);\n\n    const validOptions = this.getOptions();\n    assertIsOneOf(option, 'option', validOptions);\n\n    this.markAsDirty();\n\n    const onValues = this.acroField.getOnValues();\n    const exportValues = this.acroField.getExportValues();\n    if (exportValues) {\n      for (let idx = 0, len = exportValues.length; idx < len; idx++) {\n        if (exportValues[idx].decodeText() === option) {\n          this.acroField.setValue(onValues[idx]);\n        }\n      }\n    } else {\n      for (let idx = 0, len = onValues.length; idx < len; idx++) {\n        const value = onValues[idx];\n        if (value.decodeText() === option) this.acroField.setValue(value);\n      }\n    }\n  }\n\n  /**\n   * Clear any selected option for this dropdown. This will result in all\n   * radio buttons in this group being toggled off. This method will update\n   * the underlying state of the dropdown to indicate that no radio buttons\n   * have been selected.\n   * For example:\n   * ```js\n   * const radioGroup = form.getRadioGroup('some.radioGroup.field')\n   * radioGroup.clear()\n   * ```\n   * This method will mark this radio group as dirty. See\n   * [[PDFRadioGroup.select]] for more details about what this means.\n   */\n  clear() {\n    this.markAsDirty();\n    this.acroField.setValue(PDFName.of('Off'));\n  }\n\n  /**\n   * Returns `true` if users can click on radio buttons in this group to toggle\n   * them off. The alternative is that once a user clicks on a radio button\n   * to select it, the only way to deselect it is by selecting on another radio\n   * button in the group. See [[PDFRadioGroup.enableOffToggling]] and\n   * [[PDFRadioGroup.disableOffToggling]]. For example:\n   * ```js\n   * const radioGroup = form.getRadioGroup('some.radioGroup.field')\n   * if (radioGroup.isOffToggleable()) console.log('Off toggling is enabled')\n   * ```\n   */\n  isOffToggleable() {\n    return !this.acroField.hasFlag(AcroButtonFlags.NoToggleToOff);\n  }\n\n  /**\n   * Allow users to click on selected radio buttons in this group to toggle\n   * them off. For example:\n   * ```js\n   * const radioGroup = form.getRadioGroup('some.radioGroup.field')\n   * radioGroup.enableOffToggling()\n   * ```\n   * > **NOTE:** This feature is documented in the PDF specification\n   * > (Table 226). However, most PDF readers do not respect this option and\n   * > prevent users from toggling radio buttons off even when it is enabled.\n   * > At the time of this writing (9/6/2020) Mac's Preview software did\n   * > respect the option. Adobe Acrobat, Foxit Reader, and Google Chrome did\n   * > not.\n   */\n  enableOffToggling() {\n    this.acroField.setFlagTo(AcroButtonFlags.NoToggleToOff, false);\n  }\n\n  /**\n   * Prevent users from clicking on selected radio buttons in this group to\n   * toggle them off. Clicking on a selected radio button will have no effect.\n   * The only way to deselect a selected radio button is to click on a\n   * different radio button in the group. For example:\n   * ```js\n   * const radioGroup = form.getRadioGroup('some.radioGroup.field')\n   * radioGroup.disableOffToggling()\n   * ```\n   */\n  disableOffToggling() {\n    this.acroField.setFlagTo(AcroButtonFlags.NoToggleToOff, true);\n  }\n\n  /**\n   * Returns `true` if the radio buttons in this group are mutually exclusive.\n   * This means that when the user selects a radio button, only that specific\n   * button will be turned on. Even if other radio buttons in the group\n   * represent the same value, they will not be enabled. The alternative to\n   * this is that clicking a radio button will select that button along with\n   * any other radio buttons in the group that share the same value. See\n   * [[PDFRadioGroup.enableMutualExclusion]] and\n   * [[PDFRadioGroup.disableMutualExclusion]].\n   * For example:\n   * ```js\n   * const radioGroup = form.getRadioGroup('some.radioGroup.field')\n   * if (radioGroup.isMutuallyExclusive()) console.log('Mutual exclusion is enabled')\n   * ```\n   */\n  isMutuallyExclusive() {\n    return !this.acroField.hasFlag(AcroButtonFlags.RadiosInUnison);\n  }\n\n  /**\n   * When the user clicks a radio button in this group it will be selected. In\n   * addition, any other radio buttons in this group that share the same\n   * underlying value will also be selected. For example:\n   * ```js\n   * const radioGroup = form.getRadioGroup('some.radioGroup.field')\n   * radioGroup.enableMutualExclusion()\n   * ```\n   * Note that this option must be enabled prior to adding options to the\n   * radio group. It does not currently apply retroactively to existing\n   * radio buttons in the group.\n   */\n  enableMutualExclusion() {\n    this.acroField.setFlagTo(AcroButtonFlags.RadiosInUnison, false);\n  }\n\n  /**\n   * When the user clicks a radio button in this group only it will be selected.\n   * No other radio buttons in the group will be selected, even if they share\n   * the same underlying value. For example:\n   * ```js\n   * const radioGroup = form.getRadioGroup('some.radioGroup.field')\n   * radioGroup.disableMutualExclusion()\n   * ```\n   * Note that this option must be disabled prior to adding options to the\n   * radio group. It does not currently apply retroactively to existing\n   * radio buttons in the group.\n   */\n  disableMutualExclusion() {\n    this.acroField.setFlagTo(AcroButtonFlags.RadiosInUnison, true);\n  }\n\n  /**\n   * Add a new radio button to this group on the specified page. For example:\n   * ```js\n   * const page = pdfDoc.addPage()\n   *\n   * const form = pdfDoc.getForm()\n   * const radioGroup = form.createRadioGroup('best.gundam')\n   *\n   * const options = {\n   *   x: 50,\n   *   width: 25,\n   *   height: 25,\n   *   textColor: rgb(1, 0, 0),\n   *   backgroundColor: rgb(0, 1, 0),\n   *   borderColor: rgb(0, 0, 1),\n   *   borderWidth: 2,\n   *   rotate: degrees(90),\n   * }\n   *\n   * radioGroup.addOptionToPage('Exia', page, { ...options, y: 50 })\n   * radioGroup.addOptionToPage('Dynames', page, { ...options, y: 110 })\n   * ```\n   * This will create a new radio button widget for this radio group field.\n   * @param option The option that the radio button widget represents.\n   * @param page The page to which the radio button widget should be added.\n   * @param options The options to be used when adding the radio button widget.\n   */\n  addOptionToPage(\n    option: string,\n    page: PDFPage,\n    options?: FieldAppearanceOptions,\n  ) {\n    assertIs(option, 'option', ['string']);\n    assertIs(page, 'page', [[PDFPage, 'PDFPage']]);\n    assertFieldAppearanceOptions(options);\n\n    // Create a widget for this radio button\n    const widget = this.createWidget({\n      x: options?.x ?? 0,\n      y: options?.y ?? 0,\n      width: options?.width ?? 50,\n      height: options?.height ?? 50,\n      textColor: options?.textColor ?? rgb(0, 0, 0),\n      backgroundColor: options?.backgroundColor ?? rgb(1, 1, 1),\n      borderColor: options?.borderColor ?? rgb(0, 0, 0),\n      borderWidth: options?.borderWidth ?? 1,\n      rotate: options?.rotate ?? degrees(0),\n      hidden: options?.hidden,\n      page: page.ref,\n    });\n    const widgetRef = this.doc.context.register(widget.dict);\n\n    // Add widget to this field\n    const apStateValue = this.acroField.addWidgetWithOpt(\n      widgetRef,\n      PDFHexString.fromText(option),\n      !this.isMutuallyExclusive(),\n    );\n\n    // Set appearance streams for widget\n    widget.setAppearanceState(PDFName.of('Off'));\n    this.updateWidgetAppearance(widget, apStateValue);\n\n    // Add widget to the given page\n    page.node.addAnnot(widgetRef);\n  }\n\n  /**\n   * Returns `true` if any of this group's radio button widgets do not have an\n   * appearance stream for their current state. For example:\n   * ```js\n   * const radioGroup = form.getRadioGroup('some.radioGroup.field')\n   * if (radioGroup.needsAppearancesUpdate()) console.log('Needs update')\n   * ```\n   * @returns Whether or not this radio group needs an appearance update.\n   */\n  needsAppearancesUpdate(): boolean {\n    const widgets = this.acroField.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      const state = widget.getAppearanceState();\n      const normal = widget.getAppearances()?.normal;\n\n      if (!(normal instanceof PDFDict)) return true;\n      if (state && !normal.has(state)) return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Update the appearance streams for each of this group's radio button widgets\n   * using the default appearance provider for radio groups. For example:\n   * ```js\n   * const radioGroup = form.getRadioGroup('some.radioGroup.field')\n   * radioGroup.defaultUpdateAppearances()\n   * ```\n   */\n  defaultUpdateAppearances() {\n    this.updateAppearances();\n  }\n\n  // rg.updateAppearances((field: any, widget: any) => {\n  //   assert(field === rg);\n  //   assert(widget instanceof PDFWidgetAnnotation);\n  //   return { on: [...rectangle, ...circle], off: [...rectangle, ...circle] };\n  // });\n\n  /**\n   * Update the appearance streams for each of this group's radio button widgets\n   * using the given appearance provider. If no `provider` is passed, the\n   * default appearance provider for radio groups will be used. For example:\n   * ```js\n   * const radioGroup = form.getRadioGroup('some.radioGroup.field')\n   * radioGroup.updateAppearances((field, widget) => {\n   *   ...\n   *   return {\n   *     normal: { on: drawRadioButton(...), off: drawRadioButton(...) },\n   *     down: { on: drawRadioButton(...), off: drawRadioButton(...) },\n   *   }\n   * })\n   * ```\n   * @param provider Optionally, the appearance provider to be used for\n   *                 generating the contents of the appearance streams.\n   */\n  updateAppearances(provider?: AppearanceProviderFor<PDFRadioGroup>) {\n    assertOrUndefined(provider, 'provider', [Function]);\n\n    const widgets = this.acroField.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      const onValue = widget.getOnValue();\n      if (!onValue) continue;\n      this.updateWidgetAppearance(widget, onValue, provider);\n    }\n  }\n\n  private updateWidgetAppearance(\n    widget: PDFWidgetAnnotation,\n    onValue: PDFName,\n    provider?: AppearanceProviderFor<PDFRadioGroup>,\n  ) {\n    const apProvider = provider ?? defaultRadioGroupAppearanceProvider;\n    const appearances = normalizeAppearance(apProvider(this, widget));\n    this.updateOnOffWidgetAppearance(widget, onValue, appearances);\n  }\n}\n","import PDFDocument from 'src/api/PDFDocument';\nimport PDFField from 'src/api/form/PDFField';\n\nimport { PDFRef, PDFAcroSignature } from 'src/core';\nimport { assertIs } from 'src/utils';\n\n/**\n * Represents a signature field of a [[PDFForm]].\n *\n * [[PDFSignature]] fields are digital signatures. `pdf-lib` does not\n * currently provide any specialized APIs for creating digital signatures or\n * reading the contents of existing digital signatures.\n */\nexport default class PDFSignature extends PDFField {\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFForm.getSignature]] method, which will create an\n   * > instance of [[PDFSignature]] for you.\n   *\n   * Create an instance of [[PDFSignature]] from an existing acroSignature and\n   * ref\n   *\n   * @param acroSignature The underlying `PDFAcroSignature` for this signature.\n   * @param ref The unique reference for this signature.\n   * @param doc The document to which this signature will belong.\n   */\n  static of = (\n    acroSignature: PDFAcroSignature,\n    ref: PDFRef,\n    doc: PDFDocument,\n  ) => new PDFSignature(acroSignature, ref, doc);\n\n  /** The low-level PDFAcroSignature wrapped by this signature. */\n  readonly acroField: PDFAcroSignature;\n\n  private constructor(\n    acroSignature: PDFAcroSignature,\n    ref: PDFRef,\n    doc: PDFDocument,\n  ) {\n    super(acroSignature, ref, doc);\n\n    assertIs(acroSignature, 'acroSignature', [\n      [PDFAcroSignature, 'PDFAcroSignature'],\n    ]);\n\n    this.acroField = acroSignature;\n  }\n\n  needsAppearancesUpdate() {\n    return false;\n  }\n}\n","import PDFDocument from 'src/api/PDFDocument';\nimport PDFPage from 'src/api/PDFPage';\nimport PDFFont from 'src/api/PDFFont';\nimport PDFImage from 'src/api/PDFImage';\nimport PDFField, {\n  FieldAppearanceOptions,\n  assertFieldAppearanceOptions,\n} from 'src/api/form/PDFField';\nimport {\n  AppearanceProviderFor,\n  normalizeAppearance,\n  defaultTextFieldAppearanceProvider,\n} from 'src/api/form/appearances';\nimport { rgb } from 'src/api/colors';\nimport { degrees } from 'src/api/rotations';\nimport {\n  RichTextFieldReadError,\n  ExceededMaxLengthError,\n  InvalidMaxLengthError,\n} from 'src/api/errors';\nimport { ImageAlignment } from 'src/api/image/alignment';\nimport { TextAlignment } from 'src/api/text/alignment';\n\nimport {\n  PDFHexString,\n  PDFRef,\n  PDFStream,\n  PDFAcroText,\n  AcroTextFlags,\n  PDFWidgetAnnotation,\n} from 'src/core';\nimport {\n  assertIs,\n  assertIsOneOf,\n  assertOrUndefined,\n  assertPositive,\n  assertRangeOrUndefined,\n} from 'src/utils';\n\n/**\n * Represents a text field of a [[PDFForm]].\n *\n * [[PDFTextField]] fields are boxes that display text entered by the user. The\n * purpose of a text field is to enable users to enter text or view text values\n * in the document prefilled by software. Users can click on a text field and\n * input text via their keyboard. Some text fields allow multiple lines of text\n * to be entered (see [[PDFTextField.isMultiline]]).\n */\nexport default class PDFTextField extends PDFField {\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFForm.getTextField]] method, which will create an\n   * > instance of [[PDFTextField]] for you.\n   *\n   * Create an instance of [[PDFTextField]] from an existing acroText and ref\n   *\n   * @param acroText The underlying `PDFAcroText` for this text field.\n   * @param ref The unique reference for this text field.\n   * @param doc The document to which this text field will belong.\n   */\n  static of = (acroText: PDFAcroText, ref: PDFRef, doc: PDFDocument) =>\n    new PDFTextField(acroText, ref, doc);\n\n  /** The low-level PDFAcroText wrapped by this text field. */\n  readonly acroField: PDFAcroText;\n\n  private constructor(acroText: PDFAcroText, ref: PDFRef, doc: PDFDocument) {\n    super(acroText, ref, doc);\n\n    assertIs(acroText, 'acroText', [[PDFAcroText, 'PDFAcroText']]);\n\n    this.acroField = acroText;\n  }\n\n  /**\n   * Get the text that this field contains. This text is visible to users who\n   * view this field in a PDF reader.\n   *\n   * For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * const text = textField.getText()\n   * console.log('Text field contents:', text)\n   * ```\n   *\n   * Note that if this text field contains no underlying value, `undefined`\n   * will be returned. Text fields may also contain an underlying value that\n   * is simply an empty string (`''`). This detail is largely irrelevant for\n   * most applications. In general, you'll want to treat both cases the same\n   * way and simply consider the text field to be empty. In either case, the\n   * text field will appear empty to users when viewed in a PDF reader.\n   *\n   * An error will be thrown if this is a rich text field. `pdf-lib` does not\n   * support reading rich text fields. Nor do most PDF readers and writers.\n   * Rich text fields are based on XFA (XML Forms Architecture). Relatively few\n   * PDFs use rich text fields or XFA. Unlike PDF itself, XFA is not an ISO\n   * standard. XFA has been deprecated in PDF 2.0:\n   * * https://en.wikipedia.org/wiki/XFA\n   * * http://blog.pdfshareforms.com/pdf-2-0-release-bid-farewell-xfa-forms/\n   *\n   * @returns The text contained in this text field.\n   */\n  getText(): string | undefined {\n    const value = this.acroField.getValue();\n    if (!value && this.isRichFormatted()) {\n      throw new RichTextFieldReadError(this.getName());\n    }\n    return value?.decodeText();\n  }\n\n  /**\n   * Set the text for this field. This operation is analogous to a human user\n   * clicking on the text field in a PDF reader and typing in text via their\n   * keyboard. This method will update the underlying state of the text field\n   * to indicate what text has been set. PDF libraries and readers will be able\n   * to extract these values from the saved document and determine what text\n   * was set.\n   *\n   * For example:\n   * ```js\n   * const textField = form.getTextField('best.superhero.text.field')\n   * textField.setText('One Punch Man')\n   * ```\n   *\n   * This method will mark this text field as dirty, causing its appearance\n   * streams to be updated when either [[PDFDocument.save]] or\n   * [[PDFForm.updateFieldAppearances]] is called. The updated streams will\n   * display the text this field contains inside the widgets of this text\n   * field.\n   *\n   * **IMPORTANT:** The default font used to update appearance streams is\n   * [[StandardFonts.Helvetica]]. Note that this is a WinAnsi font. This means\n   * that encoding errors will be thrown if this field contains text outside\n   * the WinAnsi character set (the latin alphabet).\n   *\n   * Embedding a custom font and passing it to\n   * [[PDFForm.updateFieldAppearances]] or [[PDFTextField.updateAppearances]]\n   * allows you to generate appearance streams with characters outside the\n   * latin alphabet (assuming the custom font supports them).\n   *\n   * If this is a rich text field, it will be converted to a standard text\n   * field in order to set the text. `pdf-lib` does not support writing rich\n   * text strings. Nor do most PDF readers and writers. See\n   * [[PDFTextField.getText]] for more information about rich text fields and\n   * their deprecation in PDF 2.0.\n   *\n   * @param text The text this field should contain.\n   */\n  setText(text: string | undefined) {\n    assertOrUndefined(text, 'text', ['string']);\n\n    const maxLength = this.getMaxLength();\n    if (maxLength !== undefined && text && text.length > maxLength) {\n      throw new ExceededMaxLengthError(text.length, maxLength, this.getName());\n    }\n\n    this.markAsDirty();\n    this.disableRichFormatting();\n\n    if (text) {\n      this.acroField.setValue(PDFHexString.fromText(text));\n    } else {\n      this.acroField.removeValue();\n    }\n  }\n\n  /**\n   * Get the alignment for this text field. This value represents the\n   * justification of the text when it is displayed to the user in PDF readers.\n   * There are three possible alignments: left, center, and right. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * const alignment = textField.getAlignment()\n   * if (alignment === TextAlignment.Left) console.log('Text is left justified')\n   * if (alignment === TextAlignment.Center) console.log('Text is centered')\n   * if (alignment === TextAlignment.Right) console.log('Text is right justified')\n   * ```\n   * @returns The alignment of this text field.\n   */\n  getAlignment(): TextAlignment {\n    const quadding = this.acroField.getQuadding();\n\n    // prettier-ignore\n    return (\n      quadding === 0 ? TextAlignment.Left\n        : quadding === 1 ? TextAlignment.Center\n          : quadding === 2 ? TextAlignment.Right\n            : TextAlignment.Left\n    );\n  }\n\n  /**\n   * Set the alignment for this text field. This will determine the\n   * justification of the text when it is displayed to the user in PDF readers.\n   * There are three possible alignments: left, center, and right. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   *\n   * // Text will be left justified when displayed\n   * textField.setAlignment(TextAlignment.Left)\n   *\n   * // Text will be centered when displayed\n   * textField.setAlignment(TextAlignment.Center)\n   *\n   * // Text will be right justified when displayed\n   * textField.setAlignment(TextAlignment.Right)\n   * ```\n   * This method will mark this text field as dirty. See\n   * [[PDFTextField.setText]] for more details about what this means.\n   * @param alignment The alignment for this text field.\n   */\n  setAlignment(alignment: TextAlignment) {\n    assertIsOneOf(alignment, 'alignment', TextAlignment);\n    this.markAsDirty();\n    this.acroField.setQuadding(alignment);\n  }\n\n  /**\n   * Get the maximum length of this field. This value represents the maximum\n   * number of characters that can be typed into this field by the user. If\n   * this field does not have a maximum length, `undefined` is returned.\n   * For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * const maxLength = textField.getMaxLength()\n   * if (maxLength === undefined) console.log('No max length')\n   * else console.log(`Max length is ${maxLength}`)\n   * ```\n   * @returns The maximum number of characters allowed in this field, or\n   *          `undefined` if no limit exists.\n   */\n  getMaxLength(): number | undefined {\n    return this.acroField.getMaxLength();\n  }\n\n  /**\n   * Set the maximum length of this field. This limits the number of characters\n   * that can be typed into this field by the user. This also limits the length\n   * of the string that can be passed to [[PDFTextField.setText]]. This limit\n   * can be removed by passing `undefined` as `maxLength`. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   *\n   * // Allow between 0 and 5 characters to be entered\n   * textField.setMaxLength(5)\n   *\n   * // Allow any number of characters to be entered\n   * textField.setMaxLength(undefined)\n   * ```\n   * This method will mark this text field as dirty. See\n   * [[PDFTextField.setText]] for more details about what this means.\n   * @param maxLength The maximum number of characters allowed in this field, or\n   *                  `undefined` to remove the limit.\n   */\n  setMaxLength(maxLength?: number) {\n    assertRangeOrUndefined(maxLength, 'maxLength', 0, Number.MAX_SAFE_INTEGER);\n\n    this.markAsDirty();\n\n    if (maxLength === undefined) {\n      this.acroField.removeMaxLength();\n    } else {\n      const text = this.getText();\n      if (text && text.length > maxLength) {\n        throw new InvalidMaxLengthError(text.length, maxLength, this.getName());\n      }\n      this.acroField.setMaxLength(maxLength);\n    }\n  }\n\n  /**\n   * Remove the maximum length for this text field. This allows any number of\n   * characters to be typed into this field by the user. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.removeMaxLength()\n   * ```\n   * Calling this method is equivalent to passing `undefined` to\n   * [[PDFTextField.setMaxLength]].\n   */\n  removeMaxLength() {\n    this.markAsDirty();\n    this.acroField.removeMaxLength();\n  }\n\n  /**\n   * Display an image inside the bounds of this text field's widgets. For example:\n   * ```js\n   * const pngImage = await pdfDoc.embedPng(...)\n   * const textField = form.getTextField('some.text.field')\n   * textField.setImage(pngImage)\n   * ```\n   * This will update the appearances streams for each of this text field's widgets.\n   * @param image The image that should be displayed.\n   */\n  setImage(image: PDFImage) {\n    const fieldAlignment = this.getAlignment();\n\n    // prettier-ignore\n    const alignment = \n        fieldAlignment === TextAlignment.Center ? ImageAlignment.Center\n          : fieldAlignment === TextAlignment.Right ? ImageAlignment.Right\n            : ImageAlignment.Left;\n\n    const widgets = this.acroField.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      const streamRef = this.createImageAppearanceStream(\n        widget,\n        image,\n        alignment,\n      );\n      this.updateWidgetAppearances(widget, { normal: streamRef });\n    }\n\n    this.markAsClean();\n  }\n\n  /**\n   * Set the font size for this field. Larger font sizes will result in larger\n   * text being displayed when PDF readers render this text field. Font sizes\n   * may be integer or floating point numbers. Supplying a negative font size\n   * will cause this method to throw an error.\n   *\n   * For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.setFontSize(4)\n   * textField.setFontSize(15.7)\n   * ```\n   *\n   * > This method depends upon the existence of a default appearance\n   * > (`/DA`) string. If this field does not have a default appearance string,\n   * > or that string does not contain a font size (via the `Tf` operator),\n   * > then this method will throw an error.\n   *\n   * @param fontSize The font size to be used when rendering text in this field.\n   */\n  setFontSize(fontSize: number) {\n    assertPositive(fontSize, 'fontSize');\n    this.acroField.setFontSize(fontSize);\n    this.markAsDirty();\n  }\n\n  /**\n   * Returns `true` if each line of text is shown on a new line when this\n   * field is displayed in a PDF reader. The alternative is that all lines of\n   * text are merged onto a single line when displayed. See\n   * [[PDFTextField.enableMultiline]] and [[PDFTextField.disableMultiline]].\n   * For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * if (textField.isMultiline()) console.log('Multiline is enabled')\n   * ```\n   * @returns Whether or not this is a multiline text field.\n   */\n  isMultiline(): boolean {\n    return this.acroField.hasFlag(AcroTextFlags.Multiline);\n  }\n\n  /**\n   * Display each line of text on a new line when this field is displayed in a\n   * PDF reader. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.enableMultiline()\n   * ```\n   * This method will mark this text field as dirty. See\n   * [[PDFTextField.setText]] for more details about what this means.\n   */\n  enableMultiline() {\n    this.markAsDirty();\n    this.acroField.setFlagTo(AcroTextFlags.Multiline, true);\n  }\n\n  /**\n   * Display each line of text on the same line when this field is displayed\n   * in a PDF reader. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.disableMultiline()\n   * ```\n   * This method will mark this text field as dirty. See\n   * [[PDFTextField.setText]] for more details about what this means.\n   */\n  disableMultiline() {\n    this.markAsDirty();\n    this.acroField.setFlagTo(AcroTextFlags.Multiline, false);\n  }\n\n  /**\n   * Returns `true` if this is a password text field. This means that the field\n   * is intended for storing a secure password. See\n   * [[PDFTextField.enablePassword]] and [[PDFTextField.disablePassword]].\n   * For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * if (textField.isPassword()) console.log('Password is enabled')\n   * ```\n   * @returns Whether or not this is a password text field.\n   */\n  isPassword(): boolean {\n    return this.acroField.hasFlag(AcroTextFlags.Password);\n  }\n\n  /**\n   * Indicate that this text field is intended for storing a secure password.\n   * For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.enablePassword()\n   * ```\n   * Values entered into password text fields should not be displayed on the\n   * screen by PDF readers. Most PDF readers will display the value as\n   * asterisks or bullets. PDF readers should never store values entered by the\n   * user into password text fields. Similarly, applications should not\n   * write data to a password text field.\n   *\n   * **Please note that this method does not cause entered values to be\n   * encrypted or secured in any way! It simply sets a flag that PDF software\n   * and readers can access to determine the _purpose_ of this field.**\n   */\n  enablePassword() {\n    this.acroField.setFlagTo(AcroTextFlags.Password, true);\n  }\n\n  /**\n   * Indicate that this text field is **not** intended for storing a secure\n   * password. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.disablePassword()\n   * ```\n   */\n  disablePassword() {\n    this.acroField.setFlagTo(AcroTextFlags.Password, false);\n  }\n\n  /**\n   * Returns `true` if the contents of this text field represent a file path.\n   * See [[PDFTextField.enableFileSelection]] and\n   * [[PDFTextField.disableFileSelection]]. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * if (textField.isFileSelector()) console.log('Is a file selector')\n   * ```\n   * @returns Whether or not this field should contain file paths.\n   */\n  isFileSelector(): boolean {\n    return this.acroField.hasFlag(AcroTextFlags.FileSelect);\n  }\n\n  /**\n   * Indicate that this text field is intended to store a file path. The\n   * contents of the file stored at that path should be submitted as the value\n   * of the field. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.enableFileSelection()\n   * ```\n   */\n  enableFileSelection() {\n    this.acroField.setFlagTo(AcroTextFlags.FileSelect, true);\n  }\n\n  /**\n   * Indicate that this text field is **not** intended to store a file path.\n   * For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.disableFileSelection()\n   * ```\n   */\n  disableFileSelection() {\n    this.acroField.setFlagTo(AcroTextFlags.FileSelect, false);\n  }\n\n  /**\n   * Returns `true` if the text entered in this field should be spell checked\n   * by PDF readers. See [[PDFTextField.enableSpellChecking]] and\n   * [[PDFTextField.disableSpellChecking]]. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * if (textField.isSpellChecked()) console.log('Spell checking is enabled')\n   * ```\n   * @returns Whether or not this field should be spell checked.\n   */\n  isSpellChecked(): boolean {\n    return !this.acroField.hasFlag(AcroTextFlags.DoNotSpellCheck);\n  }\n\n  /**\n   * Allow PDF readers to spell check the text entered in this field.\n   * For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.enableSpellChecking()\n   * ```\n   */\n  enableSpellChecking() {\n    this.acroField.setFlagTo(AcroTextFlags.DoNotSpellCheck, false);\n  }\n\n  /**\n   * Do not allow PDF readers to spell check the text entered in this field.\n   * For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.disableSpellChecking()\n   * ```\n   */\n  disableSpellChecking() {\n    this.acroField.setFlagTo(AcroTextFlags.DoNotSpellCheck, true);\n  }\n\n  /**\n   * Returns `true` if PDF readers should allow the user to scroll the text\n   * field when its contents do not fit within the field's view bounds. See\n   * [[PDFTextField.enableScrolling]] and [[PDFTextField.disableScrolling]].\n   * For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * if (textField.isScrollable()) console.log('Scrolling is enabled')\n   * ```\n   * @returns Whether or not the field is scrollable in PDF readers.\n   */\n  isScrollable(): boolean {\n    return !this.acroField.hasFlag(AcroTextFlags.DoNotScroll);\n  }\n\n  /**\n   * Allow PDF readers to present a scroll bar to the user when the contents\n   * of this text field do not fit within its view bounds. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.enableScrolling()\n   * ```\n   * A horizontal scroll bar should be shown for singleline fields. A vertical\n   * scroll bar should be shown for multiline fields.\n   */\n  enableScrolling() {\n    this.acroField.setFlagTo(AcroTextFlags.DoNotScroll, false);\n  }\n\n  /**\n   * Do not allow PDF readers to present a scroll bar to the user when the\n   * contents of this text field do not fit within its view bounds. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.disableScrolling()\n   * ```\n   */\n  disableScrolling() {\n    this.acroField.setFlagTo(AcroTextFlags.DoNotScroll, true);\n  }\n\n  /**\n   * Returns `true` if this is a combed text field. This means that the field\n   * is split into `n` equal size cells with one character in each (where `n`\n   * is equal to the max length of the text field). The result is that all\n   * characters in this field are displayed an equal distance apart from one\n   * another. See [[PDFTextField.enableCombing]] and\n   * [[PDFTextField.disableCombing]]. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * if (textField.isCombed()) console.log('Combing is enabled')\n   * ```\n   * Note that in order for a text field to be combed, the following must be\n   * true (in addition to enabling combing):\n   * * It must not be a multiline field (see [[PDFTextField.isMultiline]])\n   * * It must not be a password field (see [[PDFTextField.isPassword]])\n   * * It must not be a file selector field (see [[PDFTextField.isFileSelector]])\n   * * It must have a max length defined (see [[PDFTextField.setMaxLength]])\n   * @returns Whether or not this field is combed.\n   */\n  isCombed(): boolean {\n    return (\n      this.acroField.hasFlag(AcroTextFlags.Comb) &&\n      !this.isMultiline() &&\n      !this.isPassword() &&\n      !this.isFileSelector() &&\n      this.getMaxLength() !== undefined\n    );\n  }\n\n  /**\n   * Split this field into `n` equal size cells with one character in each\n   * (where `n` is equal to the max length of the text field). This will cause\n   * all characters in the field to be displayed an equal distance apart from\n   * one another. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.enableCombing()\n   * ```\n   *\n   * In addition to calling this method, text fields must have a max length\n   * defined in order to be combed (see [[PDFTextField.setMaxLength]]).\n   *\n   * This method will also call the following three methods internally:\n   * * [[PDFTextField.disableMultiline]]\n   * * [[PDFTextField.disablePassword]]\n   * * [[PDFTextField.disableFileSelection]]\n   *\n   * This method will mark this text field as dirty. See\n   * [[PDFTextField.setText]] for more details about what this means.\n   */\n  enableCombing() {\n    if (this.getMaxLength() === undefined) {\n      const msg = 'PDFTextFields must have a max length in order to be combed';\n      console.warn(msg);\n    }\n\n    this.markAsDirty();\n\n    this.disableMultiline();\n    this.disablePassword();\n    this.disableFileSelection();\n\n    this.acroField.setFlagTo(AcroTextFlags.Comb, true);\n  }\n\n  /**\n   * Turn off combing for this text field. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.disableCombing()\n   * ```\n   * See [[PDFTextField.isCombed]] and [[PDFTextField.enableCombing]] for more\n   * information about what combing is.\n   *\n   * This method will mark this text field as dirty. See\n   * [[PDFTextField.setText]] for more details about what this means.\n   */\n  disableCombing() {\n    this.markAsDirty();\n    this.acroField.setFlagTo(AcroTextFlags.Comb, false);\n  }\n\n  /**\n   * Returns `true` if this text field contains rich text. See\n   * [[PDFTextField.enableRichFormatting]] and\n   * [[PDFTextField.disableRichFormatting]]. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * if (textField.isRichFormatted()) console.log('Rich formatting enabled')\n   * ```\n   * @returns Whether or not this field contains rich text.\n   */\n  isRichFormatted(): boolean {\n    return this.acroField.hasFlag(AcroTextFlags.RichText);\n  }\n\n  /**\n   * Indicate that this field contains XFA data - or rich text. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.enableRichFormatting()\n   * ```\n   * Note that `pdf-lib` does not support reading or writing rich text fields.\n   * Nor do most PDF readers and writers. Rich text fields are based on XFA\n   * (XML Forms Architecture). Relatively few PDFs use rich text fields or XFA.\n   * Unlike PDF itself, XFA is not an ISO standard. XFA has been deprecated in\n   * PDF 2.0:\n   * * https://en.wikipedia.org/wiki/XFA\n   * * http://blog.pdfshareforms.com/pdf-2-0-release-bid-farewell-xfa-forms/\n   */\n  enableRichFormatting() {\n    this.acroField.setFlagTo(AcroTextFlags.RichText, true);\n  }\n\n  /**\n   * Indicate that this is a standard text field that does not XFA data (rich\n   * text). For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * textField.disableRichFormatting()\n   * ```\n   */\n  disableRichFormatting() {\n    this.acroField.setFlagTo(AcroTextFlags.RichText, false);\n  }\n\n  /**\n   * Show this text field on the specified page. For example:\n   * ```js\n   * const ubuntuFont = await pdfDoc.embedFont(ubuntuFontBytes)\n   * const page = pdfDoc.addPage()\n   *\n   * const form = pdfDoc.getForm()\n   * const textField = form.createTextField('best.gundam')\n   * textField.setText('Exia')\n   *\n   * textField.addToPage(page, {\n   *   x: 50,\n   *   y: 75,\n   *   width: 200,\n   *   height: 100,\n   *   textColor: rgb(1, 0, 0),\n   *   backgroundColor: rgb(0, 1, 0),\n   *   borderColor: rgb(0, 0, 1),\n   *   borderWidth: 2,\n   *   rotate: degrees(90),\n   *   font: ubuntuFont,\n   * })\n   * ```\n   * This will create a new widget for this text field.\n   * @param page The page to which this text field widget should be added.\n   * @param options The options to be used when adding this text field widget.\n   */\n  addToPage(page: PDFPage, options?: FieldAppearanceOptions) {\n    assertIs(page, 'page', [[PDFPage, 'PDFPage']]);\n    assertFieldAppearanceOptions(options);\n\n    if (!options) options = {};\n\n    if (!('textColor' in options)) options.textColor = rgb(0, 0, 0);\n    if (!('backgroundColor' in options)) options.backgroundColor = rgb(1, 1, 1);\n    if (!('borderColor' in options)) options.borderColor = rgb(0, 0, 0);\n    if (!('borderWidth' in options)) options.borderWidth = 1;\n\n    // Create a widget for this text field\n    const widget = this.createWidget({\n      x: options.x ?? 0,\n      y: options.y ?? 0,\n      width: options.width ?? 200,\n      height: options.height ?? 50,\n      textColor: options.textColor,\n      backgroundColor: options.backgroundColor,\n      borderColor: options.borderColor,\n      borderWidth: options.borderWidth ?? 0,\n      rotate: options.rotate ?? degrees(0),\n      hidden: options.hidden,\n      page: page.ref,\n    });\n    const widgetRef = this.doc.context.register(widget.dict);\n\n    // Add widget to this field\n    this.acroField.addWidget(widgetRef);\n\n    // Set appearance streams for widget\n    const font = options.font ?? this.doc.getForm().getDefaultFont();\n    this.updateWidgetAppearance(widget, font);\n\n    // Add widget to the given page\n    page.node.addAnnot(widgetRef);\n  }\n\n  /**\n   * Returns `true` if this text field has been marked as dirty, or if any of\n   * this text field's widgets do not have an appearance stream. For example:\n   * ```js\n   * const textField = form.getTextField('some.text.field')\n   * if (textField.needsAppearancesUpdate()) console.log('Needs update')\n   * ```\n   * @returns Whether or not this text field needs an appearance update.\n   */\n  needsAppearancesUpdate(): boolean {\n    if (this.isDirty()) return true;\n\n    const widgets = this.acroField.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      const hasAppearances =\n        widget.getAppearances()?.normal instanceof PDFStream;\n      if (!hasAppearances) return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Update the appearance streams for each of this text field's widgets using\n   * the default appearance provider for text fields. For example:\n   * ```js\n   * const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const textField = form.getTextField('some.text.field')\n   * textField.defaultUpdateAppearances(helvetica)\n   * ```\n   * @param font The font to be used for creating the appearance streams.\n   */\n  defaultUpdateAppearances(font: PDFFont) {\n    assertIs(font, 'font', [[PDFFont, 'PDFFont']]);\n    this.updateAppearances(font);\n  }\n\n  /**\n   * Update the appearance streams for each of this text field's widgets using\n   * the given appearance provider. If no `provider` is passed, the default\n   * appearance provider for text fields will be used. For example:\n   * ```js\n   * const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const textField = form.getTextField('some.text.field')\n   * textField.updateAppearances(helvetica, (field, widget, font) => {\n   *   ...\n   *   return drawTextField(...)\n   * })\n   * ```\n   * @param font The font to be used for creating the appearance streams.\n   * @param provider Optionally, the appearance provider to be used for\n   *                 generating the contents of the appearance streams.\n   */\n  updateAppearances(\n    font: PDFFont,\n    provider?: AppearanceProviderFor<PDFTextField>,\n  ) {\n    assertIs(font, 'font', [[PDFFont, 'PDFFont']]);\n    assertOrUndefined(provider, 'provider', [Function]);\n\n    const widgets = this.acroField.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      this.updateWidgetAppearance(widget, font, provider);\n    }\n    this.markAsClean();\n  }\n\n  private updateWidgetAppearance(\n    widget: PDFWidgetAnnotation,\n    font: PDFFont,\n    provider?: AppearanceProviderFor<PDFTextField>,\n  ) {\n    const apProvider = provider ?? defaultTextFieldAppearanceProvider;\n    const appearances = normalizeAppearance(apProvider(this, widget, font));\n    this.updateWidgetAppearanceWithFont(widget, font, appearances);\n  }\n}\n","export enum StandardFonts {\n  Courier = 'Courier',\n  CourierBold = 'Courier-Bold',\n  CourierOblique = 'Courier-Oblique',\n  CourierBoldOblique = 'Courier-BoldOblique',\n  Helvetica = 'Helvetica',\n  HelveticaBold = 'Helvetica-Bold',\n  HelveticaOblique = 'Helvetica-Oblique',\n  HelveticaBoldOblique = 'Helvetica-BoldOblique',\n  TimesRoman = 'Times-Roman',\n  TimesRomanBold = 'Times-Bold',\n  TimesRomanItalic = 'Times-Italic',\n  TimesRomanBoldItalic = 'Times-BoldItalic',\n  Symbol = 'Symbol',\n  ZapfDingbats = 'ZapfDingbats'\n}\n","import PDFDocument from 'src/api/PDFDocument';\nimport PDFPage from 'src/api/PDFPage';\nimport PDFField from 'src/api/form/PDFField';\nimport PDFButton from 'src/api/form/PDFButton';\nimport PDFCheckBox from 'src/api/form/PDFCheckBox';\nimport PDFDropdown from 'src/api/form/PDFDropdown';\nimport PDFOptionList from 'src/api/form/PDFOptionList';\nimport PDFRadioGroup from 'src/api/form/PDFRadioGroup';\nimport PDFSignature from 'src/api/form/PDFSignature';\nimport PDFTextField from 'src/api/form/PDFTextField';\nimport {\n  NoSuchFieldError,\n  UnexpectedFieldTypeError,\n  FieldAlreadyExistsError,\n  InvalidFieldNamePartError,\n} from 'src/api/errors';\nimport PDFFont from 'src/api/PDFFont';\nimport { StandardFonts } from 'src/api/StandardFonts';\nimport { rotateInPlace } from 'src/api/operations';\nimport {\n  drawObject,\n  popGraphicsState,\n  pushGraphicsState,\n  translate,\n} from 'src/api/operators';\nimport {\n  PDFAcroForm,\n  PDFAcroField,\n  PDFAcroCheckBox,\n  PDFAcroComboBox,\n  PDFAcroListBox,\n  PDFAcroRadioButton,\n  PDFAcroSignature,\n  PDFAcroText,\n  PDFAcroPushButton,\n  PDFAcroNonTerminal,\n  PDFDict,\n  PDFRef,\n  createPDFAcroFields,\n  PDFName,\n  PDFWidgetAnnotation,\n} from 'src/core';\nimport { assertIs, Cache, assertOrUndefined } from 'src/utils';\n\nexport interface FlattenOptions {\n  updateFieldAppearances: boolean;\n}\n\n/**\n * Represents the interactive form of a [[PDFDocument]].\n *\n * Interactive forms (sometimes called _AcroForms_) are collections of fields\n * designed to gather information from a user. A PDF document may contains any\n * number of fields that appear on various pages, all of which make up a single,\n * global interactive form spanning the entire document. This means that\n * instances of [[PDFDocument]] shall contain at most one [[PDFForm]].\n *\n * The fields of an interactive form are represented by [[PDFField]] instances.\n */\nexport default class PDFForm {\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFDocument.getForm]] method, which will create an\n   * > instance of [[PDFForm]] for you.\n   *\n   * Create an instance of [[PDFForm]] from an existing acroForm and embedder\n   *\n   * @param acroForm The underlying `PDFAcroForm` for this form.\n   * @param doc The document to which the form will belong.\n   */\n  static of = (acroForm: PDFAcroForm, doc: PDFDocument) =>\n    new PDFForm(acroForm, doc);\n\n  /** The low-level PDFAcroForm wrapped by this form. */\n  readonly acroForm: PDFAcroForm;\n\n  /** The document to which this form belongs. */\n  readonly doc: PDFDocument;\n\n  private readonly dirtyFields: Set<PDFRef>;\n  private readonly defaultFontCache: Cache<PDFFont>;\n\n  private constructor(acroForm: PDFAcroForm, doc: PDFDocument) {\n    assertIs(acroForm, 'acroForm', [[PDFAcroForm, 'PDFAcroForm']]);\n    assertIs(doc, 'doc', [[PDFDocument, 'PDFDocument']]);\n\n    this.acroForm = acroForm;\n    this.doc = doc;\n\n    this.dirtyFields = new Set();\n    this.defaultFontCache = Cache.populatedBy(this.embedDefaultFont);\n  }\n\n  /**\n   * Returns `true` if this [[PDFForm]] has XFA data. Most PDFs with form\n   * fields do not use XFA as it is not widely supported by PDF readers.\n   *\n   * > `pdf-lib` does not support creation, modification, or reading of XFA\n   * > fields.\n   *\n   * For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * if (form.hasXFA()) console.log('PDF has XFA data')\n   * ```\n   * @returns Whether or not this form has XFA data.\n   */\n  hasXFA(): boolean {\n    return this.acroForm.dict.has(PDFName.of('XFA'));\n  }\n\n  /**\n   * Disconnect the XFA data from this [[PDFForm]] (if any exists). This will\n   * force readers to fallback to standard fields if the [[PDFDocument]]\n   * contains any. For example:\n   *\n   * For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * form.deleteXFA()\n   * ```\n   */\n  deleteXFA(): void {\n    this.acroForm.dict.delete(PDFName.of('XFA'));\n  }\n\n  /**\n   * Get all fields contained in this [[PDFForm]]. For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const fields = form.getFields()\n   * fields.forEach(field => {\n   *   const type = field.constructor.name\n   *   const name = field.getName()\n   *   console.log(`${type}: ${name}`)\n   * })\n   * ```\n   * @returns An array of all fields in this form.\n   */\n  getFields(): PDFField[] {\n    const allFields = this.acroForm.getAllFields();\n\n    const fields: PDFField[] = [];\n    for (let idx = 0, len = allFields.length; idx < len; idx++) {\n      const [acroField, ref] = allFields[idx];\n      const field = convertToPDFField(acroField, ref, this.doc);\n      if (field) fields.push(field);\n    }\n\n    return fields;\n  }\n\n  /**\n   * Get the field in this [[PDFForm]] with the given name. For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const field = form.getFieldMaybe('Page1.Foo.Bar[0]')\n   * if (field) console.log('Field exists!')\n   * ```\n   * @param name A fully qualified field name.\n   * @returns The field with the specified name, if one exists.\n   */\n  getFieldMaybe(name: string): PDFField | undefined {\n    assertIs(name, 'name', ['string']);\n    const fields = this.getFields();\n    for (let idx = 0, len = fields.length; idx < len; idx++) {\n      const field = fields[idx];\n      if (field.getName() === name) return field;\n    }\n    return undefined;\n  }\n\n  /**\n   * Get the field in this [[PDFForm]] with the given name. For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const field = form.getField('Page1.Foo.Bar[0]')\n   * ```\n   * If no field exists with the provided name, an error will be thrown.\n   * @param name A fully qualified field name.\n   * @returns The field with the specified name.\n   */\n  getField(name: string): PDFField {\n    assertIs(name, 'name', ['string']);\n    const field = this.getFieldMaybe(name);\n    if (field) return field;\n    throw new NoSuchFieldError(name);\n  }\n\n  /**\n   * Get the button field in this [[PDFForm]] with the given name. For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const button = form.getButton('Page1.Foo.Button[0]')\n   * ```\n   * An error will be thrown if no field exists with the provided name, or if\n   * the field exists but is not a button.\n   * @param name A fully qualified button name.\n   * @returns The button with the specified name.\n   */\n  getButton(name: string): PDFButton {\n    assertIs(name, 'name', ['string']);\n    const field = this.getField(name);\n    if (field instanceof PDFButton) return field;\n    throw new UnexpectedFieldTypeError(name, PDFButton, field);\n  }\n\n  /**\n   * Get the check box field in this [[PDFForm]] with the given name.\n   * For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const checkBox = form.getCheckBox('Page1.Foo.CheckBox[0]')\n   * checkBox.check()\n   * ```\n   * An error will be thrown if no field exists with the provided name, or if\n   * the field exists but is not a check box.\n   * @param name A fully qualified check box name.\n   * @returns The check box with the specified name.\n   */\n  getCheckBox(name: string): PDFCheckBox {\n    assertIs(name, 'name', ['string']);\n    const field = this.getField(name);\n    if (field instanceof PDFCheckBox) return field;\n    throw new UnexpectedFieldTypeError(name, PDFCheckBox, field);\n  }\n\n  /**\n   * Get the dropdown field in this [[PDFForm]] with the given name.\n   * For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const dropdown = form.getDropdown('Page1.Foo.Dropdown[0]')\n   * const options = dropdown.getOptions()\n   * dropdown.select(options[0])\n   * ```\n   * An error will be thrown if no field exists with the provided name, or if\n   * the field exists but is not a dropdown.\n   * @param name A fully qualified dropdown name.\n   * @returns The dropdown with the specified name.\n   */\n  getDropdown(name: string): PDFDropdown {\n    assertIs(name, 'name', ['string']);\n    const field = this.getField(name);\n    if (field instanceof PDFDropdown) return field;\n    throw new UnexpectedFieldTypeError(name, PDFDropdown, field);\n  }\n\n  /**\n   * Get the option list field in this [[PDFForm]] with the given name.\n   * For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const optionList = form.getOptionList('Page1.Foo.OptionList[0]')\n   * const options = optionList.getOptions()\n   * optionList.select(options[0])\n   * ```\n   * An error will be thrown if no field exists with the provided name, or if\n   * the field exists but is not an option list.\n   * @param name A fully qualified option list name.\n   * @returns The option list with the specified name.\n   */\n  getOptionList(name: string): PDFOptionList {\n    assertIs(name, 'name', ['string']);\n    const field = this.getField(name);\n    if (field instanceof PDFOptionList) return field;\n    throw new UnexpectedFieldTypeError(name, PDFOptionList, field);\n  }\n\n  /**\n   * Get the radio group field in this [[PDFForm]] with the given name.\n   * For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const radioGroup = form.getRadioGroup('Page1.Foo.RadioGroup[0]')\n   * const options = radioGroup.getOptions()\n   * radioGroup.select(options[0])\n   * ```\n   * An error will be thrown if no field exists with the provided name, or if\n   * the field exists but is not a radio group.\n   * @param name A fully qualified radio group name.\n   * @returns The radio group with the specified name.\n   */\n  getRadioGroup(name: string): PDFRadioGroup {\n    assertIs(name, 'name', ['string']);\n    const field = this.getField(name);\n    if (field instanceof PDFRadioGroup) return field;\n    throw new UnexpectedFieldTypeError(name, PDFRadioGroup, field);\n  }\n\n  /**\n   * Get the signature field in this [[PDFForm]] with the given name.\n   * For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const signature = form.getSignature('Page1.Foo.Signature[0]')\n   * ```\n   * An error will be thrown if no field exists with the provided name, or if\n   * the field exists but is not a signature.\n   * @param name A fully qualified signature name.\n   * @returns The signature with the specified name.\n   */\n  getSignature(name: string): PDFSignature {\n    assertIs(name, 'name', ['string']);\n    const field = this.getField(name);\n    if (field instanceof PDFSignature) return field;\n    throw new UnexpectedFieldTypeError(name, PDFSignature, field);\n  }\n\n  /**\n   * Get the text field in this [[PDFForm]] with the given name.\n   * For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const textField = form.getTextField('Page1.Foo.TextField[0]')\n   * textField.setText('Are you designed to act or to be acted upon?')\n   * ```\n   * An error will be thrown if no field exists with the provided name, or if\n   * the field exists but is not a text field.\n   * @param name A fully qualified text field name.\n   * @returns The text field with the specified name.\n   */\n  getTextField(name: string): PDFTextField {\n    assertIs(name, 'name', ['string']);\n    const field = this.getField(name);\n    if (field instanceof PDFTextField) return field;\n    throw new UnexpectedFieldTypeError(name, PDFTextField, field);\n  }\n\n  /**\n   * Create a new button field in this [[PDFForm]] with the given name.\n   * For example:\n   * ```js\n   * const font = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const page = pdfDoc.addPage()\n   *\n   * const form = pdfDoc.getForm()\n   * const button = form.createButton('cool.new.button')\n   *\n   * button.addToPage('Do Stuff', font, page)\n   * ```\n   * An error will be thrown if a field already exists with the provided name.\n   * @param name The fully qualified name for the new button.\n   * @returns The new button field.\n   */\n  createButton(name: string): PDFButton {\n    assertIs(name, 'name', ['string']);\n\n    const nameParts = splitFieldName(name);\n    const parent = this.findOrCreateNonTerminals(nameParts.nonTerminal);\n\n    const button = PDFAcroPushButton.create(this.doc.context);\n    button.setPartialName(nameParts.terminal);\n\n    addFieldToParent(parent, [button, button.ref], nameParts.terminal);\n\n    return PDFButton.of(button, button.ref, this.doc);\n  }\n\n  /**\n   * Create a new check box field in this [[PDFForm]] with the given name.\n   * For example:\n   * ```js\n   * const font = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const page = pdfDoc.addPage()\n   *\n   * const form = pdfDoc.getForm()\n   * const checkBox = form.createCheckBox('cool.new.checkBox')\n   *\n   * checkBox.addToPage(page)\n   * ```\n   * An error will be thrown if a field already exists with the provided name.\n   * @param name The fully qualified name for the new check box.\n   * @returns The new check box field.\n   */\n  createCheckBox(name: string): PDFCheckBox {\n    assertIs(name, 'name', ['string']);\n\n    const nameParts = splitFieldName(name);\n    const parent = this.findOrCreateNonTerminals(nameParts.nonTerminal);\n\n    const checkBox = PDFAcroCheckBox.create(this.doc.context);\n    checkBox.setPartialName(nameParts.terminal);\n\n    addFieldToParent(parent, [checkBox, checkBox.ref], nameParts.terminal);\n\n    return PDFCheckBox.of(checkBox, checkBox.ref, this.doc);\n  }\n\n  /**\n   * Create a new dropdown field in this [[PDFForm]] with the given name.\n   * For example:\n   * ```js\n   * const font = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const page = pdfDoc.addPage()\n   *\n   * const form = pdfDoc.getForm()\n   * const dropdown = form.createDropdown('cool.new.dropdown')\n   *\n   * dropdown.addToPage(font, page)\n   * ```\n   * An error will be thrown if a field already exists with the provided name.\n   * @param name The fully qualified name for the new dropdown.\n   * @returns The new dropdown field.\n   */\n  createDropdown(name: string): PDFDropdown {\n    assertIs(name, 'name', ['string']);\n\n    const nameParts = splitFieldName(name);\n    const parent = this.findOrCreateNonTerminals(nameParts.nonTerminal);\n\n    const comboBox = PDFAcroComboBox.create(this.doc.context);\n    comboBox.setPartialName(nameParts.terminal);\n\n    addFieldToParent(parent, [comboBox, comboBox.ref], nameParts.terminal);\n\n    return PDFDropdown.of(comboBox, comboBox.ref, this.doc);\n  }\n\n  /**\n   * Create a new option list field in this [[PDFForm]] with the given name.\n   * For example:\n   * ```js\n   * const font = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const page = pdfDoc.addPage()\n   *\n   * const form = pdfDoc.getForm()\n   * const optionList = form.createOptionList('cool.new.optionList')\n   *\n   * optionList.addToPage(font, page)\n   * ```\n   * An error will be thrown if a field already exists with the provided name.\n   * @param name The fully qualified name for the new option list.\n   * @returns The new option list field.\n   */\n  createOptionList(name: string): PDFOptionList {\n    assertIs(name, 'name', ['string']);\n\n    const nameParts = splitFieldName(name);\n    const parent = this.findOrCreateNonTerminals(nameParts.nonTerminal);\n\n    const listBox = PDFAcroListBox.create(this.doc.context);\n    listBox.setPartialName(nameParts.terminal);\n\n    addFieldToParent(parent, [listBox, listBox.ref], nameParts.terminal);\n\n    return PDFOptionList.of(listBox, listBox.ref, this.doc);\n  }\n\n  /**\n   * Create a new radio group field in this [[PDFForm]] with the given name.\n   * For example:\n   * ```js\n   * const font = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const page = pdfDoc.addPage()\n   *\n   * const form = pdfDoc.getForm()\n   * const radioGroup = form.createRadioGroup('cool.new.radioGroup')\n   *\n   * radioGroup.addOptionToPage('is-dog', page, { y: 0 })\n   * radioGroup.addOptionToPage('is-cat', page, { y: 75 })\n   * ```\n   * An error will be thrown if a field already exists with the provided name.\n   * @param name The fully qualified name for the new radio group.\n   * @returns The new radio group field.\n   */\n  createRadioGroup(name: string): PDFRadioGroup {\n    assertIs(name, 'name', ['string']);\n    const nameParts = splitFieldName(name);\n\n    const parent = this.findOrCreateNonTerminals(nameParts.nonTerminal);\n\n    const radioButton = PDFAcroRadioButton.create(this.doc.context);\n    radioButton.setPartialName(nameParts.terminal);\n\n    addFieldToParent(\n      parent,\n      [radioButton, radioButton.ref],\n      nameParts.terminal,\n    );\n\n    return PDFRadioGroup.of(radioButton, radioButton.ref, this.doc);\n  }\n\n  /**\n   * Create a new text field in this [[PDFForm]] with the given name.\n   * For example:\n   * ```js\n   * const font = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const page = pdfDoc.addPage()\n   *\n   * const form = pdfDoc.getForm()\n   * const textField = form.createTextField('cool.new.textField')\n   *\n   * textField.addToPage(font, page)\n   * ```\n   * An error will be thrown if a field already exists with the provided name.\n   * @param name The fully qualified name for the new radio group.\n   * @returns The new radio group field.\n   */\n  createTextField(name: string): PDFTextField {\n    assertIs(name, 'name', ['string']);\n    const nameParts = splitFieldName(name);\n\n    const parent = this.findOrCreateNonTerminals(nameParts.nonTerminal);\n\n    const text = PDFAcroText.create(this.doc.context);\n    text.setPartialName(nameParts.terminal);\n\n    addFieldToParent(parent, [text, text.ref], nameParts.terminal);\n\n    return PDFTextField.of(text, text.ref, this.doc);\n  }\n\n  /**\n   * Flatten all fields in this [[PDFForm]].\n   *\n   * Flattening a form field will take the current appearance for each of that\n   * field's widgets and make them part of their page's content stream. All form\n   * fields and annotations associated are then removed. Note that once a form\n   * has been flattened its fields can no longer be accessed or edited.\n   *\n   * This operation is often used after filling form fields to ensure a\n   * consistent appearance across different PDF readers and/or printers.\n   * Another common use case is to copy a template document with form fields\n   * into another document. In this scenario you would load the template\n   * document, fill its fields, flatten it, and then copy its pages into the\n   * recipient document - the filled fields will be copied over.\n   *\n   * For example:\n   * ```js\n   * const form = pdfDoc.getForm();\n   * form.flatten();\n   * ```\n   */\n  flatten(options: FlattenOptions = { updateFieldAppearances: true }) {\n    if (options.updateFieldAppearances) {\n      this.updateFieldAppearances();\n    }\n\n    const fields = this.getFields();\n\n    for (let i = 0, lenFields = fields.length; i < lenFields; i++) {\n      const field = fields[i];\n      const widgets = field.acroField.getWidgets();\n\n      for (let j = 0, lenWidgets = widgets.length; j < lenWidgets; j++) {\n        const widget = widgets[j];\n        const page = this.findWidgetPage(widget);\n        const widgetRef = this.findWidgetAppearanceRef(field, widget);\n\n        const xObjectKey = page.node.newXObject('FlatWidget', widgetRef);\n\n        const rectangle = widget.getRectangle();\n        const operators = [\n          pushGraphicsState(),\n          translate(rectangle.x, rectangle.y),\n          ...rotateInPlace({ ...rectangle, rotation: 0 }),\n          drawObject(xObjectKey),\n          popGraphicsState(),\n        ].filter(Boolean);\n\n        page.pushOperators(...operators);\n      }\n\n      this.removeField(field);\n    }\n  }\n\n  /**\n   * Remove a field from this [[PDFForm]].\n   *\n   * For example:\n   * ```js\n   * const form = pdfDoc.getForm();\n   * const ageField = form.getFields().find(x => x.getName() === 'Age');\n   * form.removeField(ageField);\n   * ```\n   */\n  removeField(field: PDFField) {\n    const widgets = field.acroField.getWidgets();\n    const pages: Set<PDFPage> = new Set();\n\n    for (let i = 0, len = widgets.length; i < len; i++) {\n      const widget = widgets[i];\n      const widgetRef = this.findWidgetAppearanceRef(field, widget);\n\n      const page = this.findWidgetPage(widget);\n      pages.add(page);\n\n      page.node.removeAnnot(widgetRef);\n    }\n\n    pages.forEach((page) => page.node.removeAnnot(field.ref));\n    this.acroForm.removeField(field.acroField);\n    const fieldKids = field.acroField.normalizedEntries().Kids;\n    const kidsCount = fieldKids.size();\n    for (let childIndex = 0; childIndex < kidsCount; childIndex++) {\n      const child = fieldKids.get(childIndex);\n      if (child instanceof PDFRef) {\n        this.doc.context.delete(child);\n      }\n    }\n    this.doc.context.delete(field.ref);\n  }\n\n  /**\n   * Update the appearance streams for all widgets of all fields in this\n   * [[PDFForm]]. Appearance streams will only be created for a widget if it\n   * does not have any existing appearance streams, or the field's value has\n   * changed (e.g. by calling [[PDFTextField.setText]] or\n   * [[PDFDropdown.select]]).\n   *\n   * For example:\n   * ```js\n   * const courier = await pdfDoc.embedFont(StandardFonts.Courier)\n   * const form = pdfDoc.getForm()\n   * form.updateFieldAppearances(courier)\n   * ```\n   *\n   * **IMPORTANT:** The default value for the `font` parameter is\n   * [[StandardFonts.Helvetica]]. Note that this is a WinAnsi font. This means\n   * that encoding errors will be thrown if any fields contain text with\n   * characters outside the WinAnsi character set (the latin alphabet).\n   *\n   * Embedding a custom font and passing that as the `font`\n   * parameter allows you to generate appearance streams with non WinAnsi\n   * characters (assuming your custom font supports them).\n   *\n   * > **NOTE:** The [[PDFDocument.save]] method will call this method to\n   * > update appearances automatically if a form was accessed via the\n   * > [[PDFDocument.getForm]] method prior to saving.\n   *\n   * @param font Optionally, the font to use when creating new appearances.\n   */\n  updateFieldAppearances(font?: PDFFont) {\n    assertOrUndefined(font, 'font', [[PDFFont, 'PDFFont']]);\n\n    font = font ?? this.getDefaultFont();\n\n    const fields = this.getFields();\n\n    for (let idx = 0, len = fields.length; idx < len; idx++) {\n      const field = fields[idx];\n      if (field.needsAppearancesUpdate()) {\n        field.defaultUpdateAppearances(font);\n      }\n    }\n  }\n\n  /**\n   * Mark a field as dirty. This will cause its appearance streams to be\n   * updated by [[PDFForm.updateFieldAppearances]].\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const field = form.getField('foo.bar')\n   * form.markFieldAsDirty(field.ref)\n   * ```\n   * @param fieldRef The reference to the field that should be marked.\n   */\n  markFieldAsDirty(fieldRef: PDFRef) {\n    assertOrUndefined(fieldRef, 'fieldRef', [[PDFRef, 'PDFRef']]);\n    this.dirtyFields.add(fieldRef);\n  }\n\n  /**\n   * Mark a field as dirty. This will cause its appearance streams to not be\n   * updated by [[PDFForm.updateFieldAppearances]].\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const field = form.getField('foo.bar')\n   * form.markFieldAsClean(field.ref)\n   * ```\n   * @param fieldRef The reference to the field that should be marked.\n   */\n  markFieldAsClean(fieldRef: PDFRef) {\n    assertOrUndefined(fieldRef, 'fieldRef', [[PDFRef, 'PDFRef']]);\n    this.dirtyFields.delete(fieldRef);\n  }\n\n  /**\n   * Returns `true` is the specified field has been marked as dirty.\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const field = form.getField('foo.bar')\n   * if (form.fieldIsDirty(field.ref)) console.log('Field is dirty')\n   * ```\n   * @param fieldRef The reference to the field that should be checked.\n   * @returns Whether or not the specified field is dirty.\n   */\n  fieldIsDirty(fieldRef: PDFRef): boolean {\n    assertOrUndefined(fieldRef, 'fieldRef', [[PDFRef, 'PDFRef']]);\n    return this.dirtyFields.has(fieldRef);\n  }\n\n  getDefaultFont() {\n    return this.defaultFontCache.access();\n  }\n\n  private findWidgetPage(widget: PDFWidgetAnnotation): PDFPage {\n    const pageRef = widget.P();\n    let page = this.doc.getPages().find((x) => x.ref === pageRef);\n    if (page === undefined) {\n      const widgetRef = this.doc.context.getObjectRef(widget.dict);\n      if (widgetRef === undefined) {\n        throw new Error('Could not find PDFRef for PDFObject');\n      }\n\n      page = this.doc.findPageForAnnotationRef(widgetRef);\n\n      if (page === undefined) {\n        throw new Error(`Could not find page for PDFRef ${widgetRef}`);\n      }\n    }\n\n    return page;\n  }\n\n  private findWidgetAppearanceRef(\n    field: PDFField,\n    widget: PDFWidgetAnnotation,\n  ): PDFRef {\n    let refOrDict = widget.getNormalAppearance();\n\n    if (\n      refOrDict instanceof PDFDict &&\n      (field instanceof PDFCheckBox || field instanceof PDFRadioGroup)\n    ) {\n      const value = field.acroField.getValue();\n      const ref = refOrDict.get(value) ?? refOrDict.get(PDFName.of('Off'));\n\n      if (ref instanceof PDFRef) {\n        refOrDict = ref;\n      }\n    }\n\n    if (!(refOrDict instanceof PDFRef)) {\n      const name = field.getName();\n      throw new Error(`Failed to extract appearance ref for: ${name}`);\n    }\n\n    return refOrDict;\n  }\n\n  private findOrCreateNonTerminals(partialNames: string[]) {\n    let nonTerminal: [PDFAcroForm] | [PDFAcroNonTerminal, PDFRef] = [\n      this.acroForm,\n    ];\n    for (let idx = 0, len = partialNames.length; idx < len; idx++) {\n      const namePart = partialNames[idx];\n      if (!namePart) throw new InvalidFieldNamePartError(namePart);\n      const [parent, parentRef] = nonTerminal;\n      const res = this.findNonTerminal(namePart, parent);\n\n      if (res) {\n        nonTerminal = res;\n      } else {\n        const node = PDFAcroNonTerminal.create(this.doc.context);\n        node.setPartialName(namePart);\n        node.setParent(parentRef);\n        const nodeRef = this.doc.context.register(node.dict);\n        parent.addField(nodeRef);\n        nonTerminal = [node, nodeRef];\n      }\n    }\n    return nonTerminal;\n  }\n\n  private findNonTerminal(\n    partialName: string,\n    parent: PDFAcroForm | PDFAcroNonTerminal,\n  ): [PDFAcroNonTerminal, PDFRef] | undefined {\n    const fields =\n      parent instanceof PDFAcroForm\n        ? this.acroForm.getFields()\n        : createPDFAcroFields(parent.Kids());\n\n    for (let idx = 0, len = fields.length; idx < len; idx++) {\n      const [field, ref] = fields[idx];\n      if (field.getPartialName() === partialName) {\n        if (field instanceof PDFAcroNonTerminal) return [field, ref];\n        throw new FieldAlreadyExistsError(partialName);\n      }\n    }\n\n    return undefined;\n  }\n\n  private embedDefaultFont = (): PDFFont =>\n    this.doc.embedStandardFont(StandardFonts.Helvetica);\n}\n\nconst convertToPDFField = (\n  field: PDFAcroField,\n  ref: PDFRef,\n  doc: PDFDocument,\n): PDFField | undefined => {\n  if (field instanceof PDFAcroPushButton) return PDFButton.of(field, ref, doc);\n  if (field instanceof PDFAcroCheckBox) return PDFCheckBox.of(field, ref, doc);\n  if (field instanceof PDFAcroComboBox) return PDFDropdown.of(field, ref, doc);\n  if (field instanceof PDFAcroListBox) return PDFOptionList.of(field, ref, doc);\n  if (field instanceof PDFAcroText) return PDFTextField.of(field, ref, doc);\n  if (field instanceof PDFAcroRadioButton) {\n    return PDFRadioGroup.of(field, ref, doc);\n  }\n  if (field instanceof PDFAcroSignature) {\n    return PDFSignature.of(field, ref, doc);\n  }\n  return undefined;\n};\n\nconst splitFieldName = (fullyQualifiedName: string) => {\n  if (fullyQualifiedName.length === 0) {\n    throw new Error('PDF field names must not be empty strings');\n  }\n\n  const parts = fullyQualifiedName.split('.');\n\n  for (let idx = 0, len = parts.length; idx < len; idx++) {\n    if (parts[idx] === '') {\n      throw new Error(\n        `Periods in PDF field names must be separated by at least one character: \"${fullyQualifiedName}\"`,\n      );\n    }\n  }\n\n  if (parts.length === 1) return { nonTerminal: [], terminal: parts[0] };\n\n  return {\n    nonTerminal: parts.slice(0, parts.length - 1),\n    terminal: parts[parts.length - 1],\n  };\n};\n\nconst addFieldToParent = (\n  [parent, parentRef]: [PDFAcroForm] | [PDFAcroNonTerminal, PDFRef],\n  [field, fieldRef]: [PDFAcroField, PDFRef],\n  partialName: string,\n) => {\n  const entries = parent.normalizedEntries();\n  const fields = createPDFAcroFields(\n    'Kids' in entries ? entries.Kids : entries.Fields,\n  );\n  for (let idx = 0, len = fields.length; idx < len; idx++) {\n    if (fields[idx][0].getPartialName() === partialName) {\n      throw new FieldAlreadyExistsError(partialName);\n    }\n  }\n  parent.addField(fieldRef);\n  field.setParent(parentRef);\n};\n","export const PageSizes = {\n  '4A0': [4767.87, 6740.79] as [number, number],\n  '2A0': [3370.39, 4767.87] as [number, number],\n  A0: [2383.94, 3370.39] as [number, number],\n  A1: [1683.78, 2383.94] as [number, number],\n  A2: [1190.55, 1683.78] as [number, number],\n  A3: [841.89, 1190.55] as [number, number],\n  A4: [595.28, 841.89] as [number, number],\n  A5: [419.53, 595.28] as [number, number],\n  A6: [297.64, 419.53] as [number, number],\n  A7: [209.76, 297.64] as [number, number],\n  A8: [147.4, 209.76] as [number, number],\n  A9: [104.88, 147.4] as [number, number],\n  A10: [73.7, 104.88] as [number, number],\n  B0: [2834.65, 4008.19] as [number, number],\n  B1: [2004.09, 2834.65] as [number, number],\n  B2: [1417.32, 2004.09] as [number, number],\n  B3: [1000.63, 1417.32] as [number, number],\n  B4: [708.66, 1000.63] as [number, number],\n  B5: [498.9, 708.66] as [number, number],\n  B6: [354.33, 498.9] as [number, number],\n  B7: [249.45, 354.33] as [number, number],\n  B8: [175.75, 249.45] as [number, number],\n  B9: [124.72, 175.75] as [number, number],\n  B10: [87.87, 124.72] as [number, number],\n  C0: [2599.37, 3676.54] as [number, number],\n  C1: [1836.85, 2599.37] as [number, number],\n  C2: [1298.27, 1836.85] as [number, number],\n  C3: [918.43, 1298.27] as [number, number],\n  C4: [649.13, 918.43] as [number, number],\n  C5: [459.21, 649.13] as [number, number],\n  C6: [323.15, 459.21] as [number, number],\n  C7: [229.61, 323.15] as [number, number],\n  C8: [161.57, 229.61] as [number, number],\n  C9: [113.39, 161.57] as [number, number],\n  C10: [79.37, 113.39] as [number, number],\n  RA0: [2437.8, 3458.27] as [number, number],\n  RA1: [1729.13, 2437.8] as [number, number],\n  RA2: [1218.9, 1729.13] as [number, number],\n  RA3: [864.57, 1218.9] as [number, number],\n  RA4: [609.45, 864.57] as [number, number],\n  SRA0: [2551.18, 3628.35] as [number, number],\n  SRA1: [1814.17, 2551.18] as [number, number],\n  SRA2: [1275.59, 1814.17] as [number, number],\n  SRA3: [907.09, 1275.59] as [number, number],\n  SRA4: [637.8, 907.09] as [number, number],\n  Executive: [521.86, 756.0] as [number, number],\n  Folio: [612.0, 936.0] as [number, number],\n  Legal: [612.0, 1008.0] as [number, number],\n  Letter: [612.0, 792.0] as [number, number],\n  Tabloid: [792.0, 1224.0] as [number, number],\n};\n","import { EmbeddedFileOptions } from 'src/core/embedders/FileEmbedder';\nimport { TypeFeatures } from 'src/types/fontkit';\n\nexport enum ParseSpeeds {\n  Fastest = Infinity,\n  Fast = 1500,\n  Medium = 500,\n  Slow = 100\n}\n\nexport interface AttachmentOptions extends EmbeddedFileOptions {}\n\nexport interface SaveOptions {\n  useObjectStreams?: boolean;\n  addDefaultPage?: boolean;\n  objectsPerTick?: number;\n  updateFieldAppearances?: boolean;\n}\n\nexport interface Base64SaveOptions extends SaveOptions {\n  dataUri?: boolean;\n}\n\nexport interface LoadOptions {\n  ignoreEncryption?: boolean;\n  parseSpeed?: ParseSpeeds | number;\n  throwOnInvalidObject?: boolean;\n  updateMetadata?: boolean;\n  capNumbers?: boolean;\n}\n\nexport interface CreateOptions {\n  updateMetadata?: boolean;\n}\n\nexport interface EmbedFontOptions {\n  subset?: boolean;\n  customName?: string;\n  features?: TypeFeatures;\n}\n\nexport interface SetTitleOptions {\n  showInWindowTitleBar: boolean;\n}\n","import Embeddable from 'src/api/Embeddable';\nimport PDFDocument from 'src/api/PDFDocument';\nimport FileEmbedder from 'src/core/embedders/FileEmbedder';\nimport { PDFName, PDFArray, PDFDict, PDFHexString, PDFRef } from 'src/core';\n\n/**\n * Represents a file that has been embedded in a [[PDFDocument]].\n */\nexport default class PDFEmbeddedFile implements Embeddable {\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFDocument.attach]] method, which will create\n   * instances of [[PDFEmbeddedFile]] for you.\n   *\n   * Create an instance of [[PDFEmbeddedFile]] from an existing ref and embedder\n   *\n   * @param ref The unique reference for this file.\n   * @param doc The document to which the file will belong.\n   * @param embedder The embedder that will be used to embed the file.\n   */\n  static of = (ref: PDFRef, doc: PDFDocument, embedder: FileEmbedder) =>\n    new PDFEmbeddedFile(ref, doc, embedder);\n\n  /** The unique reference assigned to this embedded file within the document. */\n  readonly ref: PDFRef;\n\n  /** The document to which this embedded file belongs. */\n  readonly doc: PDFDocument;\n\n  private alreadyEmbedded = false;\n  private readonly embedder: FileEmbedder;\n\n  private constructor(ref: PDFRef, doc: PDFDocument, embedder: FileEmbedder) {\n    this.ref = ref;\n    this.doc = doc;\n    this.embedder = embedder;\n  }\n\n  /**\n   * > **NOTE:** You probably don't need to call this method directly. The\n   * > [[PDFDocument.save]] and [[PDFDocument.saveAsBase64]] methods will\n   * > automatically ensure all embeddable files get embedded.\n   *\n   * Embed this embeddable file in its document.\n   *\n   * @returns Resolves when the embedding is complete.\n   */\n  async embed(): Promise<void> {\n    if (!this.alreadyEmbedded) {\n      const ref = await this.embedder.embedIntoContext(\n        this.doc.context,\n        this.ref,\n      );\n\n      if (!this.doc.catalog.has(PDFName.of('Names'))) {\n        this.doc.catalog.set(PDFName.of('Names'), this.doc.context.obj({}));\n      }\n      const Names = this.doc.catalog.lookup(PDFName.of('Names'), PDFDict);\n\n      if (!Names.has(PDFName.of('EmbeddedFiles'))) {\n        Names.set(PDFName.of('EmbeddedFiles'), this.doc.context.obj({}));\n      }\n      const EmbeddedFiles = Names.lookup(PDFName.of('EmbeddedFiles'), PDFDict);\n\n      if (!EmbeddedFiles.has(PDFName.of('Names'))) {\n        EmbeddedFiles.set(PDFName.of('Names'), this.doc.context.obj([]));\n      }\n      const EFNames = EmbeddedFiles.lookup(PDFName.of('Names'), PDFArray);\n\n      EFNames.push(PDFHexString.fromText(this.embedder.fileName));\n      EFNames.push(ref);\n\n      /**\n       * The AF-Tag is needed to achieve PDF-A3 compliance for embedded files\n       *\n       * The following document outlines the uses cases of the associated files (AF) tag.\n       * See:\n       * https://www.pdfa.org/wp-content/uploads/2018/10/PDF20_AN002-AF.pdf\n       */\n\n      if (!this.doc.catalog.has(PDFName.of('AF'))) {\n        this.doc.catalog.set(PDFName.of('AF'), this.doc.context.obj([]));\n      }\n      const AF = this.doc.catalog.lookup(PDFName.of('AF'), PDFArray);\n      AF.push(ref);\n\n      this.alreadyEmbedded = true;\n    }\n  }\n}\n","import Embeddable from 'src/api/Embeddable';\nimport PDFDocument from 'src/api/PDFDocument';\nimport JavaScriptEmbedder from 'src/core/embedders/JavaScriptEmbedder';\nimport { PDFName, PDFArray, PDFDict, PDFHexString, PDFRef } from 'src/core';\n\n/**\n * Represents JavaScript that has been embedded in a [[PDFDocument]].\n */\nexport default class PDFJavaScript implements Embeddable {\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFDocument.addJavaScript]] method, which will\n   * create instances of [[PDFJavaScript]] for you.\n   *\n   * Create an instance of [[PDFJavaScript]] from an existing ref and script\n   *\n   * @param ref The unique reference for this script.\n   * @param doc The document to which the script will belong.\n   * @param embedder The embedder that will be used to embed the script.\n   */\n  static of = (ref: PDFRef, doc: PDFDocument, embedder: JavaScriptEmbedder) =>\n    new PDFJavaScript(ref, doc, embedder);\n\n  /** The unique reference assigned to this embedded script within the document. */\n  readonly ref: PDFRef;\n\n  /** The document to which this embedded script belongs. */\n  readonly doc: PDFDocument;\n\n  private alreadyEmbedded = false;\n  private readonly embedder: JavaScriptEmbedder;\n\n  private constructor(\n    ref: PDFRef,\n    doc: PDFDocument,\n    embedder: JavaScriptEmbedder,\n  ) {\n    this.ref = ref;\n    this.doc = doc;\n    this.embedder = embedder;\n  }\n\n  /**\n   * > **NOTE:** You probably don't need to call this method directly. The\n   * > [[PDFDocument.save]] and [[PDFDocument.saveAsBase64]] methods will\n   * > automatically ensure all JavaScripts get embedded.\n   *\n   * Embed this JavaScript in its document.\n   *\n   * @returns Resolves when the embedding is complete.\n   */\n  async embed(): Promise<void> {\n    if (!this.alreadyEmbedded) {\n      const { catalog, context } = this.doc;\n\n      const ref = await this.embedder.embedIntoContext(\n        this.doc.context,\n        this.ref,\n      );\n\n      if (!catalog.has(PDFName.of('Names'))) {\n        catalog.set(PDFName.of('Names'), context.obj({}));\n      }\n      const Names = catalog.lookup(PDFName.of('Names'), PDFDict);\n\n      if (!Names.has(PDFName.of('JavaScript'))) {\n        Names.set(PDFName.of('JavaScript'), context.obj({}));\n      }\n      const Javascript = Names.lookup(PDFName.of('JavaScript'), PDFDict);\n\n      if (!Javascript.has(PDFName.of('Names'))) {\n        Javascript.set(PDFName.of('Names'), context.obj([]));\n      }\n      const JSNames = Javascript.lookup(PDFName.of('Names'), PDFArray);\n\n      JSNames.push(PDFHexString.fromText(this.embedder.scriptName));\n      JSNames.push(ref);\n\n      this.alreadyEmbedded = true;\n    }\n  }\n}\n","import PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFContext from 'src/core/PDFContext';\nimport PDFRef from 'src/core/objects/PDFRef';\n\nclass JavaScriptEmbedder {\n  static for(script: string, scriptName: string) {\n    return new JavaScriptEmbedder(script, scriptName);\n  }\n\n  private readonly script: string;\n  readonly scriptName: string;\n\n  private constructor(script: string, scriptName: string) {\n    this.script = script;\n    this.scriptName = scriptName;\n  }\n\n  async embedIntoContext(context: PDFContext, ref?: PDFRef): Promise<PDFRef> {\n    const jsActionDict = context.obj({\n      Type: 'Action',\n      S: 'JavaScript',\n      JS: PDFHexString.fromText(this.script),\n    });\n\n    if (ref) {\n      context.assign(ref, jsActionDict);\n      return ref;\n    } else {\n      return context.register(jsActionDict);\n    }\n  }\n}\n\nexport default JavaScriptEmbedder;\n","import Embeddable from 'src/api/Embeddable';\nimport {\n  EncryptedPDFError,\n  FontkitNotRegisteredError,\n  ForeignPageError,\n  RemovePageFromEmptyDocumentError,\n} from 'src/api/errors';\nimport PDFEmbeddedPage from 'src/api/PDFEmbeddedPage';\nimport PDFFont from 'src/api/PDFFont';\nimport PDFImage from 'src/api/PDFImage';\nimport PDFPage from 'src/api/PDFPage';\nimport PDFForm from 'src/api/form/PDFForm';\nimport { PageSizes } from 'src/api/sizes';\nimport { StandardFonts } from 'src/api/StandardFonts';\nimport {\n  CustomFontEmbedder,\n  CustomFontSubsetEmbedder,\n  JpegEmbedder,\n  PageBoundingBox,\n  PageEmbeddingMismatchedContextError,\n  PDFCatalog,\n  PDFContext,\n  PDFDict,\n  PDFHexString,\n  PDFName,\n  PDFObjectCopier,\n  PDFPageEmbedder,\n  PDFPageLeaf,\n  PDFPageTree,\n  PDFParser,\n  PDFStreamWriter,\n  PDFString,\n  PDFWriter,\n  PngEmbedder,\n  StandardFontEmbedder,\n  UnexpectedObjectTypeError,\n} from 'src/core';\nimport {\n  ParseSpeeds,\n  AttachmentOptions,\n  SaveOptions,\n  Base64SaveOptions,\n  LoadOptions,\n  CreateOptions,\n  EmbedFontOptions,\n  SetTitleOptions,\n} from 'src/api/PDFDocumentOptions';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport { Fontkit } from 'src/types/fontkit';\nimport { TransformationMatrix } from 'src/types/matrix';\nimport {\n  assertIs,\n  assertIsOneOfOrUndefined,\n  assertOrUndefined,\n  assertRange,\n  Cache,\n  canBeConvertedToUint8Array,\n  encodeToBase64,\n  isStandardFont,\n  pluckIndices,\n  range,\n  toUint8Array,\n} from 'src/utils';\nimport FileEmbedder, { AFRelationship } from 'src/core/embedders/FileEmbedder';\nimport PDFEmbeddedFile from 'src/api/PDFEmbeddedFile';\nimport PDFJavaScript from 'src/api/PDFJavaScript';\nimport JavaScriptEmbedder from 'src/core/embedders/JavaScriptEmbedder';\n\n/**\n * Represents a PDF document.\n */\nexport default class PDFDocument {\n  /**\n   * Load an existing [[PDFDocument]]. The input data can be provided in\n   * multiple formats:\n   *\n   * | Type          | Contents                                               |\n   * | ------------- | ------------------------------------------------------ |\n   * | `string`      | A base64 encoded string (or data URI) containing a PDF |\n   * | `Uint8Array`  | The raw bytes of a PDF                                 |\n   * | `ArrayBuffer` | The raw bytes of a PDF                                 |\n   *\n   * For example:\n   * ```js\n   * import { PDFDocument } from 'pdf-lib'\n   *\n   * // pdf=string\n   * const base64 =\n   *  'JVBERi0xLjcKJYGBgYEKCjUgMCBvYmoKPDwKL0ZpbHRlciAvRmxhdGVEZWNvZGUKL0xlbm' +\n   *  'd0aCAxMDQKPj4Kc3RyZWFtCniccwrhMlAAwaJ0Ln2P1Jyy1JLM5ERdc0MjCwUjE4WQNC4Q' +\n   *  '6cNlCFZkqGCqYGSqEJLLZWNuYGZiZmbkYuZsZmlmZGRgZmluDCQNzc3NTM2NzdzMXMxMjQ' +\n   *  'ztFEKyuEK0uFxDuAAOERdVCmVuZHN0cmVhbQplbmRvYmoKCjYgMCBvYmoKPDwKL0ZpbHRl' +\n   *  'ciAvRmxhdGVEZWNvZGUKL1R5cGUgL09ialN0bQovTiA0Ci9GaXJzdCAyMAovTGVuZ3RoID' +\n   *  'IxNQo+PgpzdHJlYW0KeJxVj9GqwjAMhu/zFHkBzTo3nCCCiiKIHPEICuJF3cKoSCu2E8/b' +\n   *  '20wPIr1p8v9/8kVhgilmGfawX2CGaVrgcAi0/bsy0lrX7IGWpvJ4iJYEN3gEmrrGBlQwGs' +\n   *  'HHO9VBX1wNrxAqMX87RBD5xpJuddqwd82tjAHxzV1U5LPgy52DKXWnr1Lheg+j/c/pzGVr' +\n   *  'iqV0VlwZPXGPCJjElw/ybkwUmeoWgxesDXGhHJC/D/iikp1Av80ptKU0FdBEe25pPihAM1' +\n   *  'u6ytgaaWfs2Hrz35CJT1+EWmAKZW5kc3RyZWFtCmVuZG9iagoKNyAwIG9iago8PAovU2l6' +\n   *  'ZSA4Ci9Sb290IDIgMCBSCi9GaWx0ZXIgL0ZsYXRlRGVjb2RlCi9UeXBlIC9YUmVmCi9MZW' +\n   *  '5ndGggMzgKL1cgWyAxIDIgMiBdCi9JbmRleCBbIDAgOCBdCj4+CnN0cmVhbQp4nBXEwREA' +\n   *  'EBAEsCwz3vrvRmOOyyOoGhZdutHN2MT55fIAVocD+AplbmRzdHJlYW0KZW5kb2JqCgpzdG' +\n   *  'FydHhyZWYKNTEwCiUlRU9G'\n   *\n   * const dataUri = 'data:application/pdf;base64,' + base64\n   *\n   * const pdfDoc1 = await PDFDocument.load(base64)\n   * const pdfDoc2 = await PDFDocument.load(dataUri)\n   *\n   * // pdf=Uint8Array\n   * import fs from 'fs'\n   * const uint8Array = fs.readFileSync('with_update_sections.pdf')\n   * const pdfDoc3 = await PDFDocument.load(uint8Array)\n   *\n   * // pdf=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/with_update_sections.pdf'\n   * const arrayBuffer = await fetch(url).then(res => res.arrayBuffer())\n   * const pdfDoc4 = await PDFDocument.load(arrayBuffer)\n   *\n   * ```\n   *\n   * @param pdf The input data containing a PDF document.\n   * @param options The options to be used when loading the document.\n   * @returns Resolves with a document loaded from the input.\n   */\n  static async load(\n    pdf: string | Uint8Array | ArrayBuffer,\n    options: LoadOptions = {},\n  ) {\n    const {\n      ignoreEncryption = false,\n      parseSpeed = ParseSpeeds.Slow,\n      throwOnInvalidObject = false,\n      updateMetadata = true,\n      capNumbers = false,\n    } = options;\n\n    assertIs(pdf, 'pdf', ['string', Uint8Array, ArrayBuffer]);\n    assertIs(ignoreEncryption, 'ignoreEncryption', ['boolean']);\n    assertIs(parseSpeed, 'parseSpeed', ['number']);\n    assertIs(throwOnInvalidObject, 'throwOnInvalidObject', ['boolean']);\n\n    const bytes = toUint8Array(pdf);\n    const context = await PDFParser.forBytesWithOptions(\n      bytes,\n      parseSpeed,\n      throwOnInvalidObject,\n      capNumbers,\n    ).parseDocument();\n    return new PDFDocument(context, ignoreEncryption, updateMetadata);\n  }\n\n  /**\n   * Create a new [[PDFDocument]].\n   * @returns Resolves with the newly created document.\n   */\n  static async create(options: CreateOptions = {}) {\n    const { updateMetadata = true } = options;\n\n    const context = PDFContext.create();\n    const pageTree = PDFPageTree.withContext(context);\n    const pageTreeRef = context.register(pageTree);\n    const catalog = PDFCatalog.withContextAndPages(context, pageTreeRef);\n    context.trailerInfo.Root = context.register(catalog);\n\n    return new PDFDocument(context, false, updateMetadata);\n  }\n\n  /** The low-level context of this document. */\n  readonly context: PDFContext;\n\n  /** The catalog of this document. */\n  readonly catalog: PDFCatalog;\n\n  /** Whether or not this document is encrypted. */\n  readonly isEncrypted: boolean;\n\n  /** The default word breaks used in PDFPage.drawText */\n  defaultWordBreaks: string[] = [' '];\n\n  private fontkit?: Fontkit;\n  private pageCount: number | undefined;\n  private readonly pageCache: Cache<PDFPage[]>;\n  private readonly pageMap: Map<PDFPageLeaf, PDFPage>;\n  private readonly formCache: Cache<PDFForm>;\n  private readonly fonts: PDFFont[];\n  private readonly images: PDFImage[];\n  private readonly embeddedPages: PDFEmbeddedPage[];\n  private readonly embeddedFiles: PDFEmbeddedFile[];\n  private readonly javaScripts: PDFJavaScript[];\n\n  private constructor(\n    context: PDFContext,\n    ignoreEncryption: boolean,\n    updateMetadata: boolean,\n  ) {\n    assertIs(context, 'context', [[PDFContext, 'PDFContext']]);\n    assertIs(ignoreEncryption, 'ignoreEncryption', ['boolean']);\n\n    this.context = context;\n    this.catalog = context.lookup(context.trailerInfo.Root) as PDFCatalog;\n    this.isEncrypted = !!context.lookup(context.trailerInfo.Encrypt);\n\n    this.pageCache = Cache.populatedBy(this.computePages);\n    this.pageMap = new Map();\n    this.formCache = Cache.populatedBy(this.getOrCreateForm);\n    this.fonts = [];\n    this.images = [];\n    this.embeddedPages = [];\n    this.embeddedFiles = [];\n    this.javaScripts = [];\n\n    if (!ignoreEncryption && this.isEncrypted) throw new EncryptedPDFError();\n\n    if (updateMetadata) this.updateInfoDict();\n  }\n\n  /**\n   * Register a fontkit instance. This must be done before custom fonts can\n   * be embedded. See [here](https://github.com/Hopding/pdf-lib/tree/master#fontkit-installation)\n   * for instructions on how to install and register a fontkit instance.\n   *\n   * > You do **not** need to call this method to embed standard fonts.\n   *\n   * For example:\n   * ```js\n   * import { PDFDocument } from 'pdf-lib'\n   * import fontkit from '@pdf-lib/fontkit'\n   *\n   * const pdfDoc = await PDFDocument.create()\n   * pdfDoc.registerFontkit(fontkit)\n   * ```\n   *\n   * @param fontkit The fontkit instance to be registered.\n   */\n  registerFontkit(fontkit: Fontkit): void {\n    this.fontkit = fontkit;\n  }\n\n  /**\n   * Get the [[PDFForm]] containing all interactive fields for this document.\n   * For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const fields = form.getFields()\n   * fields.forEach(field => {\n   *   const type = field.constructor.name\n   *   const name = field.getName()\n   *   console.log(`${type}: ${name}`)\n   * })\n   * ```\n   * @returns The form for this document.\n   */\n  getForm(): PDFForm {\n    const form = this.formCache.access();\n    if (form.hasXFA()) {\n      console.warn(\n        'Removing XFA form data as pdf-lib does not support reading or writing XFA',\n      );\n      form.deleteXFA();\n    }\n    return form;\n  }\n\n  /**\n   * Get this document's title metadata. The title appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const title = pdfDoc.getTitle()\n   * ```\n   * @returns A string containing the title of this document, if it has one.\n   */\n  getTitle(): string | undefined {\n    const title = this.getInfoDict().lookup(PDFName.Title);\n    if (!title) return undefined;\n    assertIsLiteralOrHexString(title);\n    return title.decodeText();\n  }\n\n  /**\n   * Get this document's author metadata. The author appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const author = pdfDoc.getAuthor()\n   * ```\n   * @returns A string containing the author of this document, if it has one.\n   */\n  getAuthor(): string | undefined {\n    const author = this.getInfoDict().lookup(PDFName.Author);\n    if (!author) return undefined;\n    assertIsLiteralOrHexString(author);\n    return author.decodeText();\n  }\n\n  /**\n   * Get this document's subject metadata. The subject appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const subject = pdfDoc.getSubject()\n   * ```\n   * @returns A string containing the subject of this document, if it has one.\n   */\n  getSubject(): string | undefined {\n    const subject = this.getInfoDict().lookup(PDFName.Subject);\n    if (!subject) return undefined;\n    assertIsLiteralOrHexString(subject);\n    return subject.decodeText();\n  }\n\n  /**\n   * Get this document's keywords metadata. The keywords appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const keywords = pdfDoc.getKeywords()\n   * ```\n   * @returns A string containing the keywords of this document, if it has any.\n   */\n  getKeywords(): string | undefined {\n    const keywords = this.getInfoDict().lookup(PDFName.Keywords);\n    if (!keywords) return undefined;\n    assertIsLiteralOrHexString(keywords);\n    return keywords.decodeText();\n  }\n\n  /**\n   * Get this document's creator metadata. The creator appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const creator = pdfDoc.getCreator()\n   * ```\n   * @returns A string containing the creator of this document, if it has one.\n   */\n  getCreator(): string | undefined {\n    const creator = this.getInfoDict().lookup(PDFName.Creator);\n    if (!creator) return undefined;\n    assertIsLiteralOrHexString(creator);\n    return creator.decodeText();\n  }\n\n  /**\n   * Get this document's producer metadata. The producer appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const producer = pdfDoc.getProducer()\n   * ```\n   * @returns A string containing the producer of this document, if it has one.\n   */\n  getProducer(): string | undefined {\n    const producer = this.getInfoDict().lookup(PDFName.Producer);\n    if (!producer) return undefined;\n    assertIsLiteralOrHexString(producer);\n    return producer.decodeText();\n  }\n\n  /**\n   * Get this document's creation date metadata. The creation date appears in\n   * the \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const creationDate = pdfDoc.getCreationDate()\n   * ```\n   * @returns A Date containing the creation date of this document,\n   *          if it has one.\n   */\n  getCreationDate(): Date | undefined {\n    const creationDate = this.getInfoDict().lookup(PDFName.CreationDate);\n    if (!creationDate) return undefined;\n    assertIsLiteralOrHexString(creationDate);\n    return creationDate.decodeDate();\n  }\n\n  /**\n   * Get this document's modification date metadata. The modification date\n   * appears in the \"Document Properties\" section of most PDF readers.\n   * For example:\n   * ```js\n   * const modification = pdfDoc.getModificationDate()\n   * ```\n   * @returns A Date containing the modification date of this document,\n   *          if it has one.\n   */\n  getModificationDate(): Date | undefined {\n    const modificationDate = this.getInfoDict().lookup(PDFName.ModDate);\n    if (!modificationDate) return undefined;\n    assertIsLiteralOrHexString(modificationDate);\n    return modificationDate.decodeDate();\n  }\n\n  /**\n   * Set this document's title metadata. The title will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setTitle('🥚 The Life of an Egg 🍳')\n   * ```\n   *\n   * To display the title in the window's title bar, set the\n   * `showInWindowTitleBar` option to `true` (works for _most_ PDF readers).\n   * For example:\n   * ```js\n   * pdfDoc.setTitle('🥚 The Life of an Egg 🍳', { showInWindowTitleBar: true })\n   * ```\n   *\n   * @param title The title of this document.\n   * @param options The options to be used when setting the title.\n   */\n  setTitle(title: string, options?: SetTitleOptions): void {\n    assertIs(title, 'title', ['string']);\n    const key = PDFName.of('Title');\n    this.getInfoDict().set(key, PDFHexString.fromText(title));\n\n    // Indicate that readers should display the title rather than the filename\n    if (options?.showInWindowTitleBar) {\n      const prefs = this.catalog.getOrCreateViewerPreferences();\n      prefs.setDisplayDocTitle(true);\n    }\n  }\n\n  /**\n   * Set this document's author metadata. The author will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setAuthor('Humpty Dumpty')\n   * ```\n   * @param author The author of this document.\n   */\n  setAuthor(author: string): void {\n    assertIs(author, 'author', ['string']);\n    const key = PDFName.of('Author');\n    this.getInfoDict().set(key, PDFHexString.fromText(author));\n  }\n\n  /**\n   * Set this document's subject metadata. The subject will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setSubject('📘 An Epic Tale of Woe 📖')\n   * ```\n   * @param subject The subject of this document.\n   */\n  setSubject(subject: string): void {\n    assertIs(subject, 'author', ['string']);\n    const key = PDFName.of('Subject');\n    this.getInfoDict().set(key, PDFHexString.fromText(subject));\n  }\n\n  /**\n   * Set this document's keyword metadata. These keywords will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setKeywords(['eggs', 'wall', 'fall', 'king', 'horses', 'men'])\n   * ```\n   * @param keywords An array of keywords associated with this document.\n   */\n  setKeywords(keywords: string[]): void {\n    assertIs(keywords, 'keywords', [Array]);\n    const key = PDFName.of('Keywords');\n    this.getInfoDict().set(key, PDFHexString.fromText(keywords.join(' ')));\n  }\n\n  /**\n   * Set this document's creator metadata. The creator will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setCreator('PDF App 9000 🤖')\n   * ```\n   * @param creator The creator of this document.\n   */\n  setCreator(creator: string): void {\n    assertIs(creator, 'creator', ['string']);\n    const key = PDFName.of('Creator');\n    this.getInfoDict().set(key, PDFHexString.fromText(creator));\n  }\n\n  /**\n   * Set this document's producer metadata. The producer will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setProducer('PDF App 9000 🤖')\n   * ```\n   * @param producer The producer of this document.\n   */\n  setProducer(producer: string): void {\n    assertIs(producer, 'creator', ['string']);\n    const key = PDFName.of('Producer');\n    this.getInfoDict().set(key, PDFHexString.fromText(producer));\n  }\n\n  /**\n   * Set this document's language metadata. The language will appear in the\n   * \"Document Properties\" section of some PDF readers. For example:\n   * ```js\n   * pdfDoc.setLanguage('en-us')\n   * ```\n   *\n   * @param language An RFC 3066 _Language-Tag_ denoting the language of this\n   *                 document, or an empty string if the language is unknown.\n   */\n  setLanguage(language: string): void {\n    assertIs(language, 'language', ['string']);\n    const key = PDFName.of('Lang');\n    this.catalog.set(key, PDFString.of(language));\n  }\n\n  /**\n   * Set this document's creation date metadata. The creation date will appear\n   * in the \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setCreationDate(new Date())\n   * ```\n   * @param creationDate The date this document was created.\n   */\n  setCreationDate(creationDate: Date): void {\n    assertIs(creationDate, 'creationDate', [[Date, 'Date']]);\n    const key = PDFName.of('CreationDate');\n    this.getInfoDict().set(key, PDFString.fromDate(creationDate));\n  }\n\n  /**\n   * Set this document's modification date metadata. The modification date will\n   * appear in the \"Document Properties\" section of most PDF readers. For\n   * example:\n   * ```js\n   * pdfDoc.setModificationDate(new Date())\n   * ```\n   * @param modificationDate The date this document was last modified.\n   */\n  setModificationDate(modificationDate: Date): void {\n    assertIs(modificationDate, 'modificationDate', [[Date, 'Date']]);\n    const key = PDFName.of('ModDate');\n    this.getInfoDict().set(key, PDFString.fromDate(modificationDate));\n  }\n\n  /**\n   * Get the number of pages contained in this document. For example:\n   * ```js\n   * const totalPages = pdfDoc.getPageCount()\n   * ```\n   * @returns The number of pages in this document.\n   */\n  getPageCount(): number {\n    if (this.pageCount === undefined) this.pageCount = this.getPages().length;\n    return this.pageCount;\n  }\n\n  /**\n   * Get an array of all the pages contained in this document. The pages are\n   * stored in the array in the same order that they are rendered in the\n   * document. For example:\n   * ```js\n   * const pages = pdfDoc.getPages()\n   * pages[0]   // The first page of the document\n   * pages[2]   // The third page of the document\n   * pages[197] // The 198th page of the document\n   * ```\n   * @returns An array of all the pages contained in this document.\n   */\n  getPages(): PDFPage[] {\n    return this.pageCache.access();\n  }\n\n  /**\n   * Get the page rendered at a particular `index` of the document. For example:\n   * ```js\n   * pdfDoc.getPage(0)   // The first page of the document\n   * pdfDoc.getPage(2)   // The third page of the document\n   * pdfDoc.getPage(197) // The 198th page of the document\n   * ```\n   * @returns The [[PDFPage]] rendered at the given `index` of the document.\n   */\n  getPage(index: number): PDFPage {\n    const pages = this.getPages();\n    assertRange(index, 'index', 0, pages.length - 1);\n    return pages[index];\n  }\n\n  /**\n   * Get an array of indices for all the pages contained in this document. The\n   * array will contain a range of integers from\n   * `0..pdfDoc.getPageCount() - 1`. For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   * pdfDoc.addPage()\n   * pdfDoc.addPage()\n   * pdfDoc.addPage()\n   *\n   * const indices = pdfDoc.getPageIndices()\n   * indices // => [0, 1, 2]\n   * ```\n   * @returns An array of indices for all pages contained in this document.\n   */\n  getPageIndices(): number[] {\n    return range(0, this.getPageCount());\n  }\n\n  /**\n   * Remove the page at a given index from this document. For example:\n   * ```js\n   * pdfDoc.removePage(0)   // Remove the first page of the document\n   * pdfDoc.removePage(2)   // Remove the third page of the document\n   * pdfDoc.removePage(197) // Remove the 198th page of the document\n   * ```\n   * Once a page has been removed, it will no longer be rendered at that index\n   * in the document.\n   * @param index The index of the page to be removed.\n   */\n  removePage(index: number): void {\n    const pageCount = this.getPageCount();\n    if (this.pageCount === 0) throw new RemovePageFromEmptyDocumentError();\n    assertRange(index, 'index', 0, pageCount - 1);\n    this.catalog.removeLeafNode(index);\n    this.pageCount = pageCount - 1;\n  }\n\n  /**\n   * Add a page to the end of this document. This method accepts three\n   * different value types for the `page` parameter:\n   *\n   * | Type               | Behavior                                                                            |\n   * | ------------------ | ----------------------------------------------------------------------------------- |\n   * | `undefined`        | Create a new page and add it to the end of this document                            |\n   * | `[number, number]` | Create a new page with the given dimensions and add it to the end of this document  |\n   * | `PDFPage`          | Add the existing page to the end of this document                                   |\n   *\n   * For example:\n   * ```js\n   * // page=undefined\n   * const newPage = pdfDoc.addPage()\n   *\n   * // page=[number, number]\n   * import { PageSizes } from 'pdf-lib'\n   * const newPage1 = pdfDoc.addPage(PageSizes.A7)\n   * const newPage2 = pdfDoc.addPage(PageSizes.Letter)\n   * const newPage3 = pdfDoc.addPage([500, 750])\n   *\n   * // page=PDFPage\n   * const pdfDoc1 = await PDFDocument.create()\n   * const pdfDoc2 = await PDFDocument.load(...)\n   * const [existingPage] = await pdfDoc1.copyPages(pdfDoc2, [0])\n   * pdfDoc1.addPage(existingPage)\n   * ```\n   *\n   * @param page Optionally, the desired dimensions or existing page.\n   * @returns The newly created (or existing) page.\n   */\n  addPage(page?: PDFPage | [number, number]): PDFPage {\n    assertIs(page, 'page', ['undefined', [PDFPage, 'PDFPage'], Array]);\n    return this.insertPage(this.getPageCount(), page);\n  }\n\n  /**\n   * Insert a page at a given index within this document. This method accepts\n   * three different value types for the `page` parameter:\n   *\n   * | Type               | Behavior                                                                       |\n   * | ------------------ | ------------------------------------------------------------------------------ |\n   * | `undefined`        | Create a new page and insert it into this document                             |\n   * | `[number, number]` | Create a new page with the given dimensions and insert it into this document   |\n   * | `PDFPage`          | Insert the existing page into this document                                    |\n   *\n   * For example:\n   * ```js\n   * // page=undefined\n   * const newPage = pdfDoc.insertPage(2)\n   *\n   * // page=[number, number]\n   * import { PageSizes } from 'pdf-lib'\n   * const newPage1 = pdfDoc.insertPage(2, PageSizes.A7)\n   * const newPage2 = pdfDoc.insertPage(0, PageSizes.Letter)\n   * const newPage3 = pdfDoc.insertPage(198, [500, 750])\n   *\n   * // page=PDFPage\n   * const pdfDoc1 = await PDFDocument.create()\n   * const pdfDoc2 = await PDFDocument.load(...)\n   * const [existingPage] = await pdfDoc1.copyPages(pdfDoc2, [0])\n   * pdfDoc1.insertPage(0, existingPage)\n   * ```\n   *\n   * @param index The index at which the page should be inserted (zero-based).\n   * @param page Optionally, the desired dimensions or existing page.\n   * @returns The newly created (or existing) page.\n   */\n  insertPage(index: number, page?: PDFPage | [number, number]): PDFPage {\n    const pageCount = this.getPageCount();\n    assertRange(index, 'index', 0, pageCount);\n    assertIs(page, 'page', ['undefined', [PDFPage, 'PDFPage'], Array]);\n    if (!page || Array.isArray(page)) {\n      const dims = Array.isArray(page) ? page : PageSizes.A4;\n      page = PDFPage.create(this);\n      page.setSize(...dims);\n    } else if (page.doc !== this) {\n      throw new ForeignPageError();\n    }\n\n    const parentRef = this.catalog.insertLeafNode(page.ref, index);\n    page.node.setParent(parentRef);\n\n    this.pageMap.set(page.node, page);\n    this.pageCache.invalidate();\n\n    this.pageCount = pageCount + 1;\n\n    return page;\n  }\n\n  /**\n   * Copy pages from a source document into this document. Allows pages to be\n   * copied between different [[PDFDocument]] instances. For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   * const srcDoc = await PDFDocument.load(...)\n   *\n   * const copiedPages = await pdfDoc.copyPages(srcDoc, [0, 3, 89])\n   * const [firstPage, fourthPage, ninetiethPage] = copiedPages;\n   *\n   * pdfDoc.addPage(fourthPage)\n   * pdfDoc.insertPage(0, ninetiethPage)\n   * pdfDoc.addPage(firstPage)\n   * ```\n   * @param srcDoc The document from which pages should be copied.\n   * @param indices The indices of the pages that should be copied.\n   * @returns Resolves with an array of pages copied into this document.\n   */\n  async copyPages(srcDoc: PDFDocument, indices: number[]): Promise<PDFPage[]> {\n    assertIs(srcDoc, 'srcDoc', [[PDFDocument, 'PDFDocument']]);\n    assertIs(indices, 'indices', [Array]);\n    await srcDoc.flush();\n    const copier = PDFObjectCopier.for(srcDoc.context, this.context);\n    const srcPages = srcDoc.getPages();\n    const copiedPages: PDFPage[] = new Array(indices.length);\n    for (let idx = 0, len = indices.length; idx < len; idx++) {\n      const srcPage = srcPages[indices[idx]];\n      const copiedPage = copier.copy(srcPage.node);\n      const ref = this.context.register(copiedPage);\n      copiedPages[idx] = PDFPage.of(copiedPage, ref, this);\n    }\n    return copiedPages;\n  }\n\n  /**\n   * Get a copy of this document.\n   *\n   * For example:\n   * ```js\n   * const srcDoc = await PDFDocument.load(...)\n   * const pdfDoc = await srcDoc.copy()\n   * ```\n   *\n   * > **NOTE:**  This method won't copy all information over to the new\n   * > document (acroforms, outlines, etc...).\n   *\n   * @returns Resolves with a copy this document.\n   */\n  async copy(): Promise<PDFDocument> {\n    const pdfCopy = await PDFDocument.create();\n    const contentPages = await pdfCopy.copyPages(this, this.getPageIndices());\n\n    for (let idx = 0, len = contentPages.length; idx < len; idx++) {\n      pdfCopy.addPage(contentPages[idx]);\n    }\n\n    if (this.getAuthor() !== undefined) {\n      pdfCopy.setAuthor(this.getAuthor()!);\n    }\n    if (this.getCreationDate() !== undefined) {\n      pdfCopy.setCreationDate(this.getCreationDate()!);\n    }\n    if (this.getCreator() !== undefined) {\n      pdfCopy.setCreator(this.getCreator()!);\n    }\n    if (this.getModificationDate() !== undefined) {\n      pdfCopy.setModificationDate(this.getModificationDate()!);\n    }\n    if (this.getProducer() !== undefined) {\n      pdfCopy.setProducer(this.getProducer()!);\n    }\n    if (this.getSubject() !== undefined) {\n      pdfCopy.setSubject(this.getSubject()!);\n    }\n    if (this.getTitle() !== undefined) {\n      pdfCopy.setTitle(this.getTitle()!);\n    }\n    pdfCopy.defaultWordBreaks = this.defaultWordBreaks;\n\n    return pdfCopy;\n  }\n\n  /**\n   * Add JavaScript to this document. The supplied `script` is executed when the\n   * document is opened. The `script` can be used to perform some operation\n   * when the document is opened (e.g. logging to the console), or it can be\n   * used to define a function that can be referenced later in a JavaScript\n   * action. For example:\n   * ```js\n   * // Show \"Hello World!\" in the console when the PDF is opened\n   * pdfDoc.addJavaScript(\n   *   'main',\n   *   'console.show(); console.println(\"Hello World!\");'\n   * );\n   *\n   * // Define a function named \"foo\" that can be called in JavaScript Actions\n   * pdfDoc.addJavaScript(\n   *   'foo',\n   *   'function foo() { return \"foo\"; }'\n   * );\n   * ```\n   * See the [JavaScript for Acrobat API Reference](https://www.adobe.com/content/dam/acom/en/devnet/acrobat/pdfs/js_api_reference.pdf)\n   * for details.\n   * @param name The name of the script. Must be unique per document.\n   * @param script The JavaScript to execute.\n   */\n  addJavaScript(name: string, script: string) {\n    assertIs(name, 'name', ['string']);\n    assertIs(script, 'script', ['string']);\n\n    const embedder = JavaScriptEmbedder.for(script, name);\n\n    const ref = this.context.nextRef();\n    const javaScript = PDFJavaScript.of(ref, this, embedder);\n    this.javaScripts.push(javaScript);\n  }\n\n  /**\n   * Add an attachment to this document. Attachments are visible in the\n   * \"Attachments\" panel of Adobe Acrobat and some other PDF readers. Any\n   * type of file can be added as an attachment. This includes, but is not\n   * limited to, `.png`, `.jpg`, `.pdf`, `.csv`, `.docx`, and `.xlsx` files.\n   *\n   * The input data can be provided in multiple formats:\n   *\n   * | Type          | Contents                                                       |\n   * | ------------- | -------------------------------------------------------------- |\n   * | `string`      | A base64 encoded string (or data URI) containing an attachment |\n   * | `Uint8Array`  | The raw bytes of an attachment                                 |\n   * | `ArrayBuffer` | The raw bytes of an attachment                                 |\n   *\n   * For example:\n   * ```js\n   * // attachment=string\n   * await pdfDoc.attach('/9j/4AAQSkZJRgABAQAAAQABAAD/2wBD...', 'cat_riding_unicorn.jpg', {\n   *   mimeType: 'image/jpeg',\n   *   description: 'Cool cat riding a unicorn! 🦄🐈🕶️',\n   *   creationDate: new Date('2019/12/01'),\n   *   modificationDate: new Date('2020/04/19'),\n   * })\n   * await pdfDoc.attach('data:image/jpeg;base64,/9j/4AAQ...', 'cat_riding_unicorn.jpg', {\n   *   mimeType: 'image/jpeg',\n   *   description: 'Cool cat riding a unicorn! 🦄🐈🕶️',\n   *   creationDate: new Date('2019/12/01'),\n   *   modificationDate: new Date('2020/04/19'),\n   * })\n   *\n   * // attachment=Uint8Array\n   * import fs from 'fs'\n   * const uint8Array = fs.readFileSync('cat_riding_unicorn.jpg')\n   * await pdfDoc.attach(uint8Array, 'cat_riding_unicorn.jpg', {\n   *   mimeType: 'image/jpeg',\n   *   description: 'Cool cat riding a unicorn! 🦄🐈🕶️',\n   *   creationDate: new Date('2019/12/01'),\n   *   modificationDate: new Date('2020/04/19'),\n   * })\n   *\n   * // attachment=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/cat_riding_unicorn.jpg'\n   * const arrayBuffer = await fetch(url).then(res => res.arrayBuffer())\n   * await pdfDoc.attach(arrayBuffer, 'cat_riding_unicorn.jpg', {\n   *   mimeType: 'image/jpeg',\n   *   description: 'Cool cat riding a unicorn! 🦄🐈🕶️',\n   *   creationDate: new Date('2019/12/01'),\n   *   modificationDate: new Date('2020/04/19'),\n   * })\n   * ```\n   *\n   * @param attachment The input data containing the file to be attached.\n   * @param name The name of the file to be attached.\n   * @returns Resolves when the attachment is complete.\n   */\n  async attach(\n    attachment: string | Uint8Array | ArrayBuffer,\n    name: string,\n    options: AttachmentOptions = {},\n  ): Promise<void> {\n    assertIs(attachment, 'attachment', ['string', Uint8Array, ArrayBuffer]);\n    assertIs(name, 'name', ['string']);\n    assertOrUndefined(options.mimeType, 'mimeType', ['string']);\n    assertOrUndefined(options.description, 'description', ['string']);\n    assertOrUndefined(options.creationDate, 'options.creationDate', [Date]);\n    assertOrUndefined(options.modificationDate, 'options.modificationDate', [\n      Date,\n    ]);\n    assertIsOneOfOrUndefined(\n      options.afRelationship,\n      'options.afRelationship',\n      AFRelationship,\n    );\n\n    const bytes = toUint8Array(attachment);\n    const embedder = FileEmbedder.for(bytes, name, options);\n\n    const ref = this.context.nextRef();\n    const embeddedFile = PDFEmbeddedFile.of(ref, this, embedder);\n    this.embeddedFiles.push(embeddedFile);\n  }\n\n  /**\n   * Embed a font into this document. The input data can be provided in multiple\n   * formats:\n   *\n   * | Type            | Contents                                                |\n   * | --------------- | ------------------------------------------------------- |\n   * | `StandardFonts` | One of the standard 14 fonts                            |\n   * | `string`        | A base64 encoded string (or data URI) containing a font |\n   * | `Uint8Array`    | The raw bytes of a font                                 |\n   * | `ArrayBuffer`   | The raw bytes of a font                                 |\n   *\n   * For example:\n   * ```js\n   * // font=StandardFonts\n   * import { StandardFonts } from 'pdf-lib'\n   * const font1 = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   *\n   * // font=string\n   * const font2 = await pdfDoc.embedFont('AAEAAAAVAQAABABQRFNJRx/upe...')\n   * const font3 = await pdfDoc.embedFont('data:font/opentype;base64,AAEAAA...')\n   *\n   * // font=Uint8Array\n   * import fs from 'fs'\n   * const font4 = await pdfDoc.embedFont(fs.readFileSync('Ubuntu-R.ttf'))\n   *\n   * // font=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/ubuntu/Ubuntu-R.ttf'\n   * const ubuntuBytes = await fetch(url).then(res => res.arrayBuffer())\n   * const font5 = await pdfDoc.embedFont(ubuntuBytes)\n   * ```\n   * See also: [[registerFontkit]]\n   * @param font The input data for a font.\n   * @param options The options to be used when embedding the font.\n   * @returns Resolves with the embedded font.\n   */\n  async embedFont(\n    font: StandardFonts | string | Uint8Array | ArrayBuffer,\n    options: EmbedFontOptions = {},\n  ): Promise<PDFFont> {\n    const { subset = false, customName, features } = options;\n\n    assertIs(font, 'font', ['string', Uint8Array, ArrayBuffer]);\n    assertIs(subset, 'subset', ['boolean']);\n\n    let embedder: CustomFontEmbedder | StandardFontEmbedder;\n    if (isStandardFont(font)) {\n      embedder = StandardFontEmbedder.for(font, customName);\n    } else if (canBeConvertedToUint8Array(font)) {\n      const bytes = toUint8Array(font);\n      const fontkit = this.assertFontkit();\n      embedder = subset\n        ? await CustomFontSubsetEmbedder.for(\n          fontkit,\n          bytes,\n          customName,\n          features,\n        )\n        : await CustomFontEmbedder.for(fontkit, bytes, customName, features);\n    } else {\n      throw new TypeError(\n        '`font` must be one of `StandardFonts | string | Uint8Array | ArrayBuffer`',\n      );\n    }\n\n    const ref = this.context.nextRef();\n    const pdfFont = PDFFont.of(ref, this, embedder);\n    this.fonts.push(pdfFont);\n\n    return pdfFont;\n  }\n\n  /**\n   * Embed a standard font into this document.\n   * For example:\n   * ```js\n   * import { StandardFonts } from 'pdf-lib'\n   * const helveticaFont = pdfDoc.embedFont(StandardFonts.Helvetica)\n   * ```\n   * @param font The standard font to be embedded.\n   * @param customName The name to be used when embedding the font.\n   * @returns The embedded font.\n   */\n  embedStandardFont(font: StandardFonts, customName?: string): PDFFont {\n    assertIs(font, 'font', ['string']);\n    if (!isStandardFont(font)) {\n      throw new TypeError('`font` must be one of type `StandardFonts`');\n    }\n\n    const embedder = StandardFontEmbedder.for(font, customName);\n\n    const ref = this.context.nextRef();\n    const pdfFont = PDFFont.of(ref, this, embedder);\n    this.fonts.push(pdfFont);\n\n    return pdfFont;\n  }\n\n  /**\n   * Embed a JPEG image into this document. The input data can be provided in\n   * multiple formats:\n   *\n   * | Type          | Contents                                                      |\n   * | ------------- | ------------------------------------------------------------- |\n   * | `string`      | A base64 encoded string (or data URI) containing a JPEG image |\n   * | `Uint8Array`  | The raw bytes of a JPEG image                                 |\n   * | `ArrayBuffer` | The raw bytes of a JPEG image                                 |\n   *\n   * For example:\n   * ```js\n   * // jpg=string\n   * const image1 = await pdfDoc.embedJpg('/9j/4AAQSkZJRgABAQAAAQABAAD/2wBD...')\n   * const image2 = await pdfDoc.embedJpg('data:image/jpeg;base64,/9j/4AAQ...')\n   *\n   * // jpg=Uint8Array\n   * import fs from 'fs'\n   * const uint8Array = fs.readFileSync('cat_riding_unicorn.jpg')\n   * const image3 = await pdfDoc.embedJpg(uint8Array)\n   *\n   * // jpg=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/cat_riding_unicorn.jpg'\n   * const arrayBuffer = await fetch(url).then(res => res.arrayBuffer())\n   * const image4 = await pdfDoc.embedJpg(arrayBuffer)\n   * ```\n   *\n   * @param jpg The input data for a JPEG image.\n   * @returns Resolves with the embedded image.\n   */\n  async embedJpg(jpg: string | Uint8Array | ArrayBuffer): Promise<PDFImage> {\n    assertIs(jpg, 'jpg', ['string', Uint8Array, ArrayBuffer]);\n    const bytes = toUint8Array(jpg);\n    const embedder = await JpegEmbedder.for(bytes);\n    const ref = this.context.nextRef();\n    const pdfImage = PDFImage.of(ref, this, embedder);\n    this.images.push(pdfImage);\n    return pdfImage;\n  }\n\n  /**\n   * Embed a PNG image into this document. The input data can be provided in\n   * multiple formats:\n   *\n   * | Type          | Contents                                                     |\n   * | ------------- | ------------------------------------------------------------ |\n   * | `string`      | A base64 encoded string (or data URI) containing a PNG image |\n   * | `Uint8Array`  | The raw bytes of a PNG image                                 |\n   * | `ArrayBuffer` | The raw bytes of a PNG image                                 |\n   *\n   * For example:\n   * ```js\n   * // png=string\n   * const image1 = await pdfDoc.embedPng('iVBORw0KGgoAAAANSUhEUgAAAlgAAAF3...')\n   * const image2 = await pdfDoc.embedPng('data:image/png;base64,iVBORw0KGg...')\n   *\n   * // png=Uint8Array\n   * import fs from 'fs'\n   * const uint8Array = fs.readFileSync('small_mario.png')\n   * const image3 = await pdfDoc.embedPng(uint8Array)\n   *\n   * // png=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/small_mario.png'\n   * const arrayBuffer = await fetch(url).then(res => res.arrayBuffer())\n   * const image4 = await pdfDoc.embedPng(arrayBuffer)\n   * ```\n   *\n   * @param png The input data for a PNG image.\n   * @returns Resolves with the embedded image.\n   */\n  async embedPng(png: string | Uint8Array | ArrayBuffer): Promise<PDFImage> {\n    assertIs(png, 'png', ['string', Uint8Array, ArrayBuffer]);\n    const bytes = toUint8Array(png);\n    const embedder = await PngEmbedder.for(bytes);\n    const ref = this.context.nextRef();\n    const pdfImage = PDFImage.of(ref, this, embedder);\n    this.images.push(pdfImage);\n    return pdfImage;\n  }\n\n  /**\n   * Embed one or more PDF pages into this document.\n   *\n   * For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   *\n   * const sourcePdfUrl = 'https://pdf-lib.js.org/assets/with_large_page_count.pdf'\n   * const sourcePdf = await fetch(sourcePdfUrl).then((res) => res.arrayBuffer())\n   *\n   * // Embed page 74 of `sourcePdf` into `pdfDoc`\n   * const [embeddedPage] = await pdfDoc.embedPdf(sourcePdf, [73])\n   * ```\n   *\n   * See [[PDFDocument.load]] for examples of the allowed input data formats.\n   *\n   * @param pdf The input data containing a PDF document.\n   * @param indices The indices of the pages that should be embedded.\n   * @returns Resolves with an array of the embedded pages.\n   */\n  async embedPdf(\n    pdf: string | Uint8Array | ArrayBuffer | PDFDocument,\n    indices: number[] = [0],\n  ): Promise<PDFEmbeddedPage[]> {\n    assertIs(pdf, 'pdf', [\n      'string',\n      Uint8Array,\n      ArrayBuffer,\n      [PDFDocument, 'PDFDocument'],\n    ]);\n    assertIs(indices, 'indices', [Array]);\n\n    const srcDoc =\n      pdf instanceof PDFDocument ? pdf : await PDFDocument.load(pdf);\n\n    const srcPages = pluckIndices(srcDoc.getPages(), indices);\n\n    return this.embedPages(srcPages);\n  }\n\n  /**\n   * Embed a single PDF page into this document.\n   *\n   * For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   *\n   * const sourcePdfUrl = 'https://pdf-lib.js.org/assets/with_large_page_count.pdf'\n   * const sourceBuffer = await fetch(sourcePdfUrl).then((res) => res.arrayBuffer())\n   * const sourcePdfDoc = await PDFDocument.load(sourceBuffer)\n   * const sourcePdfPage = sourcePdfDoc.getPages()[73]\n   *\n   * const embeddedPage = await pdfDoc.embedPage(\n   *   sourcePdfPage,\n   *\n   *   // Clip a section of the source page so that we only embed part of it\n   *   { left: 100, right: 450, bottom: 330, top: 570 },\n   *\n   *   // Translate all drawings of the embedded page by (10, 200) units\n   *   [1, 0, 0, 1, 10, 200],\n   * )\n   * ```\n   *\n   * @param page The page to be embedded.\n   * @param boundingBox\n   * Optionally, an area of the source page that should be embedded\n   * (defaults to entire page).\n   * @param transformationMatrix\n   * Optionally, a transformation matrix that is always applied to the embedded\n   * page anywhere it is drawn.\n   * @returns Resolves with the embedded pdf page.\n   */\n  async embedPage(\n    page: PDFPage,\n    boundingBox?: PageBoundingBox,\n    transformationMatrix?: TransformationMatrix,\n  ): Promise<PDFEmbeddedPage> {\n    assertIs(page, 'page', [[PDFPage, 'PDFPage']]);\n    const [embeddedPage] = await this.embedPages(\n      [page],\n      [boundingBox],\n      [transformationMatrix],\n    );\n    return embeddedPage;\n  }\n\n  /**\n   * Embed one or more PDF pages into this document.\n   *\n   * For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   *\n   * const sourcePdfUrl = 'https://pdf-lib.js.org/assets/with_large_page_count.pdf'\n   * const sourceBuffer = await fetch(sourcePdfUrl).then((res) => res.arrayBuffer())\n   * const sourcePdfDoc = await PDFDocument.load(sourceBuffer)\n   *\n   * const page1 = sourcePdfDoc.getPages()[0]\n   * const page2 = sourcePdfDoc.getPages()[52]\n   * const page3 = sourcePdfDoc.getPages()[73]\n   *\n   * const embeddedPages = await pdfDoc.embedPages([page1, page2, page3])\n   * ```\n   *\n   * @param page\n   * The pages to be embedded (they must all share the same context).\n   * @param boundingBoxes\n   * Optionally, an array of clipping boundaries - one for each page\n   * (defaults to entirety of each page).\n   * @param transformationMatrices\n   * Optionally, an array of transformation matrices - one for each page\n   * (each page's transformation will apply anywhere it is drawn).\n   * @returns Resolves with an array of the embedded pdf pages.\n   */\n  async embedPages(\n    pages: PDFPage[],\n    boundingBoxes: (PageBoundingBox | undefined)[] = [],\n    transformationMatrices: (TransformationMatrix | undefined)[] = [],\n  ) {\n    if (pages.length === 0) return [];\n\n    // Assert all pages have the same context\n    for (let idx = 0, len = pages.length - 1; idx < len; idx++) {\n      const currPage = pages[idx];\n      const nextPage = pages[idx + 1];\n      if (currPage.node.context !== nextPage.node.context) {\n        throw new PageEmbeddingMismatchedContextError();\n      }\n    }\n\n    const context = pages[0].node.context;\n    const maybeCopyPage =\n      context === this.context\n        ? (p: PDFPageLeaf) => p\n        : PDFObjectCopier.for(context, this.context).copy;\n\n    const embeddedPages = new Array<PDFEmbeddedPage>(pages.length);\n    for (let idx = 0, len = pages.length; idx < len; idx++) {\n      const page = maybeCopyPage(pages[idx].node);\n      const box = boundingBoxes[idx];\n      const matrix = transformationMatrices[idx];\n\n      const embedder = await PDFPageEmbedder.for(page, box, matrix);\n\n      const ref = this.context.nextRef();\n      embeddedPages[idx] = PDFEmbeddedPage.of(ref, this, embedder);\n    }\n\n    this.embeddedPages.push(...embeddedPages);\n\n    return embeddedPages;\n  }\n\n  /**\n   * > **NOTE:** You shouldn't need to call this method directly. The [[save]]\n   * > and [[saveAsBase64]] methods will automatically ensure that all embedded\n   * > assets are flushed before serializing the document.\n   *\n   * Flush all embedded fonts, PDF pages, and images to this document's\n   * [[context]].\n   *\n   * @returns Resolves when the flush is complete.\n   */\n  async flush(): Promise<void> {\n    await this.embedAll(this.fonts);\n    await this.embedAll(this.images);\n    await this.embedAll(this.embeddedPages);\n    await this.embedAll(this.embeddedFiles);\n    await this.embedAll(this.javaScripts);\n  }\n\n  /**\n   * Serialize this document to an array of bytes making up a PDF file.\n   * For example:\n   * ```js\n   * const pdfBytes = await pdfDoc.save()\n   * ```\n   *\n   * There are a number of things you can do with the serialized document,\n   * depending on the JavaScript environment you're running in:\n   * * Write it to a file in Node or React Native\n   * * Download it as a Blob in the browser\n   * * Render it in an `iframe`\n   *\n   * @param options The options to be used when saving the document.\n   * @returns Resolves with the bytes of the serialized document.\n   */\n  async save(options: SaveOptions = {}): Promise<Uint8Array> {\n    const {\n      useObjectStreams = true,\n      addDefaultPage = true,\n      objectsPerTick = 50,\n      updateFieldAppearances = true,\n    } = options;\n\n    assertIs(useObjectStreams, 'useObjectStreams', ['boolean']);\n    assertIs(addDefaultPage, 'addDefaultPage', ['boolean']);\n    assertIs(objectsPerTick, 'objectsPerTick', ['number']);\n    assertIs(updateFieldAppearances, 'updateFieldAppearances', ['boolean']);\n\n    if (addDefaultPage && this.getPageCount() === 0) this.addPage();\n\n    if (updateFieldAppearances) {\n      const form = this.formCache.getValue();\n      if (form) form.updateFieldAppearances();\n    }\n\n    await this.flush();\n\n    const Writer = useObjectStreams ? PDFStreamWriter : PDFWriter;\n    return Writer.forContext(this.context, objectsPerTick).serializeToBuffer();\n  }\n\n  /**\n   * Serialize this document to a base64 encoded string or data URI making up a\n   * PDF file. For example:\n   * ```js\n   * const base64String = await pdfDoc.saveAsBase64()\n   * base64String // => 'JVBERi0xLjcKJYGBgYEKC...'\n   *\n   * const base64DataUri = await pdfDoc.saveAsBase64({ dataUri: true })\n   * base64DataUri // => 'data:application/pdf;base64,JVBERi0xLjcKJYGBgYEKC...'\n   * ```\n   *\n   * @param options The options to be used when saving the document.\n   * @returns Resolves with a base64 encoded string or data URI of the\n   *          serialized document.\n   */\n  async saveAsBase64(options: Base64SaveOptions = {}): Promise<string> {\n    const { dataUri = false, ...otherOptions } = options;\n    assertIs(dataUri, 'dataUri', ['boolean']);\n    const bytes = await this.save(otherOptions);\n    const base64 = encodeToBase64(bytes);\n    return dataUri ? `data:application/pdf;base64,${base64}` : base64;\n  }\n\n  findPageForAnnotationRef(ref: PDFRef): PDFPage | undefined {\n    const pages = this.getPages();\n    for (let idx = 0, len = pages.length; idx < len; idx++) {\n      const page = pages[idx];\n      const annotations = page.node.Annots();\n\n      if (annotations?.indexOf(ref) !== undefined) {\n        return page;\n      }\n    }\n\n    return undefined;\n  }\n\n  private async embedAll(embeddables: Embeddable[]): Promise<void> {\n    for (let idx = 0, len = embeddables.length; idx < len; idx++) {\n      await embeddables[idx].embed();\n    }\n  }\n\n  private updateInfoDict(): void {\n    const pdfLib = 'pdf-lib (https://github.com/Hopding/pdf-lib)';\n    const now = new Date();\n\n    const info = this.getInfoDict();\n\n    this.setProducer(pdfLib);\n    this.setModificationDate(now);\n\n    if (!info.get(PDFName.of('Creator'))) this.setCreator(pdfLib);\n    if (!info.get(PDFName.of('CreationDate'))) this.setCreationDate(now);\n  }\n\n  private getInfoDict(): PDFDict {\n    const existingInfo = this.context.lookup(this.context.trailerInfo.Info);\n    if (existingInfo instanceof PDFDict) return existingInfo;\n\n    const newInfo = this.context.obj({});\n    this.context.trailerInfo.Info = this.context.register(newInfo);\n\n    return newInfo;\n  }\n\n  private assertFontkit(): Fontkit {\n    if (!this.fontkit) throw new FontkitNotRegisteredError();\n    return this.fontkit;\n  }\n\n  private computePages = (): PDFPage[] => {\n    const pages: PDFPage[] = [];\n    this.catalog.Pages().traverse((node, ref) => {\n      if (node instanceof PDFPageLeaf) {\n        let page = this.pageMap.get(node);\n        if (!page) {\n          page = PDFPage.of(node, ref, this);\n          this.pageMap.set(node, page);\n        }\n        pages.push(page);\n      }\n    });\n    return pages;\n  };\n\n  private getOrCreateForm = (): PDFForm => {\n    const acroForm = this.catalog.getOrCreateAcroForm();\n    return PDFForm.of(acroForm, this);\n  };\n}\n\n/* tslint:disable-next-line only-arrow-functions */\nfunction assertIsLiteralOrHexString(\n  pdfObject: PDFObject,\n): asserts pdfObject is PDFHexString | PDFString {\n  if (\n    !(pdfObject instanceof PDFHexString) &&\n    !(pdfObject instanceof PDFString)\n  ) {\n    throw new UnexpectedObjectTypeError([PDFHexString, PDFString], pdfObject);\n  }\n}\n","import { Color } from 'src/api/colors';\nimport PDFFont from 'src/api/PDFFont';\nimport { Rotation } from 'src/api/rotations';\nimport { LineCapStyle } from 'src/api/operators';\n\nexport enum BlendMode {\n  Normal = 'Normal',\n  Multiply = 'Multiply',\n  Screen = 'Screen',\n  Overlay = 'Overlay',\n  Darken = 'Darken',\n  Lighten = 'Lighten',\n  ColorDodge = 'ColorDodge',\n  ColorBurn = 'ColorBurn',\n  HardLight = 'HardLight',\n  SoftLight = 'SoftLight',\n  Difference = 'Difference',\n  Exclusion = 'Exclusion'\n}\n\nexport interface PDFPageDrawTextOptions {\n  color?: Color;\n  opacity?: number;\n  blendMode?: BlendMode;\n  font?: PDFFont;\n  size?: number;\n  rotate?: Rotation;\n  xSkew?: Rotation;\n  ySkew?: Rotation;\n  x?: number;\n  y?: number;\n  lineHeight?: number;\n  maxWidth?: number;\n  wordBreaks?: string[];\n}\n\nexport interface PDFPageDrawImageOptions {\n  x?: number;\n  y?: number;\n  width?: number;\n  height?: number;\n  rotate?: Rotation;\n  xSkew?: Rotation;\n  ySkew?: Rotation;\n  opacity?: number;\n  blendMode?: BlendMode;\n}\n\nexport interface PDFPageDrawPageOptions {\n  x?: number;\n  y?: number;\n  xScale?: number;\n  yScale?: number;\n  width?: number;\n  height?: number;\n  rotate?: Rotation;\n  xSkew?: Rotation;\n  ySkew?: Rotation;\n  opacity?: number;\n  blendMode?: BlendMode;\n}\n\nexport interface PDFPageDrawSVGOptions {\n  x?: number;\n  y?: number;\n  scale?: number;\n  rotate?: Rotation;\n  borderWidth?: number;\n  color?: Color;\n  opacity?: number;\n  borderColor?: Color;\n  borderOpacity?: number;\n  borderDashArray?: number[];\n  borderDashPhase?: number;\n  borderLineCap?: LineCapStyle;\n  blendMode?: BlendMode;\n}\n\nexport interface PDFPageDrawLineOptions {\n  start: { x: number; y: number };\n  end: { x: number; y: number };\n  thickness?: number;\n  color?: Color;\n  opacity?: number;\n  lineCap?: LineCapStyle;\n  dashArray?: number[];\n  dashPhase?: number;\n  blendMode?: BlendMode;\n}\n\nexport interface PDFPageDrawRectangleOptions {\n  x?: number;\n  y?: number;\n  width?: number;\n  height?: number;\n  rotate?: Rotation;\n  xSkew?: Rotation;\n  ySkew?: Rotation;\n  borderWidth?: number;\n  color?: Color;\n  opacity?: number;\n  borderColor?: Color;\n  borderOpacity?: number;\n  borderDashArray?: number[];\n  borderDashPhase?: number;\n  borderLineCap?: LineCapStyle;\n  blendMode?: BlendMode;\n}\n\nexport interface PDFPageDrawSquareOptions {\n  x?: number;\n  y?: number;\n  size?: number;\n  rotate?: Rotation;\n  xSkew?: Rotation;\n  ySkew?: Rotation;\n  borderWidth?: number;\n  color?: Color;\n  opacity?: number;\n  borderColor?: Color;\n  borderOpacity?: number;\n  borderDashArray?: number[];\n  borderDashPhase?: number;\n  borderLineCap?: LineCapStyle;\n  blendMode?: BlendMode;\n}\n\nexport interface PDFPageDrawEllipseOptions {\n  x?: number;\n  y?: number;\n  xScale?: number;\n  yScale?: number;\n  rotate?: Rotation;\n  color?: Color;\n  opacity?: number;\n  borderColor?: Color;\n  borderOpacity?: number;\n  borderWidth?: number;\n  borderDashArray?: number[];\n  borderDashPhase?: number;\n  borderLineCap?: LineCapStyle;\n  blendMode?: BlendMode;\n}\n\nexport interface PDFPageDrawCircleOptions {\n  x?: number;\n  y?: number;\n  size?: number;\n  color?: Color;\n  opacity?: number;\n  borderColor?: Color;\n  borderOpacity?: number;\n  borderWidth?: number;\n  borderDashArray?: number[];\n  borderDashPhase?: number;\n  borderLineCap?: LineCapStyle;\n  blendMode?: BlendMode;\n}\n","import { Color, rgb } from 'src/api/colors';\nimport {\n  drawImage,\n  drawLine,\n  drawLinesOfText,\n  drawPage,\n  drawRectangle,\n  drawSvgPath,\n  drawEllipse,\n} from 'src/api/operations';\nimport {\n  popGraphicsState,\n  pushGraphicsState,\n  translate,\n  LineCapStyle,\n  scale,\n} from 'src/api/operators';\nimport PDFDocument from 'src/api/PDFDocument';\nimport PDFEmbeddedPage from 'src/api/PDFEmbeddedPage';\nimport PDFFont from 'src/api/PDFFont';\nimport PDFImage from 'src/api/PDFImage';\nimport {\n  PDFPageDrawCircleOptions,\n  PDFPageDrawEllipseOptions,\n  PDFPageDrawImageOptions,\n  PDFPageDrawLineOptions,\n  PDFPageDrawPageOptions,\n  PDFPageDrawRectangleOptions,\n  PDFPageDrawSquareOptions,\n  PDFPageDrawSVGOptions,\n  PDFPageDrawTextOptions,\n  BlendMode,\n} from 'src/api/PDFPageOptions';\nimport { degrees, Rotation, toDegrees } from 'src/api/rotations';\nimport { StandardFonts } from 'src/api/StandardFonts';\nimport {\n  PDFContentStream,\n  PDFHexString,\n  PDFName,\n  PDFOperator,\n  PDFPageLeaf,\n  PDFRef,\n  PDFDict,\n  PDFArray,\n} from 'src/core';\nimport {\n  assertEachIs,\n  assertIs,\n  assertMultiple,\n  assertOrUndefined,\n  breakTextIntoLines,\n  cleanText,\n  rectanglesAreEqual,\n  lineSplit,\n  assertRangeOrUndefined,\n  assertIsOneOfOrUndefined,\n} from 'src/utils';\n\n/**\n * Represents a single page of a [[PDFDocument]].\n */\nexport default class PDFPage {\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFDocument.addPage]] and [[PDFDocument.insertPage]]\n   * > methods, which can create instances of [[PDFPage]] for you.\n   *\n   * Create an instance of [[PDFPage]] from an existing leaf node.\n   *\n   * @param leafNode The leaf node to be wrapped.\n   * @param ref The unique reference for the page.\n   * @param doc The document to which the page will belong.\n   */\n  static of = (leafNode: PDFPageLeaf, ref: PDFRef, doc: PDFDocument) =>\n    new PDFPage(leafNode, ref, doc);\n\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFDocument.addPage]] and [[PDFDocument.insertPage]]\n   * > methods, which can create instances of [[PDFPage]] for you.\n   *\n   * Create an instance of [[PDFPage]].\n   *\n   * @param doc The document to which the page will belong.\n   */\n  static create = (doc: PDFDocument) => {\n    assertIs(doc, 'doc', [[PDFDocument, 'PDFDocument']]);\n    const dummyRef = PDFRef.of(-1);\n    const pageLeaf = PDFPageLeaf.withContextAndParent(doc.context, dummyRef);\n    const pageRef = doc.context.register(pageLeaf);\n    return new PDFPage(pageLeaf, pageRef, doc);\n  };\n\n  /** The low-level PDFDictionary wrapped by this page. */\n  readonly node: PDFPageLeaf;\n\n  /** The unique reference assigned to this page within the document. */\n  readonly ref: PDFRef;\n\n  /** The document to which this page belongs. */\n  readonly doc: PDFDocument;\n\n  private fontKey?: PDFName;\n  private font?: PDFFont;\n  private fontSize = 24;\n  private fontColor = rgb(0, 0, 0) as Color;\n  private lineHeight = 24;\n  private x = 0;\n  private y = 0;\n  private contentStream?: PDFContentStream;\n  private contentStreamRef?: PDFRef;\n\n  private constructor(leafNode: PDFPageLeaf, ref: PDFRef, doc: PDFDocument) {\n    assertIs(leafNode, 'leafNode', [[PDFPageLeaf, 'PDFPageLeaf']]);\n    assertIs(ref, 'ref', [[PDFRef, 'PDFRef']]);\n    assertIs(doc, 'doc', [[PDFDocument, 'PDFDocument']]);\n\n    this.node = leafNode;\n    this.ref = ref;\n    this.doc = doc;\n  }\n\n  /**\n   * Rotate this page by a multiple of 90 degrees. For example:\n   * ```js\n   * import { degrees } from 'pdf-lib'\n   *\n   * page.setRotation(degrees(-90))\n   * page.setRotation(degrees(0))\n   * page.setRotation(degrees(90))\n   * page.setRotation(degrees(180))\n   * page.setRotation(degrees(270))\n   * ```\n   * @param angle The angle to rotate this page.\n   */\n  setRotation(angle: Rotation): void {\n    const degreesAngle = toDegrees(angle);\n    assertMultiple(degreesAngle, 'degreesAngle', 90);\n    this.node.set(PDFName.of('Rotate'), this.doc.context.obj(degreesAngle));\n  }\n\n  /**\n   * Get this page's rotation angle in degrees. For example:\n   * ```js\n   * const rotationAngle = page.getRotation().angle;\n   * ```\n   * @returns The rotation angle of the page in degrees (always a multiple of\n   *          90 degrees).\n   */\n  getRotation(): Rotation {\n    const Rotate = this.node.Rotate();\n    return degrees(Rotate ? Rotate.asNumber() : 0);\n  }\n\n  /**\n   * Resize this page by increasing or decreasing its width and height. For\n   * example:\n   * ```js\n   * page.setSize(250, 500)\n   * page.setSize(page.getWidth() + 50, page.getHeight() + 100)\n   * page.setSize(page.getWidth() - 50, page.getHeight() - 100)\n   * ```\n   *\n   * Note that the PDF specification does not allow for pages to have explicit\n   * widths and heights. Instead it defines the \"size\" of a page in terms of\n   * five rectangles: the MediaBox, CropBox, BleedBox, TrimBox, and ArtBox. As a\n   * result, this method cannot directly change the width and height of a page.\n   * Instead, it works by adjusting these five boxes.\n   *\n   * This method performs the following steps:\n   *   1. Set width & height of MediaBox.\n   *   2. Set width & height of CropBox, if it has same dimensions as MediaBox.\n   *   3. Set width & height of BleedBox, if it has same dimensions as MediaBox.\n   *   4. Set width & height of TrimBox, if it has same dimensions as MediaBox.\n   *   5. Set width & height of ArtBox, if it has same dimensions as MediaBox.\n   *\n   * This approach works well for most PDF documents as all PDF pages must\n   * have a MediaBox, but relatively few have a CropBox, BleedBox, TrimBox, or\n   * ArtBox. And when they do have these additional boxes, they often have the\n   * same dimensions as the MediaBox. However, if you find this method does not\n   * work for your document, consider setting the boxes directly:\n   *   * [[PDFPage.setMediaBox]]\n   *   * [[PDFPage.setCropBox]]\n   *   * [[PDFPage.setBleedBox]]\n   *   * [[PDFPage.setTrimBox]]\n   *   * [[PDFPage.setArtBox]]\n   *\n   * @param width The new width of the page.\n   * @param height The new height of the page.\n   */\n  setSize(width: number, height: number): void {\n    assertIs(width, 'width', ['number']);\n    assertIs(height, 'height', ['number']);\n\n    const mediaBox = this.getMediaBox();\n    this.setMediaBox(mediaBox.x, mediaBox.y, width, height);\n\n    const cropBox = this.getCropBox();\n    const bleedBox = this.getBleedBox();\n    const trimBox = this.getTrimBox();\n    const artBox = this.getArtBox();\n\n    const hasCropBox = this.node.CropBox()!;\n    const hasBleedBox = this.node.BleedBox()!;\n    const hasTrimBox = this.node.TrimBox()!;\n    const hasArtBox = this.node.ArtBox()!;\n\n    if (hasCropBox && rectanglesAreEqual(cropBox, mediaBox)) {\n      this.setCropBox(mediaBox.x, mediaBox.y, width, height);\n    }\n    if (hasBleedBox && rectanglesAreEqual(bleedBox, mediaBox)) {\n      this.setBleedBox(mediaBox.x, mediaBox.y, width, height);\n    }\n    if (hasTrimBox && rectanglesAreEqual(trimBox, mediaBox)) {\n      this.setTrimBox(mediaBox.x, mediaBox.y, width, height);\n    }\n    if (hasArtBox && rectanglesAreEqual(artBox, mediaBox)) {\n      this.setArtBox(mediaBox.x, mediaBox.y, width, height);\n    }\n  }\n\n  /**\n   * Resize this page by increasing or decreasing its width. For example:\n   * ```js\n   * page.setWidth(250)\n   * page.setWidth(page.getWidth() + 50)\n   * page.setWidth(page.getWidth() - 50)\n   * ```\n   *\n   * This method uses [[PDFPage.setSize]] to set the page's width.\n   *\n   * @param width The new width of the page.\n   */\n  setWidth(width: number): void {\n    assertIs(width, 'width', ['number']);\n    this.setSize(width, this.getSize().height);\n  }\n\n  /**\n   * Resize this page by increasing or decreasing its height. For example:\n   * ```js\n   * page.setHeight(500)\n   * page.setHeight(page.getWidth() + 100)\n   * page.setHeight(page.getWidth() - 100)\n   * ```\n   *\n   * This method uses [[PDFPage.setSize]] to set the page's height.\n   *\n   * @param height The new height of the page.\n   */\n  setHeight(height: number): void {\n    assertIs(height, 'height', ['number']);\n    this.setSize(this.getSize().width, height);\n  }\n\n  /**\n   * Set the MediaBox of this page. For example:\n   * ```js\n   * const mediaBox = page.getMediaBox()\n   *\n   * page.setMediaBox(0, 0, 250, 500)\n   * page.setMediaBox(mediaBox.x, mediaBox.y, 50, 100)\n   * page.setMediaBox(15, 5, mediaBox.width - 50, mediaBox.height - 100)\n   * ```\n   *\n   * See [[PDFPage.getMediaBox]] for details about what the MediaBox represents.\n   *\n   * @param x The x coordinate of the lower left corner of the new MediaBox.\n   * @param y The y coordinate of the lower left corner of the new MediaBox.\n   * @param width The width of the new MediaBox.\n   * @param height The height of the new MediaBox.\n   */\n  setMediaBox(x: number, y: number, width: number, height: number): void {\n    assertIs(x, 'x', ['number']);\n    assertIs(y, 'y', ['number']);\n    assertIs(width, 'width', ['number']);\n    assertIs(height, 'height', ['number']);\n    const mediaBox = this.doc.context.obj([x, y, x + width, y + height]);\n    this.node.set(PDFName.MediaBox, mediaBox);\n  }\n\n  /**\n   * Set the CropBox of this page. For example:\n   * ```js\n   * const cropBox = page.getCropBox()\n   *\n   * page.setCropBox(0, 0, 250, 500)\n   * page.setCropBox(cropBox.x, cropBox.y, 50, 100)\n   * page.setCropBox(15, 5, cropBox.width - 50, cropBox.height - 100)\n   * ```\n   *\n   * See [[PDFPage.getCropBox]] for details about what the CropBox represents.\n   *\n   * @param x The x coordinate of the lower left corner of the new CropBox.\n   * @param y The y coordinate of the lower left corner of the new CropBox.\n   * @param width The width of the new CropBox.\n   * @param height The height of the new CropBox.\n   */\n  setCropBox(x: number, y: number, width: number, height: number): void {\n    assertIs(x, 'x', ['number']);\n    assertIs(y, 'y', ['number']);\n    assertIs(width, 'width', ['number']);\n    assertIs(height, 'height', ['number']);\n    const cropBox = this.doc.context.obj([x, y, x + width, y + height]);\n    this.node.set(PDFName.CropBox, cropBox);\n  }\n\n  /**\n   * Set the BleedBox of this page. For example:\n   * ```js\n   * const bleedBox = page.getBleedBox()\n   *\n   * page.setBleedBox(0, 0, 250, 500)\n   * page.setBleedBox(bleedBox.x, bleedBox.y, 50, 100)\n   * page.setBleedBox(15, 5, bleedBox.width - 50, bleedBox.height - 100)\n   * ```\n   *\n   * See [[PDFPage.getBleedBox]] for details about what the BleedBox represents.\n   *\n   * @param x The x coordinate of the lower left corner of the new BleedBox.\n   * @param y The y coordinate of the lower left corner of the new BleedBox.\n   * @param width The width of the new BleedBox.\n   * @param height The height of the new BleedBox.\n   */\n  setBleedBox(x: number, y: number, width: number, height: number): void {\n    assertIs(x, 'x', ['number']);\n    assertIs(y, 'y', ['number']);\n    assertIs(width, 'width', ['number']);\n    assertIs(height, 'height', ['number']);\n    const bleedBox = this.doc.context.obj([x, y, x + width, y + height]);\n    this.node.set(PDFName.BleedBox, bleedBox);\n  }\n\n  /**\n   * Set the TrimBox of this page. For example:\n   * ```js\n   * const trimBox = page.getTrimBox()\n   *\n   * page.setTrimBox(0, 0, 250, 500)\n   * page.setTrimBox(trimBox.x, trimBox.y, 50, 100)\n   * page.setTrimBox(15, 5, trimBox.width - 50, trimBox.height - 100)\n   * ```\n   *\n   * See [[PDFPage.getTrimBox]] for details about what the TrimBox represents.\n   *\n   * @param x The x coordinate of the lower left corner of the new TrimBox.\n   * @param y The y coordinate of the lower left corner of the new TrimBox.\n   * @param width The width of the new TrimBox.\n   * @param height The height of the new TrimBox.\n   */\n  setTrimBox(x: number, y: number, width: number, height: number): void {\n    assertIs(x, 'x', ['number']);\n    assertIs(y, 'y', ['number']);\n    assertIs(width, 'width', ['number']);\n    assertIs(height, 'height', ['number']);\n    const trimBox = this.doc.context.obj([x, y, x + width, y + height]);\n    this.node.set(PDFName.TrimBox, trimBox);\n  }\n\n  /**\n   * Set the ArtBox of this page. For example:\n   * ```js\n   * const artBox = page.getArtBox()\n   *\n   * page.setArtBox(0, 0, 250, 500)\n   * page.setArtBox(artBox.x, artBox.y, 50, 100)\n   * page.setArtBox(15, 5, artBox.width - 50, artBox.height - 100)\n   * ```\n   *\n   * See [[PDFPage.getArtBox]] for details about what the ArtBox represents.\n   *\n   * @param x The x coordinate of the lower left corner of the new ArtBox.\n   * @param y The y coordinate of the lower left corner of the new ArtBox.\n   * @param width The width of the new ArtBox.\n   * @param height The height of the new ArtBox.\n   */\n  setArtBox(x: number, y: number, width: number, height: number): void {\n    assertIs(x, 'x', ['number']);\n    assertIs(y, 'y', ['number']);\n    assertIs(width, 'width', ['number']);\n    assertIs(height, 'height', ['number']);\n    const artBox = this.doc.context.obj([x, y, x + width, y + height]);\n    this.node.set(PDFName.ArtBox, artBox);\n  }\n\n  /**\n   * Get this page's width and height. For example:\n   * ```js\n   * const { width, height } = page.getSize()\n   * ```\n   *\n   * This method uses [[PDFPage.getMediaBox]] to obtain the page's\n   * width and height.\n   *\n   * @returns The width and height of the page.\n   */\n  getSize(): { width: number; height: number } {\n    const { width, height } = this.getMediaBox();\n    return { width, height };\n  }\n\n  /**\n   * Get this page's width. For example:\n   * ```js\n   * const width = page.getWidth()\n   * ```\n   *\n   * This method uses [[PDFPage.getSize]] to obtain the page's size.\n   *\n   * @returns The width of the page.\n   */\n  getWidth(): number {\n    return this.getSize().width;\n  }\n\n  /**\n   * Get this page's height. For example:\n   * ```js\n   * const height = page.getHeight()\n   * ```\n   *\n   * This method uses [[PDFPage.getSize]] to obtain the page's size.\n   *\n   * @returns The height of the page.\n   */\n  getHeight(): number {\n    return this.getSize().height;\n  }\n\n  /**\n   * Get the rectangle defining this page's MediaBox. For example:\n   * ```js\n   * const { x, y, width, height } = page.getMediaBox()\n   * ```\n   *\n   * The MediaBox of a page defines the boundaries of the physical medium on\n   * which the page is to be displayed/printed. It may include extended area\n   * surrounding the page content for bleed marks, printing marks, etc...\n   * It may also include areas close to the edges of the medium that cannot be\n   * marked because of physical limitations of the output device. Content\n   * falling outside this boundary may safely be discarded without affecting\n   * the meaning of the PDF file.\n   *\n   * @returns An object defining the lower left corner of the MediaBox and its\n   *          width & height.\n   */\n  getMediaBox(): { x: number; y: number; width: number; height: number } {\n    const mediaBox = this.node.MediaBox();\n    return mediaBox.asRectangle();\n  }\n\n  /**\n   * Get the rectangle defining this page's CropBox. For example:\n   * ```js\n   * const { x, y, width, height } = page.getCropBox()\n   * ```\n   *\n   * The CropBox of a page defines the region to which the contents of the page\n   * shall be clipped when displayed or printed. Unlike the other boxes, the\n   * CropBox does not necessarily represent the physical page geometry. It\n   * merely imposes clipping on the page contents.\n   *\n   * The CropBox's default value is the page's MediaBox.\n   *\n   * @returns An object defining the lower left corner of the CropBox and its\n   *          width & height.\n   */\n  getCropBox(): { x: number; y: number; width: number; height: number } {\n    const cropBox = this.node.CropBox();\n    return cropBox?.asRectangle() ?? this.getMediaBox();\n  }\n\n  /**\n   * Get the rectangle defining this page's BleedBox. For example:\n   * ```js\n   * const { x, y, width, height } = page.getBleedBox()\n   * ```\n   *\n   * The BleedBox of a page defines the region to which the contents of the\n   * page shall be clipped when output in a production environment. This may\n   * include any extra bleed area needed to accommodate the physical\n   * limitations of cutting, folding, and trimming equipment. The actual\n   * printed page may include printing marks that fall outside the BleedBox.\n   *\n   * The BleedBox's default value is the page's CropBox.\n   *\n   * @returns An object defining the lower left corner of the BleedBox and its\n   *          width & height.\n   */\n  getBleedBox(): { x: number; y: number; width: number; height: number } {\n    const bleedBox = this.node.BleedBox();\n    return bleedBox?.asRectangle() ?? this.getCropBox();\n  }\n\n  /**\n   * Get the rectangle defining this page's TrimBox. For example:\n   * ```js\n   * const { x, y, width, height } = page.getTrimBox()\n   * ```\n   *\n   * The TrimBox of a page defines the intended dimensions of the finished\n   * page after trimming. It may be smaller than the MediaBox to allow for\n   * production-related content, such as printing instructions, cut marks, or\n   * color bars.\n   *\n   * The TrimBox's default value is the page's CropBox.\n   *\n   * @returns An object defining the lower left corner of the TrimBox and its\n   *          width & height.\n   */\n  getTrimBox(): { x: number; y: number; width: number; height: number } {\n    const trimBox = this.node.TrimBox();\n    return trimBox?.asRectangle() ?? this.getCropBox();\n  }\n\n  /**\n   * Get the rectangle defining this page's ArtBox. For example:\n   * ```js\n   * const { x, y, width, height } = page.getArtBox()\n   * ```\n   *\n   * The ArtBox of a page defines the extent of the page's meaningful content\n   * (including potential white space).\n   *\n   * The ArtBox's default value is the page's CropBox.\n   *\n   * @returns An object defining the lower left corner of the ArtBox and its\n   *          width & height.\n   */\n  getArtBox(): { x: number; y: number; width: number; height: number } {\n    const artBox = this.node.ArtBox();\n    return artBox?.asRectangle() ?? this.getCropBox();\n  }\n\n  /**\n   * Translate this page's content to a new location on the page. This operation\n   * is often useful after resizing the page with [[setSize]]. For example:\n   * ```js\n   * // Add 50 units of whitespace to the top and right of the page\n   * page.setSize(page.getWidth() + 50, page.getHeight() + 50)\n   *\n   * // Move the page's content from the lower-left corner of the page\n   * // to the top-right corner.\n   * page.translateContent(50, 50)\n   *\n   * // Now there are 50 units of whitespace to the left and bottom of the page\n   * ```\n   * See also: [[resetPosition]]\n   * @param x The new position on the x-axis for this page's content.\n   * @param y The new position on the y-axis for this page's content.\n   */\n  translateContent(x: number, y: number): void {\n    assertIs(x, 'x', ['number']);\n    assertIs(y, 'y', ['number']);\n\n    this.node.normalize();\n    this.getContentStream();\n\n    const start = this.createContentStream(\n      pushGraphicsState(),\n      translate(x, y),\n    );\n    const startRef = this.doc.context.register(start);\n\n    const end = this.createContentStream(popGraphicsState());\n    const endRef = this.doc.context.register(end);\n\n    this.node.wrapContentStreams(startRef, endRef);\n  }\n\n  /**\n   * Scale the size, content, and annotations of a page.\n   *\n   * For example:\n   * ```js\n   * page.scale(0.5, 0.5);\n   * ```\n   *\n   * @param x The factor by which the width for the page should be scaled\n   *          (e.g. `0.5` is 50%).\n   * @param y The factor by which the height for the page should be scaled\n   *          (e.g. `2.0` is 200%).\n   */\n  scale(x: number, y: number): void {\n    assertIs(x, 'x', ['number']);\n    assertIs(y, 'y', ['number']);\n    this.setSize(this.getWidth() * x, this.getHeight() * y);\n    this.scaleContent(x, y);\n    this.scaleAnnotations(x, y);\n  }\n\n  /**\n   * Scale the content of a page. This is useful after resizing an existing\n   * page. This scales only the content, not the annotations.\n   *\n   * For example:\n   * ```js\n   * // Bisect the size of the page\n   * page.setSize(page.getWidth() / 2, page.getHeight() / 2);\n   *\n   * // Scale the content of the page down by 50% in x and y\n   * page.scaleContent(0.5, 0.5);\n   * ```\n   * See also: [[scaleAnnotations]]\n   * @param x The factor by which the x-axis for the content should be scaled\n   *          (e.g. `0.5` is 50%).\n   * @param y The factor by which the y-axis for the content should be scaled\n   *          (e.g. `2.0` is 200%).\n   */\n  scaleContent(x: number, y: number): void {\n    assertIs(x, 'x', ['number']);\n    assertIs(y, 'y', ['number']);\n\n    this.node.normalize();\n    this.getContentStream();\n\n    const start = this.createContentStream(pushGraphicsState(), scale(x, y));\n    const startRef = this.doc.context.register(start);\n\n    const end = this.createContentStream(popGraphicsState());\n    const endRef = this.doc.context.register(end);\n\n    this.node.wrapContentStreams(startRef, endRef);\n  }\n\n  /**\n   * Scale the annotations of a page. This is useful if you want to scale a\n   * page with comments or other annotations.\n   * ```js\n   * // Scale the content of the page down by 50% in x and y\n   * page.scaleContent(0.5, 0.5);\n   *\n   * // Scale the content of the page down by 50% in x and y\n   * page.scaleAnnotations(0.5, 0.5);\n   * ```\n   * See also: [[scaleContent]]\n   * @param x The factor by which the x-axis for the annotations should be\n   *          scaled (e.g. `0.5` is 50%).\n   * @param y The factor by which the y-axis for the annotations should be\n   *          scaled (e.g. `2.0` is 200%).\n   */\n  scaleAnnotations(x: number, y: number) {\n    assertIs(x, 'x', ['number']);\n    assertIs(y, 'y', ['number']);\n\n    const annots = this.node.Annots();\n    if (!annots) return;\n\n    for (let idx = 0; idx < annots.size(); idx++) {\n      const annot = annots.lookup(idx);\n      if (annot instanceof PDFDict) this.scaleAnnot(annot, x, y);\n    }\n  }\n\n  /**\n   * Reset the x and y coordinates of this page to `(0, 0)`. This operation is\n   * often useful after calling [[translateContent]]. For example:\n   * ```js\n   * // Shift the page's contents up and to the right by 50 units\n   * page.translateContent(50, 50)\n   *\n   * // This text will shifted - it will be drawn at (50, 50)\n   * page.drawText('I am shifted')\n   *\n   * // Move back to (0, 0)\n   * page.resetPosition()\n   *\n   * // This text will not be shifted - it will be drawn at (0, 0)\n   * page.drawText('I am not shifted')\n   * ```\n   */\n  resetPosition(): void {\n    this.getContentStream(false);\n    this.x = 0;\n    this.y = 0;\n  }\n\n  /**\n   * Choose a default font for this page. The default font will be used whenever\n   * text is drawn on this page and no font is specified. For example:\n   * ```js\n   * import { StandardFonts } from 'pdf-lib'\n   *\n   * const timesRomanFont = await pdfDoc.embedFont(StandardFonts.TimesRoman)\n   * const helveticaFont = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const courierFont = await pdfDoc.embedFont(StandardFonts.Courier)\n   *\n   * const page = pdfDoc.addPage()\n   *\n   * page.setFont(helveticaFont)\n   * page.drawText('I will be drawn in Helvetica')\n   *\n   * page.setFont(timesRomanFont)\n   * page.drawText('I will be drawn in Courier', { font: courierFont })\n   * ```\n   * @param font The default font to be used when drawing text on this page.\n   */\n  setFont(font: PDFFont): void {\n    // TODO: Reuse image Font name if we've already added this image to Resources.Fonts\n    assertIs(font, 'font', [[PDFFont, 'PDFFont']]);\n    this.font = font;\n    this.fontKey = this.node.newFontDictionary(this.font.name, this.font.ref);\n  }\n\n  /**\n   * Choose a default font size for this page. The default font size will be\n   * used whenever text is drawn on this page and no font size is specified.\n   * For example:\n   * ```js\n   * page.setFontSize(12)\n   * page.drawText('I will be drawn in size 12')\n   *\n   * page.setFontSize(36)\n   * page.drawText('I will be drawn in size 24', { fontSize: 24 })\n   * ```\n   * @param fontSize The default font size to be used when drawing text on this\n   *                 page.\n   */\n  setFontSize(fontSize: number): void {\n    assertIs(fontSize, 'fontSize', ['number']);\n    this.fontSize = fontSize;\n  }\n\n  /**\n   * Choose a default font color for this page. The default font color will be\n   * used whenever text is drawn on this page and no font color is specified.\n   * For example:\n   * ```js\n   * import { rgb, cmyk, grayscale } from 'pdf-lib'\n   *\n   * page.setFontColor(rgb(0.97, 0.02, 0.97))\n   * page.drawText('I will be drawn in pink')\n   *\n   * page.setFontColor(cmyk(0.4, 0.7, 0.39, 0.15))\n   * page.drawText('I will be drawn in gray', { color: grayscale(0.5) })\n   * ```\n   * @param fontColor The default font color to be used when drawing text on\n   *                  this page.\n   */\n  setFontColor(fontColor: Color): void {\n    assertIs(fontColor, 'fontColor', [[Object, 'Color']]);\n    this.fontColor = fontColor;\n  }\n\n  /**\n   * Choose a default line height for this page. The default line height will be\n   * used whenever text is drawn on this page and no line height is specified.\n   * For example:\n   * ```js\n   * page.setLineHeight(12);\n   * page.drawText('These lines will be vertically \\n separated by 12 units')\n   *\n   * page.setLineHeight(36);\n   * page.drawText('These lines will be vertically \\n separated by 24 units', {\n   *   lineHeight: 24\n   * })\n   * ```\n   * @param lineHeight The default line height to be used when drawing text on\n   *                   this page.\n   */\n  setLineHeight(lineHeight: number): void {\n    assertIs(lineHeight, 'lineHeight', ['number']);\n    this.lineHeight = lineHeight;\n  }\n\n  /**\n   * Get the default position of this page. For example:\n   * ```js\n   * const { x, y } = page.getPosition()\n   * ```\n   * @returns The default position of the page.\n   */\n  getPosition(): { x: number; y: number } {\n    return { x: this.x, y: this.y };\n  }\n\n  /**\n   * Get the default x coordinate of this page. For example:\n   * ```js\n   * const x = page.getX()\n   * ```\n   * @returns The default x coordinate of the page.\n   */\n  getX(): number {\n    return this.x;\n  }\n\n  /**\n   * Get the default y coordinate of this page. For example:\n   * ```js\n   * const y = page.getY()\n   * ```\n   * @returns The default y coordinate of the page.\n   */\n  getY(): number {\n    return this.y;\n  }\n\n  /**\n   * Change the default position of this page. For example:\n   * ```js\n   * page.moveTo(0, 0)\n   * page.drawText('I will be drawn at the origin')\n   *\n   * page.moveTo(0, 25)\n   * page.drawText('I will be drawn 25 units up')\n   *\n   * page.moveTo(25, 25)\n   * page.drawText('I will be drawn 25 units up and 25 units to the right')\n   * ```\n   * @param x The new default position on the x-axis for this page.\n   * @param y The new default position on the y-axis for this page.\n   */\n  moveTo(x: number, y: number): void {\n    assertIs(x, 'x', ['number']);\n    assertIs(y, 'y', ['number']);\n    this.x = x;\n    this.y = y;\n  }\n\n  /**\n   * Change the default position of this page to be further down the y-axis.\n   * For example:\n   * ```js\n   * page.moveTo(50, 50)\n   * page.drawText('I will be drawn at (50, 50)')\n   *\n   * page.moveDown(10)\n   * page.drawText('I will be drawn at (50, 40)')\n   * ```\n   * @param yDecrease The amount by which the page's default position along the\n   *                  y-axis should be decreased.\n   */\n  moveDown(yDecrease: number): void {\n    assertIs(yDecrease, 'yDecrease', ['number']);\n    this.y -= yDecrease;\n  }\n\n  /**\n   * Change the default position of this page to be further up the y-axis.\n   * For example:\n   * ```js\n   * page.moveTo(50, 50)\n   * page.drawText('I will be drawn at (50, 50)')\n   *\n   * page.moveUp(10)\n   * page.drawText('I will be drawn at (50, 60)')\n   * ```\n   * @param yIncrease The amount by which the page's default position along the\n   *                  y-axis should be increased.\n   */\n  moveUp(yIncrease: number): void {\n    assertIs(yIncrease, 'yIncrease', ['number']);\n    this.y += yIncrease;\n  }\n\n  /**\n   * Change the default position of this page to be further left on the x-axis.\n   * For example:\n   * ```js\n   * page.moveTo(50, 50)\n   * page.drawText('I will be drawn at (50, 50)')\n   *\n   * page.moveLeft(10)\n   * page.drawText('I will be drawn at (40, 50)')\n   * ```\n   * @param xDecrease The amount by which the page's default position along the\n   *                  x-axis should be decreased.\n   */\n  moveLeft(xDecrease: number): void {\n    assertIs(xDecrease, 'xDecrease', ['number']);\n    this.x -= xDecrease;\n  }\n\n  /**\n   * Change the default position of this page to be further right on the y-axis.\n   * For example:\n   * ```js\n   * page.moveTo(50, 50)\n   * page.drawText('I will be drawn at (50, 50)')\n   *\n   * page.moveRight(10)\n   * page.drawText('I will be drawn at (60, 50)')\n   * ```\n   * @param xIncrease The amount by which the page's default position along the\n   *                  x-axis should be increased.\n   */\n  moveRight(xIncrease: number): void {\n    assertIs(xIncrease, 'xIncrease', ['number']);\n    this.x += xIncrease;\n  }\n\n  /**\n   * Push one or more operators to the end of this page's current content\n   * stream. For example:\n   * ```js\n   * import {\n   *   pushGraphicsState,\n   *   moveTo,\n   *   lineTo,\n   *   closePath,\n   *   setFillingColor,\n   *   rgb,\n   *   fill,\n   *   popGraphicsState,\n   * } from 'pdf-lib'\n   *\n   * // Draw a green triangle in the lower-left corner of the page\n   * page.pushOperators(\n   *   pushGraphicsState(),\n   *   moveTo(0, 0),\n   *   lineTo(100, 0),\n   *   lineTo(50, 100),\n   *   closePath(),\n   *   setFillingColor(rgb(0.0, 1.0, 0.0)),\n   *   fill(),\n   *   popGraphicsState(),\n   * )\n   * ```\n   * @param operator The operators to be pushed.\n   */\n  pushOperators(...operator: PDFOperator[]): void {\n    assertEachIs(operator, 'operator', [[PDFOperator, 'PDFOperator']]);\n    const contentStream = this.getContentStream();\n    contentStream.push(...operator);\n  }\n\n  /**\n   * Draw one or more lines of text on this page. For example:\n   * ```js\n   * import { StandardFonts, rgb } from 'pdf-lib'\n   *\n   * const helveticaFont = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const timesRomanFont = await pdfDoc.embedFont(StandardFonts.TimesRoman)\n   *\n   * const page = pdfDoc.addPage()\n   *\n   * page.setFont(helveticaFont)\n   *\n   * page.moveTo(5, 200)\n   * page.drawText('The Life of an Egg', { size: 36 })\n   *\n   * page.moveDown(36)\n   * page.drawText('An Epic Tale of Woe', { size: 30 })\n   *\n   * page.drawText(\n   *   `Humpty Dumpty sat on a wall \\n` +\n   *   `Humpty Dumpty had a great fall; \\n` +\n   *   `All the king's horses and all the king's men \\n` +\n   *   `Couldn't put Humpty together again. \\n`,\n   *   {\n   *     x: 25,\n   *     y: 100,\n   *     font: timesRomanFont,\n   *     size: 24,\n   *     color: rgb(1, 0, 0),\n   *     lineHeight: 24,\n   *     opacity: 0.75,\n   *   },\n   * )\n   * ```\n   * @param text The text to be drawn.\n   * @param options The options to be used when drawing the text.\n   */\n  drawText(text: string, options: PDFPageDrawTextOptions = {}): void {\n    assertIs(text, 'text', ['string']);\n    assertOrUndefined(options.color, 'options.color', [[Object, 'Color']]);\n    assertRangeOrUndefined(options.opacity, 'opacity.opacity', 0, 1);\n    assertOrUndefined(options.font, 'options.font', [[PDFFont, 'PDFFont']]);\n    assertOrUndefined(options.size, 'options.size', ['number']);\n    assertOrUndefined(options.rotate, 'options.rotate', [[Object, 'Rotation']]);\n    assertOrUndefined(options.xSkew, 'options.xSkew', [[Object, 'Rotation']]);\n    assertOrUndefined(options.ySkew, 'options.ySkew', [[Object, 'Rotation']]);\n    assertOrUndefined(options.x, 'options.x', ['number']);\n    assertOrUndefined(options.y, 'options.y', ['number']);\n    assertOrUndefined(options.lineHeight, 'options.lineHeight', ['number']);\n    assertOrUndefined(options.maxWidth, 'options.maxWidth', ['number']);\n    assertOrUndefined(options.wordBreaks, 'options.wordBreaks', [Array]);\n    assertIsOneOfOrUndefined(options.blendMode, 'options.blendMode', BlendMode);\n\n    const { oldFont, newFont, newFontKey } = this.setOrEmbedFont(options.font);\n    const fontSize = options.size || this.fontSize;\n\n    const wordBreaks = options.wordBreaks || this.doc.defaultWordBreaks;\n    const textWidth = (t: string) => newFont.widthOfTextAtSize(t, fontSize);\n    const lines =\n      options.maxWidth === undefined\n        ? lineSplit(cleanText(text))\n        : breakTextIntoLines(text, wordBreaks, options.maxWidth, textWidth);\n\n    const encodedLines = new Array(lines.length) as PDFHexString[];\n    for (let idx = 0, len = lines.length; idx < len; idx++) {\n      encodedLines[idx] = newFont.encodeText(lines[idx]);\n    }\n\n    const graphicsStateKey = this.maybeEmbedGraphicsState({\n      opacity: options.opacity,\n      blendMode: options.blendMode,\n    });\n\n    const contentStream = this.getContentStream();\n    contentStream.push(\n      ...drawLinesOfText(encodedLines, {\n        color: options.color ?? this.fontColor,\n        font: newFontKey,\n        size: fontSize,\n        rotate: options.rotate ?? degrees(0),\n        xSkew: options.xSkew ?? degrees(0),\n        ySkew: options.ySkew ?? degrees(0),\n        x: options.x ?? this.x,\n        y: options.y ?? this.y,\n        lineHeight: options.lineHeight ?? this.lineHeight,\n        graphicsState: graphicsStateKey,\n      }),\n    );\n\n    if (options.font) {\n      if (oldFont) this.setFont(oldFont);\n      else this.resetFont();\n    }\n  }\n\n  /**\n   * Draw an image on this page. For example:\n   * ```js\n   * import { degrees } from 'pdf-lib'\n   *\n   * const jpgUrl = 'https://pdf-lib.js.org/assets/cat_riding_unicorn.jpg'\n   * const jpgImageBytes = await fetch(jpgUrl).then((res) => res.arrayBuffer())\n   *\n   * const jpgImage = await pdfDoc.embedJpg(jpgImageBytes)\n   * const jpgDims = jpgImage.scale(0.5)\n   *\n   * const page = pdfDoc.addPage()\n   *\n   * page.drawImage(jpgImage, {\n   *   x: 25,\n   *   y: 25,\n   *   width: jpgDims.width,\n   *   height: jpgDims.height,\n   *   rotate: degrees(30),\n   *   opacity: 0.75,\n   * })\n   * ```\n   * @param image The image to be drawn.\n   * @param options The options to be used when drawing the image.\n   */\n  drawImage(image: PDFImage, options: PDFPageDrawImageOptions = {}): void {\n    // TODO: Reuse image XObject name if we've already added this image to Resources.XObjects\n    assertIs(image, 'image', [[PDFImage, 'PDFImage']]);\n    assertOrUndefined(options.x, 'options.x', ['number']);\n    assertOrUndefined(options.y, 'options.y', ['number']);\n    assertOrUndefined(options.width, 'options.width', ['number']);\n    assertOrUndefined(options.height, 'options.height', ['number']);\n    assertOrUndefined(options.rotate, 'options.rotate', [[Object, 'Rotation']]);\n    assertOrUndefined(options.xSkew, 'options.xSkew', [[Object, 'Rotation']]);\n    assertOrUndefined(options.ySkew, 'options.ySkew', [[Object, 'Rotation']]);\n    assertRangeOrUndefined(options.opacity, 'opacity.opacity', 0, 1);\n    assertIsOneOfOrUndefined(options.blendMode, 'options.blendMode', BlendMode);\n\n    const xObjectKey = this.node.newXObject('Image', image.ref);\n\n    const graphicsStateKey = this.maybeEmbedGraphicsState({\n      opacity: options.opacity,\n      blendMode: options.blendMode,\n    });\n\n    const contentStream = this.getContentStream();\n    contentStream.push(\n      ...drawImage(xObjectKey, {\n        x: options.x ?? this.x,\n        y: options.y ?? this.y,\n        width: options.width ?? image.size().width,\n        height: options.height ?? image.size().height,\n        rotate: options.rotate ?? degrees(0),\n        xSkew: options.xSkew ?? degrees(0),\n        ySkew: options.ySkew ?? degrees(0),\n        graphicsState: graphicsStateKey,\n      }),\n    );\n  }\n\n  /**\n   * Draw an embedded PDF page on this page. For example:\n   * ```js\n   * import { degrees } from 'pdf-lib'\n   *\n   * const pdfDoc = await PDFDocument.create()\n   * const page = pdfDoc.addPage()\n   *\n   * const sourcePdfUrl = 'https://pdf-lib.js.org/assets/with_large_page_count.pdf'\n   * const sourcePdf = await fetch(sourcePdfUrl).then((res) => res.arrayBuffer())\n   *\n   * // Embed page 74 from the PDF\n   * const [embeddedPage] = await pdfDoc.embedPdf(sourcePdf, 73)\n   *\n   * page.drawPage(embeddedPage, {\n   *   x: 250,\n   *   y: 200,\n   *   xScale: 0.5,\n   *   yScale: 0.5,\n   *   rotate: degrees(30),\n   *   opacity: 0.75,\n   * })\n   * ```\n   *\n   * The `options` argument accepts both `width`/`height` and `xScale`/`yScale`\n   * as options. Since each of these options defines the size of the drawn page,\n   * if both options are given, `width` and `height` take precedence and the\n   * corresponding scale variants are ignored.\n   *\n   * @param embeddedPage The embedded page to be drawn.\n   * @param options The options to be used when drawing the embedded page.\n   */\n  drawPage(\n    embeddedPage: PDFEmbeddedPage,\n    options: PDFPageDrawPageOptions = {},\n  ): void {\n    // TODO: Reuse embeddedPage XObject name if we've already added this embeddedPage to Resources.XObjects\n    assertIs(embeddedPage, 'embeddedPage', [\n      [PDFEmbeddedPage, 'PDFEmbeddedPage'],\n    ]);\n    assertOrUndefined(options.x, 'options.x', ['number']);\n    assertOrUndefined(options.y, 'options.y', ['number']);\n    assertOrUndefined(options.xScale, 'options.xScale', ['number']);\n    assertOrUndefined(options.yScale, 'options.yScale', ['number']);\n    assertOrUndefined(options.width, 'options.width', ['number']);\n    assertOrUndefined(options.height, 'options.height', ['number']);\n    assertOrUndefined(options.rotate, 'options.rotate', [[Object, 'Rotation']]);\n    assertOrUndefined(options.xSkew, 'options.xSkew', [[Object, 'Rotation']]);\n    assertOrUndefined(options.ySkew, 'options.ySkew', [[Object, 'Rotation']]);\n    assertRangeOrUndefined(options.opacity, 'opacity.opacity', 0, 1);\n    assertIsOneOfOrUndefined(options.blendMode, 'options.blendMode', BlendMode);\n\n    const xObjectKey = this.node.newXObject(\n      'EmbeddedPdfPage',\n      embeddedPage.ref,\n    );\n\n    const graphicsStateKey = this.maybeEmbedGraphicsState({\n      opacity: options.opacity,\n      blendMode: options.blendMode,\n    });\n\n    // prettier-ignore\n    const xScale = (\n      options.width  !== undefined ? options.width / embeddedPage.width\n        : options.xScale !== undefined ? options.xScale\n          : 1\n    );\n\n    // prettier-ignore\n    const yScale = (\n      options.height !== undefined ? options.height / embeddedPage.height\n        : options.yScale !== undefined ? options.yScale\n          : 1\n    );\n\n    const contentStream = this.getContentStream();\n    contentStream.push(\n      ...drawPage(xObjectKey, {\n        x: options.x ?? this.x,\n        y: options.y ?? this.y,\n        xScale,\n        yScale,\n        rotate: options.rotate ?? degrees(0),\n        xSkew: options.xSkew ?? degrees(0),\n        ySkew: options.ySkew ?? degrees(0),\n        graphicsState: graphicsStateKey,\n      }),\n    );\n  }\n\n  /**\n   * Draw an SVG path on this page. For example:\n   * ```js\n   * import { rgb } from 'pdf-lib'\n   *\n   * const svgPath = 'M 0,20 L 100,160 Q 130,200 150,120 C 190,-40 200,200 300,150 L 400,90'\n   *\n   * // Draw path as black line\n   * page.drawSvgPath(svgPath, { x: 25, y: 75 })\n   *\n   * // Change border style and opacity\n   * page.drawSvgPath(svgPath, {\n   *   x: 25,\n   *   y: 275,\n   *   borderColor: rgb(0.5, 0.5, 0.5),\n   *   borderWidth: 2,\n   *   borderOpacity: 0.75,\n   * })\n   *\n   * // Set fill color and opacity\n   * page.drawSvgPath(svgPath, {\n   *   x: 25,\n   *   y: 475,\n   *   color: rgb(1.0, 0, 0),\n   *   opacity: 0.75,\n   * })\n   *\n   * // Draw 50% of original size\n   * page.drawSvgPath(svgPath, {\n   *   x: 25,\n   *   y: 675,\n   *   scale: 0.5,\n   * })\n   * ```\n   * @param path The SVG path to be drawn.\n   * @param options The options to be used when drawing the SVG path.\n   */\n  drawSvgPath(path: string, options: PDFPageDrawSVGOptions = {}): void {\n    assertIs(path, 'path', ['string']);\n    assertOrUndefined(options.x, 'options.x', ['number']);\n    assertOrUndefined(options.y, 'options.y', ['number']);\n    assertOrUndefined(options.scale, 'options.scale', ['number']);\n    assertOrUndefined(options.rotate, 'options.rotate', [[Object, 'Rotation']]);\n    assertOrUndefined(options.borderWidth, 'options.borderWidth', ['number']);\n    assertOrUndefined(options.color, 'options.color', [[Object, 'Color']]);\n    assertRangeOrUndefined(options.opacity, 'opacity.opacity', 0, 1);\n    assertOrUndefined(options.borderColor, 'options.borderColor', [\n      [Object, 'Color'],\n    ]);\n    assertOrUndefined(options.borderDashArray, 'options.borderDashArray', [\n      Array,\n    ]);\n    assertOrUndefined(options.borderDashPhase, 'options.borderDashPhase', [\n      'number',\n    ]);\n    assertIsOneOfOrUndefined(\n      options.borderLineCap,\n      'options.borderLineCap',\n      LineCapStyle,\n    );\n    assertRangeOrUndefined(\n      options.borderOpacity,\n      'options.borderOpacity',\n      0,\n      1,\n    );\n    assertIsOneOfOrUndefined(options.blendMode, 'options.blendMode', BlendMode);\n\n    const graphicsStateKey = this.maybeEmbedGraphicsState({\n      opacity: options.opacity,\n      borderOpacity: options.borderOpacity,\n      blendMode: options.blendMode,\n    });\n\n    if (!('color' in options) && !('borderColor' in options)) {\n      options.borderColor = rgb(0, 0, 0);\n    }\n\n    const contentStream = this.getContentStream();\n    contentStream.push(\n      ...drawSvgPath(path, {\n        x: options.x ?? this.x,\n        y: options.y ?? this.y,\n        scale: options.scale,\n        rotate: options.rotate ?? degrees(0),\n        color: options.color ?? undefined,\n        borderColor: options.borderColor ?? undefined,\n        borderWidth: options.borderWidth ?? 0,\n        borderDashArray: options.borderDashArray ?? undefined,\n        borderDashPhase: options.borderDashPhase ?? undefined,\n        borderLineCap: options.borderLineCap ?? undefined,\n        graphicsState: graphicsStateKey,\n      }),\n    );\n  }\n\n  /**\n   * Draw a line on this page. For example:\n   * ```js\n   * import { rgb } from 'pdf-lib'\n   *\n   * page.drawLine({\n   *   start: { x: 25, y: 75 },\n   *   end: { x: 125, y: 175 },\n   *   thickness: 2,\n   *   color: rgb(0.75, 0.2, 0.2),\n   *   opacity: 0.75,\n   * })\n   * ```\n   * @param options The options to be used when drawing the line.\n   */\n  drawLine(options: PDFPageDrawLineOptions): void {\n    assertIs(options.start, 'options.start', [\n      [Object, '{ x: number, y: number }'],\n    ]);\n    assertIs(options.end, 'options.end', [\n      [Object, '{ x: number, y: number }'],\n    ]);\n    assertIs(options.start.x, 'options.start.x', ['number']);\n    assertIs(options.start.y, 'options.start.y', ['number']);\n    assertIs(options.end.x, 'options.end.x', ['number']);\n    assertIs(options.end.y, 'options.end.y', ['number']);\n    assertOrUndefined(options.thickness, 'options.thickness', ['number']);\n    assertOrUndefined(options.color, 'options.color', [[Object, 'Color']]);\n    assertOrUndefined(options.dashArray, 'options.dashArray', [Array]);\n    assertOrUndefined(options.dashPhase, 'options.dashPhase', ['number']);\n    assertIsOneOfOrUndefined(options.lineCap, 'options.lineCap', LineCapStyle);\n    assertRangeOrUndefined(options.opacity, 'opacity.opacity', 0, 1);\n    assertIsOneOfOrUndefined(options.blendMode, 'options.blendMode', BlendMode);\n\n    const graphicsStateKey = this.maybeEmbedGraphicsState({\n      borderOpacity: options.opacity,\n      blendMode: options.blendMode,\n    });\n\n    if (!('color' in options)) {\n      options.color = rgb(0, 0, 0);\n    }\n\n    const contentStream = this.getContentStream();\n    contentStream.push(\n      ...drawLine({\n        start: options.start,\n        end: options.end,\n        thickness: options.thickness ?? 1,\n        color: options.color ?? undefined,\n        dashArray: options.dashArray ?? undefined,\n        dashPhase: options.dashPhase ?? undefined,\n        lineCap: options.lineCap ?? undefined,\n        graphicsState: graphicsStateKey,\n      }),\n    );\n  }\n\n  /**\n   * Draw a rectangle on this page. For example:\n   * ```js\n   * import { degrees, grayscale, rgb } from 'pdf-lib'\n   *\n   * page.drawRectangle({\n   *   x: 25,\n   *   y: 75,\n   *   width: 250,\n   *   height: 75,\n   *   rotate: degrees(-15),\n   *   borderWidth: 5,\n   *   borderColor: grayscale(0.5),\n   *   color: rgb(0.75, 0.2, 0.2),\n   *   opacity: 0.5,\n   *   borderOpacity: 0.75,\n   * })\n   * ```\n   * @param options The options to be used when drawing the rectangle.\n   */\n  drawRectangle(options: PDFPageDrawRectangleOptions = {}): void {\n    assertOrUndefined(options.x, 'options.x', ['number']);\n    assertOrUndefined(options.y, 'options.y', ['number']);\n    assertOrUndefined(options.width, 'options.width', ['number']);\n    assertOrUndefined(options.height, 'options.height', ['number']);\n    assertOrUndefined(options.rotate, 'options.rotate', [[Object, 'Rotation']]);\n    assertOrUndefined(options.xSkew, 'options.xSkew', [[Object, 'Rotation']]);\n    assertOrUndefined(options.ySkew, 'options.ySkew', [[Object, 'Rotation']]);\n    assertOrUndefined(options.borderWidth, 'options.borderWidth', ['number']);\n    assertOrUndefined(options.color, 'options.color', [[Object, 'Color']]);\n    assertRangeOrUndefined(options.opacity, 'opacity.opacity', 0, 1);\n    assertOrUndefined(options.borderColor, 'options.borderColor', [\n      [Object, 'Color'],\n    ]);\n    assertOrUndefined(options.borderDashArray, 'options.borderDashArray', [\n      Array,\n    ]);\n    assertOrUndefined(options.borderDashPhase, 'options.borderDashPhase', [\n      'number',\n    ]);\n    assertIsOneOfOrUndefined(\n      options.borderLineCap,\n      'options.borderLineCap',\n      LineCapStyle,\n    );\n    assertRangeOrUndefined(\n      options.borderOpacity,\n      'options.borderOpacity',\n      0,\n      1,\n    );\n    assertIsOneOfOrUndefined(options.blendMode, 'options.blendMode', BlendMode);\n\n    const graphicsStateKey = this.maybeEmbedGraphicsState({\n      opacity: options.opacity,\n      borderOpacity: options.borderOpacity,\n      blendMode: options.blendMode,\n    });\n\n    if (!('color' in options) && !('borderColor' in options)) {\n      options.color = rgb(0, 0, 0);\n    }\n\n    const contentStream = this.getContentStream();\n    contentStream.push(\n      ...drawRectangle({\n        x: options.x ?? this.x,\n        y: options.y ?? this.y,\n        width: options.width ?? 150,\n        height: options.height ?? 100,\n        rotate: options.rotate ?? degrees(0),\n        xSkew: options.xSkew ?? degrees(0),\n        ySkew: options.ySkew ?? degrees(0),\n        borderWidth: options.borderWidth ?? 0,\n        color: options.color ?? undefined,\n        borderColor: options.borderColor ?? undefined,\n        borderDashArray: options.borderDashArray ?? undefined,\n        borderDashPhase: options.borderDashPhase ?? undefined,\n        graphicsState: graphicsStateKey,\n        borderLineCap: options.borderLineCap ?? undefined,\n      }),\n    );\n  }\n\n  /**\n   * Draw a square on this page. For example:\n   * ```js\n   * import { degrees, grayscale, rgb } from 'pdf-lib'\n   *\n   * page.drawSquare({\n   *   x: 25,\n   *   y: 75,\n   *   size: 100,\n   *   rotate: degrees(-15),\n   *   borderWidth: 5,\n   *   borderColor: grayscale(0.5),\n   *   color: rgb(0.75, 0.2, 0.2),\n   *   opacity: 0.5,\n   *   borderOpacity: 0.75,\n   * })\n   * ```\n   * @param options The options to be used when drawing the square.\n   */\n  drawSquare(options: PDFPageDrawSquareOptions = {}): void {\n    const { size } = options;\n    assertOrUndefined(size, 'size', ['number']);\n    this.drawRectangle({ ...options, width: size, height: size });\n  }\n\n  /**\n   * Draw an ellipse on this page. For example:\n   * ```js\n   * import { grayscale, rgb } from 'pdf-lib'\n   *\n   * page.drawEllipse({\n   *   x: 200,\n   *   y: 75,\n   *   xScale: 100,\n   *   yScale: 50,\n   *   borderWidth: 5,\n   *   borderColor: grayscale(0.5),\n   *   color: rgb(0.75, 0.2, 0.2),\n   *   opacity: 0.5,\n   *   borderOpacity: 0.75,\n   * })\n   * ```\n   * @param options The options to be used when drawing the ellipse.\n   */\n  drawEllipse(options: PDFPageDrawEllipseOptions = {}): void {\n    assertOrUndefined(options.x, 'options.x', ['number']);\n    assertOrUndefined(options.y, 'options.y', ['number']);\n    assertOrUndefined(options.xScale, 'options.xScale', ['number']);\n    assertOrUndefined(options.yScale, 'options.yScale', ['number']);\n    assertOrUndefined(options.rotate, 'options.rotate', [[Object, 'Rotation']]);\n    assertOrUndefined(options.color, 'options.color', [[Object, 'Color']]);\n    assertRangeOrUndefined(options.opacity, 'opacity.opacity', 0, 1);\n    assertOrUndefined(options.borderColor, 'options.borderColor', [\n      [Object, 'Color'],\n    ]);\n    assertRangeOrUndefined(\n      options.borderOpacity,\n      'options.borderOpacity',\n      0,\n      1,\n    );\n    assertOrUndefined(options.borderWidth, 'options.borderWidth', ['number']);\n    assertOrUndefined(options.borderDashArray, 'options.borderDashArray', [\n      Array,\n    ]);\n    assertOrUndefined(options.borderDashPhase, 'options.borderDashPhase', [\n      'number',\n    ]);\n    assertIsOneOfOrUndefined(\n      options.borderLineCap,\n      'options.borderLineCap',\n      LineCapStyle,\n    );\n    assertIsOneOfOrUndefined(options.blendMode, 'options.blendMode', BlendMode);\n    const graphicsStateKey = this.maybeEmbedGraphicsState({\n      opacity: options.opacity,\n      borderOpacity: options.borderOpacity,\n      blendMode: options.blendMode,\n    });\n\n    if (!('color' in options) && !('borderColor' in options)) {\n      options.color = rgb(0, 0, 0);\n    }\n\n    const contentStream = this.getContentStream();\n    contentStream.push(\n      ...drawEllipse({\n        x: options.x ?? this.x,\n        y: options.y ?? this.y,\n        xScale: options.xScale ?? 100,\n        yScale: options.yScale ?? 100,\n        rotate: options.rotate ?? undefined,\n        color: options.color ?? undefined,\n        borderColor: options.borderColor ?? undefined,\n        borderWidth: options.borderWidth ?? 0,\n        borderDashArray: options.borderDashArray ?? undefined,\n        borderDashPhase: options.borderDashPhase ?? undefined,\n        borderLineCap: options.borderLineCap ?? undefined,\n        graphicsState: graphicsStateKey,\n      }),\n    );\n  }\n\n  /**\n   * Draw a circle on this page. For example:\n   * ```js\n   * import { grayscale, rgb } from 'pdf-lib'\n   *\n   * page.drawCircle({\n   *   x: 200,\n   *   y: 150,\n   *   size: 100,\n   *   borderWidth: 5,\n   *   borderColor: grayscale(0.5),\n   *   color: rgb(0.75, 0.2, 0.2),\n   *   opacity: 0.5,\n   *   borderOpacity: 0.75,\n   * })\n   * ```\n   * @param options The options to be used when drawing the ellipse.\n   */\n  drawCircle(options: PDFPageDrawCircleOptions = {}): void {\n    const { size = 100 } = options;\n    assertOrUndefined(size, 'size', ['number']);\n    this.drawEllipse({ ...options, xScale: size, yScale: size });\n  }\n\n  private setOrEmbedFont(font?: PDFFont) {\n    const oldFont = this.font;\n    const oldFontKey = this.fontKey;\n\n    if (font) this.setFont(font);\n    else this.getFont();\n\n    const newFont = this.font!;\n    const newFontKey = this.fontKey!;\n\n    return { oldFont, oldFontKey, newFont, newFontKey };\n  }\n\n  private getFont(): [PDFFont, PDFName] {\n    if (!this.font || !this.fontKey) {\n      const font = this.doc.embedStandardFont(StandardFonts.Helvetica);\n      this.setFont(font);\n    }\n    return [this.font!, this.fontKey!];\n  }\n\n  private resetFont(): void {\n    this.font = undefined;\n    this.fontKey = undefined;\n  }\n\n  private getContentStream(useExisting = true): PDFContentStream {\n    if (useExisting && this.contentStream) return this.contentStream;\n    this.contentStream = this.createContentStream();\n    this.contentStreamRef = this.doc.context.register(this.contentStream);\n    this.node.addContentStream(this.contentStreamRef);\n    return this.contentStream;\n  }\n\n  private createContentStream(...operators: PDFOperator[]): PDFContentStream {\n    const dict = this.doc.context.obj({});\n    const contentStream = PDFContentStream.of(dict, operators);\n    return contentStream;\n  }\n\n  private maybeEmbedGraphicsState(options: {\n    opacity?: number;\n    borderOpacity?: number;\n    blendMode?: BlendMode;\n  }): PDFName | undefined {\n    const { opacity, borderOpacity, blendMode } = options;\n\n    if (\n      opacity === undefined &&\n      borderOpacity === undefined &&\n      blendMode === undefined\n    ) {\n      return undefined;\n    }\n\n    const graphicsState = this.doc.context.obj({\n      Type: 'ExtGState',\n      ca: opacity,\n      CA: borderOpacity,\n      BM: blendMode,\n    });\n\n    const key = this.node.newExtGState('GS', graphicsState);\n\n    return key;\n  }\n\n  private scaleAnnot(annot: PDFDict, x: number, y: number) {\n    const selectors = ['RD', 'CL', 'Vertices', 'QuadPoints', 'L', 'Rect'];\n    for (let idx = 0, len = selectors.length; idx < len; idx++) {\n      const list = annot.lookup(PDFName.of(selectors[idx]));\n      if (list instanceof PDFArray) list.scalePDFNumbers(x, y);\n    }\n\n    const inkLists = annot.lookup(PDFName.of('InkList'));\n    if (inkLists instanceof PDFArray) {\n      for (let idx = 0, len = inkLists.size(); idx < len; idx++) {\n        const arr = inkLists.lookup(idx);\n        if (arr instanceof PDFArray) arr.scalePDFNumbers(x, y);\n      }\n    }\n  }\n}\n","import PDFDocument from 'src/api/PDFDocument';\nimport PDFPage from 'src/api/PDFPage';\nimport PDFFont from 'src/api/PDFFont';\nimport PDFImage from 'src/api/PDFImage';\nimport { ImageAlignment } from 'src/api/image/alignment';\nimport {\n  AppearanceProviderFor,\n  normalizeAppearance,\n  defaultButtonAppearanceProvider,\n} from 'src/api/form/appearances';\nimport PDFField, {\n  FieldAppearanceOptions,\n  assertFieldAppearanceOptions,\n} from 'src/api/form/PDFField';\nimport { rgb } from 'src/api/colors';\nimport { degrees } from 'src/api/rotations';\n\nimport {\n  PDFRef,\n  PDFStream,\n  PDFAcroPushButton,\n  PDFWidgetAnnotation,\n} from 'src/core';\nimport { assertIs, assertOrUndefined, assertPositive } from 'src/utils';\n\n/**\n * Represents a button field of a [[PDFForm]].\n *\n * [[PDFButton]] fields are interactive controls that users can click with their\n * mouse. This type of [[PDFField]] is not stateful. The purpose of a button\n * is to perform an action when the user clicks on it, such as opening a print\n * modal or resetting the form. Buttons are typically rectangular in shape and\n * have a text label describing the action that they perform when clicked.\n */\nexport default class PDFButton extends PDFField {\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFForm.getButton]] method, which will create an\n   * > instance of [[PDFButton]] for you.\n   *\n   * Create an instance of [[PDFButton]] from an existing acroPushButton and ref\n   *\n   * @param acroPushButton The underlying `PDFAcroPushButton` for this button.\n   * @param ref The unique reference for this button.\n   * @param doc The document to which this button will belong.\n   */\n  static of = (\n    acroPushButton: PDFAcroPushButton,\n    ref: PDFRef,\n    doc: PDFDocument,\n  ) => new PDFButton(acroPushButton, ref, doc);\n\n  /** The low-level PDFAcroPushButton wrapped by this button. */\n  readonly acroField: PDFAcroPushButton;\n\n  private constructor(\n    acroPushButton: PDFAcroPushButton,\n    ref: PDFRef,\n    doc: PDFDocument,\n  ) {\n    super(acroPushButton, ref, doc);\n\n    assertIs(acroPushButton, 'acroButton', [\n      [PDFAcroPushButton, 'PDFAcroPushButton'],\n    ]);\n\n    this.acroField = acroPushButton;\n  }\n\n  /**\n   * Display an image inside the bounds of this button's widgets. For example:\n   * ```js\n   * const pngImage = await pdfDoc.embedPng(...)\n   * const button = form.getButton('some.button.field')\n   * button.setImage(pngImage, ImageAlignment.Center)\n   * ```\n   * This will update the appearances streams for each of this button's widgets.\n   * @param image The image that should be displayed.\n   * @param alignment The alignment of the image.\n   */\n  setImage(image: PDFImage, alignment = ImageAlignment.Center) {\n    const widgets = this.acroField.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      const streamRef = this.createImageAppearanceStream(\n        widget,\n        image,\n        alignment,\n      );\n      this.updateWidgetAppearances(widget, { normal: streamRef });\n    }\n\n    this.markAsClean();\n  }\n\n  /**\n   * Set the font size for this field. Larger font sizes will result in larger\n   * text being displayed when PDF readers render this button. Font sizes may\n   * be integer or floating point numbers. Supplying a negative font size will\n   * cause this method to throw an error.\n   *\n   * For example:\n   * ```js\n   * const button = form.getButton('some.button.field')\n   * button.setFontSize(4)\n   * button.setFontSize(15.7)\n   * ```\n   *\n   * > This method depends upon the existence of a default appearance\n   * > (`/DA`) string. If this field does not have a default appearance string,\n   * > or that string does not contain a font size (via the `Tf` operator),\n   * > then this method will throw an error.\n   *\n   * @param fontSize The font size to be used when rendering text in this field.\n   */\n  setFontSize(fontSize: number) {\n    assertPositive(fontSize, 'fontSize');\n    this.acroField.setFontSize(fontSize);\n    this.markAsDirty();\n  }\n\n  /**\n   * Show this button on the specified page with the given text. For example:\n   * ```js\n   * const ubuntuFont = await pdfDoc.embedFont(ubuntuFontBytes)\n   * const page = pdfDoc.addPage()\n   *\n   * const form = pdfDoc.getForm()\n   * const button = form.createButton('some.button.field')\n   *\n   * button.addToPage('Do Stuff', page, {\n   *   x: 50,\n   *   y: 75,\n   *   width: 200,\n   *   height: 100,\n   *   textColor: rgb(1, 0, 0),\n   *   backgroundColor: rgb(0, 1, 0),\n   *   borderColor: rgb(0, 0, 1),\n   *   borderWidth: 2,\n   *   rotate: degrees(90),\n   *   font: ubuntuFont,\n   * })\n   * ```\n   * This will create a new widget for this button field.\n   * @param text The text to be displayed for this button widget.\n   * @param page The page to which this button widget should be added.\n   * @param options The options to be used when adding this button widget.\n   */\n  addToPage(\n    // TODO: This needs to be optional, e.g. for image buttons\n    text: string,\n    page: PDFPage,\n    options?: FieldAppearanceOptions,\n  ) {\n    assertOrUndefined(text, 'text', ['string']);\n    assertOrUndefined(page, 'page', [[PDFPage, 'PDFPage']]);\n    assertFieldAppearanceOptions(options);\n\n    // Create a widget for this button\n    const widget = this.createWidget({\n      x: (options?.x ?? 0) - (options?.borderWidth ?? 0) / 2,\n      y: (options?.y ?? 0) - (options?.borderWidth ?? 0) / 2,\n      width: options?.width ?? 100,\n      height: options?.height ?? 50,\n      textColor: options?.textColor ?? rgb(0, 0, 0),\n      backgroundColor: options?.backgroundColor ?? rgb(0.75, 0.75, 0.75),\n      borderColor: options?.borderColor,\n      borderWidth: options?.borderWidth ?? 0,\n      rotate: options?.rotate ?? degrees(0),\n      caption: text,\n      hidden: options?.hidden,\n      page: page.ref,\n    });\n    const widgetRef = this.doc.context.register(widget.dict);\n\n    // Add widget to this field\n    this.acroField.addWidget(widgetRef);\n\n    // Set appearance streams for widget\n    const font = options?.font ?? this.doc.getForm().getDefaultFont();\n    this.updateWidgetAppearance(widget, font);\n\n    // Add widget to the given page\n    page.node.addAnnot(widgetRef);\n  }\n\n  /**\n   * Returns `true` if this button has been marked as dirty, or if any of this\n   * button's widgets do not have an appearance stream. For example:\n   * ```js\n   * const button = form.getButton('some.button.field')\n   * if (button.needsAppearancesUpdate()) console.log('Needs update')\n   * ```\n   * @returns Whether or not this button needs an appearance update.\n   */\n  needsAppearancesUpdate(): boolean {\n    if (this.isDirty()) return true;\n\n    const widgets = this.acroField.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      const hasAppearances =\n        widget.getAppearances()?.normal instanceof PDFStream;\n      if (!hasAppearances) return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Update the appearance streams for each of this button's widgets using\n   * the default appearance provider for buttons. For example:\n   * ```js\n   * const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const button = form.getButton('some.button.field')\n   * button.defaultUpdateAppearances(helvetica)\n   * ```\n   * @param font The font to be used for creating the appearance streams.\n   */\n  defaultUpdateAppearances(font: PDFFont) {\n    assertIs(font, 'font', [[PDFFont, 'PDFFont']]);\n    this.updateAppearances(font);\n  }\n\n  /**\n   * Update the appearance streams for each of this button's widgets using\n   * the given appearance provider. If no `provider` is passed, the default\n   * appearance provider for buttons will be used. For example:\n   * ```js\n   * const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const button = form.getButton('some.button.field')\n   * button.updateAppearances(helvetica, (field, widget, font) => {\n   *   ...\n   *   return {\n   *     normal: drawButton(...),\n   *     down: drawButton(...),\n   *   }\n   * })\n   * ```\n   * @param font The font to be used for creating the appearance streams.\n   * @param provider Optionally, the appearance provider to be used for\n   *                 generating the contents of the appearance streams.\n   */\n  updateAppearances(\n    font: PDFFont,\n    provider?: AppearanceProviderFor<PDFButton>,\n  ) {\n    assertIs(font, 'font', [[PDFFont, 'PDFFont']]);\n    assertOrUndefined(provider, 'provider', [Function]);\n\n    const widgets = this.acroField.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      this.updateWidgetAppearance(widget, font, provider);\n    }\n  }\n\n  private updateWidgetAppearance(\n    widget: PDFWidgetAnnotation,\n    font: PDFFont,\n    provider?: AppearanceProviderFor<PDFButton>,\n  ) {\n    const apProvider = provider ?? defaultButtonAppearanceProvider;\n    const appearances = normalizeAppearance(apProvider(this, widget, font));\n    this.updateWidgetAppearanceWithFont(widget, font, appearances);\n  }\n}\n"],"mappings":"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,IAAI,WAAW,QAAQ;AACnD,wBAAwB,EAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,EAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,EAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,EAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,EAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,EAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,EAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AACnD,wBAAwB,GAAI,IAAI,WAAW,QAAQ;AAQ5C,IAAM,uBAAuB,CAAC,UAA8B;AACjE,QAAM,aAAa,IAAI,MAAM,MAAM,MAAM;AACzC,WAAS,MAAM,GAAG,MAAM,MAAM,QAAQ,MAAM,KAAK,OAAO;AACtD,eAAW,GAAG,IAAI,wBAAwB,MAAM,GAAG,CAAC;AAAA,EACtD;AACA,SAAO,OAAO,cAAc,GAAG,UAAU;AAC3C;;;ACpEA,IAAM,SAAN,MAAM,OAAS;AAAA,EAML,YAAY,UAAmB;AAHvC,wBAAiB;AACjB,wBAAQ;AAGN,SAAK,WAAW;AAChB,SAAK,QAAQ;AAAA,EACf;AAAA,EAEA,WAA0B;AACxB,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,SAAY;AACV,QAAI,CAAC,KAAK,MAAO,MAAK,QAAQ,KAAK,SAAS;AAC5C,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,aAAmB;AACjB,SAAK,QAAQ;AAAA,EACf;AACF;AAtBE,cADI,QACY,eAAc,CAAI,aAAsB,IAAI,OAAM,QAAQ;AAD5E,IAAM,QAAN;AAyBA,IAAO,gBAAQ;;;ACrBR,IAAM,4BAAN,cAAwC,MAAM;AAAA,EACnD,YAAY,WAAmB,YAAoB;AACjD,UAAM,MAAM,UAAU,SAAS,IAAI,UAAU;AAC7C,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,0BAAN,cAAsC,MAAM;AAAA,EACjD,YAAY,WAAmB;AAC7B,UAAM,MAAM,oBAAoB,SAAS;AACzC,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,4BAAN,cAAwC,MAAM;AAAA,EACnD,YAAY,UAAuB,QAAa;AAC9C,UAAM,OAAO,CAAC,MAAW,GAAG,QAAQ,GAAG,aAAa;AAEpD,UAAM,gBAAgB,MAAM,QAAQ,QAAQ,IACxC,SAAS,IAAI,IAAI,IACjB,CAAC,KAAK,QAAQ,CAAC;AAEnB,UAAM,MACJ,wBAAwB,cAAc,KAAK,MAAM,CAAC,yBAC3B,SAAS,KAAK,MAAM,IAAI,MAAM;AAEvD,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,2BAAN,cAAuC,MAAM;AAAA,EAClD,YAAY,UAAkB;AAC5B,UAAM,MAAM,GAAG,QAAQ;AACvB,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,eAAN,cAA2B,MAAM;AAAA,EACtC,YAAY,WAAmB,YAAoB;AACjD,UAAM,MAAM,eAAe,SAAS,IAAI,UAAU;AAClD,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,sBAAN,cAAkC,MAAM;AAAA,EAC7C,YAAY,KAAiB;AAC3B,UAAM,MAAM,wBAAwB,GAAG;AACvC,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,oCAAN,cAAgD,MAAM;AAAA,EAC3D,cAAc;AACZ,UAAM,MAAM;AACZ,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,8BAAN,cAA0C,MAAM;AAAA,EACrD,YAAYC,SAAa;AACvB,UAAM,aAAaA,SAAQ,YAAY,QAAQA,SAAQ,QAAQA;AAC/D,UAAM,MAAM,6BAA6B,UAAU;AACnD,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,sCAAN,cAAkD,MAAM;AAAA,EAC7D,cAAc;AACZ,UAAM,MAAM;AACZ,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,8BAAN,cAA0C,MAAM;AAAA,EACrD,YAAY,MAAc;AACxB,UAAM,MAAM,sCAAsC,IAAI;AACtD,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,4BAAN,cAAwC,MAAM;AAAA,EACnD,YAAY,OAAe;AACzB,UAAM,MAAM,yBAAyB,KAAK;AAC1C,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,0BAAN,cAAsC,MAAM;AAAA,EACjD,YAAY,aAAqB,OAAe;AAC9C,UAAM,MAAM,8CAA8C,WAAW,4BAA4B,KAAK;AACtG,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,uBAAN,cAAmC,MAAM;AAAA,EAC9C,YAAY,aAAqB,WAAmB;AAClD,UAAM,MAAM,aAAa,SAAS,mBAAmB,WAAW;AAChE,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,wBAAN,cAAoC,MAAM;AAAA,EAC/C,YAAY,OAAe,KAAa,KAAa;AACnD,UAAM,MAAM,4BAA4B,GAAG,gBAAgB,GAAG,sBAAsB,KAAK;AACzF,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,6BAAN,cAAyC,MAAM;AAAA,EACpD,cAAc;AACZ,UAAM,MAAM;AACZ,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,wBAAN,cAAoC,MAAM;AAAA,EAC/C,cAAc;AACZ,UAAM,MAAM;AACZ,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,sBAAN,cAAkC,MAAM;AAAA,EAC7C,YAAY,WAAmB;AAC7B,UAAM,MAAM,sDAAsD,SAAS;AAC3E,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,yBAAN,cAAqC,MAAM;AAAA,EAChD,YAAY,WAAmB;AAC7B,UAAM,MAAM,yCAAyC,SAAS;AAC9D,UAAM,GAAG;AAAA,EACX;AACF;AAUO,IAAM,qBAAN,cAAiC,MAAM;AAAA,EAC5C,YAAY,KAAe,OAAe;AACxC,UAAM,MACJ,gCACS,IAAI,IAAI,QAAQ,IAAI,MAAM,WAAW,IAAI,MAAM,OAAO,KAAK;AACtE,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,kBAAN,cAA8B,MAAM;AAAA,EACzC,YAAY,KAAe,SAAiB;AAC1C,UAAM,MACJ,sCACS,IAAI,IAAI,QAAQ,IAAI,MAAM,WAAW,IAAI,MAAM,MAAM,OAAO;AACvE,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,yBAAN,cAAqC,gBAAgB;AAAA,EAC1D,YAAY,KAAe,cAAsB,YAAoB;AACnE,UAAM,MAAM,4BAA4B,YAAY,wBAAwB,UAAU;AACtF,UAAM,KAAK,GAAG;AAAA,EAChB;AACF;AAEO,IAAM,wBAAN,cAAoC,gBAAgB;AAAA,EACzD,YAAY,KAAe,MAAc;AACvC,UAAM,MAAM,gEAAgE,IAAI;AAChF,UAAM,KAAK,GAAG;AAAA,EAChB;AACF;AAEO,IAAM,+BAAN,cAA2C,gBAAgB;AAAA,EAChE,YAAY,KAAe;AACzB,UAAM,MAAM;AACZ,UAAM,KAAK,GAAG;AAAA,EAChB;AACF;AAEO,IAAM,wBAAN,cAAoC,gBAAgB;AAAA,EACzD,YAAY,KAAe;AACzB,UAAM,MAAM;AACZ,UAAM,KAAK,GAAG;AAAA,EAChB;AACF;AAEO,IAAM,6BAAN,cAAyC,gBAAgB;AAAA,EAC9D,YAAY,KAAe;AACzB,UAAM,MAAM;AACZ,UAAM,KAAK,GAAG;AAAA,EAChB;AACF;AAEO,IAAM,qBAAN,cAAiC,gBAAgB;AAAA,EACtD,YAAY,KAAe;AACzB,UAAM,MAAM;AACZ,UAAM,KAAK,GAAG;AAAA,EAChB;AACF;AAEO,IAAM,wBAAN,cAAoC,gBAAgB;AAAA,EACzD,YAAY,KAAe;AACzB,UAAM,MAAM;AACZ,UAAM,KAAK,GAAG;AAAA,EAChB;AACF;AAEO,IAAM,sBAAN,cAAkC,gBAAgB;AAAA,EACvD,YAAY,KAAe,SAAmB;AAC5C,UAAM,MAAM,kCAAkC,cAAc,OAAO,CAAC;AACpE,UAAM,KAAK,GAAG;AAAA,EAChB;AACF;;;AC5NA,IAAK,YAAL,kBAAKC,eAAL;AACE,EAAAA,sBAAA,UAAO,KAAP;AACA,EAAAA,sBAAA,eAAY,KAAZ;AACA,EAAAA,sBAAA,SAAM,KAAN;AACA,EAAAA,sBAAA,aAAU,MAAV;AACA,EAAAA,sBAAA,cAAW,MAAX;AACA,EAAAA,sBAAA,oBAAiB,MAAjB;AACA,EAAAA,sBAAA,WAAQ,MAAR;AACA,EAAAA,sBAAA,sBAAmB,MAAnB;AACA,EAAAA,sBAAA,UAAO,MAAP;AACA,EAAAA,sBAAA,aAAU,MAAV;AACA,EAAAA,sBAAA,eAAY,MAAZ;AACA,EAAAA,sBAAA,gBAAa,MAAb;AACA,EAAAA,sBAAA,UAAO,MAAP;AACA,EAAAA,sBAAA,WAAQ,MAAR;AACA,EAAAA,sBAAA,UAAO,MAAP;AACA,EAAAA,sBAAA,YAAS,MAAT;AACA,EAAAA,sBAAA,kBAAe,MAAf;AACA,EAAAA,sBAAA,UAAO,MAAP;AACA,EAAAA,sBAAA,SAAM,MAAN;AACA,EAAAA,sBAAA,SAAM,MAAN;AACA,EAAAA,sBAAA,WAAQ,MAAR;AACA,EAAAA,sBAAA,UAAO,MAAP;AACA,EAAAA,sBAAA,UAAO,MAAP;AACA,EAAAA,sBAAA,SAAM,MAAN;AACA,EAAAA,sBAAA,WAAQ,MAAR;AACA,EAAAA,sBAAA,WAAQ,MAAR;AACA,EAAAA,sBAAA,UAAO,MAAP;AACA,EAAAA,sBAAA,cAAW,MAAX;AACA,EAAAA,sBAAA,iBAAc,MAAd;AACA,EAAAA,sBAAA,OAAI,MAAJ;AACA,EAAAA,sBAAA,OAAI,MAAJ;AACA,EAAAA,sBAAA,OAAI,MAAJ;AACA,EAAAA,sBAAA,OAAI,MAAJ;AACA,EAAAA,sBAAA,OAAI,MAAJ;AACA,EAAAA,sBAAA,OAAI,MAAJ;AACA,EAAAA,sBAAA,OAAI,MAAJ;AACA,EAAAA,sBAAA,uBAAoB,MAApB;AACA,EAAAA,sBAAA,eAAY,MAAZ;AACA,EAAAA,sBAAA,wBAAqB,MAArB;AACA,EAAAA,sBAAA,OAAI,MAAJ;AACA,EAAAA,sBAAA,OAAI,MAAJ;AACA,EAAAA,sBAAA,OAAI,OAAJ;AACA,EAAAA,sBAAA,OAAI,OAAJ;AACA,EAAAA,sBAAA,OAAI,OAAJ;AACA,EAAAA,sBAAA,OAAI,OAAJ;AACA,EAAAA,sBAAA,OAAI,OAAJ;AACA,EAAAA,sBAAA,OAAI,OAAJ;AACA,EAAAA,sBAAA,OAAI,OAAJ;AACA,EAAAA,sBAAA,OAAI,OAAJ;AACA,EAAAA,sBAAA,OAAI,OAAJ;AACA,EAAAA,sBAAA,OAAI,OAAJ;AACA,EAAAA,sBAAA,OAAI,OAAJ;AACA,EAAAA,sBAAA,OAAI,OAAJ;AACA,EAAAA,sBAAA,OAAI,OAAJ;AACA,EAAAA,sBAAA,OAAI,OAAJ;AACA,EAAAA,sBAAA,eAAY,OAAZ;AACA,EAAAA,sBAAA,gBAAa,OAAb;AACA,EAAAA,sBAAA,WAAQ,OAAR;AA1DG,SAAAA;AAAA,GAAA;AA6DL,IAAO,oBAAQ;;;AC7Df,OAAOC,WAAU;;;ACGjB,IAAM,aAAN,MAAM,WAAU;AAAA,EAON,YAAY,OAAe,OAAe;AAHlD,wBAAiB;AACjB,wBAAiB;AAGf,SAAK,QAAQ,OAAO,KAAK;AACzB,SAAK,QAAQ,OAAO,KAAK;AAAA,EAC3B;AAAA,EAEA,WAAmB;AACjB,UAAM,KAAK,aAAa,GAAG;AAC3B,WAAO,QAAQ,KAAK,KAAK,IAAI,KAAK,KAAK;AAAA,GAAM,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE;AAAA,EAChE;AAAA,EAEA,cAAsB;AACpB,WAAO,KAAK,KAAK,MAAM,SAAS,KAAK,MAAM;AAAA,EAC7C;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,UAAM,gBAAgB;AAEtB,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAE7B,cAAU,qBAAqB,KAAK,OAAO,QAAQ,MAAM;AACzD,WAAO,QAAQ,IAAI,kBAAU;AAC7B,cAAU,qBAAqB,KAAK,OAAO,QAAQ,MAAM;AACzD,WAAO,QAAQ,IAAI,kBAAU;AAE7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI;AACnB,WAAO,QAAQ,IAAI;AACnB,WAAO,QAAQ,IAAI;AACnB,WAAO,QAAQ,IAAI;AAEnB,WAAO,SAAS;AAAA,EAClB;AACF;AA1CE,cADI,YACG,cAAa,CAAC,OAAe,UAClC,IAAI,WAAU,OAAO,KAAK;AAF9B,IAAM,YAAN;AA6CA,IAAO,oBAAQ;;;AC7Cf,IAAM,YAAN,MAAgB;AAAA,EACd,MAAM,UAAkC;AACtC,UAAM,IAAI,0BAA0B,KAAK,YAAY,MAAM,OAAO;AAAA,EACpE;AAAA,EAEA,WAAmB;AACjB,UAAM,IAAI,0BAA0B,KAAK,YAAY,MAAM,UAAU;AAAA,EACvE;AAAA,EAEA,cAAsB;AACpB,UAAM,IAAI,0BAA0B,KAAK,YAAY,MAAM,aAAa;AAAA,EAC1E;AAAA,EAEA,cAAc,SAAqB,SAAyB;AAC1D,UAAM,IAAI,0BAA0B,KAAK,YAAY,MAAM,eAAe;AAAA,EAC5E;AACF;AAEA,IAAO,oBAAQ;;;ACjBf,IAAM,aAAN,MAAM,mBAAkB,kBAAU;AAAA,EAMxB,YAAY,OAAe;AACjC,UAAM;AAJR,wBAAiB;AACjB,wBAAiB;AAIf,SAAK,cAAc;AACnB,SAAK,cAAc,eAAe,KAAK;AAAA,EACzC;AAAA,EAEA,WAAmB;AACjB,WAAO,KAAK;AAAA,EACd;AAAA;AAAA,EAGA,QAAgB;AACd,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,QAAmB;AACjB,WAAO,WAAU,GAAG,KAAK,WAAW;AAAA,EACtC;AAAA,EAEA,WAAmB;AACjB,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,cAAsB;AACpB,WAAO,KAAK,YAAY;AAAA,EAC1B;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,cAAU,qBAAqB,KAAK,aAAa,QAAQ,MAAM;AAC/D,WAAO,KAAK,YAAY;AAAA,EAC1B;AACF;AApCE,cADI,YACG,MAAK,CAAC,UAAkB,IAAI,WAAU,KAAK;AADpD,IAAM,YAAN;AAuCA,IAAO,oBAAQ;;;AC5Bf,IAAM,YAAN,MAAM,kBAAiB,kBAAU;AAAA,EAMvB,YAAY,SAAqB;AACvC,UAAM;AAJR,wBAAiB;AACjB,wBAAiB;AAIf,SAAK,QAAQ,CAAC;AACd,SAAK,UAAU;AAAA,EACjB;AAAA,EAEA,OAAe;AACb,WAAO,KAAK,MAAM;AAAA,EACpB;AAAA,EAEA,KAAK,QAAyB;AAC5B,SAAK,MAAM,KAAK,MAAM;AAAA,EACxB;AAAA,EAEA,OAAO,OAAe,QAAyB;AAC7C,SAAK,MAAM,OAAO,OAAO,GAAG,MAAM;AAAA,EACpC;AAAA,EAEA,QAAQ,QAAuC;AAC7C,UAAM,QAAQ,KAAK,MAAM,QAAQ,MAAM;AACvC,WAAO,UAAU,KAAK,SAAY;AAAA,EACpC;AAAA,EAEA,OAAO,OAAqB;AAC1B,SAAK,MAAM,OAAO,OAAO,CAAC;AAAA,EAC5B;AAAA,EAEA,IAAI,KAAa,QAAyB;AACxC,SAAK,MAAM,GAAG,IAAI;AAAA,EACpB;AAAA,EAEA,IAAI,OAA0B;AAC5B,WAAO,KAAK,MAAM,KAAK;AAAA,EACzB;AAAA,EAyBA,YAAY,UAAkB,OAAc;AAC1C,WAAO,KAAK,QAAQ;AAAA,MAClB,KAAK,IAAI,KAAK;AAAA,MAEd,GAAG;AAAA,IACL;AAAA,EACF;AAAA,EAoBA,OAAO,UAAkB,OAAc;AACrC,WAAO,KAAK,QAAQ;AAAA,MAClB,KAAK,IAAI,KAAK;AAAA,MAEd,GAAG;AAAA,IACL;AAAA,EACF;AAAA,EAEA,cAAuE;AACrE,QAAI,KAAK,KAAK,MAAM,EAAG,OAAM,IAAI,4BAA4B,KAAK,KAAK,CAAC;AAExE,UAAM,aAAa,KAAK,OAAO,GAAG,iBAAS,EAAE,SAAS;AACtD,UAAM,aAAa,KAAK,OAAO,GAAG,iBAAS,EAAE,SAAS;AACtD,UAAM,cAAc,KAAK,OAAO,GAAG,iBAAS,EAAE,SAAS;AACvD,UAAM,cAAc,KAAK,OAAO,GAAG,iBAAS,EAAE,SAAS;AAEvD,UAAM,IAAI;AACV,UAAM,IAAI;AACV,UAAM,QAAQ,cAAc;AAC5B,UAAM,SAAS,cAAc;AAE7B,WAAO,EAAE,GAAG,GAAG,OAAO,OAAO;AAAA,EAC/B;AAAA,EAEA,UAAuB;AACrB,WAAO,KAAK,MAAM,MAAM;AAAA,EAC1B;AAAA,EAEA,MAAM,SAAgC;AACpC,UAAM,QAAQ,UAAS,YAAY,WAAW,KAAK,OAAO;AAC1D,aAAS,MAAM,GAAG,MAAM,KAAK,KAAK,GAAG,MAAM,KAAK,OAAO;AACrD,YAAM,KAAK,KAAK,MAAM,GAAG,CAAC;AAAA,IAC5B;AACA,WAAO;AAAA,EACT;AAAA,EAEA,WAAmB;AACjB,QAAI,cAAc;AAClB,aAAS,MAAM,GAAG,MAAM,KAAK,KAAK,GAAG,MAAM,KAAK,OAAO;AACrD,qBAAe,KAAK,IAAI,GAAG,EAAE,SAAS;AACtC,qBAAe;AAAA,IACjB;AACA,mBAAe;AACf,WAAO;AAAA,EACT;AAAA,EAEA,cAAsB;AACpB,QAAI,OAAO;AACX,aAAS,MAAM,GAAG,MAAM,KAAK,KAAK,GAAG,MAAM,KAAK,OAAO;AACrD,cAAQ,KAAK,IAAI,GAAG,EAAE,YAAY,IAAI;AAAA,IACxC;AACA,WAAO;AAAA,EACT;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,UAAM,gBAAgB;AAEtB,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAS,MAAM,GAAG,MAAM,KAAK,KAAK,GAAG,MAAM,KAAK,OAAO;AACrD,gBAAU,KAAK,IAAI,GAAG,EAAE,cAAc,QAAQ,MAAM;AACpD,aAAO,QAAQ,IAAI,kBAAU;AAAA,IAC/B;AACA,WAAO,QAAQ,IAAI,kBAAU;AAE7B,WAAO,SAAS;AAAA,EAClB;AAAA,EAEA,gBAAgB,GAAW,GAAiB;AAC1C,aAAS,MAAM,GAAG,MAAM,KAAK,KAAK,GAAG,MAAM,KAAK,OAAO;AACrD,YAAM,KAAK,KAAK,OAAO,GAAG;AAC1B,UAAI,cAAc,mBAAW;AAC3B,cAAM,SAAS,MAAM,MAAM,IAAI,IAAI;AACnC,aAAK,IAAI,KAAK,kBAAU,GAAG,GAAG,SAAS,IAAI,MAAM,CAAC;AAAA,MACpD;AAAA,IACF;AAAA,EACF;AACF;AAtKE,cADI,WACG,eAAc,CAAC,YAAwB,IAAI,UAAS,OAAO;AADpE,IAAM,WAAN;AAyKA,IAAO,mBAAQ;;;ACpLf,IAAM,WAAW,CAAC;AAElB,IAAM,WAAN,MAAM,iBAAgB,kBAAU;AAAA,EAMtB,YAAY,UAAe,OAAgB;AACjD,QAAI,aAAa,SAAU,OAAM,IAAI,wBAAwB,SAAS;AACtE,UAAM;AAJR,wBAAiB;AAKf,SAAK,QAAQ;AAAA,EACf;AAAA,EAEA,YAAqB;AACnB,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,QAAiB;AACf,WAAO;AAAA,EACT;AAAA,EAEA,WAAmB;AACjB,WAAO,OAAO,KAAK,KAAK;AAAA,EAC1B;AAAA,EAEA,cAAsB;AACpB,WAAO,KAAK,QAAQ,IAAI;AAAA,EAC1B;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,QAAI,KAAK,OAAO;AACd,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO;AAAA,IACT,OAAO;AACL,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO;AAAA,IACT;AAAA,EACF;AACF;AA3CE,cADI,UACY,QAAO,IAAI,SAAQ,UAAU,IAAI;AACjD,cAFI,UAEY,SAAQ,IAAI,SAAQ,UAAU,KAAK;AAFrD,IAAM,UAAN;AA8CA,IAAO,kBAAQ;;;AClDR,IAAM,cAAc,IAAI,WAAW,GAAG;AAE7C,YAAY,kBAAU,SAAS,IAAI;AACnC,YAAY,kBAAU,UAAU,IAAI;AACpC,YAAY,kBAAU,QAAQ,IAAI;AAClC,YAAY,kBAAU,WAAW,IAAI;AACrC,YAAY,kBAAU,iBAAiB,IAAI;AAC3C,YAAY,kBAAU,kBAAkB,IAAI;AAC5C,YAAY,kBAAU,SAAS,IAAI;AACnC,YAAY,kBAAU,UAAU,IAAI;AACpC,YAAY,kBAAU,YAAY,IAAI;AACtC,YAAY,kBAAU,OAAO,IAAI;;;ACX1B,IAAM,eAAe,IAAI,WAAW,GAAG;AAE9C,aAAa,kBAAU,IAAI,IAAI;AAC/B,aAAa,kBAAU,GAAG,IAAI;AAC9B,aAAa,kBAAU,OAAO,IAAI;AAClC,aAAa,kBAAU,QAAQ,IAAI;AACnC,aAAa,kBAAU,cAAc,IAAI;AACzC,aAAa,kBAAU,KAAK,IAAI;;;ACLzB,IAAM,cAAc,IAAI,WAAW,GAAG;AAE7C,SAAS,MAAM,GAAG,MAAM,KAAK,MAAM,KAAK,OAAO;AAC7C,cAAY,GAAG,IAAI,aAAa,GAAG,KAAK,YAAY,GAAG,IAAI,IAAI;AACjE;AACA,YAAY,kBAAU,IAAI,IAAI;;;ACE9B,IAAM,aAAa,CAAC,SAClB,KAAK,QAAQ,qBAAqB,CAAC,GAAG,QAAQ,gBAAgB,GAAG,CAAC;AAEpE,IAAM,gBAAgB,CAAC,aACrB,YAAY,kBAAU,oBACtB,YAAY,kBAAU,SACtB,CAAC,YAAY,QAAQ;AAEvB,IAAMC,YAAW,CAAC;AAClB,IAAM,OAAO,oBAAI,IAAqB;AAEtC,IAAM,WAAN,MAAM,iBAAgB,kBAAU;AAAA,EA2CtB,YAAY,UAAe,MAAc;AAC/C,QAAI,aAAaA,UAAU,OAAM,IAAI,wBAAwB,SAAS;AACtE,UAAM;AAJR;AAAA,wBAAiB;AAMf,QAAI,cAAc;AAClB,aAAS,MAAM,GAAG,MAAM,KAAK,QAAQ,MAAM,KAAK,OAAO;AACrD,YAAM,YAAY,KAAK,GAAG;AAC1B,YAAM,OAAO,WAAW,SAAS;AACjC,qBAAe,cAAc,IAAI,IAAI,YAAY,IAAI,YAAY,IAAI,CAAC;AAAA,IACxE;AAEA,SAAK,cAAc;AAAA,EACrB;AAAA,EAEA,UAAsB;AACpB,UAAM,QAAkB,CAAC;AAEzB,QAAI,MAAM;AACV,QAAI,UAAU;AAEd,UAAM,WAAW,CAAC,SAAkB;AAClC,UAAI,SAAS,OAAW,OAAM,KAAK,IAAI;AACvC,gBAAU;AAAA,IACZ;AAEA,aAAS,MAAM,GAAG,MAAM,KAAK,YAAY,QAAQ,MAAM,KAAK,OAAO;AACjE,YAAM,OAAO,KAAK,YAAY,GAAG;AACjC,YAAM,OAAO,WAAW,IAAI;AAC5B,YAAM,WAAW,KAAK,YAAY,MAAM,CAAC;AACzC,UAAI,CAAC,SAAS;AACZ,YAAI,SAAS,kBAAU,KAAM,WAAU;AAAA,YAClC,UAAS,IAAI;AAAA,MACpB,OAAO;AACL,YACG,QAAQ,kBAAU,QAAQ,QAAQ,kBAAU,QAC5C,QAAQ,kBAAU,KAAK,QAAQ,kBAAU,KACzC,QAAQ,kBAAU,KAAK,QAAQ,kBAAU,GAC1C;AACA,iBAAO;AACP,cACE,IAAI,WAAW,KACf,EACG,YAAY,OAAO,YAAY,OAC/B,YAAY,OAAO,YAAY,OAC/B,YAAY,OAAO,YAAY,MAElC;AACA,qBAAS,SAAS,KAAK,EAAE,CAAC;AAC1B,kBAAM;AAAA,UACR;AAAA,QACF,OAAO;AACL,mBAAS,IAAI;AAAA,QACf;AAAA,MACF;AAAA,IACF;AAEA,WAAO,IAAI,WAAW,KAAK;AAAA,EAC7B;AAAA;AAAA;AAAA,EAIA,aAAqB;AACnB,UAAM,QAAQ,KAAK,QAAQ;AAC3B,WAAO,OAAO,aAAa,GAAG,MAAM,KAAK,KAAK,CAAC;AAAA,EACjD;AAAA,EAEA,WAAmB;AACjB,WAAO,KAAK;AAAA,EACd;AAAA;AAAA,EAGA,QAAgB;AACd,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,QAAiB;AACf,WAAO;AAAA,EACT;AAAA,EAEA,WAAmB;AACjB,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,cAAsB;AACpB,WAAO,KAAK,YAAY;AAAA,EAC1B;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,cAAU,qBAAqB,KAAK,aAAa,QAAQ,MAAM;AAC/D,WAAO,KAAK,YAAY;AAAA,EAC1B;AACF;AArIE,cADI,UACG,MAAK,CAAC,SAA0B;AACrC,QAAM,eAAe,WAAW,IAAI;AAEpC,MAAI,WAAW,KAAK,IAAI,YAAY;AACpC,MAAI,CAAC,UAAU;AACb,eAAW,IAAI,SAAQA,WAAU,YAAY;AAC7C,SAAK,IAAI,cAAc,QAAQ;AAAA,EACjC;AAEA,SAAO;AACT;AAAA;AAGA,cAdI,UAcY,UAAS,SAAQ,GAAG,QAAQ;AAC5C,cAfI,UAeY,eAAc,SAAQ,GAAG,aAAa;AACtD,cAhBI,UAgBY,aAAY,SAAQ,GAAG,WAAW;AAClD,cAjBI,UAiBY,QAAO,SAAQ,GAAG,MAAM;AACxC,cAlBI,UAkBY,WAAU,SAAQ,GAAG,SAAS;AAC9C,cAnBI,UAmBY,aAAY,SAAQ,GAAG,WAAW;AAClD,cApBI,UAoBY,YAAW,SAAQ,GAAG,UAAU;AAChD,cArBI,UAqBY,QAAO,SAAQ,GAAG,MAAM;AACxC,cAtBI,UAsBY,UAAS,SAAQ,GAAG,QAAQ;AAC5C,cAvBI,UAuBY,YAAW,SAAQ,GAAG,UAAU;AAChD,cAxBI,UAwBY,QAAO,SAAQ,GAAG,MAAM;AACxC,cAzBI,UAyBY,UAAS,SAAQ,GAAG,QAAQ;AAC5C,cA1BI,UA0BY,WAAU,SAAQ,GAAG,SAAS;AAC9C,cA3BI,UA2BY,UAAS,SAAQ,GAAG,QAAQ;AAC5C,cA5BI,UA4BY,YAAW,SAAQ,GAAG,UAAU;AAChD,cA7BI,UA6BY,WAAU,SAAQ,GAAG,SAAS;AAC9C,cA9BI,UA8BY,UAAS,SAAQ,GAAG,QAAQ;AAC5C,cA/BI,UA+BY,SAAQ,SAAQ,GAAG,OAAO;AAC1C,cAhCI,UAgCY,UAAS,SAAQ,GAAG,QAAQ;AAC5C,cAjCI,UAiCY,WAAU,SAAQ,GAAG,SAAS;AAC9C,cAlCI,UAkCY,WAAU,SAAQ,GAAG,SAAS;AAC9C,cAnCI,UAmCY,YAAW,SAAQ,GAAG,UAAU;AAChD,cApCI,UAoCY,YAAW,SAAQ,GAAG,UAAU;AAChD,cArCI,UAqCY,gBAAe,SAAQ,GAAG,cAAc;AACxD,cAtCI,UAsCY,WAAU,SAAQ,GAAG,SAAS;AAtChD,IAAM,UAAN;AAwIA,IAAO,kBAAQ;;;AC3Jf,IAAM,UAAN,cAAsB,kBAAU;AAAA,EAC9B,SAAe;AACb,WAAO;AAAA,EACT;AAAA,EAEA,QAAiB;AACf,WAAO;AAAA,EACT;AAAA,EAEA,WAAmB;AACjB,WAAO;AAAA,EACT;AAAA,EAEA,cAAsB;AACpB,WAAO;AAAA,EACT;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO;AAAA,EACT;AACF;AAEA,IAAO,kBAAQ,IAAI,QAAQ;;;ACd3B,IAAM,WAAN,MAAM,iBAAgB,kBAAU;AAAA,EAUpB,YAAY,KAAc,SAAqB;AACvD,UAAM;AALR,wBAAS;AAET,wBAAiB;AAIf,SAAK,OAAO;AACZ,SAAK,UAAU;AAAA,EACjB;AAAA,EAEA,OAAkB;AAChB,WAAO,MAAM,KAAK,KAAK,KAAK,KAAK,CAAC;AAAA,EACpC;AAAA,EAEA,SAAsB;AACpB,WAAO,MAAM,KAAK,KAAK,KAAK,OAAO,CAAC;AAAA,EACtC;AAAA,EAEA,UAAkC;AAChC,WAAO,MAAM,KAAK,KAAK,KAAK,QAAQ,CAAC;AAAA,EACvC;AAAA,EAEA,IAAI,KAAc,OAAwB;AACxC,SAAK,KAAK,IAAI,KAAK,KAAK;AAAA,EAC1B;AAAA,EAEA,IACE,KAGA,kBAAkB,OACK;AACvB,UAAM,QAAQ,KAAK,KAAK,IAAI,GAAG;AAC/B,QAAI,UAAU,mBAAW,CAAC,gBAAiB,QAAO;AAClD,WAAO;AAAA,EACT;AAAA,EAEA,IAAI,KAAuB;AACzB,UAAM,QAAQ,KAAK,KAAK,IAAI,GAAG;AAC/B,WAAO,UAAU,UAAa,UAAU;AAAA,EAC1C;AAAA,EAgCA,YAAY,QAAiB,OAAc;AAGzC,UAAM,kBAAkB,MAAM,SAAS,eAAO;AAE9C,UAAM,QAAQ,KAAK,QAAQ;AAAA,MACzB,KAAK,IAAI,KAAK,eAAe;AAAA,MAE7B,GAAG;AAAA,IACL;AAEA,QAAI,UAAU,mBAAW,CAAC,gBAAiB,QAAO;AAElD,WAAO;AAAA,EACT;AAAA,EA8BA,OAAO,QAAiB,OAAc;AAGpC,UAAM,kBAAkB,MAAM,SAAS,eAAO;AAE9C,UAAM,QAAQ,KAAK,QAAQ;AAAA,MACzB,KAAK,IAAI,KAAK,eAAe;AAAA,MAE7B,GAAG;AAAA,IACL;AAEA,QAAI,UAAU,mBAAW,CAAC,gBAAiB,QAAO;AAElD,WAAO;AAAA,EACT;AAAA,EAEA,OAAO,KAAuB;AAC5B,WAAO,KAAK,KAAK,OAAO,GAAG;AAAA,EAC7B;AAAA,EAEA,QAAiC;AAC/B,WAAO,IAAI,IAAI,KAAK,IAAI;AAAA,EAC1B;AAAA;AAAA,EAGA,UAAU,MAAM,IAAa;AAC3B,UAAM,eAAe,KAAK,KAAK;AAC/B,QAAI,MAAM,gBAAQ,GAAG,KAAK,QAAQ,gBAAgB,KAAK,EAAE,CAAC;AAC1D,WAAO,aAAa,SAAS,GAAG,GAAG;AACjC,YAAM,gBAAQ,GAAG,KAAK,QAAQ,gBAAgB,KAAK,EAAE,CAAC;AAAA,IACxD;AACA,WAAO;AAAA,EACT;AAAA,EAEA,MAAM,SAA+B;AACnC,UAAM,QAAQ,SAAQ,YAAY,WAAW,KAAK,OAAO;AACzD,UAAM,UAAU,KAAK,QAAQ;AAC7B,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,CAAC,KAAK,KAAK,IAAI,QAAQ,GAAG;AAChC,YAAM,IAAI,KAAK,KAAK;AAAA,IACtB;AACA,WAAO;AAAA,EACT;AAAA,EAEA,WAAmB;AACjB,QAAI,aAAa;AACjB,UAAM,UAAU,KAAK,QAAQ;AAC7B,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,CAAC,KAAK,KAAK,IAAI,QAAQ,GAAG;AAChC,oBAAc,IAAI,SAAS,IAAI,MAAM,MAAM,SAAS,IAAI;AAAA,IAC1D;AACA,kBAAc;AACd,WAAO;AAAA,EACT;AAAA,EAEA,cAAsB;AACpB,QAAI,OAAO;AACX,UAAM,UAAU,KAAK,QAAQ;AAC7B,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,CAAC,KAAK,KAAK,IAAI,QAAQ,GAAG;AAChC,cAAQ,IAAI,YAAY,IAAI,MAAM,YAAY,IAAI;AAAA,IACpD;AACA,WAAO;AAAA,EACT;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,UAAM,gBAAgB;AAEtB,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAE7B,UAAM,UAAU,KAAK,QAAQ;AAC7B,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,CAAC,KAAK,KAAK,IAAI,QAAQ,GAAG;AAChC,gBAAU,IAAI,cAAc,QAAQ,MAAM;AAC1C,aAAO,QAAQ,IAAI,kBAAU;AAC7B,gBAAU,MAAM,cAAc,QAAQ,MAAM;AAC5C,aAAO,QAAQ,IAAI,kBAAU;AAAA,IAC/B;AAEA,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAE7B,WAAO,SAAS;AAAA,EAClB;AACF;AA/ME,cADI,UACG,eAAc,CAAC,YAAwB,IAAI,SAAQ,oBAAI,IAAI,GAAG,OAAO;AAE5E,cAHI,UAGG,sBAAqB,CAAC,KAAc,YACzC,IAAI,SAAQ,KAAK,OAAO;AAJ5B,IAAM,UAAN;AAkNA,IAAO,kBAAQ;;;ACzNf,IAAM,YAAN,cAAwB,kBAAU;AAAA,EAGhC,YAAY,MAAe;AACzB,UAAM;AAHR,wBAAS;AAIP,SAAK,OAAO;AAAA,EACd;AAAA,EAEA,MAAM,UAAkC;AACtC,UAAM,IAAI,0BAA0B,KAAK,YAAY,MAAM,OAAO;AAAA,EACpE;AAAA,EAEA,oBAA4B;AAC1B,UAAM,IAAI;AAAA,MACR,KAAK,YAAY;AAAA,MACjB;AAAA,IACF;AAAA,EACF;AAAA,EAEA,cAA0B;AACxB,UAAM,IAAI,0BAA0B,KAAK,YAAY,MAAM,aAAa;AAAA,EAC1E;AAAA,EAEA,kBAA0B;AACxB,UAAM,IAAI;AAAA,MACR,KAAK,YAAY;AAAA,MACjB;AAAA,IACF;AAAA,EACF;AAAA,EAEA,aAAmB;AACjB,UAAM,eAAe,KAAK,gBAAgB;AAC1C,SAAK,KAAK,IAAI,gBAAQ,QAAQ,kBAAU,GAAG,YAAY,CAAC;AAAA,EAC1D;AAAA,EAEA,cAAsB;AACpB,SAAK,WAAW;AAChB,WAAO,KAAK,KAAK,YAAY,IAAI,KAAK,gBAAgB,IAAI;AAAA,EAC5D;AAAA,EAEA,WAAmB;AACjB,SAAK,WAAW;AAChB,QAAI,eAAe,KAAK,KAAK,SAAS;AACtC,oBAAgB;AAChB,oBAAgB,KAAK,kBAAkB;AACvC,oBAAgB;AAChB,WAAO;AAAA,EACT;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,SAAK,WAAW;AAChB,UAAM,gBAAgB;AAEtB,cAAU,KAAK,KAAK,cAAc,QAAQ,MAAM;AAChD,WAAO,QAAQ,IAAI,kBAAU;AAE7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAE7B,UAAM,WAAW,KAAK,YAAY;AAClC,aAAS,MAAM,GAAG,MAAM,SAAS,QAAQ,MAAM,KAAK,OAAO;AACzD,aAAO,QAAQ,IAAI,SAAS,GAAG;AAAA,IACjC;AAEA,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAE7B,WAAO,SAAS;AAAA,EAClB;AACF;AAEA,IAAO,oBAAQ;;;ACvFf,IAAM,gBAAN,MAAM,sBAAqB,kBAAU;AAAA,EAM3B,YAAY,MAAe,UAAsB;AACvD,UAAM,IAAI;AAHZ,wBAAS;AAIP,SAAK,WAAW;AAAA,EAClB;AAAA,EAEA,eAA2B;AACzB,WAAO,KAAK,SAAS,MAAM;AAAA,EAC7B;AAAA,EAEA,MAAM,SAAoC;AACxC,WAAO,cAAa,GAAG,KAAK,KAAK,MAAM,OAAO,GAAG,KAAK,SAAS,MAAM,CAAC;AAAA,EACxE;AAAA,EAEA,oBAA4B;AAC1B,WAAO,cAAc,KAAK,QAAQ;AAAA,EACpC;AAAA,EAEA,cAA0B;AACxB,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,kBAA0B;AACxB,WAAO,KAAK,SAAS;AAAA,EACvB;AACF;AA7BE,cADI,eACG,MAAK,CAAC,MAAe,aAC1B,IAAI,cAAa,MAAM,QAAQ;AAFnC,IAAM,eAAN;AAgCA,IAAO,uBAAQ;;;ACjCf,IAAMC,YAAW,CAAC;AAClB,IAAMC,QAAO,oBAAI,IAAoB;AAErC,IAAM,UAAN,MAAM,gBAAe,kBAAU;AAAA,EAiBrB,YACN,UACA,cACA,kBACA;AACA,QAAI,aAAaD,UAAU,OAAM,IAAI,wBAAwB,QAAQ;AACrE,UAAM;AAVR,wBAAS;AACT,wBAAS;AACT,wBAAS;AASP,SAAK,eAAe;AACpB,SAAK,mBAAmB;AACxB,SAAK,MAAM,GAAG,YAAY,IAAI,gBAAgB;AAAA,EAChD;AAAA,EAEA,QAAgB;AACd,WAAO;AAAA,EACT;AAAA,EAEA,WAAmB;AACjB,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,cAAsB;AACpB,WAAO,KAAK,IAAI;AAAA,EAClB;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,cAAU,qBAAqB,KAAK,KAAK,QAAQ,MAAM;AACvD,WAAO,KAAK,IAAI;AAAA,EAClB;AACF;AA5CE,cADI,SACG,MAAK,CAAC,cAAsB,mBAAmB,MAAM;AAC1D,QAAM,MAAM,GAAG,YAAY,IAAI,gBAAgB;AAE/C,MAAI,WAAWC,MAAK,IAAI,GAAG;AAC3B,MAAI,CAAC,UAAU;AACb,eAAW,IAAI,QAAOD,WAAU,cAAc,gBAAgB;AAC9D,IAAAC,MAAK,IAAI,KAAK,QAAQ;AAAA,EACxB;AAEA,SAAO;AACT;AAXF,IAAM,SAAN;AA+CA,IAAO,iBAAQ;;;ACnCf,IAAM,eAAN,MAAM,aAAY;AAAA,EAOR,YAAY,MAAwB,MAAyB;AAHrE,wBAAiB;AACjB,wBAAiB;AAGf,SAAK,OAAO;AACZ,SAAK,OAAO,QAAQ,CAAC;AAAA,EACvB;AAAA,EAEA,MAAM,SAAmC;AACvC,UAAM,OAAO,IAAI,MAAM,KAAK,KAAK,MAAM;AACvC,aAAS,MAAM,GAAG,MAAM,KAAK,QAAQ,MAAM,KAAK,OAAO;AACrD,YAAM,MAAM,KAAK,KAAK,GAAG;AACzB,WAAK,GAAG,IAAI,eAAe,oBAAY,IAAI,MAAM,OAAO,IAAI;AAAA,IAC9D;AACA,WAAO,aAAY,GAAG,KAAK,MAAM,IAAI;AAAA,EACvC;AAAA,EAEA,WAAmB;AACjB,QAAI,QAAQ;AACZ,aAAS,MAAM,GAAG,MAAM,KAAK,KAAK,QAAQ,MAAM,KAAK,OAAO;AAC1D,eAAS,OAAO,KAAK,KAAK,GAAG,CAAC,IAAI;AAAA,IACpC;AACA,aAAS,KAAK;AACd,WAAO;AAAA,EACT;AAAA,EAEA,cAAsB;AACpB,QAAI,OAAO;AACX,aAAS,MAAM,GAAG,MAAM,KAAK,KAAK,QAAQ,MAAM,KAAK,OAAO;AAC1D,YAAM,MAAM,KAAK,KAAK,GAAG;AACzB,eAAS,eAAe,oBAAY,IAAI,YAAY,IAAI,IAAI,UAAU;AAAA,IACxE;AACA,YAAQ,KAAK,KAAK;AAClB,WAAO;AAAA,EACT;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,UAAM,gBAAgB;AAEtB,aAAS,MAAM,GAAG,MAAM,KAAK,KAAK,QAAQ,MAAM,KAAK,OAAO;AAC1D,YAAM,MAAM,KAAK,KAAK,GAAG;AACzB,UAAI,eAAe,mBAAW;AAC5B,kBAAU,IAAI,cAAc,QAAQ,MAAM;AAAA,MAC5C,OAAO;AACL,kBAAU,qBAAqB,KAAK,QAAQ,MAAM;AAAA,MACpD;AACA,aAAO,QAAQ,IAAI,kBAAU;AAAA,IAC/B;AAEA,cAAU,qBAAqB,KAAK,MAAM,QAAQ,MAAM;AAExD,WAAO,SAAS;AAAA,EAClB;AACF;AAxDE,cADI,cACG,MAAK,CAAC,MAAwB,SACnC,IAAI,aAAY,MAAM,IAAI;AAF9B,IAAM,cAAN;AA2DA,IAAO,sBAAQ;;;AC9Ef,IAAK,mBAAL,kBAAKC,sBAAL;AAEE,EAAAA,kBAAA,sBAAmB;AACnB,EAAAA,kBAAA,uBAAoB;AACpB,EAAAA,kBAAA,yBAAsB;AACtB,EAAAA,kBAAA,0BAAuB;AACvB,EAAAA,kBAAA,0BAAuB;AACvB,EAAAA,kBAAA,2BAAwB;AAGxB,EAAAA,kBAAA,mBAAgB;AAChB,EAAAA,kBAAA,oBAAiB;AACjB,EAAAA,kBAAA,sBAAmB;AACnB,EAAAA,kBAAA,uBAAoB;AACpB,EAAAA,kBAAA,uBAAoB;AACpB,EAAAA,kBAAA,wBAAqB;AAGrB,EAAAA,kBAAA,gCAA6B;AAC7B,EAAAA,kBAAA,wBAAqB;AACrB,EAAAA,kBAAA,sBAAmB;AACnB,EAAAA,kBAAA,iCAA8B;AAC9B,EAAAA,kBAAA,wBAAqB;AACrB,EAAAA,kBAAA,gBAAa;AAGb,EAAAA,kBAAA,gCAA6B;AAC7B,EAAAA,kBAAA,sBAAmB;AACnB,EAAAA,kBAAA,uBAAoB;AACpB,EAAAA,kBAAA,iBAAc;AACd,EAAAA,kBAAA,4BAAyB;AACzB,EAAAA,kBAAA,qBAAkB;AAClB,EAAAA,kBAAA,wBAAqB;AACrB,EAAAA,kBAAA,sBAAmB;AACnB,EAAAA,kBAAA,uBAAoB;AACpB,EAAAA,kBAAA,kBAAe;AACf,EAAAA,kBAAA,mBAAgB;AAChB,EAAAA,kBAAA,wBAAqB;AAGrB,EAAAA,kBAAA,qBAAkB;AAClB,EAAAA,kBAAA,sBAAmB;AACnB,EAAAA,kBAAA,0BAAuB;AACvB,EAAAA,kBAAA,oBAAiB;AACjB,EAAAA,kBAAA,iBAAc;AACd,EAAAA,kBAAA,iBAAc;AACd,EAAAA,kBAAA,oBAAiB;AACjB,EAAAA,kBAAA,+BAA4B;AAC5B,EAAAA,kBAAA,+BAA4B;AAC5B,EAAAA,kBAAA,eAAY;AACZ,EAAAA,kBAAA,uBAAoB;AACpB,EAAAA,kBAAA,gCAA6B;AAC7B,EAAAA,kBAAA,kCAA+B;AAC/B,EAAAA,kBAAA,aAAU;AACV,EAAAA,kBAAA,0BAAuB;AACvB,EAAAA,kBAAA,iBAAc;AACd,EAAAA,kBAAA,0BAAuB;AACvB,EAAAA,kBAAA,iBAAc;AACd,EAAAA,kBAAA,uBAAoB;AACpB,EAAAA,kBAAA,YAAS;AACT,EAAAA,kBAAA,YAAS;AACT,EAAAA,kBAAA,iBAAc;AACd,EAAAA,kBAAA,gBAAa;AAGb,EAAAA,kBAAA,eAAY;AACZ,EAAAA,kBAAA,aAAU;AACV,EAAAA,kBAAA,cAAW;AACX,EAAAA,kBAAA,wBAAqB;AACrB,EAAAA,kBAAA,cAAW;AACX,EAAAA,kBAAA,yBAAsB;AACtB,EAAAA,kBAAA,oBAAiB;AACjB,EAAAA,kBAAA,8BAA2B;AAC3B,EAAAA,kBAAA,uBAAoB;AACpB,EAAAA,kBAAA,0BAAuB;AACvB,EAAAA,kBAAA,iBAAc;AACd,EAAAA,kBAAA,oBAAiB;AACjB,EAAAA,kBAAA,cAAW;AACX,EAAAA,kBAAA,sBAAmB;AACnB,EAAAA,kBAAA,kBAAe;AACf,EAAAA,kBAAA,0BAAuB;AAGvB,EAAAA,kBAAA,aAAU;AACV,EAAAA,kBAAA,aAAU;AAGV,EAAAA,kBAAA,+BAA4B;AAC5B,EAAAA,kBAAA,6BAA0B;AAxFvB,SAAAA;AAAA,GAAA;AA2FL,IAAO,2BAAQ;;;AC3Ff,OAAO,UAAU;AAQjB,IAAM,iBAAN,cAA6B,kBAAU;AAAA,EAIrC,YAAY,MAAe,QAAiB;AAC1C,UAAM,IAAI;AAJZ,wBAAmB;AACnB,wBAAmB;AAWnB,2CAAkB,MAAkB;AAClC,YAAM,oBAAoB,KAAK,qBAAqB;AACpD,aAAO,KAAK,SAAS,KAAK,QAAQ,iBAAiB,IAAI;AAAA,IACzD;AATE,SAAK,SAAS;AAEd,QAAI,OAAQ,MAAK,IAAI,gBAAQ,GAAG,QAAQ,GAAG,gBAAQ,GAAG,aAAa,CAAC;AACpE,SAAK,gBAAgB,cAAM,YAAY,KAAK,eAAe;AAAA,EAC7D;AAAA,EAOA,cAA0B;AACxB,WAAO,KAAK,cAAc,OAAO;AAAA,EACnC;AAAA,EAEA,kBAA0B;AACxB,WAAO,KAAK,cAAc,OAAO,EAAE;AAAA,EACrC;AAAA,EAEA,uBAAmC;AACjC,UAAM,IAAI;AAAA,MACR,KAAK,YAAY;AAAA,MACjB;AAAA,IACF;AAAA,EACF;AACF;AAEA,IAAO,yBAAQ;;;ACpCf,IAAM,oBAAN,MAAM,0BAAyB,uBAAe;AAAA,EAMpC,YAAY,MAAe,WAA0B,SAAS,MAAM;AAC1E,UAAM,MAAM,MAAM;AAHpB,wBAAiB;AAIf,SAAK,YAAY;AAAA,EACnB;AAAA,EAEA,QAAQ,WAAgC;AACtC,SAAK,UAAU,KAAK,GAAG,SAAS;AAAA,EAClC;AAAA,EAEA,MAAM,SAAwC;AAC5C,UAAM,YAAY,IAAI,MAAM,KAAK,UAAU,MAAM;AACjD,aAAS,MAAM,GAAG,MAAM,KAAK,UAAU,QAAQ,MAAM,KAAK,OAAO;AAC/D,gBAAU,GAAG,IAAI,KAAK,UAAU,GAAG,EAAE,MAAM,OAAO;AAAA,IACpD;AACA,UAAM,EAAE,MAAM,OAAO,IAAI;AACzB,WAAO,kBAAiB,GAAG,KAAK,MAAM,OAAO,GAAG,WAAW,MAAM;AAAA,EACnE;AAAA,EAEA,oBAA4B;AAC1B,QAAI,QAAQ;AACZ,aAAS,MAAM,GAAG,MAAM,KAAK,UAAU,QAAQ,MAAM,KAAK,OAAO;AAC/D,eAAS,GAAG,KAAK,UAAU,GAAG,CAAC;AAAA;AAAA,IACjC;AACA,WAAO;AAAA,EACT;AAAA,EAEA,uBAAmC;AACjC,UAAM,SAAS,IAAI,WAAW,KAAK,yBAAyB,CAAC;AAC7D,QAAI,SAAS;AACb,aAAS,MAAM,GAAG,MAAM,KAAK,UAAU,QAAQ,MAAM,KAAK,OAAO;AAC/D,gBAAU,KAAK,UAAU,GAAG,EAAE,cAAc,QAAQ,MAAM;AAC1D,aAAO,QAAQ,IAAI,kBAAU;AAAA,IAC/B;AACA,WAAO;AAAA,EACT;AAAA,EAEA,2BAAmC;AACjC,QAAI,OAAO;AACX,aAAS,MAAM,GAAG,MAAM,KAAK,UAAU,QAAQ,MAAM,KAAK,OAAO;AAC/D,cAAQ,KAAK,UAAU,GAAG,EAAE,YAAY,IAAI;AAAA,IAC9C;AACA,WAAO;AAAA,EACT;AACF;AAhDE,cADI,mBACG,MAAK,CAAC,MAAe,WAA0B,SAAS,SAC7D,IAAI,kBAAiB,MAAM,WAAW,MAAM;AAFhD,IAAM,mBAAN;AAmDA,IAAO,2BAAQ;;;AClDR,IAAM,aAAN,MAAM,WAAU;AAAA,EAKb,YAAY,MAAc;AAFlC,wBAAQ;AAGN,SAAK,OAAO;AAAA,EACd;AAAA,EAEA,UAAkB;AAChB,UAAM,IAAI,KAAK,IAAI,KAAK,MAAM,IAAI;AAClC,WAAO,IAAI,KAAK,MAAM,CAAC;AAAA,EACzB;AACF;AAZE,cADW,YACJ,YAAW,CAAC,SAAiB,IAAI,WAAU,IAAI;AADjD,IAAM,YAAN;;;AnBkCP,IAAM,0BAA0B,CAC9B,CAAC,CAAC,GACF,CAAC,CAAC,MACC,EAAE,eAAe,EAAE;AAExB,IAAM,cAAN,MAAM,YAAW;AAAA,EAkBP,cAAc;AAftB;AACA;AACA;AAMA;AAEA,wBAAiB;AAEjB,wBAAQ;AACR,wBAAQ;AAGN,SAAK,sBAAsB;AAC3B,SAAK,SAAS,kBAAU,WAAW,GAAG,CAAC;AACvC,SAAK,cAAc,CAAC;AAEpB,SAAK,kBAAkB,oBAAI,IAAI;AAC/B,SAAK,MAAM,UAAU,SAAS,CAAC;AAAA,EACjC;AAAA,EAEA,OAAO,KAAa,QAAyB;AAC3C,SAAK,gBAAgB,IAAI,KAAK,MAAM;AACpC,QAAI,IAAI,eAAe,KAAK,qBAAqB;AAC/C,WAAK,sBAAsB,IAAI;AAAA,IACjC;AAAA,EACF;AAAA,EAEA,UAAkB;AAChB,SAAK,uBAAuB;AAC5B,WAAO,eAAO,GAAG,KAAK,mBAAmB;AAAA,EAC3C;AAAA,EAEA,SAAS,QAA2B;AAClC,UAAM,MAAM,KAAK,QAAQ;AACzB,SAAK,OAAO,KAAK,MAAM;AACvB,WAAO;AAAA,EACT;AAAA,EAEA,OAAO,KAAsB;AAC3B,WAAO,KAAK,gBAAgB,OAAO,GAAG;AAAA,EACxC;AAAA,EAqBA,YAAY,QAAmB,OAAc;AAG3C,UAAM,kBAAkB,MAAM,SAAS,eAAO;AAE9C,UAAM,SAAS,eAAe,iBAAS,KAAK,gBAAgB,IAAI,GAAG,IAAI;AAEvE,QAAI,CAAC,UAAW,WAAW,mBAAW,CAAC,gBAAkB,QAAO;AAEhE,aAAS,MAAM,GAAG,MAAM,MAAM,QAAQ,MAAM,KAAK,OAAO;AACtD,YAAM,OAAO,MAAM,GAAG;AACtB,UAAI,SAAS,iBAAS;AACpB,YAAI,WAAW,gBAAS,QAAO;AAAA,MACjC,OAAO;AACL,YAAI,kBAAkB,KAAM,QAAO;AAAA,MACrC;AAAA,IACF;AACA,UAAM,IAAI,0BAA0B,OAAO,MAAM;AAAA,EACnD;AAAA,EAmBA,OAAO,QAAmB,OAAc;AACtC,UAAM,SAAS,eAAe,iBAAS,KAAK,gBAAgB,IAAI,GAAG,IAAI;AAEvE,QAAI,MAAM,WAAW,EAAG,QAAO;AAE/B,aAAS,MAAM,GAAG,MAAM,MAAM,QAAQ,MAAM,KAAK,OAAO;AACtD,YAAM,OAAO,MAAM,GAAG;AACtB,UAAI,SAAS,iBAAS;AACpB,YAAI,WAAW,gBAAS,QAAO;AAAA,MACjC,OAAO;AACL,YAAI,kBAAkB,KAAM,QAAO;AAAA,MACrC;AAAA,IACF;AAEA,UAAM,IAAI,0BAA0B,OAAO,MAAM;AAAA,EACnD;AAAA,EAEA,aAAa,WAA0C;AACrD,UAAM,UAAU,MAAM,KAAK,KAAK,gBAAgB,QAAQ,CAAC;AACzD,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,CAAC,KAAK,MAAM,IAAI,QAAQ,GAAG;AACjC,UAAI,WAAW,WAAW;AACxB,eAAO;AAAA,MACT;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,2BAAkD;AAChD,WAAO,MAAM,KAAK,KAAK,gBAAgB,QAAQ,CAAC,EAAE;AAAA,MAChD;AAAA,IACF;AAAA,EACF;AAAA,EASA,IAAI,SAAkB;AACpB,QAAI,mBAAmB,mBAAW;AAChC,aAAO;AAAA,IACT,WAAW,YAAY,QAAQ,YAAY,QAAW;AACpD,aAAO;AAAA,IACT,WAAW,OAAO,YAAY,UAAU;AACtC,aAAO,gBAAQ,GAAG,OAAO;AAAA,IAC3B,WAAW,OAAO,YAAY,UAAU;AACtC,aAAO,kBAAU,GAAG,OAAO;AAAA,IAC7B,WAAW,OAAO,YAAY,WAAW;AACvC,aAAO,UAAU,gBAAQ,OAAO,gBAAQ;AAAA,IAC1C,WAAW,MAAM,QAAQ,OAAO,GAAG;AACjC,YAAM,QAAQ,iBAAS,YAAY,IAAI;AACvC,eAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,cAAM,KAAK,KAAK,IAAI,QAAQ,GAAG,CAAC,CAAC;AAAA,MACnC;AACA,aAAO;AAAA,IACT,OAAO;AACL,YAAM,OAAO,gBAAQ,YAAY,IAAI;AACrC,YAAM,OAAO,OAAO,KAAK,OAAO;AAChC,eAAS,MAAM,GAAG,MAAM,KAAK,QAAQ,MAAM,KAAK,OAAO;AACrD,cAAM,MAAM,KAAK,GAAG;AACpB,cAAM,QAAS,QAA0B,GAAG;AAC5C,YAAI,UAAU,OAAW,MAAK,IAAI,gBAAQ,GAAG,GAAG,GAAG,KAAK,IAAI,KAAK,CAAC;AAAA,MACpE;AACA,aAAO;AAAA,IACT;AAAA,EACF;AAAA,EAEA,OACE,UACA,OAAsB,CAAC,GACT;AACd,WAAO,qBAAa,GAAG,KAAK,IAAI,IAAI,GAAG,cAAc,QAAQ,CAAC;AAAA,EAChE;AAAA,EAEA,YACE,UACA,OAAsB,CAAC,GACT;AACd,WAAO,KAAK,OAAOC,MAAK,QAAQ,cAAc,QAAQ,CAAC,GAAG;AAAA,MACxD,GAAG;AAAA,MACH,QAAQ;AAAA,IACV,CAAC;AAAA,EACH;AAAA,EAEA,cACE,WACA,OAAsB,CAAC,GACL;AAClB,WAAO,yBAAiB,GAAG,KAAK,IAAI,IAAI,GAAG,SAAS;AAAA,EACtD;AAAA,EAEA,YACE,WACA,OAAsB,CAAC,GACL;AAClB,WAAO,KAAK,cAAc,WAAW;AAAA,MACnC,MAAM,KAAK,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC;AAAA,MAC3B,QAAQ,KAAK,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;AAAA,MACnC,GAAG;AAAA,MACH,MAAM;AAAA,MACN,SAAS;AAAA,IACX,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,oCAA4C;AAC1C,QAAI,KAAK,mCAAmC;AAC1C,aAAO,KAAK;AAAA,IACd;AACA,UAAM,OAAO,KAAK,IAAI,CAAC,CAAC;AACxB,UAAM,KAAK,oBAAY,GAAG,yBAAI,iBAAiB;AAC/C,UAAMC,UAAS,yBAAiB,GAAG,MAAM,CAAC,EAAE,CAAC;AAC7C,SAAK,oCAAoC,KAAK,SAASA,OAAM;AAC7D,WAAO,KAAK;AAAA,EACd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,mCAA2C;AACzC,QAAI,KAAK,kCAAkC;AACzC,aAAO,KAAK;AAAA,IACd;AACA,UAAM,OAAO,KAAK,IAAI,CAAC,CAAC;AACxB,UAAM,KAAK,oBAAY,GAAG,yBAAI,gBAAgB;AAC9C,UAAMA,UAAS,yBAAiB,GAAG,MAAM,CAAC,EAAE,CAAC;AAC7C,SAAK,mCAAmC,KAAK,SAASA,OAAM;AAC5D,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,gBAAgB,QAAgB,eAAe,GAAW;AACxD,WAAO,GAAG,MAAM,IAAI,KAAK,MAAM,KAAK,IAAI,QAAQ,IAAI,MAAM,YAAY,CAAC;AAAA,EACzE;AACF;AAzPE,cADI,aACG,UAAS,MAAM,IAAI,YAAW;AADvC,IAAM,aAAN;AA4PA,IAAO,qBAAQ;;;AoBhSf,IAAM,eAAN,MAAM,qBAAoB,gBAAQ;AAAA,EA0BxB,YACN,KACA,SACA,mBAAmB,MACnB;AACA,UAAM,KAAK,OAAO;AARpB,wBAAQ,cAAa;AACrB,wBAAiB;AAQf,SAAK,mBAAmB;AAAA,EAC1B;AAAA,EAEA,MAAM,SAAmC;AACvC,UAAM,QAAQ,aAAY;AAAA,MACxB,oBAAI,IAAI;AAAA,MACR,WAAW,KAAK;AAAA,MAChB,KAAK;AAAA,IACP;AACA,UAAM,UAAU,KAAK,QAAQ;AAC7B,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,CAAC,KAAK,KAAK,IAAI,QAAQ,GAAG;AAChC,YAAM,IAAI,KAAK,KAAK;AAAA,IACtB;AACA,WAAO;AAAA,EACT;AAAA,EAEA,SAAkC;AAChC,WAAO,KAAK,YAAY,gBAAQ,QAAQ,eAAO;AAAA,EACjD;AAAA,EAEA,WAA6C;AAC3C,WAAO,KAAK,OAAO,gBAAQ,GAAG,UAAU,CAAC;AAAA,EAI3C;AAAA,EAEA,SAA+B;AAC7B,WAAO,KAAK,YAAY,gBAAQ,QAAQ,gBAAQ;AAAA,EAClD;AAAA,EAEA,WAAiC;AAC/B,WAAO,KAAK,YAAY,gBAAQ,UAAU,gBAAQ;AAAA,EACpD;AAAA,EAEA,UAAgC;AAC9B,WAAO,KAAK,YAAY,gBAAQ,SAAS,gBAAQ;AAAA,EACnD;AAAA,EAEA,SAA+B;AAC7B,WAAO,KAAK,YAAY,gBAAQ,QAAQ,gBAAQ;AAAA,EAClD;AAAA,EAEA,YAAiC;AAC/B,UAAM,YAAY,KAAK,wBAAwB,gBAAQ,SAAS;AAChE,WAAO,KAAK,QAAQ,YAAY,WAAW,eAAO;AAAA,EACpD;AAAA,EAEA,WAAqB;AACnB,UAAM,aAAa,KAAK,wBAAwB,gBAAQ,QAAQ;AAChE,WAAO,KAAK,QAAQ,OAAO,YAAY,gBAAQ;AAAA,EACjD;AAAA,EAEA,UAAgC;AAC9B,UAAM,aAAa,KAAK,wBAAwB,gBAAQ,OAAO;AAC/D,WAAO,KAAK,QAAQ,YAAY,YAAY,gBAAQ;AAAA,EACtD;AAAA,EAEA,SAAgC;AAC9B,UAAM,cAAc,KAAK,wBAAwB,gBAAQ,MAAM;AAC/D,WAAO,KAAK,QAAQ,YAAY,aAAa,iBAAS;AAAA,EACxD;AAAA,EAEA,wBAAwB,MAAsC;AAC5D,QAAI;AACJ,SAAK,OAAO,CAAC,SAAS;AACpB,UAAI,CAAC,UAAW,aAAY,KAAK,IAAI,IAAI;AAAA,IAC3C,CAAC;AACD,WAAO;AAAA,EACT;AAAA,EAEA,UAAU,WAAyB;AACjC,SAAK,IAAI,gBAAQ,QAAQ,SAAS;AAAA,EACpC;AAAA,EAEA,iBAAiB,kBAAgC;AAC/C,UAAM,WAAW,KAAK,kBAAkB,EAAE,YAAY,KAAK,QAAQ,IAAI,CAAC,CAAC;AACzE,SAAK,IAAI,gBAAQ,UAAU,QAAQ;AACnC,aAAS,KAAK,gBAAgB;AAAA,EAChC;AAAA,EAEA,mBAAmB,aAAqB,WAA4B;AAClE,UAAM,WAAW,KAAK,SAAS;AAC/B,QAAI,oBAAoB,kBAAU;AAChC,eAAS,OAAO,GAAG,WAAW;AAC9B,eAAS,KAAK,SAAS;AACvB,aAAO;AAAA,IACT;AACA,WAAO;AAAA,EACT;AAAA,EAEA,SAAS,UAAwB;AAC/B,UAAM,EAAE,OAAO,IAAI,KAAK,kBAAkB;AAC1C,WAAO,KAAK,QAAQ;AAAA,EACtB;AAAA,EAEA,YAAY,UAAkB;AAC5B,UAAM,EAAE,OAAO,IAAI,KAAK,kBAAkB;AAC1C,UAAM,QAAQ,OAAO,QAAQ,QAAQ;AACrC,QAAI,UAAU,QAAW;AACvB,aAAO,OAAO,KAAK;AAAA,IACrB;AAAA,EACF;AAAA,EAEA,kBAAkB,MAAe,aAA2B;AAC1D,UAAM,EAAE,MAAAC,MAAK,IAAI,KAAK,kBAAkB;AACxC,IAAAA,MAAK,IAAI,MAAM,WAAW;AAAA,EAC5B;AAAA,EAEA,qBAAqB,KAAsB;AACzC,UAAM,EAAE,MAAAA,MAAK,IAAI,KAAK,kBAAkB;AACxC,WAAOA,MAAK,UAAU,GAAG;AAAA,EAC3B;AAAA,EAEA,kBAAkB,KAAa,aAA8B;AAC3D,UAAM,MAAM,KAAK,qBAAqB,GAAG;AACzC,SAAK,kBAAkB,KAAK,WAAW;AACvC,WAAO;AAAA,EACT;AAAA,EAEA,WAAW,MAAe,YAA0B;AAClD,UAAM,EAAE,QAAQ,IAAI,KAAK,kBAAkB;AAC3C,YAAQ,IAAI,MAAM,UAAU;AAAA,EAC9B;AAAA,EAEA,cAAc,KAAsB;AAClC,UAAM,EAAE,QAAQ,IAAI,KAAK,kBAAkB;AAC3C,WAAO,QAAQ,UAAU,GAAG;AAAA,EAC9B;AAAA,EAEA,WAAW,KAAa,YAA6B;AACnD,UAAM,MAAM,KAAK,cAAc,GAAG;AAClC,SAAK,WAAW,KAAK,UAAU;AAC/B,WAAO;AAAA,EACT;AAAA,EAEA,aAAa,MAAe,cAAsC;AAChE,UAAM,EAAE,UAAU,IAAI,KAAK,kBAAkB;AAC7C,cAAU,IAAI,MAAM,YAAY;AAAA,EAClC;AAAA,EAEA,gBAAgB,KAAsB;AACpC,UAAM,EAAE,UAAU,IAAI,KAAK,kBAAkB;AAC7C,WAAO,UAAU,UAAU,GAAG;AAAA,EAChC;AAAA,EAEA,aAAa,KAAa,cAAyC;AACjE,UAAM,MAAM,KAAK,gBAAgB,GAAG;AACpC,SAAK,aAAa,KAAK,YAAY;AACnC,WAAO;AAAA,EACT;AAAA,EAEA,OAAO,SAAyD;AAC9D,YAAQ,IAAI;AACZ,UAAM,SAAS,KAAK,OAAO;AAC3B,QAAI,OAAQ,QAAO,OAAO,OAAO;AAAA,EACnC;AAAA,EAEA,YAAY;AACV,QAAI,KAAK,WAAY;AAErB,UAAM,EAAE,QAAQ,IAAI;AAEpB,UAAM,cAAc,KAAK,IAAI,gBAAQ,QAAQ;AAC7C,UAAM,WAAW,KAAK,QAAQ,OAAO,WAAW;AAChD,QAAI,oBAAoB,mBAAW;AACjC,WAAK,IAAI,gBAAQ,UAAU,QAAQ,IAAI,CAAC,WAAW,CAAC,CAAC;AAAA,IACvD;AAEA,QAAI,KAAK,kBAAkB;AACzB,WAAK;AAAA,QACH,KAAK,QAAQ,kCAAkC;AAAA,QAC/C,KAAK,QAAQ,iCAAiC;AAAA,MAChD;AAAA,IACF;AAGA,UAAM,YAAY,KAAK,wBAAwB,gBAAQ,SAAS;AAChE,UAAM,YACJ,QAAQ,YAAY,WAAW,eAAO,KAAK,QAAQ,IAAI,CAAC,CAAC;AAC3D,SAAK,IAAI,gBAAQ,WAAW,SAAS;AAGrC,UAAMA,QACJ,UAAU,YAAY,gBAAQ,MAAM,eAAO,KAAK,QAAQ,IAAI,CAAC,CAAC;AAChE,cAAU,IAAI,gBAAQ,MAAMA,KAAI;AAGhC,UAAM,UACJ,UAAU,YAAY,gBAAQ,SAAS,eAAO,KAAK,QAAQ,IAAI,CAAC,CAAC;AACnE,cAAU,IAAI,gBAAQ,SAAS,OAAO;AAGtC,UAAM,YACJ,UAAU,YAAY,gBAAQ,WAAW,eAAO,KAAK,QAAQ,IAAI,CAAC,CAAC;AACrE,cAAU,IAAI,gBAAQ,WAAW,SAAS;AAE1C,UAAM,SAAS,KAAK,OAAO,KAAK,QAAQ,IAAI,CAAC,CAAC;AAC9C,SAAK,IAAI,gBAAQ,QAAQ,MAAM;AAE/B,SAAK,aAAa;AAAA,EACpB;AAAA,EAEA,oBAAoB;AAClB,SAAK,UAAU;AACf,UAAM,SAAS,KAAK,OAAO;AAC3B,UAAM,YAAY,KAAK,UAAU;AACjC,UAAM,WAAW,KAAK,SAAS;AAC/B,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA,MAAM,UAAU,OAAO,gBAAQ,MAAM,eAAO;AAAA,MAC5C,SAAS,UAAU,OAAO,gBAAQ,SAAS,eAAO;AAAA,MAClD,WAAW,UAAU,OAAO,gBAAQ,WAAW,eAAO;AAAA,IACxD;AAAA,EACF;AACF;AAzPE,cADI,cACY,sBAAqB;AAAA,EACnC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;AAEA,cARI,cAQG,wBAAuB,CAAC,SAAqB,WAAmB;AACrE,QAAM,OAAO,oBAAI,IAAI;AACrB,OAAK,IAAI,gBAAQ,MAAM,gBAAQ,IAAI;AACnC,OAAK,IAAI,gBAAQ,QAAQ,MAAM;AAC/B,OAAK,IAAI,gBAAQ,WAAW,QAAQ,IAAI,CAAC,CAAC,CAAC;AAC3C,OAAK,IAAI,gBAAQ,UAAU,QAAQ,IAAI,CAAC,GAAG,GAAG,KAAK,GAAG,CAAC,CAAC;AACxD,SAAO,IAAI,aAAY,MAAM,SAAS,KAAK;AAC7C;AAEA,cAjBI,cAiBG,sBAAqB,CAC1B,KACA,SACA,mBAAmB,SAChB,IAAI,aAAY,KAAK,SAAS,gBAAgB;AArBrD,IAAM,cAAN;AA4PA,IAAO,sBAAQ;;;ACxOf,IAAM,mBAAN,MAAM,iBAAgB;AAAA,EAQZ,YAAY,KAAiB,MAAkB;AAJvD,wBAAiB;AACjB,wBAAiB;AACjB,wBAAiB,oBAAmB,oBAAI,IAA0B;AAQlE;AAAA,gCAAO,CAAsB,WAC3B,kBAAkB,sBAAc,KAAK,YAAY,MAAM,IACnD,kBAAkB,kBAAc,KAAK,YAAY,MAAM,IACrD,kBAAkB,mBAAc,KAAK,aAAa,MAAM,IACtD,kBAAkB,oBAAc,KAAK,cAAc,MAAM,IACvD,kBAAkB,iBAAc,KAAK,sBAAsB,MAAM,IAC/D,OAAO,MAAM;AAG3B,wBAAQ,eAAc,CAAC,iBAA2C;AAChE,YAAM,aAAa,aAAa,MAAM;AAKtC,YAAM,EAAE,mBAAmB,IAAI;AAC/B,eAAS,MAAM,GAAG,MAAM,mBAAmB,QAAQ,MAAM,KAAK,OAAO;AACnE,cAAM,MAAM,gBAAQ,GAAG,mBAAmB,GAAG,CAAC;AAC9C,cAAM,QAAQ,WAAW,wBAAwB,GAAG;AACpD,YAAI,CAAC,WAAW,IAAI,GAAG,KAAK,MAAO,YAAW,IAAI,KAAK,KAAK;AAAA,MAC9D;AAIA,iBAAW,OAAO,gBAAQ,GAAG,QAAQ,CAAC;AAEtC,aAAO,KAAK,YAAY,UAAU;AAAA,IACpC;AAEA,wBAAQ,eAAc,CAAC,iBAAmC;AACxD,UAAI,KAAK,iBAAiB,IAAI,YAAY,GAAG;AAC3C,eAAO,KAAK,iBAAiB,IAAI,YAAY;AAAA,MAC/C;AAEA,YAAM,aAAa,aAAa,MAAM,KAAK,IAAI;AAC/C,WAAK,iBAAiB,IAAI,cAAc,UAAU;AAElD,YAAM,UAAU,aAAa,QAAQ;AAErC,eAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,cAAM,CAAC,KAAK,KAAK,IAAI,QAAQ,GAAG;AAChC,mBAAW,IAAI,KAAK,KAAK,KAAK,KAAK,CAAC;AAAA,MACtC;AAEA,aAAO;AAAA,IACT;AAEA,wBAAQ,gBAAe,CAAC,kBAAsC;AAC5D,UAAI,KAAK,iBAAiB,IAAI,aAAa,GAAG;AAC5C,eAAO,KAAK,iBAAiB,IAAI,aAAa;AAAA,MAChD;AAEA,YAAM,cAAc,cAAc,MAAM,KAAK,IAAI;AACjD,WAAK,iBAAiB,IAAI,eAAe,WAAW;AAEpD,eAAS,MAAM,GAAG,MAAM,cAAc,KAAK,GAAG,MAAM,KAAK,OAAO;AAC9D,cAAM,QAAQ,cAAc,IAAI,GAAG;AACnC,oBAAY,IAAI,KAAK,KAAK,KAAK,KAAK,CAAC;AAAA,MACvC;AAEA,aAAO;AAAA,IACT;AAEA,wBAAQ,iBAAgB,CAAC,mBAAyC;AAChE,UAAI,KAAK,iBAAiB,IAAI,cAAc,GAAG;AAC7C,eAAO,KAAK,iBAAiB,IAAI,cAAc;AAAA,MACjD;AAEA,YAAM,eAAe,eAAe,MAAM,KAAK,IAAI;AACnD,WAAK,iBAAiB,IAAI,gBAAgB,YAAY;AAEtD,YAAM,UAAU,eAAe,KAAK,QAAQ;AAC5C,eAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,cAAM,CAAC,KAAK,KAAK,IAAI,QAAQ,GAAG;AAChC,qBAAa,KAAK,IAAI,KAAK,KAAK,KAAK,KAAK,CAAC;AAAA,MAC7C;AAEA,aAAO;AAAA,IACT;AAEA,wBAAQ,yBAAwB,CAAC,QAAwB;AACvD,YAAM,gBAAgB,KAAK,iBAAiB,IAAI,GAAG;AAEnD,UAAI,CAAC,eAAe;AAClB,cAAM,SAAS,KAAK,KAAK,QAAQ;AACjC,aAAK,iBAAiB,IAAI,KAAK,MAAM;AAErC,cAAM,oBAAoB,KAAK,IAAI,OAAO,GAAG;AAC7C,YAAI,mBAAmB;AACrB,gBAAM,SAAS,KAAK,KAAK,iBAAiB;AAC1C,eAAK,KAAK,OAAO,QAAQ,MAAM;AAAA,QACjC;AAAA,MACF;AAEA,aAAO,KAAK,iBAAiB,IAAI,GAAG;AAAA,IACtC;AApGE,SAAK,MAAM;AACX,SAAK,OAAO;AAAA,EACd;AAmGF;AA7GE,cADI,kBACG,OAAM,CAAC,KAAiB,SAC7B,IAAI,iBAAgB,KAAK,IAAI;AAFjC,IAAM,kBAAN;AAgHA,IAAO,0BAAQ;;;AChIf,IAAM,sBAAN,MAAM,oBAAmB;AAAA,EAcf,YAAY,YAA0B;AAJ9C,wBAAQ;AACR,wBAAQ;AACR,wBAAQ;AAGN,SAAK,cAAc,aAAa,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC;AAClD,SAAK,WAAW;AAChB,SAAK,cAAc,aAAa,IAAI;AAAA,EACtC;AAAA,EAEA,SAAS,KAAa,QAAsB;AAC1C,SAAK,OAAO,EAAE,KAAK,QAAQ,SAAS,MAAM,CAAC;AAAA,EAC7C;AAAA,EAEA,gBAAgB,KAAa,sBAAoC;AAC/D,SAAK,OAAO,EAAE,KAAK,QAAQ,sBAAsB,SAAS,KAAK,CAAC;AAAA,EAClE;AAAA,EAEA,WAAmB;AACjB,QAAI,UAAU;AAEd,aACM,WAAW,GAAG,WAAW,KAAK,YAAY,QAC9C,WAAW,UACX,YACA;AACA,YAAMC,SAAQ,KAAK,YAAY,QAAQ;AACvC,iBAAW,GAAGA,OAAM,CAAC,EAAE,IAAI,YAAY,IAAIA,OAAM,MAAM;AAAA;AACvD,eACM,WAAW,GAAG,WAAWA,OAAM,QACnC,WAAW,UACX,YACA;AACA,cAAM,QAAQA,OAAM,QAAQ;AAC5B,mBAAW,SAAS,OAAO,MAAM,MAAM,GAAG,IAAI,GAAG;AACjD,mBAAW;AACX,mBAAW,SAAS,OAAO,MAAM,IAAI,gBAAgB,GAAG,GAAG,GAAG;AAC9D,mBAAW;AACX,mBAAW,MAAM,UAAU,MAAM;AACjC,mBAAW;AAAA,MACb;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,cAAsB;AACpB,QAAI,OAAO;AACX,aAAS,MAAM,GAAG,MAAM,KAAK,YAAY,QAAQ,MAAM,KAAK,OAAO;AACjE,YAAM,aAAa,KAAK,YAAY,GAAG;AACvC,YAAM,mBAAmB,WAAW;AACpC,YAAM,CAAC,UAAU,IAAI;AACrB,cAAQ;AACR,cAAQ,OAAO,WAAW,IAAI,YAAY,EAAE;AAC5C,cAAQ,OAAO,gBAAgB,EAAE;AACjC,cAAQ,KAAK;AAAA,IACf;AACA,WAAO;AAAA,EACT;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,UAAM,gBAAgB;AAEtB,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAE7B,cAAU,KAAK,0BAA0B,KAAK,aAAa,QAAQ,MAAM;AAEzE,WAAO,SAAS;AAAA,EAClB;AAAA,EAEQ,0BACN,aACA,QACA,QACQ;AACR,UAAM,gBAAgB;AACtB,UAAM,SAAS,YAAY;AAE3B,aAAS,MAAM,GAAG,MAAM,QAAQ,OAAO;AACrC,YAAM,aAAa,KAAK,YAAY,GAAG;AAEvC,YAAM,oBAAoB,OAAO,WAAW,CAAC,EAAE,IAAI,YAAY;AAC/D,gBAAU,qBAAqB,mBAAmB,QAAQ,MAAM;AAChE,aAAO,QAAQ,IAAI,kBAAU;AAE7B,YAAM,cAAc,OAAO,WAAW,MAAM;AAC5C,gBAAU,qBAAqB,aAAa,QAAQ,MAAM;AAC1D,aAAO,QAAQ,IAAI,kBAAU;AAE7B,gBAAU,KAAK,sBAAsB,YAAY,QAAQ,MAAM;AAAA,IACjE;AAEA,WAAO,SAAS;AAAA,EAClB;AAAA,EAEQ,sBACN,SACA,QACA,QACQ;AACR,UAAM,SAAS,QAAQ;AAEvB,aAAS,MAAM,GAAG,MAAM,QAAQ,OAAO;AACrC,YAAM,QAAQ,QAAQ,GAAG;AAEzB,YAAM,cAAc,SAAS,OAAO,MAAM,MAAM,GAAG,IAAI,GAAG;AAC1D,gBAAU,qBAAqB,aAAa,QAAQ,MAAM;AAC1D,aAAO,QAAQ,IAAI,kBAAU;AAE7B,YAAM,WAAW,SAAS,OAAO,MAAM,IAAI,gBAAgB,GAAG,GAAG,GAAG;AACpE,gBAAU,qBAAqB,UAAU,QAAQ,MAAM;AACvD,aAAO,QAAQ,IAAI,kBAAU;AAE7B,aAAO,QAAQ,IAAI,MAAM,UAAU,kBAAU,IAAI,kBAAU;AAE3D,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAAA,IAC/B;AAEA,WAAO,KAAK;AAAA,EACd;AAAA,EAEQ,OAAO,WAAwB;AACrC,QAAI,KAAK,gBAAgB,GAAG;AAC1B,WAAK,YAAY,KAAK,CAAC,SAAS,CAAC;AACjC,WAAK,WAAW;AAChB,WAAK,cAAc;AACnB;AAAA,IACF;AAEA,UAAM,QAAQ,KAAK,YAAY,KAAK,QAAQ;AAC5C,UAAM,YAAY,MAAM,KAAK,cAAc,CAAC;AAE5C,QAAI,UAAU,IAAI,eAAe,UAAU,IAAI,eAAe,GAAG;AAC/D,WAAK,YAAY,KAAK,CAAC,SAAS,CAAC;AACjC,WAAK,YAAY;AACjB,WAAK,cAAc;AAAA,IACrB,OAAO;AACL,YAAM,KAAK,SAAS;AACpB,WAAK,eAAe;AAAA,IACtB;AAAA,EACF;AACF;AA3JE,cADI,qBACG,UAAS,MACd,IAAI,oBAAmB;AAAA,EACrB,KAAK,eAAO,GAAG,GAAG,KAAK;AAAA,EACvB,QAAQ;AAAA,EACR,SAAS;AACX,CAAC;AAEH,cARI,qBAQG,eAAc,MAAM,IAAI,oBAAmB;AARpD,IAAM,qBAAN;AA8JA,IAAO,6BAAQ;;;ACzKf,IAAM,cAAN,MAAM,YAAW;AAAA,EAMP,YAAY,gBAAwB;AAF5C,wBAAiB;AAGf,SAAK,iBAAiB,OAAO,cAAc;AAAA,EAC7C;AAAA,EAEA,WAAmB;AACjB,WAAO;AAAA,EAAc,KAAK,cAAc;AAAA;AAAA,EAC1C;AAAA,EAEA,cAAsB;AACpB,WAAO,KAAK,KAAK,eAAe;AAAA,EAClC;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,UAAM,gBAAgB;AAEtB,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAE7B,cAAU,qBAAqB,KAAK,gBAAgB,QAAQ,MAAM;AAElE,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAE7B,WAAO,SAAS;AAAA,EAClB;AACF;AA1CE,cADI,aACG,gCAA+B,CAAC,WACrC,IAAI,YAAW,MAAM;AAFzB,IAAM,aAAN;AA6CA,IAAO,qBAAQ;;;AC7Cf,IAAM,kBAAN,MAAM,gBAAe;AAAA,EAKX,YAAY,MAAe;AAFnC,wBAAS;AAGP,SAAK,OAAO;AAAA,EACd;AAAA,EAEA,WAAmB;AACjB,WAAO;AAAA,EAAY,KAAK,KAAK,SAAS,CAAC;AAAA,EACzC;AAAA,EAEA,cAAsB;AACpB,WAAO,IAAI,KAAK,KAAK,YAAY;AAAA,EACnC;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,UAAM,gBAAgB;AAEtB,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAE7B,cAAU,KAAK,KAAK,cAAc,QAAQ,MAAM;AAEhD,WAAO,SAAS;AAAA,EAClB;AACF;AAhCE,cADI,iBACG,MAAK,CAAC,SAAkB,IAAI,gBAAe,IAAI;AADxD,IAAM,iBAAN;AAmCA,IAAO,yBAAQ;;;AC3Bf,IAAM,mBAAN,MAAM,yBAAwB,uBAAe;AAAA,EAWnC,YACN,SACA,SACA,SAAS,MACT;AACA,UAAM,QAAQ,IAAI,CAAC,CAAC,GAAG,MAAM;AAT/B,wBAAiB;AACjB,wBAAiB;AACjB,wBAAiB;AASf,SAAK,UAAU;AACf,SAAK,UAAU,KAAK,qBAAqB;AACzC,SAAK,gBAAgB,KAAK,qBAAqB;AAE/C,SAAK,KAAK,IAAI,gBAAQ,GAAG,MAAM,GAAG,gBAAQ,GAAG,QAAQ,CAAC;AACtD,SAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,GAAG,kBAAU,GAAG,KAAK,QAAQ,MAAM,CAAC;AAChE,SAAK,KAAK,IAAI,gBAAQ,GAAG,OAAO,GAAG,kBAAU,GAAG,KAAK,cAAc,MAAM,CAAC;AAAA,EAC5E;AAAA,EAEA,kBAA0B;AACxB,WAAO,KAAK,QAAQ;AAAA,EACtB;AAAA,EAEA,MAAM,SAAuC;AAC3C,WAAO,iBAAgB;AAAA,MACrB,WAAW,KAAK,KAAK;AAAA,MACrB,KAAK,QAAQ,MAAM;AAAA,MACnB,KAAK;AAAA,IACP;AAAA,EACF;AAAA,EAEA,oBAA4B;AAC1B,QAAI,QAAQ,KAAK;AACjB,aAAS,MAAM,GAAG,MAAM,KAAK,QAAQ,QAAQ,MAAM,KAAK,OAAO;AAC7D,YAAM,CAAC,EAAE,MAAM,IAAI,KAAK,QAAQ,GAAG;AACnC,eAAS,GAAG,MAAM;AAAA;AAAA,IACpB;AACA,WAAO;AAAA,EACT;AAAA,EAEA,uBAAmC;AACjC,UAAM,SAAS,IAAI,WAAW,KAAK,yBAAyB,CAAC;AAC7D,QAAI,SAAS,qBAAqB,KAAK,eAAe,QAAQ,CAAC;AAC/D,aAAS,MAAM,GAAG,MAAM,KAAK,QAAQ,QAAQ,MAAM,KAAK,OAAO;AAC7D,YAAM,CAAC,EAAE,MAAM,IAAI,KAAK,QAAQ,GAAG;AACnC,gBAAU,OAAO,cAAc,QAAQ,MAAM;AAC7C,aAAO,QAAQ,IAAI,kBAAU;AAAA,IAC/B;AACA,WAAO;AAAA,EACT;AAAA,EAEA,2BAAmC;AACjC,WACE,KAAK,cAAc,SACnB,KAAK,KAAK,OAAO,EAAE,CAAC,IACpB,KAAK,KAAK,OAAO,EAAE,CAAC,EAAE,YAAY,IAClC;AAAA,EAEJ;AAAA,EAEQ,uBAA+B;AACrC,QAAI,gBAAgB;AACpB,aAAS,MAAM,GAAG,MAAM,KAAK,QAAQ,QAAQ,MAAM,KAAK,OAAO;AAC7D,YAAM,CAAC,cAAc,MAAM,IAAI,KAAK,QAAQ,GAAG;AAC/C,uBAAiB,GAAG,YAAY,IAAI,MAAM;AAAA,IAC5C;AACA,WAAO;AAAA,EACT;AAAA,EAEQ,uBAA2C;AACjD,QAAI,SAAS;AACb,UAAM,UAAU,IAAI,MAAM,KAAK,QAAQ,MAAM;AAC7C,aAAS,MAAM,GAAG,MAAM,KAAK,QAAQ,QAAQ,MAAM,KAAK,OAAO;AAC7D,YAAM,CAAC,KAAK,MAAM,IAAI,KAAK,QAAQ,GAAG;AACtC,cAAQ,GAAG,IAAI,CAAC,IAAI,cAAc,MAAM;AACxC,gBAAU,OAAO,YAAY,IAAI;AAAA,IACnC;AACA,WAAO;AAAA,EACT;AACF;AAtFE,cADI,kBACG,yBAAwB,CAC7B,SACA,SACA,SAAS,SACN,IAAI,iBAAgB,SAAS,SAAS,MAAM;AALnD,IAAM,kBAAN;AAyFA,IAAO,0BAAQ;;;AC/Ef,IAAM,aAAN,MAAM,WAAU;AAAA,EASJ,YAAY,SAAqB,gBAAwB;AALnE,wBAAmB;AAEnB,wBAAmB;AACnB,wBAAQ,iBAAgB;AAmHxB,wBAAU,qBAAoB,CAAC,MAAc;AAC3C,WAAK,iBAAiB;AACtB,aAAO,KAAK,gBAAgB,KAAK,mBAAmB;AAAA,IACtD;AAnHE,SAAK,UAAU;AACf,SAAK,iBAAiB;AAAA,EACxB;AAAA,EAEA,MAAM,oBAAyC;AAC7C,UAAM,EAAE,MAAM,QAAQ,iBAAiB,MAAM,aAAa,QAAQ,IAChE,MAAM,KAAK,kBAAkB;AAE/B,QAAI,SAAS;AACb,UAAM,SAAS,IAAI,WAAW,IAAI;AAElC,cAAU,OAAO,cAAc,QAAQ,MAAM;AAC7C,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,QAAQ,IAAI,kBAAU;AAE7B,aAAS,MAAM,GAAG,MAAM,gBAAgB,QAAQ,MAAM,KAAK,OAAO;AAChE,YAAM,CAAC,KAAK,MAAM,IAAI,gBAAgB,GAAG;AAEzC,YAAM,eAAe,OAAO,IAAI,YAAY;AAC5C,gBAAU,qBAAqB,cAAc,QAAQ,MAAM;AAC3D,aAAO,QAAQ,IAAI,kBAAU;AAE7B,YAAM,mBAAmB,OAAO,IAAI,gBAAgB;AACpD,gBAAU,qBAAqB,kBAAkB,QAAQ,MAAM;AAC/D,aAAO,QAAQ,IAAI,kBAAU;AAE7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAE7B,gBAAU,OAAO,cAAc,QAAQ,MAAM;AAE7C,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAE7B,YAAM,IACJ,kBAAkB,0BAAkB,OAAO,gBAAgB,IAAI;AACjE,UAAI,KAAK,kBAAkB,CAAC,EAAG,OAAM,YAAY;AAAA,IACnD;AAEA,QAAI,MAAM;AACR,gBAAU,KAAK,cAAc,QAAQ,MAAM;AAC3C,aAAO,QAAQ,IAAI,kBAAU;AAAA,IAC/B;AAEA,QAAI,aAAa;AACf,gBAAU,YAAY,cAAc,QAAQ,MAAM;AAClD,aAAO,QAAQ,IAAI,kBAAU;AAC7B,aAAO,QAAQ,IAAI,kBAAU;AAAA,IAC/B;AAEA,cAAU,QAAQ,cAAc,QAAQ,MAAM;AAE9C,WAAO;AAAA,EACT;AAAA,EAEU,0BAA0B,CAAC,KAAK,MAAM,GAGrC;AACT,UAAM,UAAU,IAAI,YAAY,IAAI;AACpC,UAAM,aAAa,OAAO,YAAY,IAAI;AAC1C,WAAO,UAAU;AAAA,EACnB;AAAA,EAEU,oBAA6B;AACrC,WAAO,KAAK,QAAQ,IAAI;AAAA,MACtB,MAAM,KAAK,QAAQ,sBAAsB;AAAA,MACzC,MAAM,KAAK,QAAQ,YAAY;AAAA,MAC/B,SAAS,KAAK,QAAQ,YAAY;AAAA,MAClC,MAAM,KAAK,QAAQ,YAAY;AAAA,MAC/B,IAAI,KAAK,QAAQ,YAAY;AAAA,IAC/B,CAAC;AAAA,EACH;AAAA,EAEA,MAAgB,oBAAgD;AAC9D,UAAM,SAAS,kBAAU,WAAW,GAAG,CAAC;AAExC,QAAI,OAAO,OAAO,YAAY,IAAI;AAElC,UAAM,OAAO,2BAAmB,OAAO;AAEvC,UAAM,kBAAkB,KAAK,QAAQ,yBAAyB;AAE9D,aAAS,MAAM,GAAG,MAAM,gBAAgB,QAAQ,MAAM,KAAK,OAAO;AAChE,YAAM,iBAAiB,gBAAgB,GAAG;AAC1C,YAAM,CAAC,GAAG,IAAI;AACd,WAAK,SAAS,KAAK,IAAI;AACvB,cAAQ,KAAK,0BAA0B,cAAc;AACrD,UAAI,KAAK,kBAAkB,CAAC,EAAG,OAAM,YAAY;AAAA,IACnD;AAEA,UAAM,aAAa;AACnB,YAAQ,KAAK,YAAY,IAAI;AAE7B,UAAM,cAAc,uBAAe,GAAG,KAAK,kBAAkB,CAAC;AAC9D,YAAQ,YAAY,YAAY,IAAI;AAEpC,UAAM,UAAU,mBAAW,6BAA6B,UAAU;AAClE,YAAQ,QAAQ,YAAY;AAE5B,WAAO,EAAE,MAAM,QAAQ,iBAAiB,MAAM,aAAa,QAAQ;AAAA,EACrE;AAMF;AA7HE,cADI,YACG,cAAa,CAAC,SAAqB,mBACxC,IAAI,WAAU,SAAS,cAAc;AAFzC,IAAM,YAAN;AAgIA,IAAO,oBAAQ;;;ACnJf,IAAM,oBAAN,MAAM,0BAAyB,kBAAU;AAAA,EAK/B,YAAY,MAAkB;AACpC,UAAM;AAHR,wBAAiB;AAIf,SAAK,OAAO;AAAA,EACd;AAAA,EAEA,QAA0B;AACxB,WAAO,kBAAiB,GAAG,KAAK,KAAK,MAAM,CAAC;AAAA,EAC9C;AAAA,EAEA,WAAmB;AACjB,WAAO,oBAAoB,KAAK,KAAK,MAAM;AAAA,EAC7C;AAAA,EAEA,cAAsB;AACpB,WAAO,KAAK,KAAK;AAAA,EACnB;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,UAAM,SAAS,KAAK,KAAK;AACzB,aAAS,MAAM,GAAG,MAAM,QAAQ,OAAO;AACrC,aAAO,QAAQ,IAAI,KAAK,KAAK,GAAG;AAAA,IAClC;AACA,WAAO;AAAA,EACT;AACF;AA5BE,cADI,mBACG,MAAK,CAAC,SAAqB,IAAI,kBAAiB,IAAI;AAD7D,IAAM,mBAAN;AA+BA,IAAO,2BAAQ;;;ACQf,IAAM,qBAAN,MAAM,2BAA0B,uBAAe;AAAA,EAerC,YAAY,MAAe,SAAmB,SAAS,MAAM;AACnE,UAAM,MAAM,MAAM;AANpB,wBAAiB;AACjB,wBAAiB;AACjB,wBAAiB;AACjB,wBAAiB;AA8HjB;AAAA;AAAA;AAAA,wBAAQ,gBAAe,MAAgB;AACrC,YAAM,cAAwB,CAAC;AAE/B,UAAI,mBAAmB;AACvB,eAAS,MAAM,GAAG,MAAM,KAAK,QAAQ,QAAQ,MAAM,KAAK,OAAO;AAC7D,cAAM,YAAY,KAAK,QAAQ,GAAG;AAClC,cAAM,YAAY,KAAK,QAAQ,MAAM,CAAC;AAEtC,YAAI,QAAQ,GAAG;AACb,sBAAY,KAAK,UAAU,IAAI,YAAY;AAAA,QAC7C,WAAW,UAAU,IAAI,eAAe,UAAU,IAAI,eAAe,GAAG;AACtE,sBAAY,KAAK,gBAAgB;AACjC,sBAAY,KAAK,UAAU,IAAI,YAAY;AAC3C,6BAAmB;AAAA,QACrB;AAEA,4BAAoB;AAAA,MACtB;AACA,kBAAY,KAAK,gBAAgB;AAEjC,aAAO;AAAA,IACT;AAEA,wBAAQ,sBAAqB,MAAoB;AAC/C,YAAM,cAA4B,IAAI,MAAM,KAAK,QAAQ,MAAM;AAE/D,eAAS,MAAM,GAAG,MAAM,KAAK,QAAQ,QAAQ,MAAM,KAAK,OAAO;AAC7D,cAAM,QAAQ,KAAK,QAAQ,GAAG;AAC9B,YAAI,MAAM,SAAS,iBAAmB;AACpC,gBAAM,EAAE,MAAM,sBAAsB,IAAI,IAAI;AAC5C,sBAAY,GAAG,IAAI,CAAC,MAAM,sBAAsB,IAAI,gBAAgB;AAAA,QACtE;AACA,YAAI,MAAM,SAAS,sBAAwB;AACzC,gBAAM,EAAE,MAAM,QAAQ,IAAI,IAAI;AAC9B,sBAAY,GAAG,IAAI,CAAC,MAAM,QAAQ,IAAI,gBAAgB;AAAA,QACxD;AACA,YAAI,MAAM,SAAS,oBAAsB;AACvC,gBAAM,EAAE,MAAM,iBAAiB,MAAM,IAAI;AACzC,sBAAY,GAAG,IAAI,CAAC,MAAM,gBAAgB,cAAc,KAAK;AAAA,QAC/D;AAAA,MACF;AAEA,aAAO;AAAA,IACT;AAEA,wBAAQ,6BAA4B,MAAgC;AAClE,YAAM,cAAc,KAAK,iBAAiB,OAAO;AACjD,YAAM,SAAmC,CAAC,GAAG,GAAG,CAAC;AAEjD,eAAS,MAAM,GAAG,MAAM,YAAY,QAAQ,MAAM,KAAK,OAAO;AAC5D,cAAM,CAAC,OAAO,QAAQ,KAAK,IAAI,YAAY,GAAG;AAE9C,cAAM,YAAY,YAAY,KAAK;AACnC,cAAM,aAAa,YAAY,MAAM;AACrC,cAAM,YAAY,YAAY,KAAK;AAEnC,YAAI,YAAY,OAAO,CAAC,EAAG,QAAO,CAAC,IAAI;AACvC,YAAI,aAAa,OAAO,CAAC,EAAG,QAAO,CAAC,IAAI;AACxC,YAAI,YAAY,OAAO,CAAC,EAAG,QAAO,CAAC,IAAI;AAAA,MACzC;AAEA,aAAO;AAAA,IACT;AAvLE,SAAK,UAAU,WAAW,CAAC;AAC3B,SAAK,mBAAmB,cAAM,YAAY,KAAK,kBAAkB;AACjE,SAAK,qBAAqB,cAAM,YAAY,KAAK,yBAAyB;AAC1E,SAAK,aAAa,cAAM,YAAY,KAAK,YAAY;AAErD,SAAK,IAAI,gBAAQ,GAAG,MAAM,GAAG,gBAAQ,GAAG,MAAM,CAAC;AAAA,EACjD;AAAA,EAEA,gBAAgB,KAAa,sBAA8B;AACzD,UAAM,OAAO;AACb,SAAK,QAAQ,KAAK,EAAE,MAAM,KAAK,qBAAqB,CAAC;AACrD,SAAK,iBAAiB,WAAW;AACjC,SAAK,mBAAmB,WAAW;AACnC,SAAK,WAAW,WAAW;AAC3B,SAAK,cAAc,WAAW;AAAA,EAChC;AAAA,EAEA,qBAAqB,KAAa,QAAgB;AAChD,UAAM,OAAO;AACb,SAAK,QAAQ,KAAK,EAAE,MAAM,KAAK,OAAO,CAAC;AACvC,SAAK,iBAAiB,WAAW;AACjC,SAAK,mBAAmB,WAAW;AACnC,SAAK,WAAW,WAAW;AAC3B,SAAK,cAAc,WAAW;AAAA,EAChC;AAAA,EAEA,mBAAmB,KAAa,iBAAyB,OAAe;AACtE,UAAM,OAAO;AACb,SAAK,QAAQ,KAAK,EAAE,MAAM,KAAK,iBAAiB,MAAM,CAAC;AACvD,SAAK,iBAAiB,WAAW;AACjC,SAAK,mBAAmB,WAAW;AACnC,SAAK,WAAW,WAAW;AAC3B,SAAK,cAAc,WAAW;AAAA,EAChC;AAAA,EAEA,MAAM,SAAyC;AAC7C,UAAM,EAAE,MAAM,SAAS,OAAO,IAAI;AAClC,WAAO,mBAAkB,GAAG,KAAK,MAAM,OAAO,GAAG,QAAQ,MAAM,GAAG,MAAM;AAAA,EAC1E;AAAA,EAEA,oBAA4B;AAC1B,UAAM,cAAc,KAAK,iBAAiB,OAAO;AACjD,UAAM,aAAa,KAAK,mBAAmB,OAAO;AAClD,QAAI,QAAQ;AAEZ,aACM,WAAW,GAAG,aAAa,YAAY,QAC3C,WAAW,YACX,YACA;AACA,YAAM,CAAC,OAAO,QAAQ,KAAK,IAAI,YAAY,QAAQ;AAEnD,YAAM,aAAa,aAAa,SAAS,KAAK,CAAC;AAC/C,YAAM,cAAc,aAAa,SAAS,MAAM,CAAC;AACjD,YAAM,aAAa,aAAa,SAAS,KAAK,CAAC;AAE/C,eAAS,MAAM,WAAW,CAAC,IAAI,GAAG,OAAO,GAAG,OAAO;AACjD,kBAAU,WAAW,GAAG,KAAK,GAAG,SAAS,CAAC;AAAA,MAC5C;AACA,eAAS,MAAM,WAAW,CAAC,IAAI,GAAG,OAAO,GAAG,OAAO;AACjD,kBAAU,YAAY,GAAG,KAAK,GAAG,SAAS,CAAC;AAAA,MAC7C;AACA,eAAS,MAAM,WAAW,CAAC,IAAI,GAAG,OAAO,GAAG,OAAO;AACjD,kBAAU,WAAW,GAAG,KAAK,GAAG,SAAS,CAAC;AAAA,MAC5C;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,uBAAmC;AACjC,UAAM,cAAc,KAAK,iBAAiB,OAAO;AACjD,UAAM,aAAa,KAAK,mBAAmB,OAAO;AAClD,UAAM,SAAS,IAAI,WAAW,KAAK,yBAAyB,CAAC;AAE7D,QAAI,SAAS;AACb,aACM,WAAW,GAAG,aAAa,YAAY,QAC3C,WAAW,YACX,YACA;AACA,YAAM,CAAC,OAAO,QAAQ,KAAK,IAAI,YAAY,QAAQ;AAEnD,YAAM,aAAa,aAAa,SAAS,KAAK,CAAC;AAC/C,YAAM,cAAc,aAAa,SAAS,MAAM,CAAC;AACjD,YAAM,aAAa,aAAa,SAAS,KAAK,CAAC;AAE/C,eAAS,MAAM,WAAW,CAAC,IAAI,GAAG,OAAO,GAAG,OAAO;AACjD,eAAO,QAAQ,IAAI,WAAW,GAAG,KAAK;AAAA,MACxC;AACA,eAAS,MAAM,WAAW,CAAC,IAAI,GAAG,OAAO,GAAG,OAAO;AACjD,eAAO,QAAQ,IAAI,YAAY,GAAG,KAAK;AAAA,MACzC;AACA,eAAS,MAAM,WAAW,CAAC,IAAI,GAAG,OAAO,GAAG,OAAO;AACjD,eAAO,QAAQ,IAAI,WAAW,GAAG,KAAK;AAAA,MACxC;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,2BAAmC;AACjC,UAAM,aAAa,KAAK,mBAAmB,OAAO;AAClD,UAAM,aAAa,IAAI,UAAU;AACjC,WAAO,aAAa,KAAK,QAAQ;AAAA,EACnC;AAAA,EAEA,aAAmB;AACjB,UAAM,WAAW;AAEjB,UAAM,aAAa,KAAK,mBAAmB,OAAO;AAClD,UAAM,QAAQ,KAAK,WAAW,OAAO;AAErC,UAAM,EAAE,QAAQ,IAAI,KAAK;AACzB,SAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,GAAG,QAAQ,IAAI,UAAU,CAAC;AACtD,SAAK,KAAK,IAAI,gBAAQ,GAAG,OAAO,GAAG,QAAQ,IAAI,KAAK,CAAC;AAAA,EACvD;AAoEF;AAzME,cADI,oBACG,UAAS,CAAC,MAAe,SAAS,SAAS;AAChD,QAAMC,UAAS,IAAI,mBAAkB,MAAM,CAAC,GAAG,MAAM;AACrD,EAAAA,QAAO,gBAAgB,eAAO,GAAG,GAAG,KAAK,GAAG,CAAC;AAC7C,SAAOA;AACT;AAEA,cAPI,oBAOG,MAAK,CAAC,MAAe,SAAkB,SAAS,SACrD,IAAI,mBAAkB,MAAM,SAAS,MAAM;AAR/C,IAAM,oBAAN;AA4MA,IAAO,4BAAQ;;;ACvOf,IAAM,mBAAN,MAAM,yBAAwB,kBAAU;AAAA,EAiB9B,YACN,SACA,gBACA,eACA,kBACA;AACA,UAAM,SAAS,cAAc;AAT/B,wBAAiB;AACjB,wBAAiB;AAUf,SAAK,gBAAgB;AACrB,SAAK,mBAAmB;AAAA,EAC1B;AAAA,EAEA,MAAgB,oBAAoB;AAClC,QAAI,eAAe,KAAK,QAAQ,sBAAsB;AAEtD,UAAM,SAAS,kBAAU,WAAW,GAAG,CAAC;AAExC,QAAI,OAAO,OAAO,YAAY,IAAI;AAElC,UAAM,aAAa,0BAAkB;AAAA,MACnC,KAAK,kBAAkB;AAAA,MACvB,KAAK;AAAA,IACP;AAEA,UAAM,sBAA6C,CAAC;AACpD,UAAM,oBAA6C,CAAC;AACpD,UAAM,mBAA6B,CAAC;AAEpC,UAAM,kBAAkB,KAAK,QAAQ,yBAAyB;AAC9D,aAAS,MAAM,GAAG,MAAM,gBAAgB,QAAQ,MAAM,KAAK,OAAO;AAChE,YAAM,iBAAiB,gBAAgB,GAAG;AAC1C,YAAM,CAAC,KAAK,MAAM,IAAI;AAEtB,YAAM,oBACJ,QAAQ,KAAK,QAAQ,YAAY,WACjC,kBAAkB,qBAClB,kBAAkB,4BAClB,IAAI,qBAAqB;AAE3B,UAAI,mBAAmB;AACrB,4BAAoB,KAAK,cAAc;AACvC,mBAAW,qBAAqB,KAAK,IAAI;AACzC,gBAAQ,KAAK,0BAA0B,cAAc;AACrD,YAAI,KAAK,kBAAkB,CAAC,EAAG,OAAM,YAAY;AAAA,MACnD,OAAO;AACL,YAAI,QAAQ,KAAK,iBAAiB;AAClC,YAAI,kBAAkB,KAAK,gBAAgB;AAC3C,YAAI,CAAC,SAAS,MAAM,SAAS,KAAK,qBAAqB,GAAG;AACxD,kBAAQ,CAAC;AACT,4BAAkB,KAAK,KAAK;AAC5B,4BAAkB,eAAO,GAAG,cAAc;AAC1C,2BAAiB,KAAK,eAAe;AAAA,QACvC;AACA,mBAAW,mBAAmB,KAAK,iBAAiB,MAAM,MAAM;AAChE,cAAM,KAAK,cAAc;AAAA,MAC3B;AAAA,IACF;AAEA,aAAS,MAAM,GAAG,MAAM,kBAAkB,QAAQ,MAAM,KAAK,OAAO;AAClE,YAAM,QAAQ,kBAAkB,GAAG;AACnC,YAAM,MAAM,iBAAiB,GAAG;AAEhC,YAAM,eAAe,wBAAgB;AAAA,QACnC,KAAK;AAAA,QACL;AAAA,QACA,KAAK;AAAA,MACP;AAEA,iBAAW,qBAAqB,KAAK,IAAI;AACzC,cAAQ,KAAK,0BAA0B,CAAC,KAAK,YAAY,CAAC;AAE1D,0BAAoB,KAAK,CAAC,KAAK,YAAY,CAAC;AAE5C,UAAI,KAAK,kBAAkB,MAAM,MAAM,EAAG,OAAM,YAAY;AAAA,IAC9D;AAEA,UAAM,gBAAgB,eAAO,GAAG,cAAc;AAC9C,eAAW,KAAK,IAAI,gBAAQ,GAAG,MAAM,GAAG,kBAAU,GAAG,YAAY,CAAC;AAClE,eAAW,qBAAqB,eAAe,IAAI;AACnD,UAAM,aAAa;AACnB,YAAQ,KAAK,0BAA0B,CAAC,eAAe,UAAU,CAAC;AAElE,wBAAoB,KAAK,CAAC,eAAe,UAAU,CAAC;AAEpD,UAAM,UAAU,mBAAW,6BAA6B,UAAU;AAClE,YAAQ,QAAQ,YAAY;AAE5B,WAAO,EAAE,MAAM,QAAQ,iBAAiB,qBAAqB,QAAQ;AAAA,EACvE;AACF;AAzGE,cADI,kBACG,cAAa,CAClB,SACA,gBACA,gBAAgB,MAChB,mBAAmB,OAEnB,IAAI;AAAA,EACF;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;AAZJ,IAAM,kBAAN;AA4GA,IAAO,0BAAQ;;;AC1Hf;AAAA,EACE;AAAA,EACA;AAAA,EACA,aAAAC;AAAA,OAEK;;;ACQP,IAAM,gBAAN,MAAM,sBAAqB,kBAAU;AAAA,EAgBnC,YAAY,OAAe;AACzB,UAAM;AAHR,wBAAiB;AAIf,SAAK,QAAQ;AAAA,EACf;AAAA,EAEA,UAAsB;AAEpB,UAAM,MAAM,KAAK,SAAS,KAAK,MAAM,SAAS,MAAM,IAAI,MAAM;AAC9D,UAAM,YAAY,IAAI;AAEtB,UAAM,QAAQ,IAAI,WAAW,IAAI,SAAS,CAAC;AAE3C,QAAI,YAAY;AAChB,QAAI,cAAc;AAGlB,WAAO,YAAY,WAAW;AAC5B,YAAM,OAAO,SAAS,IAAI,UAAU,WAAW,YAAY,CAAC,GAAG,EAAE;AACjE,YAAM,WAAW,IAAI;AAErB,mBAAa;AACb,qBAAe;AAAA,IACjB;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,aAAqB;AACnB,UAAM,QAAQ,KAAK,QAAQ;AAC3B,QAAI,YAAY,KAAK,EAAG,QAAO,YAAY,KAAK;AAChD,WAAO,qBAAqB,KAAK;AAAA,EACnC;AAAA,EAEA,aAAmB;AACjB,UAAM,OAAO,KAAK,WAAW;AAC7B,UAAM,OAAO,UAAU,IAAI;AAC3B,QAAI,CAAC,KAAM,OAAM,IAAI,0BAA0B,IAAI;AACnD,WAAO;AAAA,EACT;AAAA,EAEA,WAAmB;AACjB,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,QAAsB;AACpB,WAAO,cAAa,GAAG,KAAK,KAAK;AAAA,EACnC;AAAA,EAEA,WAAmB;AACjB,WAAO,IAAI,KAAK,KAAK;AAAA,EACvB;AAAA,EAEA,cAAsB;AACpB,WAAO,KAAK,MAAM,SAAS;AAAA,EAC7B;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,WAAO,QAAQ,IAAI,kBAAU;AAC7B,cAAU,qBAAqB,KAAK,OAAO,QAAQ,MAAM;AACzD,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,KAAK,MAAM,SAAS;AAAA,EAC7B;AACF;AA7EE,cADI,eACG,MAAK,CAAC,UAAkB,IAAI,cAAa,KAAK;AAErD,cAHI,eAGG,YAAW,CAAC,UAAkB;AACnC,QAAM,UAAU,YAAY,KAAK;AAEjC,MAAI,MAAM;AACV,WAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,WAAO,uBAAuB,QAAQ,GAAG,GAAG,CAAC;AAAA,EAC/C;AAEA,SAAO,IAAI,cAAa,GAAG;AAC7B;AAZF,IAAM,eAAN;AAgFA,IAAO,uBAAQ;;;ADvEf,IAAM,wBAAN,MAAM,sBAAqB;AAAA,EASjB,YAAY,UAAqB,YAAqB;AAL9D,wBAAS;AACT,wBAAS;AACT,wBAAS;AACT,wBAAS;AAIP,SAAK,WACH,aAAaC,WAAU,eAAe,UAAU,eAC5C,aAAaA,WAAU,SAAe,UAAU,SAC9C,UAAU;AAElB,SAAK,OAAO,KAAK,KAAK,QAAQ;AAC9B,SAAK,WAAW,KAAK,KAAK;AAC1B,SAAK,aAAa;AAAA,EACpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,WAAW,MAA4B;AACrC,UAAM,SAAS,KAAK,mBAAmB,IAAI;AAC3C,UAAM,WAAW,IAAI,MAAM,OAAO,MAAM;AACxC,aAAS,MAAM,GAAG,MAAM,OAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,eAAS,GAAG,IAAI,YAAY,OAAO,GAAG,EAAE,IAAI;AAAA,IAC9C;AACA,WAAO,qBAAa,GAAG,SAAS,KAAK,EAAE,CAAC;AAAA,EAC1C;AAAA,EAEA,kBAAkB,MAAc,MAAsB;AACpD,UAAM,SAAS,KAAK,mBAAmB,IAAI;AAC3C,QAAI,aAAa;AAEjB,aAAS,MAAM,GAAG,MAAM,OAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,YAAM,OAAO,OAAO,GAAG,EAAE;AACzB,YAAM,SAAS,OAAO,MAAM,CAAC,KAAK,CAAC,GAAG;AACtC,YAAM,aAAa,KAAK,KAAK,uBAAuB,MAAM,KAAK,KAAK;AACpE,oBAAc,KAAK,aAAa,IAAI,IAAI;AAAA,IAC1C;AAEA,UAAMC,SAAQ,OAAO;AACrB,WAAO,aAAaA;AAAA,EACtB;AAAA,EAEA,mBACE,MACA,UAAmC,CAAC,GAC5B;AACR,UAAM,EAAE,YAAY,KAAK,IAAI;AAE7B,UAAM,EAAE,UAAU,WAAW,SAAS,IAAI,KAAK;AAC/C,UAAM,OAAO,YAAY,SAAS,CAAC;AACnC,UAAM,UAAU,aAAa,SAAS,CAAC;AAEvC,QAAI,SAAS,OAAO;AACpB,QAAI,CAAC,UAAW,WAAU,aAAa;AAEvC,WAAQ,SAAS,MAAQ;AAAA,EAC3B;AAAA,EAEA,mBAAmB,QAAwB;AACzC,UAAM,EAAE,UAAU,WAAW,SAAS,IAAI,KAAK;AAC/C,UAAM,OAAO,YAAY,SAAS,CAAC;AACnC,UAAM,UAAU,aAAa,SAAS,CAAC;AACvC,WAAQ,MAAO,UAAW,OAAO;AAAA,EACnC;AAAA,EAEA,iBAAiB,SAAqB,KAAsB;AAC1D,UAAM,WAAW,QAAQ,IAAI;AAAA,MAC3B,MAAM;AAAA,MACN,SAAS;AAAA,MACT,UAAU,KAAK,cAAc,KAAK;AAAA,MAElC,UACE,KAAK,aAAa,UAAU,UAAU,oBAAoB;AAAA,IAC9D,CAAC;AAED,QAAI,KAAK;AACP,cAAQ,OAAO,KAAK,QAAQ;AAC5B,aAAO;AAAA,IACT,OAAO;AACL,aAAO,QAAQ,SAAS,QAAQ;AAAA,IAClC;AAAA,EACF;AAAA,EAEQ,aAAa,WAA2B;AAE9C,WAAO,KAAK,KAAK,gBAAgB,SAAS,KAAK;AAAA,EACjD;AAAA,EAEQ,mBAAmB,MAAuB;AAChD,UAAM,aAAa,MAAM,KAAK,IAAI;AAClC,UAAM,SAAkB,IAAI,MAAM,WAAW,MAAM;AACnD,aAAS,MAAM,GAAG,MAAM,WAAW,QAAQ,MAAM,KAAK,OAAO;AAC3D,YAAM,YAAY,YAAY,WAAW,GAAG,CAAC;AAC7C,aAAO,GAAG,IAAI,KAAK,SAAS,uBAAuB,SAAS;AAAA,IAC9D;AACA,WAAO;AAAA,EACT;AACF;AAxGE,cADI,uBACG,OAAM,CAAC,UAAqB,eACjC,IAAI,sBAAqB,UAAU,UAAU;AAFjD,IAAM,uBAAN;AA2GA,IAAO,+BAAQ;;;AEnHR,IAAM,aAAa,CAAC,QAAiB,YAAmC;AAC7E,QAAM,UAAoB,IAAI,MAAM,OAAO,MAAM;AACjD,WAAS,MAAM,GAAG,MAAM,OAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,UAAM,QAAQ,OAAO,GAAG;AACxB,UAAM,KAAK,cAAc,cAAc,QAAQ,KAAK,CAAC,CAAC;AACtD,UAAM,UAAU,cAAc,GAAG,MAAM,WAAW,IAAI,mBAAmB,CAAC;AAC1E,YAAQ,GAAG,IAAI,CAAC,IAAI,OAAO;AAAA,EAC7B;AAEA,SAAO,iBAAiB,OAAO;AACjC;AAIA,IAAM,mBAAmB,CAAC,YAAsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAc9C,QAAQ,MAAM;AAAA,EACd,QAAQ,IAAI,CAAC,CAAC,SAAS,SAAS,MAAM,GAAG,OAAO,IAAI,SAAS,EAAE,EAAE,KAAK,IAAI,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAU7E,IAAM,gBAAgB,IAAIC,YAAqB,IAAIA,QAAO,KAAK,EAAE,CAAC;AAElE,IAAM,gBAAgB,CAAC,UAAkB,uBAAuB,OAAO,CAAC;AAExE,IAAM,sBAAsB,CAAC,cAAsB;AACjD,MAAI,YAAY,SAAS,EAAG,QAAO,cAAc,SAAS;AAE1D,MAAI,cAAc,SAAS,GAAG;AAC5B,UAAM,KAAK,cAAc,SAAS;AAClC,UAAM,KAAK,aAAa,SAAS;AACjC,WAAO,GAAG,cAAc,EAAE,CAAC,GAAG,cAAc,EAAE,CAAC;AAAA,EACjD;AAEA,QAAM,MAAM,YAAY,SAAS;AACjC,QAAM,MAAM,KAAK,GAAG;AACpB,QAAM,IAAI,MAAM,GAAG;AACrB;;;ACtDA,IAAM,gBAAgB,CAAC,YAA6B;AAClD,MAAI,QAAQ;AAEZ,QAAM,UAAU,CAAC,QAAgB;AAC/B,aAAU,KAAM,MAAM;AAAA,EACxB;AAEA,MAAI,QAAQ,WAAa,SAAQ,CAAC;AAClC,MAAI,QAAQ,MAAa,SAAQ,CAAC;AAClC,MAAI,QAAQ,SAAa,SAAQ,CAAC;AAClC,MAAI,QAAQ,OAAa,SAAQ,CAAC;AAClC,MAAI,QAAQ,YAAa,SAAQ,CAAC;AAClC,MAAI,QAAQ,OAAa,SAAQ,CAAC;AAClC,MAAI,QAAQ,OAAa,SAAQ,EAAE;AACnC,MAAI,QAAQ,SAAa,SAAQ,EAAE;AACnC,MAAI,QAAQ,UAAa,SAAQ,EAAE;AAEnC,SAAO;AACT;AAGO,IAAM,kBAAkB,CAAC,SAAuB;AACrD,QAAM,cAAc,KAAK,MAAM,IAAI,KAAK,MAAM,EAAE,eAAe;AAC/D,QAAM,QAAQ,cAAc;AAAA,IAC1B,YAAY,KAAK,KAAK;AAAA,IACtB,OAAO,KAAK,eAAe,eAAe;AAAA,IAC1C,UAAU;AAAA;AAAA,IACV,QAAQ,gBAAgB;AAAA,IACxB,QAAQ,KAAK,KAAK,SAAS;AAAA,EAC7B,CAAC;AACD,SAAO;AACT;;;ACjCA,IAAM,aAAN,MAAM,mBAAkB,kBAAU;AAAA,EAkBxB,YAAY,OAAe;AACjC,UAAM;AAHR,wBAAiB;AAIf,SAAK,QAAQ;AAAA,EACf;AAAA,EAEA,UAAsB;AACpB,UAAM,QAAkB,CAAC;AAEzB,QAAI,QAAQ;AACZ,QAAI,UAAU;AAEd,UAAM,WAAW,CAAC,SAAkB;AAClC,UAAI,SAAS,OAAW,OAAM,KAAK,IAAI;AACvC,gBAAU;AAAA,IACZ;AAEA,aAAS,MAAM,GAAG,MAAM,KAAK,MAAM,QAAQ,MAAM,KAAK,OAAO;AAC3D,YAAM,OAAO,KAAK,MAAM,GAAG;AAC3B,YAAM,OAAO,WAAW,IAAI;AAC5B,YAAM,WAAW,KAAK,MAAM,MAAM,CAAC;AACnC,UAAI,CAAC,SAAS;AACZ,YAAI,SAAS,kBAAU,UAAW,WAAU;AAAA,YACvC,UAAS,IAAI;AAAA,MACpB,OAAO;AACL,YAAI,SAAS,kBAAU,QAAS,UAAS;AAAA,iBAChC,SAAS,kBAAU,eAAgB,UAAS;AAAA,iBAC5C,SAAS,kBAAU,EAAG,UAAS,kBAAU,OAAO;AAAA,iBAChD,SAAS,kBAAU,EAAG,UAAS,kBAAU,cAAc;AAAA,iBACvD,SAAS,kBAAU,EAAG,UAAS,kBAAU,GAAG;AAAA,iBAC5C,SAAS,kBAAU,EAAG,UAAS,kBAAU,SAAS;AAAA,iBAClD,SAAS,kBAAU,EAAG,UAAS,kBAAU,QAAQ;AAAA,iBACjD,SAAS,kBAAU,UAAW,UAAS,kBAAU,SAAS;AAAA,iBAC1D,SAAS,kBAAU,WAAY,UAAS,kBAAU,UAAU;AAAA,iBAC5D,SAAS,kBAAU,UAAW,UAAS,kBAAU,SAAS;AAAA,iBAC1D,QAAQ,kBAAU,QAAQ,QAAQ,kBAAU,OAAO;AAC1D,mBAAS;AACT,cAAI,MAAM,WAAW,KAAK,EAAE,YAAY,OAAO,YAAY,MAAM;AAC/D,qBAAS,SAAS,OAAO,CAAC,CAAC;AAC3B,oBAAQ;AAAA,UACV;AAAA,QACF,OAAO;AACL,mBAAS,IAAI;AAAA,QACf;AAAA,MACF;AAAA,IACF;AAEA,WAAO,IAAI,WAAW,KAAK;AAAA,EAC7B;AAAA,EAEA,aAAqB;AACnB,UAAM,QAAQ,KAAK,QAAQ;AAC3B,QAAI,YAAY,KAAK,EAAG,QAAO,YAAY,KAAK;AAChD,WAAO,qBAAqB,KAAK;AAAA,EACnC;AAAA,EAEA,aAAmB;AACjB,UAAM,OAAO,KAAK,WAAW;AAC7B,UAAM,OAAO,UAAU,IAAI;AAC3B,QAAI,CAAC,KAAM,OAAM,IAAI,0BAA0B,IAAI;AACnD,WAAO;AAAA,EACT;AAAA,EAEA,WAAmB;AACjB,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,QAAmB;AACjB,WAAO,WAAU,GAAG,KAAK,KAAK;AAAA,EAChC;AAAA,EAEA,WAAmB;AACjB,WAAO,IAAI,KAAK,KAAK;AAAA,EACvB;AAAA,EAEA,cAAsB;AACpB,WAAO,KAAK,MAAM,SAAS;AAAA,EAC7B;AAAA,EAEA,cAAc,QAAoB,QAAwB;AACxD,WAAO,QAAQ,IAAI,kBAAU;AAC7B,cAAU,qBAAqB,KAAK,OAAO,QAAQ,MAAM;AACzD,WAAO,QAAQ,IAAI,kBAAU;AAC7B,WAAO,KAAK,MAAM,SAAS;AAAA,EAC7B;AACF;AAAA;AAAA;AAAA;AAlGE,cAJI,YAIG,MAAK,CAAC,UAAkB,IAAI,WAAU,KAAK;AAElD,cANI,YAMG,YAAW,CAAC,SAAe;AAChC,QAAM,OAAO,SAAS,OAAO,KAAK,eAAe,CAAC,GAAG,GAAG,GAAG;AAC3D,QAAM,QAAQ,SAAS,OAAO,KAAK,YAAY,IAAI,CAAC,GAAG,GAAG,GAAG;AAC7D,QAAM,MAAM,SAAS,OAAO,KAAK,WAAW,CAAC,GAAG,GAAG,GAAG;AACtD,QAAM,QAAQ,SAAS,OAAO,KAAK,YAAY,CAAC,GAAG,GAAG,GAAG;AACzD,QAAM,OAAO,SAAS,OAAO,KAAK,cAAc,CAAC,GAAG,GAAG,GAAG;AAC1D,QAAM,OAAO,SAAS,OAAO,KAAK,cAAc,CAAC,GAAG,GAAG,GAAG;AAC1D,SAAO,IAAI,WAAU,KAAK,IAAI,GAAG,KAAK,GAAG,GAAG,GAAG,KAAK,GAAG,IAAI,GAAG,IAAI,GAAG;AACvE;AAdF,IAAM,YAAN;AAwGA,IAAO,oBAAQ;;;ACjGf,IAAM,qBAAN,MAAM,oBAAmB;AAAA,EAqBb,YACR,MACA,UACA,YACA,cACA;AAfF,wBAAS;AACT,wBAAS;AACT,wBAAS;AACT,wBAAS;AACT,wBAAS;AACT,wBAAS;AAET,wBAAU;AACV,wBAAU;AAuMV,wBAAQ,6BAA4B,MAAe;AACjD,YAAM,SAAkB,IAAI,MAAM,KAAK,KAAK,aAAa,MAAM;AAC/D,eAAS,MAAM,GAAG,MAAM,OAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,cAAM,YAAY,KAAK,KAAK,aAAa,GAAG;AAC5C,eAAO,GAAG,IAAI,KAAK,KAAK,kBAAkB,SAAS;AAAA,MACrD;AACA,aAAO,WAAW,OAAO,KAAK,aAAa,GAAG,CAAC,MAAM,EAAE,EAAE;AAAA,IAC3D;AAtME,SAAK,OAAO;AACZ,SAAK,QAAQ,MAAO,KAAK,KAAK;AAC9B,SAAK,WAAW;AAChB,SAAK,WAAW,KAAK,KAAK,kBAAkB;AAC5C,SAAK,aAAa;AAClB,SAAK,eAAe;AAEpB,SAAK,eAAe;AACpB,SAAK,aAAa,cAAM,YAAY,KAAK,yBAAyB;AAAA,EACpE;AAAA,EAnCA,aAAa,IACX,SACA,UACA,YACA,cACA;AACA,UAAM,OAAO,MAAM,QAAQ,OAAO,QAAQ;AAC1C,WAAO,IAAI,oBAAmB,MAAM,UAAU,YAAY,YAAY;AAAA,EACxE;AAAA;AAAA;AAAA;AAAA;AAAA,EAiCA,WAAW,MAA4B;AACrC,UAAM,EAAE,OAAO,IAAI,KAAK,KAAK,OAAO,MAAM,KAAK,YAAY;AAC3D,UAAM,WAAW,IAAI,MAAM,OAAO,MAAM;AACxC,aAAS,MAAM,GAAG,MAAM,OAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,eAAS,GAAG,IAAI,uBAAuB,OAAO,GAAG,EAAE,IAAI,CAAC;AAAA,IAC1D;AACA,WAAO,qBAAa,GAAG,SAAS,KAAK,EAAE,CAAC;AAAA,EAC1C;AAAA;AAAA;AAAA,EAIA,kBAAkB,MAAc,MAAsB;AACpD,UAAM,EAAE,OAAO,IAAI,KAAK,KAAK,OAAO,MAAM,KAAK,YAAY;AAC3D,QAAI,aAAa;AACjB,aAAS,MAAM,GAAG,MAAM,OAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,oBAAc,OAAO,GAAG,EAAE,eAAe,KAAK;AAAA,IAChD;AACA,UAAMC,SAAQ,OAAO;AACrB,WAAO,aAAaA;AAAA,EACtB;AAAA,EAEA,mBACE,MACA,UAAmC,CAAC,GAC5B;AACR,UAAM,EAAE,YAAY,KAAK,IAAI;AAE7B,UAAM,EAAE,QAAQ,SAAS,KAAK,IAAI,KAAK;AACvC,UAAM,QAAQ,UAAU,KAAK,QAAQ,KAAK;AAC1C,UAAM,WAAW,WAAW,KAAK,QAAQ,KAAK;AAE9C,QAAI,SAAS,OAAO;AACpB,QAAI,CAAC,UAAW,WAAU,KAAK,IAAI,OAAO,KAAK;AAE/C,WAAQ,SAAS,MAAQ;AAAA,EAC3B;AAAA,EAEA,mBAAmB,QAAwB;AACzC,UAAM,EAAE,QAAQ,SAAS,KAAK,IAAI,KAAK;AACvC,UAAM,QAAQ,UAAU,KAAK,QAAQ,KAAK;AAC1C,UAAM,WAAW,WAAW,KAAK,QAAQ,KAAK;AAC9C,WAAQ,MAAO,UAAW,OAAO;AAAA,EACnC;AAAA,EAEA,iBAAiB,SAAqB,KAA+B;AACnE,SAAK,eACH,KAAK,cAAc,QAAQ,gBAAgB,KAAK,QAAQ;AAC1D,WAAO,KAAK,cAAc,SAAS,GAAG;AAAA,EACxC;AAAA,EAEA,MAAgB,cACd,SACA,KACiB;AACjB,UAAM,iBAAiB,MAAM,KAAK,iBAAiB,OAAO;AAC1D,UAAM,iBAAiB,KAAK,iBAAiB,OAAO;AAEpD,UAAM,WAAW,QAAQ,IAAI;AAAA,MAC3B,MAAM;AAAA,MACN,SAAS;AAAA,MACT,UAAU,KAAK;AAAA,MACf,UAAU;AAAA,MACV,iBAAiB,CAAC,cAAc;AAAA,MAChC,WAAW;AAAA,IACb,CAAC;AAED,QAAI,KAAK;AACP,cAAQ,OAAO,KAAK,QAAQ;AAC5B,aAAO;AAAA,IACT,OAAO;AACL,aAAO,QAAQ,SAAS,QAAQ;AAAA,IAClC;AAAA,EACF;AAAA,EAEU,QAAiB;AACzB,WAAO,KAAK,KAAK;AAAA,EACnB;AAAA,EAEA,MAAgB,iBAAiB,SAAsC;AACrE,UAAM,oBAAoB,MAAM,KAAK,oBAAoB,OAAO;AAEhE,UAAM,cAAc,QAAQ,IAAI;AAAA,MAC9B,MAAM;AAAA,MACN,SAAS,KAAK,MAAM,IAAI,iBAAiB;AAAA,MACzC,aAAa;AAAA,MACb,UAAU,KAAK;AAAA,MACf,eAAe;AAAA,QACb,UAAU,kBAAU,GAAG,OAAO;AAAA,QAC9B,UAAU,kBAAU,GAAG,UAAU;AAAA,QACjC,YAAY;AAAA,MACd;AAAA,MACA,gBAAgB;AAAA,MAChB,GAAG,KAAK,cAAc;AAAA,IACxB,CAAC;AAED,WAAO,QAAQ,SAAS,WAAW;AAAA,EACrC;AAAA,EAEA,MAAgB,oBAAoB,SAAsC;AACxE,UAAM,gBAAgB,MAAM,KAAK,gBAAgB,OAAO;AAExD,UAAM,EAAE,OAAAA,OAAM,IAAI;AAClB,UAAM,EAAE,aAAa,QAAQ,SAAS,WAAW,QAAQ,IAAI,KAAK;AAClE,UAAM,EAAE,MAAM,MAAM,MAAM,KAAK,IAAI,KAAK,KAAK;AAE7C,UAAM,iBAAiB,QAAQ,IAAI;AAAA,MACjC,MAAM;AAAA,MACN,UAAU,KAAK;AAAA,MACf,OAAO,gBAAgB,KAAK,IAAI;AAAA,MAChC,UAAU,CAAC,OAAOA,QAAO,OAAOA,QAAO,OAAOA,QAAO,OAAOA,MAAK;AAAA,MACjE,aAAa;AAAA,MACb,QAAQ,SAASA;AAAA,MACjB,SAAS,UAAUA;AAAA,MACnB,YAAY,aAAa,UAAUA;AAAA,MACnC,UAAU,WAAW,KAAKA;AAAA;AAAA;AAAA,MAI1B,OAAO;AAAA,MAEP,CAAC,KAAK,MAAM,IAAI,cAAc,WAAW,GAAG;AAAA,IAC9C,CAAC;AAED,WAAO,QAAQ,SAAS,cAAc;AAAA,EACxC;AAAA,EAEA,MAAgB,gBAAqC;AACnD,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,MAAgB,gBAAgB,SAAsC;AACpE,UAAM,aAAa,QAAQ,YAAY,MAAM,KAAK,cAAc,GAAG;AAAA,MACjE,SAAS,KAAK,MAAM,IAAI,kBAAkB;AAAA,IAC5C,CAAC;AACD,WAAO,QAAQ,SAAS,UAAU;AAAA,EACpC;AAAA,EAEU,iBAAiB,SAA6B;AACtD,UAAM,OAAO,WAAW,KAAK,WAAW,OAAO,GAAG,KAAK,QAAQ,KAAK,IAAI,CAAC;AACzE,UAAM,aAAa,QAAQ,YAAY,IAAI;AAC3C,WAAO,QAAQ,SAAS,UAAU;AAAA,EACpC;AAAA,EAEU,QAAQ,OAAuB;AACvC,WAAO,QAAQ,MAAM,KAAK;AAAA,EAC5B;AAAA,EAEU,gBAAuC;AAC/C,UAAM,SAAS,KAAK,WAAW,OAAO;AAEtC,UAAM,SAAgC,CAAC;AACvC,QAAI,cAAwB,CAAC;AAE7B,aAAS,MAAM,GAAG,MAAM,OAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,YAAM,YAAY,OAAO,GAAG;AAC5B,YAAM,YAAY,OAAO,MAAM,CAAC;AAEhC,YAAM,cAAc,KAAK,QAAQ,SAAS;AAC1C,YAAM,cAAc,KAAK,QAAQ,SAAS;AAE1C,UAAI,QAAQ,GAAG;AACb,eAAO,KAAK,WAAW;AAAA,MACzB,WAAW,cAAc,gBAAgB,GAAG;AAC1C,eAAO,KAAK,WAAW;AACvB,eAAO,KAAK,WAAW;AACvB,sBAAc,CAAC;AAAA,MACjB;AAEA,kBAAY,KAAK,UAAU,eAAe,KAAK,KAAK;AAAA,IACtD;AAEA,WAAO,KAAK,WAAW;AAEvB,WAAO;AAAA,EACT;AAUF;AAEA,IAAO,6BAAQ;;;AC7Of,IAAM,2BAAN,MAAM,kCAAiC,2BAAmB;AAAA,EAoBhD,YACN,MACA,UACA,gBACA,cACA;AACA,UAAM,MAAM,UAAU,gBAAgB,YAAY;AAVpD,wBAAiB;AACjB,wBAAiB;AACjB,wBAAiB;AAUf,SAAK,SAAS,KAAK,KAAK,aAAa;AACrC,SAAK,SAAS,CAAC;AACf,SAAK,aAAa,cAAM,YAAY,MAAM,KAAK,MAAM;AACrD,SAAK,aAAa,oBAAI,IAAI;AAAA,EAC5B;AAAA,EA/BA,aAAa,IACX,SACA,UACA,gBACA,cACA;AACA,UAAM,OAAO,MAAM,QAAQ,OAAO,QAAQ;AAC1C,WAAO,IAAI;AAAA,MACT;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAAA,EAoBA,WAAW,MAA4B;AACrC,UAAM,EAAE,OAAO,IAAI,KAAK,KAAK,OAAO,MAAM,KAAK,YAAY;AAC3D,UAAM,WAAW,IAAI,MAAM,OAAO,MAAM;AAExC,aAAS,MAAM,GAAG,MAAM,OAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,YAAM,QAAQ,OAAO,GAAG;AACxB,YAAM,gBAAgB,KAAK,OAAO,aAAa,KAAK;AAEpD,WAAK,OAAO,gBAAgB,CAAC,IAAI;AACjC,WAAK,WAAW,IAAI,MAAM,IAAI,aAAa;AAE3C,eAAS,GAAG,IAAI,uBAAuB,eAAe,CAAC;AAAA,IACzD;AAEA,SAAK,WAAW,WAAW;AAC3B,WAAO,qBAAa,GAAG,SAAS,KAAK,EAAE,CAAC;AAAA,EAC1C;AAAA,EAEU,QAAiB;AACzB,WAAQ,KAAK,OAAe;AAAA,EAC9B;AAAA,EAEU,QAAQ,OAAuB;AACvC,WAAO,QAAQ,KAAK,WAAW,IAAI,MAAM,EAAE,IAAK;AAAA,EAClD;AAAA,EAEU,gBAAqC;AAC7C,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,YAAM,QAAsB,CAAC;AAC7B,WAAK,OACF,aAAa,EACb,GAAG,QAAQ,CAAC,UAAU,MAAM,KAAK,KAAK,CAAC,EACvC,GAAG,OAAO,MAAM,QAAQ,iBAAiB,KAAK,CAAC,CAAC,EAChD,GAAG,SAAgB,CAAC,QAAQ,OAAO,GAAG,CAAC;AAAA,IAC5C,CAAC;AAAA,EACH;AACF;AAEA,IAAO,mCAAQ;;;ACzER,IAAK,iBAAL,kBAAKC,oBAAL;AACL,EAAAA,gBAAA,YAAS;AACT,EAAAA,gBAAA,UAAO;AACP,EAAAA,gBAAA,iBAAc;AACd,EAAAA,gBAAA,gBAAa;AACb,EAAAA,gBAAA,sBAAmB;AACnB,EAAAA,gBAAA,cAAW;AACX,EAAAA,gBAAA,YAAS;AACT,EAAAA,gBAAA,iBAAc;AARJ,SAAAA;AAAA,GAAA;AAmBZ,IAAM,eAAN,MAAM,cAAa;AAAA,EAaT,YACN,UACA,UACA,UAA+B,CAAC,GAChC;AARF,wBAAiB;AACjB,wBAAS;AACT,wBAAS;AAOP,SAAK,WAAW;AAChB,SAAK,WAAW;AAChB,SAAK,UAAU;AAAA,EACjB;AAAA,EApBA,OAAO,IACL,OACA,UACA,UAA+B,CAAC,GAChC;AACA,WAAO,IAAI,cAAa,OAAO,UAAU,OAAO;AAAA,EAClD;AAAA,EAgBA,MAAM,iBAAiB,SAAqB,KAA+B;AACzE,UAAM;AAAA,MACJ;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF,IAAI,KAAK;AAET,UAAM,qBAAqB,QAAQ,YAAY,KAAK,UAAU;AAAA,MAC5D,MAAM;AAAA,MACN,SAAS,YAAY;AAAA,MACrB,QAAQ;AAAA,QACN,MAAM,KAAK,SAAS;AAAA,QACpB,cAAc,eACV,kBAAU,SAAS,YAAY,IAC/B;AAAA,QACJ,SAAS,mBACL,kBAAU,SAAS,gBAAgB,IACnC;AAAA,MACN;AAAA,IACF,CAAC;AACD,UAAM,wBAAwB,QAAQ,SAAS,kBAAkB;AAEjE,UAAM,eAAe,QAAQ,IAAI;AAAA,MAC/B,MAAM;AAAA,MACN,GAAG,kBAAU,GAAG,KAAK,QAAQ;AAAA;AAAA,MAC7B,IAAI,qBAAa,SAAS,KAAK,QAAQ;AAAA,MACvC,IAAI,EAAE,GAAG,sBAAsB;AAAA,MAC/B,MAAM,cAAc,qBAAa,SAAS,WAAW,IAAI;AAAA,MACzD,gBAAgB,kBAAkB;AAAA,IACpC,CAAC;AAED,QAAI,KAAK;AACP,cAAQ,OAAO,KAAK,YAAY;AAChC,aAAO;AAAA,IACT,OAAO;AACL,aAAO,QAAQ,SAAS,YAAY;AAAA,IACtC;AAAA,EACF;AACF;AAEA,IAAO,uBAAQ;;;AC1Ff,IAAM,UAAU;AAAA,EACd;AAAA,EAAQ;AAAA,EAAQ;AAAA,EAChB;AAAA,EAAQ;AAAA,EAAQ;AAAA,EAChB;AAAA,EAAQ;AAAA,EAAQ;AAAA,EAChB;AAAA,EAAQ;AAAA,EAAQ;AAAA,EAChB;AAAA,EAAQ;AAAA,EAAQ;AAClB;AAQA,IAAM,sBAAiE;AAAA,EACrE,GAAG;AAAA,EACH,GAAG;AAAA,EACH,GAAG;AACL;AAOA,IAAM,eAAN,MAAM,cAAa;AAAA,EAkDT,YACN,WACA,kBACA,OACA,QACA,YACA;AAbF,wBAAS;AACT,wBAAS;AACT,wBAAS;AACT,wBAAS;AAET,wBAAiB;AASf,SAAK,YAAY;AACjB,SAAK,mBAAmB;AACxB,SAAK,QAAQ;AACb,SAAK,SAAS;AACd,SAAK,aAAa;AAAA,EACpB;AAAA,EA7DA,aAAa,IAAI,WAAuB;AACtC,UAAM,WAAW,IAAI,SAAS,UAAU,MAAM;AAE9C,UAAM,MAAM,SAAS,UAAU,CAAC;AAChC,QAAI,QAAQ,MAAQ,OAAM,IAAI,MAAM,uBAAuB;AAE3D,QAAI,MAAM;AACV,QAAI;AAEJ,WAAO,MAAM,SAAS,YAAY;AAChC,eAAS,SAAS,UAAU,GAAG;AAC/B,aAAO;AACP,UAAI,QAAQ,SAAS,MAAM,EAAG;AAC9B,aAAO,SAAS,UAAU,GAAG;AAAA,IAC/B;AAEA,QAAI,CAAC,QAAQ,SAAS,MAAO,EAAG,OAAM,IAAI,MAAM,cAAc;AAC9D,WAAO;AAEP,UAAM,mBAAmB,SAAS,SAAS,KAAK;AAChD,UAAM,SAAS,SAAS,UAAU,GAAG;AACrC,WAAO;AAEP,UAAM,QAAQ,SAAS,UAAU,GAAG;AACpC,WAAO;AAEP,UAAM,cAAc,SAAS,SAAS,KAAK;AAC3C,UAAM,cAAc,oBAAoB,WAAW;AAEnD,QAAI,CAAC,YAAa,OAAM,IAAI,MAAM,uBAAuB;AAEzD,UAAM,aAAa;AAEnB,WAAO,IAAI;AAAA,MACT;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAAA,EAuBA,MAAM,iBAAiB,SAAqB,KAA+B;AACzE,UAAM,UAAU,QAAQ,OAAO,KAAK,WAAW;AAAA,MAC7C,MAAM;AAAA,MACN,SAAS;AAAA,MACT,kBAAkB,KAAK;AAAA,MACvB,OAAO,KAAK;AAAA,MACZ,QAAQ,KAAK;AAAA,MACb,YAAY,KAAK;AAAA,MACjB,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAUR,QACE,KAAK,eAAe,gCAChB,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,IACvB;AAAA,IACR,CAAC;AAED,QAAI,KAAK;AACP,cAAQ,OAAO,KAAK,OAAO;AAC3B,aAAO;AAAA,IACT,OAAO;AACL,aAAO,QAAQ,SAAS,OAAO;AAAA,IACjC;AAAA,EACF;AACF;AAEA,IAAO,uBAAQ;;;AC9Hf,OAAO,UAAU;AAEjB,IAAM,eAAe,CAAC,UAAkB;AACtC,MAAI,UAAU,EAAG,QAAO;AACxB,MAAI,UAAU,EAAG,QAAO;AACxB,MAAI,UAAU,EAAG,QAAO;AACxB,MAAI,UAAU,EAAG,QAAO;AACxB,MAAI,UAAU,EAAG,QAAO;AACxB,QAAM,IAAI,MAAM,uBAAuB,KAAK,EAAE;AAChD;AAEA,IAAM,oBAAoB,CAAC,gBAA4B;AACrD,QAAM,aAAa,KAAK,MAAM,YAAY,SAAS,CAAC;AAEpD,QAAM,aAAa,IAAI,WAAW,aAAa,CAAC;AAChD,QAAM,eAAe,IAAI,WAAW,aAAa,CAAC;AAElD,MAAI,aAAa;AACjB,MAAI,YAAY;AAChB,MAAI,cAAc;AAElB,SAAO,aAAa,YAAY,QAAQ;AACtC,eAAW,WAAW,IAAI,YAAY,YAAY;AAClD,eAAW,WAAW,IAAI,YAAY,YAAY;AAClD,eAAW,WAAW,IAAI,YAAY,YAAY;AAClD,iBAAa,aAAa,IAAI,YAAY,YAAY;AAAA,EACxD;AAEA,SAAO,EAAE,YAAY,aAAa;AACpC;AAUO,IAAM,OAAN,MAAM,KAAI;AAAA,EAUP,YAAY,SAAqB;AAPzC,wBAAS;AACT,wBAAS;AACT,wBAAS;AACT,wBAAS;AACT,wBAAS;AACT,wBAAS;AAGP,QAAI;AACJ,QAAI,QAAQ,kBAAkB,aAAa;AACzC,eAAS,QAAQ;AAAA,IACnB,OAAO;AACL,eAAS,IAAI,YAAY,QAAQ,UAAU;AAC3C,UAAI,WAAW,MAAM,EAAE,IAAI,OAAO;AAAA,IACpC;AAEA,UAAM,OAAO,KAAK,OAAO,MAAM;AAC/B,UAAM,SAAS,KAAK,QAAQ,IAAI;AAEhC,QAAI,OAAO,SAAS,EAAG,OAAM,IAAI,MAAM,iCAAiC;AAExE,UAAM,QAAQ,IAAI,WAAW,OAAO,CAAC,CAAC;AACtC,UAAM,EAAE,YAAY,aAAa,IAAI,kBAAkB,KAAK;AAE5D,SAAK,aAAa;AAElB,UAAM,iBAAiB,aAAa,KAAK,CAAC,MAAM,IAAI,GAAG;AACvD,QAAI,eAAgB,MAAK,eAAe;AAExC,SAAK,OAAO,aAAa,KAAK,KAAK;AAEnC,SAAK,QAAQ,KAAK;AAClB,SAAK,SAAS,KAAK;AACnB,SAAK,mBAAmB;AAAA,EAC1B;AACF;AArCE,cADW,MACJ,QAAO,CAAC,YAAwB,IAAI,KAAI,OAAO;AADjD,IAAM,MAAN;;;AC9BP,IAAM,cAAN,MAAM,aAAY;AAAA,EAaR,YAAY,KAAU;AAP9B,wBAAS;AACT,wBAAS;AACT,wBAAS;AACT,wBAAS;AAET,wBAAiB;AAGf,SAAK,QAAQ;AACb,SAAK,mBAAmB,IAAI;AAC5B,SAAK,QAAQ,IAAI;AACjB,SAAK,SAAS,IAAI;AAClB,SAAK,aAAa;AAAA,EACpB;AAAA,EAlBA,aAAa,IAAI,WAAuB;AACtC,UAAM,MAAM,IAAI,KAAK,SAAS;AAC9B,WAAO,IAAI,aAAY,GAAG;AAAA,EAC5B;AAAA,EAiBA,MAAM,iBAAiB,SAAqB,KAA+B;AACzE,UAAM,QAAQ,KAAK,kBAAkB,OAAO;AAE5C,UAAM,UAAU,QAAQ,YAAY,KAAK,MAAM,YAAY;AAAA,MACzD,MAAM;AAAA,MACN,SAAS;AAAA,MACT,kBAAkB,KAAK,MAAM;AAAA,MAC7B,OAAO,KAAK,MAAM;AAAA,MAClB,QAAQ,KAAK,MAAM;AAAA,MACnB,YAAY,KAAK;AAAA,MACjB;AAAA,IACF,CAAC;AAED,QAAI,KAAK;AACP,cAAQ,OAAO,KAAK,OAAO;AAC3B,aAAO;AAAA,IACT,OAAO;AACL,aAAO,QAAQ,SAAS,OAAO;AAAA,IACjC;AAAA,EACF;AAAA,EAEQ,kBAAkB,SAAyC;AACjE,QAAI,CAAC,KAAK,MAAM,aAAc,QAAO;AAErC,UAAM,UAAU,QAAQ,YAAY,KAAK,MAAM,cAAc;AAAA,MAC3D,MAAM;AAAA,MACN,SAAS;AAAA,MACT,QAAQ,KAAK,MAAM;AAAA,MACnB,OAAO,KAAK,MAAM;AAAA,MAClB,kBAAkB,KAAK,MAAM;AAAA,MAC7B,YAAY;AAAA,MACZ,QAAQ,CAAC,GAAG,CAAC;AAAA,IACf,CAAC;AAED,WAAO,QAAQ,SAAS,OAAO;AAAA,EACjC;AACF;AAEA,IAAO,sBAAQ;;;ACxCf,IAAM,SAAN,MAAM,QAA6B;AAAA,EAMjC,YAAY,QAAoB,OAAgB,QAAiB;AALjE,wBAAQ;AACR,wBAAQ;AACR,wBAAQ;AACR,wBAAQ;AAGN,SAAK,QAAQ;AACb,SAAK,QAAQ,SAAS;AACtB,SAAK,MAAM,KAAK;AAChB,SAAK,MAAM,CAAC,CAAC,SAAS,CAAC,CAAC,SAAS,QAAQ,SAAS,KAAK,MAAM;AAAA,EAC/D;AAAA,EAEA,IAAI,SAAS;AACX,WAAO,KAAK,MAAM,KAAK;AAAA,EACzB;AAAA,EAEA,IAAI,UAAU;AACZ,WAAO,KAAK,WAAW;AAAA,EACzB;AAAA,EAEA,UAAU;AACR,QAAI,KAAK,OAAO,KAAK,KAAK;AACxB,aAAO;AAAA,IACT;AACA,WAAO,KAAK,MAAM,KAAK,KAAK;AAAA,EAC9B;AAAA,EAEA,YAAY;AACV,UAAM,KAAK,KAAK,QAAQ;AACxB,UAAM,KAAK,KAAK,QAAQ;AACxB,QAAI,OAAO,MAAM,OAAO,IAAI;AAC1B,aAAO;AAAA,IACT;AACA,YAAQ,MAAM,KAAK;AAAA,EACrB;AAAA,EAEA,WAAW;AACT,UAAM,KAAK,KAAK,QAAQ;AACxB,UAAM,KAAK,KAAK,QAAQ;AACxB,UAAM,KAAK,KAAK,QAAQ;AACxB,UAAM,KAAK,KAAK,QAAQ;AACxB,YAAQ,MAAM,OAAO,MAAM,OAAO,MAAM,KAAK;AAAA,EAC/C;AAAA;AAAA,EAGA,SAAS,QAAgB,eAAe,OAAO;AAC7C,UAAM,QAAQ,KAAK;AACnB,UAAM,MAAM,KAAK;AACjB,UAAM,SAAS,KAAK;AAEpB,QAAI,CAAC,QAAQ;AACX,YAAM,WAAW,MAAM,SAAS,KAAK,MAAM;AAE3C,aAAO,eAAe,IAAI,kBAAkB,QAAQ,IAAI;AAAA,IAC1D,OAAO;AACL,UAAI,MAAM,MAAM;AAChB,UAAI,MAAM,QAAQ;AAChB,cAAM;AAAA,MACR;AACA,WAAK,MAAM;AACX,YAAM,WAAW,MAAM,SAAS,KAAK,GAAG;AAExC,aAAO,eAAe,IAAI,kBAAkB,QAAQ,IAAI;AAAA,IAC1D;AAAA,EACF;AAAA,EAEA,WAAW;AACT,UAAM,aAAa,KAAK,QAAQ;AAChC,SAAK;AACL,WAAO;AAAA,EACT;AAAA,EAEA,UAAU,QAAgB,eAAe,OAAO;AAC9C,UAAM,QAAQ,KAAK,SAAS,QAAQ,YAAY;AAChD,SAAK,OAAO,MAAM;AAClB,WAAO;AAAA,EACT;AAAA,EAEA,KAAK,GAAW;AACd,QAAI,CAAC,GAAG;AACN,UAAI;AAAA,IACN;AACA,SAAK,OAAO;AAAA,EACd;AAAA,EAEA,QAAQ;AACN,SAAK,MAAM,KAAK;AAAA,EAClB;AAAA,EAEA,YAAY;AACV,SAAK,QAAQ,KAAK;AAAA,EACpB;AAAA,EAEA,cAAc,OAAe,QAAgB;AAC3C,WAAO,IAAI,QAAO,KAAK,OAAO,OAAO,MAAM;AAAA,EAC7C;AAAA,EAEA,SAAqB;AACnB,WAAO,KAAK;AAAA,EACd;AACF;AAEA,IAAO,iBAAQ;;;ACpHf,IAAM,cAAc,IAAI,WAAW,CAAC;AAKpC,IAAM,eAAN,MAAyC;AAAA,EAQvC,YAAY,sBAA+B;AAP3C,wBAAU;AACV,wBAAU;AACV,wBAAU;AAEV,wBAAQ;AACR,wBAAQ;AAGN,SAAK,MAAM;AACX,SAAK,eAAe;AACpB,SAAK,MAAM;AACX,SAAK,SAAS;AACd,SAAK,kBAAkB;AACvB,QAAI,sBAAsB;AAExB,aAAO,KAAK,kBAAkB,sBAAsB;AAClD,aAAK,mBAAmB;AAAA,MAC1B;AAAA,IACF;AAAA,EACF;AAAA,EAEA,IAAI,UAAU;AACZ,WAAO,CAAC,KAAK,OAAO,KAAK,iBAAiB,GAAG;AAC3C,WAAK,UAAU;AAAA,IACjB;AACA,WAAO,KAAK,iBAAiB;AAAA,EAC/B;AAAA,EAEA,UAAU;AACR,UAAM,MAAM,KAAK;AACjB,WAAO,KAAK,gBAAgB,KAAK;AAC/B,UAAI,KAAK,KAAK;AACZ,eAAO;AAAA,MACT;AACA,WAAK,UAAU;AAAA,IACjB;AACA,WAAO,KAAK,OAAO,KAAK,KAAK;AAAA,EAC/B;AAAA,EAEA,YAAY;AACV,UAAM,KAAK,KAAK,QAAQ;AACxB,UAAM,KAAK,KAAK,QAAQ;AACxB,QAAI,OAAO,MAAM,OAAO,IAAI;AAC1B,aAAO;AAAA,IACT;AACA,YAAQ,MAAM,KAAK;AAAA,EACrB;AAAA,EAEA,WAAW;AACT,UAAM,KAAK,KAAK,QAAQ;AACxB,UAAM,KAAK,KAAK,QAAQ;AACxB,UAAM,KAAK,KAAK,QAAQ;AACxB,UAAM,KAAK,KAAK,QAAQ;AACxB,YAAQ,MAAM,OAAO,MAAM,OAAO,MAAM,KAAK;AAAA,EAC/C;AAAA,EAEA,SAAS,QAAgB,eAAe,OAAO;AAC7C,QAAI;AACJ,UAAM,MAAM,KAAK;AAEjB,QAAI,QAAQ;AACV,WAAK,aAAa,MAAM,MAAM;AAC9B,YAAM,MAAM;AAEZ,aAAO,CAAC,KAAK,OAAO,KAAK,eAAe,KAAK;AAC3C,aAAK,UAAU;AAAA,MACjB;AACA,YAAM,SAAS,KAAK;AACpB,UAAI,MAAM,QAAQ;AAChB,cAAM;AAAA,MACR;AAAA,IACF,OAAO;AACL,aAAO,CAAC,KAAK,KAAK;AAChB,aAAK,UAAU;AAAA,MACjB;AACA,YAAM,KAAK;AAAA,IACb;AAEA,SAAK,MAAM;AACX,UAAM,WAAW,KAAK,OAAO,SAAS,KAAK,GAAG;AAE9C,WAAO,gBAAgB,EAAE,oBAAoB,qBACzC,IAAI,kBAAkB,QAAQ,IAC9B;AAAA,EACN;AAAA,EAEA,WAAW;AACT,UAAM,aAAa,KAAK,QAAQ;AAChC,SAAK;AACL,WAAO;AAAA,EACT;AAAA,EAEA,UAAU,QAAgB,eAAe,OAAO;AAC9C,UAAM,QAAQ,KAAK,SAAS,QAAQ,YAAY;AAChD,SAAK,OAAO,MAAM;AAClB,WAAO;AAAA,EACT;AAAA,EAEA,KAAK,GAAW;AACd,QAAI,CAAC,GAAG;AACN,UAAI;AAAA,IACN;AACA,SAAK,OAAO;AAAA,EACd;AAAA,EAEA,QAAQ;AACN,SAAK,MAAM;AAAA,EACb;AAAA,EAEA,cAAc,OAAe,QAA2B;AACtD,UAAM,MAAM,QAAQ;AACpB,WAAO,KAAK,gBAAgB,OAAO,CAAC,KAAK,KAAK;AAC5C,WAAK,UAAU;AAAA,IACjB;AACA,WAAO,IAAI;AAAA,MAAO,KAAK;AAAA,MAAQ;AAAA,MAAO;AAAA;AAAA,IAAiB;AAAA,EACzD;AAAA,EAEA,SAAqB;AACnB,WAAO,CAAC,KAAK,IAAK,MAAK,UAAU;AACjC,WAAO,KAAK,OAAO,SAAS,GAAG,KAAK,YAAY;AAAA,EAClD;AAAA,EAEU,YAAkB;AAC1B,UAAM,IAAI,0BAA0B,KAAK,YAAY,MAAM,WAAW;AAAA,EACxE;AAAA,EAEU,aAAa,WAAmB;AACxC,UAAM,SAAS,KAAK;AACpB,QAAI,aAAa,OAAO,YAAY;AAClC,aAAO;AAAA,IACT;AACA,QAAI,OAAO,KAAK;AAChB,WAAO,OAAO,WAAW;AACvB,cAAQ;AAAA,IACV;AACA,UAAM,UAAU,IAAI,WAAW,IAAI;AACnC,YAAQ,IAAI,MAAM;AAClB,WAAQ,KAAK,SAAS;AAAA,EACxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQF;AAEA,IAAO,uBAAQ;;;AC9Jf,IAAM,UAAU,CAAC,OACf,OAAO,MAAQ,OAAO,KAAQ,OAAO,MAAQ,OAAO;AAEtD,IAAM,gBAAN,cAA4B,qBAAa;AAAA,EAIvC,YAAYC,SAAoB,aAAsB;AACpD,UAAM,WAAW;AAJnB,wBAAQ;AACR,wBAAQ;AAKN,SAAK,SAASA;AACd,SAAK,QAAQ,IAAI,WAAW,CAAC;AAI7B,QAAI,aAAa;AACf,oBAAc,MAAM;AAAA,IACtB;AAAA,EACF;AAAA,EAEU,YAAY;AACpB,UAAM,aAAa;AACnB,UAAM,eAAe;AACrB,UAAM,MAAM;AAEZ,UAAMA,UAAS,KAAK;AAEpB,QAAI,IAAIA,QAAO,QAAQ;AACvB,WAAO,QAAQ,CAAC,GAAG;AACjB,UAAIA,QAAO,QAAQ;AAAA,IACrB;AAEA,QAAI,MAAM,OAAO,MAAM,YAAY;AACjC,WAAK,MAAM;AACX;AAAA,IACF;AAEA,UAAM,eAAe,KAAK;AAC1B,QAAI;AACJ,QAAI;AAGJ,QAAI,MAAM,cAAc;AACtB,eAAS,KAAK,aAAa,eAAe,CAAC;AAC3C,WAAK,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG;AACtB,eAAO,eAAe,CAAC,IAAI;AAAA,MAC7B;AACA,WAAK,gBAAgB;AAAA,IACvB,OAAO;AACL,YAAM,QAAQ,KAAK;AACnB,YAAM,CAAC,IAAI;AACX,WAAK,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG;AACtB,YAAIA,QAAO,QAAQ;AACnB,eAAO,QAAQ,CAAC,GAAG;AACjB,cAAIA,QAAO,QAAQ;AAAA,QACrB;AAEA,cAAM,CAAC,IAAI;AAEX,YAAI,MAAM,OAAO,MAAM,YAAY;AACjC;AAAA,QACF;AAAA,MACF;AACA,eAAS,KAAK,aAAa,eAAe,IAAI,CAAC;AAC/C,WAAK,gBAAgB,IAAI;AAGzB,UAAI,IAAI,GAAG;AACT,eAAO,IAAI,GAAG,EAAE,GAAG;AACjB,gBAAM,CAAC,IAAI,KAAO;AAAA,QACpB;AACA,aAAK,MAAM;AAAA,MACb;AACA,UAAI,IAAI;AACR,WAAK,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG;AACtB,YAAI,IAAI,MAAM,MAAM,CAAC,IAAI;AAAA,MAC3B;AAEA,WAAK,IAAI,GAAG,KAAK,GAAG,EAAE,GAAG;AACvB,eAAO,eAAe,CAAC,IAAI,IAAI;AAC/B,cAAM;AAAA,MACR;AAAA,IACF;AAAA,EACF;AACF;AAEA,IAAO,wBAAQ;;;ACtFf,IAAM,iBAAN,cAA6B,qBAAa;AAAA,EAIxC,YAAYC,SAAoB,aAAsB;AACpD,UAAM,WAAW;AAJnB,wBAAQ;AACR,wBAAQ;AAKN,SAAK,SAASA;AAEd,SAAK,aAAa;AAIlB,QAAI,aAAa;AACf,oBAAc,MAAM;AAAA,IACtB;AAAA,EACF;AAAA,EAEU,YAAY;AACpB,UAAM,sBAAsB;AAC5B,UAAM,QAAQ,KAAK,OAAO,SAAS,mBAAmB;AACtD,QAAI,CAAC,MAAM,QAAQ;AACjB,WAAK,MAAM;AACX;AAAA,IACF;AAEA,UAAM,kBAAmB,MAAM,SAAS,KAAM;AAC9C,UAAM,SAAS,KAAK,aAAa,KAAK,eAAe,eAAe;AACpE,QAAI,eAAe,KAAK;AAExB,QAAI,aAAa,KAAK;AACtB,aAAS,IAAI,GAAG,KAAK,MAAM,QAAQ,IAAI,IAAI,KAAK;AAC9C,YAAM,KAAK,MAAM,CAAC;AAClB,UAAI;AACJ,UAAI,MAAM,MAAQ,MAAM,IAAM;AAE5B,gBAAQ,KAAK;AAAA,MACf,WAAY,MAAM,MAAQ,MAAM,MAAU,MAAM,MAAQ,MAAM,KAAO;AAEnE,iBAAS,KAAK,MAAQ;AAAA,MACxB,WAAW,OAAO,IAAM;AAEtB,aAAK,MAAM;AACX;AAAA,MACF,OAAO;AAEL;AAAA,MACF;AACA,UAAI,aAAa,GAAG;AAClB,qBAAa;AAAA,MACf,OAAO;AACL,eAAO,cAAc,IAAK,cAAc,IAAK;AAC7C,qBAAa;AAAA,MACf;AAAA,IACF;AACA,QAAI,cAAc,KAAK,KAAK,KAAK;AAE/B,aAAO,cAAc,IAAI,cAAc;AACvC,mBAAa;AAAA,IACf;AACA,SAAK,aAAa;AAClB,SAAK,eAAe;AAAA,EACtB;AACF;AAEA,IAAO,yBAAQ;;;ACvDf,IAAM,iBAAiB,IAAI,WAAW;AAAA,EACpC;AAAA,EAAI;AAAA,EAAI;AAAA,EAAI;AAAA,EAAG;AAAA,EAAG;AAAA,EAAG;AAAA,EAAG;AAAA,EAAG;AAAA,EAAI;AAAA,EAAG;AAAA,EAAI;AAAA,EAAG;AAAA,EAAI;AAAA,EAAG;AAAA,EAAI;AAAA,EAAG;AAAA,EAAI;AAAA,EAAG;AAChE,CAAC;AAGD,IAAM,eAAe,IAAI,WAAW;AAAA,EAClC;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AACxD,CAAC;AAGD,IAAM,aAAa,IAAI,WAAW;AAAA,EAChC;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAC/C,CAAC;AAGD,IAAM,kBAAkB,CAAC,IAAI,WAAW;AAAA,EACtC;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AACjE,CAAC,GAAG,CAAC;AAGL,IAAM,mBAAmB,CAAC,IAAI,WAAW;AAAA,EACvC;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAC/D;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AACjE,CAAC,GAAG,CAAC;AAEL,IAAM,cAAN,cAA0B,qBAAa;AAAA,EAKrC,YAAYC,SAAoB,aAAsB;AACpD,UAAM,WAAW;AALnB,wBAAQ;AACR,wBAAQ;AACR,wBAAQ;AAKN,SAAK,SAASA;AAEd,UAAM,MAAMA,QAAO,QAAQ;AAC3B,UAAM,MAAMA,QAAO,QAAQ;AAC3B,QAAI,QAAQ,MAAM,QAAQ,IAAI;AAC5B,YAAM,IAAI,MAAM,mCAAmC,GAAG,KAAK,GAAG,EAAE;AAAA,IAClE;AACA,SAAK,MAAM,QAAU,GAAM;AACzB,YAAM,IAAI;AAAA,QACR,+CAA+C,GAAG,KAAK,GAAG;AAAA,MAC5D;AAAA,IACF;AACA,UAAM,OAAO,KAAK,OAAO,OAAO,GAAG;AACjC,YAAM,IAAI,MAAM,+BAA+B,GAAG,KAAK,GAAG,EAAE;AAAA,IAC9D;AACA,QAAI,MAAM,IAAM;AACd,YAAM,IAAI,MAAM,kCAAkC,GAAG,KAAK,GAAG,EAAE;AAAA,IACjE;AAEA,SAAK,WAAW;AAChB,SAAK,UAAU;AAAA,EACjB;AAAA,EAEU,YAAY;AACpB,QAAI;AACJ,QAAI;AACJ,UAAM,MAAM,KAAK;AAEjB,QAAI,MAAM,KAAK,QAAQ,CAAC;AACxB,QAAI,MAAM,GAAG;AACX,WAAK,MAAM;AAAA,IACb;AACA,YAAQ;AAER,QAAI,QAAQ,GAAG;AAEb,UAAI;AAEJ,WAAK,IAAI,IAAI,QAAQ,OAAO,IAAI;AAC9B,cAAM,IAAI,MAAM,kCAAkC;AAAA,MACpD;AACA,UAAI,WAAW;AACf,WAAK,IAAI,IAAI,QAAQ,OAAO,IAAI;AAC9B,cAAM,IAAI,MAAM,kCAAkC;AAAA,MACpD;AACA,kBAAY,KAAK;AACjB,WAAK,IAAI,IAAI,QAAQ,OAAO,IAAI;AAC9B,cAAM,IAAI,MAAM,kCAAkC;AAAA,MACpD;AACA,UAAI,QAAQ;AACZ,WAAK,IAAI,IAAI,QAAQ,OAAO,IAAI;AAC9B,cAAM,IAAI,MAAM,kCAAkC;AAAA,MACpD;AACA,eAAS,KAAK;AACd,UAAI,WAAW,CAAC,WAAW,WAAY,aAAa,KAAK,UAAU,IAAI;AAErE,cAAM,IAAI,MAAM,+CAA+C;AAAA,MACjE;AAEA,WAAK,UAAU;AACf,WAAK,WAAW;AAEhB,YAAM,eAAe,KAAK;AAC1B,eAAS,KAAK,aAAa,eAAe,QAAQ;AAClD,YAAM,MAAM,eAAe;AAC3B,WAAK,eAAe;AACpB,UAAI,aAAa,GAAG;AAClB,YAAI,IAAI,SAAS,MAAM,IAAI;AACzB,eAAK,MAAM;AAAA,QACb;AAAA,MACF,OAAO;AACL,iBAAS,IAAI,cAAc,IAAI,KAAK,EAAE,GAAG;AACvC,eAAK,IAAI,IAAI,QAAQ,OAAO,IAAI;AAC9B,iBAAK,MAAM;AACX;AAAA,UACF;AACA,iBAAO,CAAC,IAAI;AAAA,QACd;AAAA,MACF;AACA;AAAA,IACF;AAEA,QAAI;AACJ,QAAI;AACJ,QAAI,QAAQ,GAAG;AAEb,qBAAe;AACf,sBAAgB;AAAA,IAClB,WAAW,QAAQ,GAAG;AAEpB,YAAM,cAAc,KAAK,QAAQ,CAAC,IAAI;AACtC,YAAM,eAAe,KAAK,QAAQ,CAAC,IAAI;AACvC,YAAM,kBAAkB,KAAK,QAAQ,CAAC,IAAI;AAG1C,YAAM,qBAAqB,IAAI,WAAW,eAAe,MAAM;AAE/D,UAAI;AACJ,WAAK,IAAI,GAAG,IAAI,iBAAiB,EAAE,GAAG;AACpC,2BAAmB,eAAe,CAAC,CAAC,IAAI,KAAK,QAAQ,CAAC;AAAA,MACxD;AACA,YAAM,iBAAiB,KAAK,qBAAqB,kBAAkB;AAGnE,YAAM;AACN,UAAI;AACJ,YAAM,QAAQ,cAAc;AAC5B,YAAM,cAAc,IAAI,WAAW,KAAK;AACxC,UAAI;AACJ,UAAI;AACJ,UAAI;AACJ,aAAO,IAAI,OAAO;AAChB,cAAM,OAAO,KAAK,QAAQ,cAAc;AACxC,YAAI,SAAS,IAAI;AACf,uBAAa;AACb,uBAAa;AACb,iBAAO;AAAA,QACT,WAAW,SAAS,IAAI;AACtB,uBAAa;AACb,uBAAa;AACb,iBAAO,MAAM;AAAA,QACf,WAAW,SAAS,IAAI;AACtB,uBAAa;AACb,uBAAa;AACb,iBAAO,MAAM;AAAA,QACf,OAAO;AACL,sBAAY,GAAG,IAAI,MAAM;AACzB;AAAA,QACF;AAEA,YAAI,eAAe,KAAK,QAAQ,UAAU,IAAI;AAC9C,eAAO,iBAAiB,GAAG;AACzB,sBAAY,GAAG,IAAI;AAAA,QACrB;AAAA,MACF;AAEA,qBAAe,KAAK;AAAA,QAClB,YAAY,SAAS,GAAG,WAAW;AAAA,MACrC;AACA,sBAAgB,KAAK;AAAA,QACnB,YAAY,SAAS,aAAa,KAAK;AAAA,MACzC;AAAA,IACF,OAAO;AACL,YAAM,IAAI,MAAM,oCAAoC;AAAA,IACtD;AAEA,aAAS,KAAK;AACd,QAAI,QAAQ,SAAS,OAAO,SAAS;AACrC,QAAI,MAAM,KAAK;AACf,WAAO,MAAM;AACX,UAAI,QAAQ,KAAK,QAAQ,YAAY;AACrC,UAAI,QAAQ,KAAK;AACf,YAAI,MAAM,KAAK,OAAO;AACpB,mBAAS,KAAK,aAAa,MAAM,CAAC;AAClC,kBAAQ,OAAO;AAAA,QACjB;AACA,eAAO,KAAK,IAAI;AAChB;AAAA,MACF;AACA,UAAI,UAAU,KAAK;AACjB,aAAK,eAAe;AACpB;AAAA,MACF;AACA,eAAS;AACT,cAAQ,aAAa,KAAK;AAC1B,UAAI,QAAQ,SAAS;AACrB,UAAI,QAAQ,GAAG;AACb,gBAAQ,KAAK,QAAQ,KAAK;AAAA,MAC5B;AACA,aAAO,QAAQ,SAAU;AACzB,cAAQ,KAAK,QAAQ,aAAa;AAClC,cAAQ,WAAW,KAAK;AACxB,cAAQ,SAAS;AACjB,UAAI,QAAQ,GAAG;AACb,gBAAQ,KAAK,QAAQ,KAAK;AAAA,MAC5B;AACA,YAAM,QAAQ,QAAQ,SAAU;AAChC,UAAI,MAAM,OAAO,OAAO;AACtB,iBAAS,KAAK,aAAa,MAAM,GAAG;AACpC,gBAAQ,OAAO;AAAA,MACjB;AACA,eAAS,IAAI,GAAG,IAAI,KAAK,EAAE,GAAG,EAAE,KAAK;AACnC,eAAO,GAAG,IAAI,OAAO,MAAM,IAAI;AAAA,MACjC;AAAA,IACF;AAAA,EACF;AAAA,EAEQ,QAAQ,MAAc;AAC5B,UAAM,MAAM,KAAK;AACjB,QAAI,WAAW,KAAK;AACpB,QAAI,UAAU,KAAK;AAEnB,QAAI;AACJ,WAAO,WAAW,MAAM;AACtB,WAAK,IAAI,IAAI,QAAQ,OAAO,IAAI;AAC9B,cAAM,IAAI,MAAM,8BAA8B;AAAA,MAChD;AACA,iBAAW,KAAK;AAChB,kBAAY;AAAA,IACd;AACA,QAAI,WAAY,KAAK,QAAQ;AAC7B,SAAK,UAAU,WAAW;AAC1B,SAAK,WAAW,YAAY;AAE5B,WAAO;AAAA,EACT;AAAA,EAEQ,QAAQ,OAA6B;AAC3C,UAAM,MAAM,KAAK;AACjB,UAAM,QAAQ,MAAM,CAAC;AACrB,UAAM,SAAS,MAAM,CAAC;AACtB,QAAI,WAAW,KAAK;AACpB,QAAI,UAAU,KAAK;AAEnB,QAAI;AACJ,WAAO,WAAW,QAAQ;AACxB,WAAK,IAAI,IAAI,QAAQ,OAAO,IAAI;AAG9B;AAAA,MACF;AACA,iBAAW,KAAK;AAChB,kBAAY;AAAA,IACd;AACA,UAAM,OAAO,MAAM,WAAY,KAAK,UAAU,CAAE;AAChD,QAAI,OAAO,UAAU,UAAU;AAC7B,cAAQ,IAAI,UAAU,IAAI;AAAA,IAC5B;AACA,UAAM,UAAU,QAAQ;AACxB,UAAM,UAAU,OAAO;AACvB,QAAI,UAAU,KAAK,WAAW,SAAS;AACrC,YAAM,IAAI,MAAM,8BAA8B;AAAA,IAChD;AACA,SAAK,UAAU,WAAW;AAC1B,SAAK,WAAW,WAAW;AAC3B,WAAO;AAAA,EACT;AAAA,EAEQ,qBAAqB,SAA2C;AACtE,UAAM,IAAI,QAAQ;AAGlB,QAAI,SAAS;AACb,QAAI;AACJ,SAAK,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG;AACtB,UAAI,QAAQ,CAAC,IAAI,QAAQ;AACvB,iBAAS,QAAQ,CAAC;AAAA,MACpB;AAAA,IACF;AAGA,UAAM,OAAO,KAAK;AAClB,UAAM,QAAQ,IAAI,WAAW,IAAI;AACjC,aACM,MAAM,GAAG,OAAO,GAAG,OAAO,GAC9B,OAAO,QACP,EAAE,KAAK,SAAS,GAAG,SAAS,GAC5B;AACA,eAAS,MAAM,GAAG,MAAM,GAAG,EAAE,KAAK;AAChC,YAAI,QAAQ,GAAG,MAAM,KAAK;AAExB,cAAI,QAAQ;AACZ,cAAI,IAAI;AACR,eAAK,IAAI,GAAG,IAAI,KAAK,EAAE,GAAG;AACxB,oBAAS,SAAS,IAAM,IAAI;AAC5B,kBAAM;AAAA,UACR;AAGA,eAAK,IAAI,OAAO,IAAI,MAAM,KAAK,MAAM;AACnC,kBAAM,CAAC,IAAK,OAAO,KAAM;AAAA,UAC3B;AACA,YAAE;AAAA,QACJ;AAAA,MACF;AAAA,IACF;AAEA,WAAO,CAAC,OAAO,MAAM;AAAA,EACvB;AACF;AAEA,IAAO,sBAAQ;;;AC3Yf,IAAM,YAAN,cAAwB,qBAAa;AAAA,EAgBnC,YACEC,SACA,aACA,aACA;AACA,UAAM,WAAW;AApBnB,wBAAQ;AACR,wBAAQ;AACR,wBAAQ;AACR,wBAAQ;AAmBN,SAAK,SAASA;AACd,SAAK,aAAa;AAClB,SAAK,aAAa;AAElB,UAAM,uBAAuB;AAC7B,UAAM,WAAW;AAAA,MACf;AAAA,MACA,YAAY;AAAA,MACZ,UAAU;AAAA,MACV,kBAAkB,IAAI,WAAW,oBAAoB;AAAA,MACrD,mBAAmB,IAAI,YAAY,oBAAoB;AAAA,MACvD,qBAAqB,IAAI,YAAY,oBAAoB;AAAA,MACzD,iBAAiB,IAAI,WAAW,oBAAoB;AAAA,MACpD,uBAAuB;AAAA,IACzB;AACA,aAAS,IAAI,GAAG,IAAI,KAAK,EAAE,GAAG;AAC5B,eAAS,iBAAiB,CAAC,IAAI;AAC/B,eAAS,kBAAkB,CAAC,IAAI;AAAA,IAClC;AACA,SAAK,WAAW;AAAA,EAClB;AAAA,EAEU,YAAY;AACpB,UAAM,YAAY;AAElB,QAAI,uBAAuB,YAAY;AACvC,UAAM,mBAAmB;AACzB,QAAI;AACJ,QAAI;AACJ,QAAI;AAEJ,UAAM,WAAW,KAAK;AACtB,QAAI,CAAC,UAAU;AACb;AAAA,IACF;AAEA,UAAM,cAAc,SAAS;AAC7B,QAAI,WAAW,SAAS;AACxB,UAAM,mBAAmB,SAAS;AAClC,UAAM,oBAAoB,SAAS;AACnC,UAAM,sBAAsB,SAAS;AACrC,QAAI,aAAa,SAAS;AAC1B,QAAI,WAAW,SAAS;AACxB,UAAM,kBAAkB,SAAS;AACjC,QAAI,wBAAwB,SAAS;AAErC,QAAI,gBAAgB;AACpB,QAAI,sBAAsB,KAAK;AAC/B,QAAI,SAAS,KAAK,aAAa,KAAK,eAAe,oBAAoB;AAEvE,SAAK,IAAI,GAAG,IAAI,WAAW,KAAK;AAC9B,YAAM,OAAO,KAAK,SAAS,UAAU;AACrC,YAAM,UAAU,wBAAwB;AACxC,UAAI,CAAC,QAAQ,OAAO,KAAK;AACvB,wBAAgB,CAAC,IAAI;AACrB,gCAAwB;AAAA,MAC1B,WAAW,QAAQ,KAAK;AACtB,YAAI,OAAO,UAAU;AACnB,kCAAwB,kBAAkB,IAAI;AAC9C,eAAK,IAAI,wBAAwB,GAAG,IAAI,MAAM,KAAK,GAAG,KAAK;AACzD,4BAAgB,CAAC,IAAI,iBAAiB,CAAC;AACvC,gBAAI,oBAAoB,CAAC;AAAA,UAC3B;AAAA,QACF,OAAO;AACL,0BAAgB,uBAAuB,IAAI,gBAAgB,CAAC;AAAA,QAC9D;AAAA,MACF,WAAW,SAAS,KAAK;AACvB,qBAAa;AACb,mBAAW;AACX,gCAAwB;AACxB;AAAA,MACF,OAAO;AACL,aAAK,MAAM;AACX,eAAO,KAAK;AACZ;AAAA,MACF;AAEA,UAAI,SAAS;AACX,4BAAoB,QAAQ,IAAI;AAChC,0BAAkB,QAAQ,IAAI,kBAAkB,QAAkB,IAAI;AACtE,yBAAiB,QAAQ,IAAI,gBAAgB,CAAC;AAC9C;AACA,qBACG,WAAW,cAAgB,WAAW,cAAc,IACjD,aACA,KAAK;AAAA,UACL,KAAK,IAAI,WAAW,WAAW,IAAI,qBAAqB;AAAA,UACxD;AAAA,QACF,IAAI;AAAA,MACV;AACA,iBAAW;AAEX,uBAAiB;AACjB,UAAI,uBAAuB,eAAe;AACxC,WAAG;AACD,kCAAwB;AAAA,QAC1B,SAAS,uBAAuB;AAChC,iBAAS,KAAK,aAAa,KAAK,eAAe,oBAAoB;AAAA,MACrE;AACA,WAAK,IAAI,GAAG,IAAI,uBAAuB,KAAK;AAC1C,eAAO,qBAAqB,IAAI,gBAAgB,CAAC;AAAA,MACnD;AAAA,IACF;AACA,aAAS,WAAW;AACpB,aAAS,aAAa;AACtB,aAAS,WAAW;AACpB,aAAS,wBAAwB;AAEjC,SAAK,eAAe;AAAA,EACtB;AAAA,EAEQ,SAAS,GAAW;AAC1B,QAAI,aAAa,KAAK;AACtB,QAAI,aAAa,KAAK;AACtB,WAAO,aAAa,GAAG;AACrB,YAAM,IAAI,KAAK,OAAO,QAAQ;AAC9B,UAAI,MAAM,IAAI;AACZ,aAAK,MAAM;AACX,eAAO;AAAA,MACT;AACA,mBAAc,cAAc,IAAK;AACjC,oBAAc;AAAA,IAChB;AACA,SAAK,aAAa,cAAc;AAChC,SAAK,aAAa;AAClB,WAAQ,eAAe,cAAgB,KAAK,KAAK;AAAA,EACnD;AACF;AAEA,IAAO,oBAAQ;;;ACxJf,IAAM,kBAAN,cAA8B,qBAAa;AAAA,EAGzC,YAAYC,SAAoB,aAAsB;AACpD,UAAM,WAAW;AAHnB,wBAAQ;AAIN,SAAK,SAASA;AAAA,EAChB;AAAA,EAEU,YAAY;AAKpB,UAAM,eAAe,KAAK,OAAO,SAAS,CAAC;AAC3C,QAAI,CAAC,gBAAgB,aAAa,SAAS,KAAK,aAAa,CAAC,MAAM,KAAK;AACvE,WAAK,MAAM;AACX;AAAA,IACF;AAEA,QAAI;AACJ,QAAI,eAAe,KAAK;AACxB,QAAI,IAAI,aAAa,CAAC;AACtB,QAAI,IAAI,KAAK;AAEX,eAAS,KAAK,aAAa,eAAe,IAAI,CAAC;AAC/C,aAAO,cAAc,IAAI,aAAa,CAAC;AACvC,UAAI,IAAI,GAAG;AACT,cAAM,SAAS,KAAK,OAAO,SAAS,CAAC;AACrC,eAAO,IAAI,QAAQ,YAAY;AAC/B,wBAAgB;AAAA,MAClB;AAAA,IACF,OAAO;AACL,UAAI,MAAM;AACV,YAAM,IAAI,aAAa,CAAC;AACxB,eAAS,KAAK,aAAa,eAAe,IAAI,CAAC;AAC/C,eAAS,IAAI,GAAG,IAAI,GAAG,KAAK;AAC1B,eAAO,cAAc,IAAI;AAAA,MAC3B;AAAA,IACF;AACA,SAAK,eAAe;AAAA,EACtB;AACF;AAEA,IAAO,0BAAQ;;;ACrCf,IAAM,eAAe,CACnBC,SACA,UACA,WACG;AACH,MAAI,aAAa,gBAAQ,GAAG,aAAa,GAAG;AAC1C,WAAO,IAAI,oBAAYA,OAAM;AAAA,EAC/B;AACA,MAAI,aAAa,gBAAQ,GAAG,WAAW,GAAG;AACxC,QAAI,cAAc;AAClB,QAAI,kBAAkB,iBAAS;AAC7B,YAAM,cAAc,OAAO,OAAO,gBAAQ,GAAG,aAAa,CAAC;AAC3D,UAAI,uBAAuB,mBAAW;AACpC,sBAAc,YAAY,SAAS;AAAA,MACrC;AAAA,IACF;AACA,WAAO,IAAI,kBAAUA,SAAQ,QAAW,WAAoB;AAAA,EAC9D;AACA,MAAI,aAAa,gBAAQ,GAAG,eAAe,GAAG;AAC5C,WAAO,IAAI,sBAAcA,OAAM;AAAA,EACjC;AACA,MAAI,aAAa,gBAAQ,GAAG,gBAAgB,GAAG;AAC7C,WAAO,IAAI,uBAAeA,OAAM;AAAA,EAClC;AACA,MAAI,aAAa,gBAAQ,GAAG,iBAAiB,GAAG;AAC9C,WAAO,IAAI,wBAAgBA,OAAM;AAAA,EACnC;AACA,QAAM,IAAI,yBAAyB,SAAS,SAAS,CAAC;AACxD;AAEO,IAAM,qBAAqB,CAAC,EAAE,MAAM,SAAS,MAAoB;AACtE,MAAIA,UAAqB,IAAI,eAAO,QAAQ;AAE5C,QAAM,SAAS,KAAK,OAAO,gBAAQ,GAAG,QAAQ,CAAC;AAC/C,QAAM,cAAc,KAAK,OAAO,gBAAQ,GAAG,aAAa,CAAC;AAEzD,MAAI,kBAAkB,iBAAS;AAC7B,IAAAA,UAAS;AAAA,MACPA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF,WAAW,kBAAkB,kBAAU;AACrC,aAAS,MAAM,GAAG,MAAM,OAAO,KAAK,GAAG,MAAM,KAAK,OAAO;AACvD,MAAAA,UAAS;AAAA,QACPA;AAAA,QACA,OAAO,OAAO,KAAK,eAAO;AAAA,QAC1B,eAAgB,YAAyB,YAAY,KAAK,eAAO;AAAA,MACnE;AAAA,IACF;AAAA,EACF,WAAW,QAAQ;AACjB,UAAM,IAAI,0BAA0B,CAAC,iBAAS,gBAAQ,GAAG,MAAM;AAAA,EACjE;AAEA,SAAOA;AACT;;;ACjCA,IAAM,sBAAsB,CAAC,SAAsB;AACjD,QAAM,WAAW,KAAK,SAAS;AAE/B,QAAM,QACJ,SAAS,OAAO,GAAG,iBAAS,EAAE,SAAS,IACvC,SAAS,OAAO,GAAG,iBAAS,EAAE,SAAS;AAEzC,QAAM,SACJ,SAAS,OAAO,GAAG,iBAAS,EAAE,SAAS,IACvC,SAAS,OAAO,GAAG,iBAAS,EAAE,SAAS;AAEzC,SAAO,EAAE,MAAM,GAAG,QAAQ,GAAG,OAAO,OAAO,KAAK,OAAO;AACzD;AAIA,IAAM,4BAA4B,CAChC,OACyB,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,MAAM;AAE5D,IAAM,kBAAN,MAAM,iBAAgB;AAAA,EAgBZ,YACN,MACA,aACA,sBACA;AAXF,wBAAS;AACT,wBAAS;AACT,wBAAS;AACT,wBAAS;AAET,wBAAiB;AAOf,SAAK,OAAO;AAEZ,UAAM,KAAK,eAAe,oBAAoB,IAAI;AAElD,SAAK,QAAQ,GAAG,QAAQ,GAAG;AAC3B,SAAK,SAAS,GAAG,MAAM,GAAG;AAC1B,SAAK,cAAc;AACnB,SAAK,uBACH,wBAAwB,0BAA0B,EAAE;AAAA,EACxD;AAAA,EA7BA,aAAa,IACX,MACA,aACA,sBACA;AACA,WAAO,IAAI,iBAAgB,MAAM,aAAa,oBAAoB;AAAA,EACpE;AAAA,EAyBA,MAAM,iBAAiB,SAAqB,KAA+B;AACzE,UAAM,EAAE,UAAU,UAAU,IAAI,KAAK,KAAK,kBAAkB;AAE5D,QAAI,CAAC,SAAU,OAAM,IAAI,kCAAkC;AAC3D,UAAM,kBAAkB,KAAK,eAAe,QAAQ;AAEpD,UAAM,EAAE,MAAM,QAAQ,OAAO,IAAI,IAAI,KAAK;AAC1C,UAAM,UAAU,QAAQ,YAAY,iBAAiB;AAAA,MACnD,MAAM;AAAA,MACN,SAAS;AAAA,MACT,UAAU;AAAA,MACV,MAAM,CAAC,MAAM,QAAQ,OAAO,GAAG;AAAA,MAC/B,QAAQ,KAAK;AAAA,MACb;AAAA,IACF,CAAC;AAED,QAAI,KAAK;AACP,cAAQ,OAAO,KAAK,OAAO;AAC3B,aAAO;AAAA,IACT,OAAO;AACL,aAAO,QAAQ,SAAS,OAAO;AAAA,IACjC;AAAA,EACF;AAAA;AAAA;AAAA,EAIQ,eAAe,UAAoB;AACzC,UAAM,UAAU,WAAW,GAAG,kBAAU,OAAO;AAC/C,UAAM,kBAAgC,CAAC;AAEvC,aAAS,MAAM,GAAG,MAAM,SAAS,KAAK,GAAG,MAAM,KAAK,OAAO;AACzD,YAAMC,UAAS,SAAS,OAAO,KAAK,iBAAS;AAE7C,UAAI;AACJ,UAAIA,mBAAkB,sBAAc;AAClC,kBAAU,mBAAmBA,OAAM,EAAE,OAAO;AAAA,MAC9C,WAAWA,mBAAkB,0BAAkB;AAC7C,kBAAUA,QAAO,qBAAqB;AAAA,MACxC,OAAO;AACL,cAAM,IAAI,4BAA4BA,OAAM;AAAA,MAC9C;AAEA,sBAAgB,KAAK,SAAS,OAAO;AAAA,IACvC;AAEA,WAAO,oBAAoB,GAAG,eAAe;AAAA,EAC/C;AACF;AAEA,IAAO,0BAAQ;;;AC/Hf,IAAM,SAAS,CACb,UACA,aAC2B;AAC3B,MAAI,aAAa,OAAW,QAAO;AACnC,SAAO,SAAS,QAAQ;AAC1B;AAEO,IAAK,wBAAL,kBAAKC,2BAAL;AAKL,EAAAA,uBAAA,aAAU;AAGV,EAAAA,uBAAA,iBAAc;AAGd,EAAAA,uBAAA,eAAY;AAMZ,EAAAA,uBAAA,WAAQ;AAjBE,SAAAA;AAAA,GAAA;AAoBL,IAAK,mBAAL,kBAAKC,sBAAL;AAEL,EAAAA,kBAAA,SAAM;AAMN,EAAAA,kBAAA,SAAM;AARI,SAAAA;AAAA,GAAA;AAWL,IAAK,eAAL,kBAAKC,kBAAL;AAEL,EAAAA,cAAA,UAAO;AAGP,EAAAA,cAAA,gBAAa;AALH,SAAAA;AAAA,GAAA;AAQL,IAAK,SAAL,kBAAKC,YAAL;AAEL,EAAAA,QAAA,aAAU;AAMV,EAAAA,QAAA,yBAAsB;AAMtB,EAAAA,QAAA,wBAAqB;AAdX,SAAAA;AAAA,GAAA;AAoCZ,IAAM,qBAAN,MAAM,mBAAkB;AAAA;AAAA,EAeZ,YAAY,MAAe;AAbrC;AAAA,wBAAS;AAcP,SAAK,OAAO;AAAA,EACd;AAAA,EAEU,WAAW,KAA6C;AAChE,UAAM,YAAY,KAAK,KAAK,OAAO,gBAAQ,GAAG,GAAG,CAAC;AAClD,QAAI,qBAAqB,gBAAS,QAAO;AACzC,WAAO;AAAA,EACT;AAAA,EAEU,WAAW,KAA6C;AAChE,UAAM,YAAY,KAAK,KAAK,OAAO,gBAAQ,GAAG,GAAG,CAAC;AAClD,QAAI,qBAAqB,gBAAS,QAAO;AACzC,WAAO;AAAA,EACT;AAAA;AAAA,EAGA,cAAmC;AACjC,WAAO,KAAK,WAAW,aAAa;AAAA,EACtC;AAAA;AAAA,EAGA,cAAmC;AACjC,WAAO,KAAK,WAAW,aAAa;AAAA,EACtC;AAAA;AAAA,EAGA,eAAoC;AAClC,WAAO,KAAK,WAAW,cAAc;AAAA,EACvC;AAAA;AAAA,EAGA,YAAiC;AAC/B,WAAO,KAAK,WAAW,WAAW;AAAA,EACpC;AAAA;AAAA,EAGA,eAAoC;AAClC,WAAO,KAAK,WAAW,cAAc;AAAA,EACvC;AAAA;AAAA,EAGA,kBAAuC;AACrC,WAAO,KAAK,WAAW,iBAAiB;AAAA,EAC1C;AAAA;AAAA,EAGA,wBAA6C;AAC3C,WAAO,KAAK,WAAW,uBAAuB;AAAA,EAChD;AAAA;AAAA,EAGA,YAAiC;AAC/B,WAAO,KAAK,WAAW,WAAW;AAAA,EACpC;AAAA;AAAA,EAGA,eAAoC;AAClC,WAAO,KAAK,WAAW,cAAc;AAAA,EACvC;AAAA;AAAA,EAGA,SAA8B;AAC5B,WAAO,KAAK,WAAW,QAAQ;AAAA,EACjC;AAAA;AAAA,EAGA,oBAAyC;AACvC,WAAO,KAAK,WAAW,mBAAmB;AAAA,EAC5C;AAAA;AAAA,EAGA,iBAAuC;AACrC,UAAM,iBAAiB,KAAK,KAAK,OAAO,gBAAQ,GAAG,gBAAgB,CAAC;AACpE,QAAI,0BAA0B,iBAAU,QAAO;AAC/C,WAAO;AAAA,EACT;AAAA;AAAA,EAGA,YAAmC;AACjC,UAAM,YAAY,KAAK,KAAK,OAAO,gBAAQ,GAAG,WAAW,CAAC;AAC1D,QAAI,qBAAqB,kBAAW,QAAO;AAC3C,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,iBAA0B;AACxB,WAAO,KAAK,YAAY,GAAG,UAAU,KAAK;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,iBAA0B;AACxB,WAAO,KAAK,YAAY,GAAG,UAAU,KAAK;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,kBAA2B;AACzB,WAAO,KAAK,aAAa,GAAG,UAAU,KAAK;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,eAAwB;AACtB,WAAO,KAAK,UAAU,GAAG,UAAU,KAAK;AAAA,EAC1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,kBAA2B;AACzB,WAAO,KAAK,aAAa,GAAG,UAAU,KAAK;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,qBAA8B;AAC5B,WAAO,KAAK,gBAAgB,GAAG,UAAU,KAAK;AAAA,EAChD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,2BAAkD;AAChD,UAAM,OAAO,KAAK,sBAAsB,GAAG,WAAW;AACtD,WAAO,OAAO,MAAM,qBAAqB,KAAK;AAAA,EAChD;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,sBAAwC;AACtC,UAAM,YAAY,KAAK,UAAU,GAAG,WAAW;AAC/C,WAAO,OAAO,WAAW,gBAAgB,KAAK;AAAA,EAChD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,kBAAgC;AAC9B,UAAM,UAAU,KAAK,aAAa,GAAG,WAAW;AAChD,WAAO,OAAO,SAAS,YAAY,KAAK;AAAA,EAC1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,YAAgC;AAC9B,UAAM,SAAS,KAAK,OAAO,GAAG,WAAW;AACzC,WAAO,OAAO,QAAQ,MAAM;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,uBAA4C;AAC1C,WAAO,KAAK,kBAAkB,GAAG,UAAU;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,oBAAiC;AAC/B,UAAM,MAAM,KAAK,eAAe;AAChC,QAAI,CAAC,IAAK,QAAO,CAAC;AAElB,UAAM,aAA0B,CAAC;AACjC,aAAS,IAAI,GAAG,IAAI,IAAI,KAAK,GAAG,KAAK,GAAG;AAKtC,YAAM,QAAQ,IAAI,OAAO,GAAG,iBAAS,EAAE,SAAS;AAChD,YAAM,MAAM,IAAI,OAAO,IAAI,GAAG,iBAAS,EAAE,SAAS;AAClD,iBAAW,KAAK,EAAE,OAAO,IAAI,CAAC;AAAA,IAChC;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,eAAuB;AACrB,WAAO,KAAK,UAAU,GAAG,SAAS,KAAK;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,eAAe,aAAsB;AACnC,UAAM,cAAc,KAAK,KAAK,QAAQ,IAAI,WAAW;AACrD,SAAK,KAAK,IAAI,gBAAQ,GAAG,aAAa,GAAG,WAAW;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,eAAe,aAAsB;AACnC,UAAM,cAAc,KAAK,KAAK,QAAQ,IAAI,WAAW;AACrD,SAAK,KAAK,IAAI,gBAAQ,GAAG,aAAa,GAAG,WAAW;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,gBAAgB,cAAuB;AACrC,UAAM,eAAe,KAAK,KAAK,QAAQ,IAAI,YAAY;AACvD,SAAK,KAAK,IAAI,gBAAQ,GAAG,cAAc,GAAG,YAAY;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,aAAa,WAAoB;AAC/B,UAAM,YAAY,KAAK,KAAK,QAAQ,IAAI,SAAS;AACjD,SAAK,KAAK,IAAI,gBAAQ,GAAG,WAAW,GAAG,SAAS;AAAA,EAClD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,gBAAgB,cAAuB;AACrC,UAAM,eAAe,KAAK,KAAK,QAAQ,IAAI,YAAY;AACvD,SAAK,KAAK,IAAI,gBAAQ,GAAG,cAAc,GAAG,YAAY;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,mBAAmB,cAAuB;AACxC,UAAM,kBAAkB,KAAK,KAAK,QAAQ,IAAI,YAAY;AAC1D,SAAK,KAAK,IAAI,gBAAQ,GAAG,iBAAiB,GAAG,eAAe;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAwBA,yBAAyB,uBAA8C;AACrE;AAAA,MACE;AAAA,MACA;AAAA,MACA;AAAA,IACF;AACA,UAAM,OAAO,gBAAQ,GAAG,qBAAqB;AAC7C,SAAK,KAAK,IAAI,gBAAQ,GAAG,uBAAuB,GAAG,IAAI;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAoBA,oBAAoB,kBAAoC;AACtD,kBAAc,kBAAkB,oBAAoB,gBAAgB;AACpE,UAAM,YAAY,gBAAQ,GAAG,gBAAgB;AAC7C,SAAK,KAAK,IAAI,gBAAQ,GAAG,WAAW,GAAG,SAAS;AAAA,EAClD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiBA,gBAAgB,cAA4B;AAC1C,kBAAc,cAAc,gBAAgB,YAAY;AACxD,UAAM,UAAU,gBAAQ,GAAG,YAAY;AACvC,SAAK,KAAK,IAAI,gBAAQ,GAAG,cAAc,GAAG,OAAO;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiBA,UAAU,QAAgB;AACxB,kBAAc,QAAQ,UAAU,MAAM;AACtC,UAAM,MAAM,gBAAQ,GAAG,MAAM;AAC7B,SAAK,KAAK,IAAI,gBAAQ,GAAG,QAAQ,GAAG,GAAG;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,qBAAqB,mBAA4B;AAC/C,UAAM,oBAAoB,KAAK,KAAK,QAAQ,IAAI,iBAAiB;AACjE,SAAK,KAAK,IAAI,gBAAQ,GAAG,mBAAmB,GAAG,iBAAiB;AAAA,EAClE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA4BA,kBAAkB,gBAAyC;AACzD,QAAI,CAAC,MAAM,QAAQ,cAAc,EAAG,kBAAiB,CAAC,cAAc;AAEpE,UAAM,YAAsB,CAAC;AAC7B,aAAS,MAAM,GAAG,MAAM,eAAe,QAAQ,MAAM,KAAK,OAAO;AAC/D,gBAAU,KAAK,eAAe,GAAG,EAAE,KAAK;AACxC,gBAAU,KAAK,eAAe,GAAG,EAAE,GAAG;AAAA,IACxC;AAEA,iBAAa,WAAW,kBAAkB,CAAC,QAAQ,CAAC;AAEpD,UAAM,aAAa,KAAK,KAAK,QAAQ,IAAI,SAAS;AAClD,SAAK,KAAK,IAAI,gBAAQ,GAAG,gBAAgB,GAAG,UAAU;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,aAAa,WAAmB;AAC9B,gBAAY,WAAW,aAAa,GAAG,OAAO,SAAS;AACvD,kBAAc,WAAW,WAAW;AACpC,UAAM,YAAY,KAAK,KAAK,QAAQ,IAAI,SAAS;AACjD,SAAK,KAAK,IAAI,gBAAQ,GAAG,WAAW,GAAG,SAAS;AAAA,EAClD;AACF;AAAA;AA3dE,cALI,oBAKG,YAAW,CAAC,SACjB,IAAI,mBAAkB,IAAI;AAAA;AAG5B,cATI,oBASG,UAAS,CAAC,YAAwB;AACvC,QAAM,OAAO,QAAQ,IAAI,CAAC,CAAC;AAC3B,SAAO,IAAI,mBAAkB,IAAI;AACnC;AAZF,IAAM,oBAAN;AAkeA,IAAO,4BAAQ;;;ACnjBf,IAAM,UACJ;AAEF,IAAM,eAAN,MAAM,cAAa;AAAA,EAIP,YAAY,MAAe,KAAa;AAHlD,wBAAS;AACT,wBAAS;AAGP,SAAK,OAAO;AACZ,SAAK,MAAM;AAAA,EACb;AAAA,EAEA,IAA0C;AACxC,WAAO,KAAK,KAAK,YAAY,gBAAQ,GAAG,GAAG,GAAG,mBAAW,oBAAY;AAAA,EACvE;AAAA,EAEA,KAA4B;AAC1B,UAAM,cAAc,KAAK,wBAAwB,gBAAQ,GAAG,IAAI,CAAC;AACjE,WAAO,KAAK,KAAK,QAAQ,YAAY,aAAa,iBAAS;AAAA,EAC7D;AAAA,EAEA,IAA2B;AACzB,UAAM,aAAa,KAAK,wBAAwB,gBAAQ,GAAG,GAAG,CAAC;AAC/D,WAAO,KAAK,KAAK,QAAQ,OAAO,UAAU;AAAA,EAC5C;AAAA,EAEA,OAA6B;AAC3B,WAAO,KAAK,KAAK,YAAY,gBAAQ,GAAG,MAAM,GAAG,gBAAQ;AAAA,EAC3D;AAAA;AAAA;AAAA;AAAA,EAMA,KAA2C;AACzC,UAAM,KAAK,KAAK,KAAK,OAAO,gBAAQ,GAAG,IAAI,CAAC;AAC5C,QAAI,cAAc,qBAAa,cAAc,qBAAc,QAAO;AAClE,WAAO;AAAA,EACT;AAAA,EAEA,QAAQ,MAAmB;AACzB,SAAK,KAAK,IAAI,gBAAQ,GAAG,MAAM,GAAG,KAAK,KAAK,QAAQ,IAAI,IAAI,CAAC;AAAA,EAC/D;AAAA,EAEA,YAAsC;AAKpC,UAAM,YAAY,KAAK,KAAK,IAAI,gBAAQ,GAAG,QAAQ,CAAC;AACpD,QAAI,qBAAqB,gBAAQ;AAC/B,YAAM,SAAS,KAAK,KAAK,OAAO,gBAAQ,GAAG,QAAQ,GAAG,eAAO;AAC7D,aAAO,IAAI,cAAa,QAAQ,SAAS;AAAA,IAC3C;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,UAAU,QAA4B;AACpC,QAAI,CAAC,OAAQ,MAAK,KAAK,OAAO,gBAAQ,GAAG,QAAQ,CAAC;AAAA,QAC7C,MAAK,KAAK,IAAI,gBAAQ,GAAG,QAAQ,GAAG,MAAM;AAAA,EACjD;AAAA,EAEA,wBAA4C;AAC1C,UAAM,SAAS,KAAK,UAAU;AAC9B,QAAI,CAAC,OAAQ,QAAO,KAAK,eAAe;AACxC,WAAO,GAAG,OAAO,sBAAsB,CAAC,IAAI,KAAK,eAAe,CAAC;AAAA,EACnE;AAAA,EAEA,iBAAqC;AACnC,WAAO,KAAK,EAAE,GAAG,WAAW;AAAA,EAC9B;AAAA,EAEA,eAAe,aAAiC;AAC9C,QAAI,CAAC,YAAa,MAAK,KAAK,OAAO,gBAAQ,GAAG,GAAG,CAAC;AAAA,QAC7C,MAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,GAAG,qBAAa,SAAS,WAAW,CAAC;AAAA,EACxE;AAAA,EAEA,qBAAqB,YAAoB;AACvC,SAAK,KAAK,IAAI,gBAAQ,GAAG,IAAI,GAAG,kBAAU,GAAG,UAAU,CAAC;AAAA,EAC1D;AAAA,EAEA,uBAA2C;AACzC,UAAM,KAAK,KAAK,GAAG;AAEnB,QAAI,cAAc,sBAAc;AAC9B,aAAO,GAAG,WAAW;AAAA,IACvB;AAEA,WAAO,IAAI,SAAS;AAAA,EACtB;AAAA,EAEA,YAAY,UAAkB;AAC5B,UAAM,OAAO,KAAK,sBAAsB,KAAK;AAE7C,UAAM,KAAK,KAAK,qBAAqB;AACrC,QAAI,CAAC,GAAI,OAAM,IAAI,oBAAoB,IAAI;AAE3C,UAAM,UAAU,cAAc,IAAI,OAAO;AACzC,QAAI,CAAC,QAAQ,MAAO,OAAM,IAAI,uBAAuB,IAAI;AAEzD,UAAM,UAAU,GAAG,MAAM,GAAG,QAAQ,MAAM,QAAQ,MAAM,CAAC,EAAE,MAAM;AACjE,UAAM,QAAQ,QAAQ,OAAO,GAAG,SAAS,GAAG,MAAM,QAAQ,GAAG,IAAI;AACjE,UAAM,WAAW,QAAQ,MAAM,CAAC;AAChC,UAAM,aAAa,GAAG,OAAO,KAAK,QAAQ,IAAI,QAAQ,OAAO,KAAK;AAElE,SAAK,qBAAqB,UAAU;AAAA,EACtC;AAAA,EAEA,WAAmB;AACjB,WAAO,KAAK,GAAG,GAAG,SAAS,KAAK;AAAA,EAClC;AAAA,EAEA,SAAS,OAAe;AACtB,SAAK,KAAK,IAAI,gBAAQ,GAAG,IAAI,GAAG,kBAAU,GAAG,KAAK,CAAC;AAAA,EACrD;AAAA,EAEA,QAAQC,OAAuB;AAC7B,UAAM,QAAQ,KAAK,SAAS;AAC5B,YAAQ,QAAQA,WAAU;AAAA,EAC5B;AAAA,EAEA,QAAQA,OAAc;AACpB,UAAM,QAAQ,KAAK,SAAS;AAC5B,SAAK,SAAS,QAAQA,KAAI;AAAA,EAC5B;AAAA,EAEA,UAAUA,OAAc;AACtB,UAAM,QAAQ,KAAK,SAAS;AAC5B,SAAK,SAAS,QAAQ,CAACA,KAAI;AAAA,EAC7B;AAAA,EAEA,UAAUA,OAAc,QAAiB;AACvC,QAAI,OAAQ,MAAK,QAAQA,KAAI;AAAA,QACxB,MAAK,UAAUA,KAAI;AAAA,EAC1B;AAAA,EAEA,wBAAwB,MAAsC;AAC5D,QAAI;AACJ,SAAK,OAAO,CAAC,SAAS;AACpB,UAAI,CAAC,UAAW,aAAY,KAAK,KAAK,IAAI,IAAI;AAAA,IAChD,CAAC;AACD,WAAO;AAAA,EACT;AAAA,EAEA,OAAO,SAA4C;AACjD,YAAQ,IAAI;AACZ,UAAM,SAAS,KAAK,UAAU;AAC9B,QAAI,OAAQ,QAAO,OAAO,OAAO;AAAA,EACnC;AACF;AAEA,IAAO,uBAAQ;;;AClKf,IAAM,eAAN,MAAM,aAAY;AAAA,EAKN,YAAY,MAAe;AAJrC,wBAAS;AAKP,SAAK,OAAO;AAAA,EACd;AAAA,EAEA,IAA2B;AACzB,UAAM,IAAI,KAAK,KAAK,OAAO,gBAAQ,GAAG,GAAG,CAAC;AAC1C,QAAI,aAAa,kBAAW,QAAO;AACnC,WAAO;AAAA,EACT;AAAA,EAEA,WAA+B;AAC7B,WAAO,KAAK,EAAE,GAAG,SAAS,KAAK;AAAA,EACjC;AAAA,EAEA,SAAS,OAAe;AACtB,UAAM,IAAI,KAAK,KAAK,QAAQ,IAAI,KAAK;AACrC,SAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,GAAG,CAAC;AAAA,EAClC;AACF;AApBE,cAHI,cAGG,YAAW,CAAC,SAA+B,IAAI,aAAY,IAAI;AAHxE,IAAM,cAAN;AAyBA,IAAO,sBAAQ;;;ACvBf,IAAM,iBAAN,MAAM,eAAc;AAAA,EAKR,YAAY,MAAe;AAJrC,wBAAS;AAKP,SAAK,OAAO;AAAA,EACd;AAAA;AAAA,EAGA,OAA6B;AAC3B,WAAO,KAAK,KAAK,OAAO,gBAAQ,GAAG,MAAM,GAAG,gBAAQ;AAAA,EACtD;AAAA,EAEA,KAA0B;AACxB,WAAO,KAAK,KAAK,YAAY,gBAAQ,GAAG,IAAI,GAAG,eAAO;AAAA,EACxD;AAAA,EAEA,IAA2B;AACzB,UAAM,cAAc,KAAK,KAAK,OAAO,gBAAQ,GAAG,GAAG,CAAC;AACpD,WAAO,KAAK,KAAK,QAAQ,YAAY,aAAa,iBAAS;AAAA,EAC7D;AAAA,EAEA,eAAwE;AACtE,UAAM,OAAO,KAAK,KAAK;AACvB,WAAO,MAAM,YAAY,KAAK,EAAE,GAAG,GAAG,GAAG,GAAG,OAAO,GAAG,QAAQ,EAAE;AAAA,EAClE;AAAA,EAEA,aAAa,MAA+D;AAC1E,UAAM,EAAE,GAAG,GAAG,OAAO,OAAO,IAAI;AAChC,UAAM,OAAO,KAAK,KAAK,QAAQ,IAAI,CAAC,GAAG,GAAG,IAAI,OAAO,IAAI,MAAM,CAAC;AAChE,SAAK,KAAK,IAAI,gBAAQ,GAAG,MAAM,GAAG,IAAI;AAAA,EACxC;AAAA,EAEA,qBAA0C;AACxC,UAAM,KAAK,KAAK,KAAK,OAAO,gBAAQ,GAAG,IAAI,CAAC;AAC5C,QAAI,cAAc,gBAAS,QAAO;AAClC,WAAO;AAAA,EACT;AAAA,EAEA,mBAAmB,OAAgB;AACjC,SAAK,KAAK,IAAI,gBAAQ,GAAG,IAAI,GAAG,KAAK;AAAA,EACvC;AAAA,EAEA,eAAe,aAAsB;AACnC,SAAK,KAAK,IAAI,gBAAQ,GAAG,IAAI,GAAG,WAAW;AAAA,EAC7C;AAAA,EAEA,WAAoB;AAClB,QAAI,KAAK,KAAK,GAAG;AACjB,QAAI,CAAC,IAAI;AACP,WAAK,KAAK,KAAK,QAAQ,IAAI,CAAC,CAAC;AAC7B,WAAK,KAAK,IAAI,gBAAQ,GAAG,IAAI,GAAG,EAAE;AAAA,IACpC;AACA,WAAO;AAAA,EACT;AAAA,EAEA,sBAAwC;AACtC,UAAM,KAAK,KAAK,SAAS;AACzB,UAAM,IAAI,GAAG,IAAI,gBAAQ,GAAG,GAAG,CAAC;AAChC,QAAI,aAAa,kBAAU,aAAa,gBAAS,QAAO;AAExD,UAAM,IAAI,MAAM,sBAAsB,GAAG,YAAY,IAAI,EAAE;AAAA,EAC7D;AAAA;AAAA,EAGA,oBAAoB,YAA8B;AAChD,UAAM,KAAK,KAAK,SAAS;AACzB,OAAG,IAAI,gBAAQ,GAAG,GAAG,GAAG,UAAU;AAAA,EACpC;AAAA;AAAA,EAGA,sBAAsB,YAA8B;AAClD,UAAM,KAAK,KAAK,SAAS;AACzB,OAAG,IAAI,gBAAQ,GAAG,GAAG,GAAG,UAAU;AAAA,EACpC;AAAA;AAAA,EAGA,kBAAkB,YAA8B;AAC9C,UAAM,KAAK,KAAK,SAAS;AACzB,OAAG,IAAI,gBAAQ,GAAG,GAAG,GAAG,UAAU;AAAA,EACpC;AAAA,EAEA,2BAA2B;AACzB,UAAM,KAAK,KAAK,GAAG;AACnB,QAAI,OAAO,gBAAQ,GAAG,GAAG,CAAC;AAAA,EAC5B;AAAA,EAEA,uBAAuB;AACrB,UAAM,KAAK,KAAK,GAAG;AACnB,QAAI,OAAO,gBAAQ,GAAG,GAAG,CAAC;AAAA,EAC5B;AAAA,EAEA,iBAMc;AACZ,UAAM,KAAK,KAAK,GAAG;AAEnB,QAAI,CAAC,GAAI,QAAO;AAEhB,UAAM,IAAI,GAAG,OAAO,gBAAQ,GAAG,GAAG,GAAG,iBAAS,iBAAS;AACvD,UAAM,IAAI,GAAG,YAAY,gBAAQ,GAAG,GAAG,GAAG,iBAAS,iBAAS;AAC5D,UAAM,IAAI,GAAG,YAAY,gBAAQ,GAAG,GAAG,GAAG,iBAAS,iBAAS;AAE5D,WAAO,EAAE,QAAQ,GAAG,UAAU,GAAG,MAAM,EAAE;AAAA,EAC3C;AAAA,EAEA,WAAmB;AACjB,WAAO,KAAK,EAAE,GAAG,SAAS,KAAK;AAAA,EACjC;AAAA,EAEA,SAAS,OAAe;AACtB,SAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,GAAG,kBAAU,GAAG,KAAK,CAAC;AAAA,EACpD;AAAA,EAEA,QAAQC,OAAuB;AAC7B,UAAM,QAAQ,KAAK,SAAS;AAC5B,YAAQ,QAAQA,WAAU;AAAA,EAC5B;AAAA,EAEA,QAAQA,OAAc;AACpB,UAAM,QAAQ,KAAK,SAAS;AAC5B,SAAK,SAAS,QAAQA,KAAI;AAAA,EAC5B;AAAA,EAEA,UAAUA,OAAc;AACtB,UAAM,QAAQ,KAAK,SAAS;AAC5B,SAAK,SAAS,QAAQ,CAACA,KAAI;AAAA,EAC7B;AAAA,EAEA,UAAUA,OAAc,QAAiB;AACvC,QAAI,OAAQ,MAAK,QAAQA,KAAI;AAAA,QACxB,MAAK,UAAUA,KAAI;AAAA,EAC1B;AACF;AAvIE,cAHI,gBAGG,YAAW,CAAC,SAAiC,IAAI,eAAc,IAAI;AAH5E,IAAM,gBAAN;AA4IA,IAAO,wBAAQ;;;AC5If,IAAM,6BAAN,MAAM,2BAA0B;AAAA,EAMpB,YAAY,MAAe;AALrC,wBAAS;AAMP,SAAK,OAAO;AAAA,EACd;AAAA,EAEA,IAA2B;AACzB,UAAM,IAAI,KAAK,KAAK,OAAO,gBAAQ,GAAG,GAAG,CAAC;AAC1C,QAAI,aAAa,kBAAW,QAAO;AACnC,WAAO;AAAA,EACT;AAAA,EAEA,KAA2B;AACzB,UAAM,KAAK,KAAK,KAAK,OAAO,gBAAQ,GAAG,IAAI,CAAC;AAC5C,QAAI,cAAc,iBAAU,QAAO;AACnC,WAAO;AAAA,EACT;AAAA,EAEA,KAA2B;AACzB,UAAM,KAAK,KAAK,KAAK,OAAO,gBAAQ,GAAG,IAAI,CAAC;AAC5C,QAAI,cAAc,iBAAU,QAAO;AACnC,WAAO;AAAA,EACT;AAAA,EAEA,KAA2C;AACzC,UAAM,KAAK,KAAK,KAAK,OAAO,gBAAQ,GAAG,IAAI,CAAC;AAC5C,QAAI,cAAc,wBAAgB,cAAc,kBAAW,QAAO;AAClE,WAAO;AAAA,EACT;AAAA,EAEA,KAA2C;AACzC,UAAM,KAAK,KAAK,KAAK,OAAO,gBAAQ,GAAG,IAAI,CAAC;AAC5C,QAAI,cAAc,wBAAgB,cAAc,kBAAW,QAAO;AAClE,WAAO;AAAA,EACT;AAAA,EAEA,KAA2C;AACzC,UAAM,KAAK,KAAK,KAAK,OAAO,gBAAQ,GAAG,IAAI,CAAC;AAC5C,QAAI,cAAc,wBAAgB,cAAc,kBAAW,QAAO;AAClE,WAAO;AAAA,EACT;AAAA,EAEA,cAAkC;AAChC,WAAO,KAAK,EAAE,GAAG,SAAS;AAAA,EAC5B;AAAA,EAEA,iBAAuC;AACrC,UAAM,KAAK,KAAK,GAAG;AAEnB,QAAI,CAAC,GAAI,QAAO;AAEhB,UAAM,aAAuB,CAAC;AAC9B,aAAS,MAAM,GAAG,MAAM,IAAI,KAAK,GAAG,MAAM,KAAK,OAAO;AACpD,YAAM,YAAY,GAAG,IAAI,GAAG;AAC5B,UAAI,qBAAqB,kBAAW,YAAW,KAAK,UAAU,SAAS,CAAC;AAAA,IAC1E;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,qBAA2C;AACzC,UAAM,KAAK,KAAK,GAAG;AAEnB,QAAI,CAAC,GAAI,QAAO;AAEhB,UAAM,aAAuB,CAAC;AAC9B,aAAS,MAAM,GAAG,MAAM,IAAI,KAAK,GAAG,MAAM,KAAK,OAAO;AACpD,YAAM,YAAY,GAAG,IAAI,GAAG;AAC5B,UAAI,qBAAqB,kBAAW,YAAW,KAAK,UAAU,SAAS,CAAC;AAAA,IAC1E;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,cAAqE;AACnE,UAAM,KAAK,KAAK,GAAG;AACnB,UAAM,KAAK,KAAK,GAAG;AACnB,UAAM,KAAK,KAAK,GAAG;AAEnB,WAAO;AAAA,MACL,QAAQ,IAAI,WAAW;AAAA,MACvB,UAAU,IAAI,WAAW;AAAA,MACzB,MAAM,IAAI,WAAW;AAAA,IACvB;AAAA,EACF;AAAA,EAEA,YAAY,UAAkB;AAC5B,UAAM,IAAI,KAAK,KAAK,QAAQ,IAAI,QAAQ;AACxC,SAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,GAAG,CAAC;AAAA,EAClC;AAAA,EAEA,eAAe,OAAiB;AAC9B,UAAM,KAAK,KAAK,KAAK,QAAQ,IAAI,KAAK;AACtC,SAAK,KAAK,IAAI,gBAAQ,GAAG,IAAI,GAAG,EAAE;AAAA,EACpC;AAAA,EAEA,mBAAmB,OAAiB;AAClC,UAAM,KAAK,KAAK,KAAK,QAAQ,IAAI,KAAK;AACtC,SAAK,KAAK,IAAI,gBAAQ,GAAG,IAAI,GAAG,EAAE;AAAA,EACpC;AAAA,EAEA,YAAY,UAAgE;AAC1E,UAAM,KAAK,qBAAa,SAAS,SAAS,MAAM;AAChD,SAAK,KAAK,IAAI,gBAAQ,GAAG,IAAI,GAAG,EAAE;AAElC,QAAI,SAAS,UAAU;AACrB,YAAM,KAAK,qBAAa,SAAS,SAAS,QAAQ;AAClD,WAAK,KAAK,IAAI,gBAAQ,GAAG,IAAI,GAAG,EAAE;AAAA,IACpC,OAAO;AACL,WAAK,KAAK,OAAO,gBAAQ,GAAG,IAAI,CAAC;AAAA,IACnC;AAEA,QAAI,SAAS,MAAM;AACjB,YAAM,KAAK,qBAAa,SAAS,SAAS,IAAI;AAC9C,WAAK,KAAK,IAAI,gBAAQ,GAAG,IAAI,GAAG,EAAE;AAAA,IACpC,OAAO;AACL,WAAK,KAAK,OAAO,gBAAQ,GAAG,IAAI,CAAC;AAAA,IACnC;AAAA,EACF;AACF;AAxHE,cAHI,4BAGG,YAAW,CAAC,SACjB,IAAI,2BAA0B,IAAI;AAJtC,IAAM,4BAAN;AA6HA,IAAO,oCAAQ;;;AC1Hf,IAAM,uBAAN,MAAM,6BAA4B,sBAAc;AAAA,EAc9C,KAA0B;AACxB,UAAM,KAAK,KAAK,KAAK,OAAO,gBAAQ,GAAG,IAAI,CAAC;AAC5C,QAAI,cAAc,gBAAS,QAAO;AAClC,WAAO;AAAA,EACT;AAAA,EAEA,KAA0B;AACxB,UAAM,KAAK,KAAK,KAAK,OAAO,gBAAQ,GAAG,IAAI,CAAC;AAC5C,QAAI,cAAc,gBAAS,QAAO;AAClC,WAAO;AAAA,EACT;AAAA,EAEA,KAA2C;AACzC,UAAM,KAAK,KAAK,KAAK,OAAO,gBAAQ,GAAG,IAAI,CAAC;AAC5C,QAAI,cAAc,qBAAa,cAAc,qBAAc,QAAO;AAClE,WAAO;AAAA,EACT;AAAA,EAEA,IAAwB;AACtB,UAAM,IAAI,KAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,CAAC;AACvC,QAAI,aAAa,eAAQ,QAAO;AAChC,WAAO;AAAA,EACT;AAAA,EAEA,KAAK,MAAc;AACjB,SAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,GAAG,IAAI;AAAA,EACrC;AAAA,EAEA,qBAAqB,YAAoB;AACvC,SAAK,KAAK,IAAI,gBAAQ,GAAG,IAAI,GAAG,kBAAU,GAAG,UAAU,CAAC;AAAA,EAC1D;AAAA,EAEA,uBAA2C;AACzC,UAAM,KAAK,KAAK,GAAG;AAEnB,QAAI,cAAc,sBAAc;AAC9B,aAAO,GAAG,WAAW;AAAA,IACvB;AAEA,WAAO,IAAI,SAAS;AAAA,EACtB;AAAA,EAEA,+BAAsE;AACpE,UAAM,KAAK,KAAK,GAAG;AACnB,QAAI,GAAI,QAAO,kCAA0B,SAAS,EAAE;AACpD,WAAO;AAAA,EACT;AAAA,EAEA,uCAAkE;AAChE,UAAM,KAAK,KAAK,GAAG;AACnB,QAAI,GAAI,QAAO,kCAA0B,SAAS,EAAE;AAEpD,UAAM,KAAK,kCAA0B,SAAS,KAAK,KAAK,QAAQ,IAAI,CAAC,CAAC,CAAC;AACvE,SAAK,KAAK,IAAI,gBAAQ,GAAG,IAAI,GAAG,GAAG,IAAI;AACvC,WAAO;AAAA,EACT;AAAA,EAEA,iBAA0C;AACxC,UAAM,KAAK,KAAK,GAAG;AACnB,QAAI,GAAI,QAAO,oBAAY,SAAS,EAAE;AACtC,WAAO;AAAA,EACT;AAAA,EAEA,yBAAsC;AACpC,UAAM,KAAK,KAAK,GAAG;AACnB,QAAI,GAAI,QAAO,oBAAY,SAAS,EAAE;AAEtC,UAAM,KAAK,oBAAY,SAAS,KAAK,KAAK,QAAQ,IAAI,CAAC,CAAC,CAAC;AACzD,SAAK,KAAK,IAAI,gBAAQ,GAAG,IAAI,GAAG,GAAG,IAAI;AACvC,WAAO;AAAA,EACT;AAAA,EAEA,aAAkC;AAChC,UAAM,SAAS,KAAK,eAAe,GAAG;AAEtC,QAAI,kBAAkB,iBAAS;AAC7B,YAAM,OAAO,OAAO,KAAK;AACzB,eAAS,MAAM,GAAG,MAAM,KAAK,QAAQ,MAAM,KAAK,OAAO;AACrD,cAAM,MAAM,KAAK,GAAG;AACpB,YAAI,QAAQ,gBAAQ,GAAG,KAAK,EAAG,QAAO;AAAA,MACxC;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AACF;AAlGE,cADI,sBACG,YAAW,CAAC,SACjB,IAAI,qBAAoB,IAAI;AAE9B,cAJI,sBAIG,UAAS,CAAC,SAAqB,WAAmB;AACvD,QAAM,OAAO,QAAQ,IAAI;AAAA,IACvB,MAAM;AAAA,IACN,SAAS;AAAA,IACT,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC;AAAA,IACjB,QAAQ;AAAA,EACV,CAAC;AACD,SAAO,IAAI,qBAAoB,IAAI;AACrC;AAZF,IAAM,sBAAN;AAqGA,IAAO,8BAAQ;;;ACxGf,IAAM,mBAAN,MAAM,yBAAwB,qBAAa;AAAA,EAIzC,KAAc;AACZ,UAAM,YAAY,KAAK,wBAAwB,gBAAQ,GAAG,IAAI,CAAC;AAC/D,WAAO,KAAK,KAAK,QAAQ,OAAO,WAAW,eAAO;AAAA,EACpD;AAAA,EAEA,aAAoC;AAClC,UAAM,WAAW,KAAK,KAAK;AAG3B,QAAI,CAAC,SAAU,QAAO,CAAC,4BAAoB,SAAS,KAAK,IAAI,CAAC;AAG9D,UAAM,UAAU,IAAI,MAA2B,SAAS,KAAK,CAAC;AAC9D,aAAS,MAAM,GAAG,MAAM,SAAS,KAAK,GAAG,MAAM,KAAK,OAAO;AACzD,YAAM,OAAO,SAAS,OAAO,KAAK,eAAO;AACzC,cAAQ,GAAG,IAAI,4BAAoB,SAAS,IAAI;AAAA,IAClD;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,UAAU,KAAa;AACrB,UAAM,EAAE,KAAK,IAAI,KAAK,kBAAkB;AACxC,SAAK,KAAK,GAAG;AAAA,EACf;AAAA,EAEA,aAAa,KAAa;AACxB,UAAM,WAAW,KAAK,KAAK;AAE3B,QAAI,CAAC,UAAU;AAEb,UAAI,QAAQ,EAAG,OAAM,IAAI,sBAAsB,KAAK,GAAG,CAAC;AACxD,WAAK,QAAQ,CAAC,CAAC;AAAA,IACjB,OAAO;AAEL,UAAI,MAAM,KAAK,MAAM,SAAS,KAAK,GAAG;AACpC,cAAM,IAAI,sBAAsB,KAAK,GAAG,SAAS,KAAK,CAAC;AAAA,MACzD;AACA,eAAS,OAAO,GAAG;AAAA,IACrB;AAAA,EACF;AAAA,EAEA,oBAAoB;AAClB,QAAI,OAAO,KAAK,KAAK;AAOrB,QAAI,CAAC,MAAM;AACT,aAAO,KAAK,KAAK,QAAQ,IAAI,CAAC,KAAK,GAAG,CAAC;AACvC,WAAK,KAAK,IAAI,gBAAQ,GAAG,MAAM,GAAG,IAAI;AAAA,IACxC;AAEA,WAAO,EAAE,KAAK;AAAA,EAChB;AACF;AA5DE,cADI,kBACG,YAAW,CAAC,MAAe,QAChC,IAAI,iBAAgB,MAAM,GAAG;AAFjC,IAAM,kBAAN;AA+DA,IAAO,0BAAQ;;;AC7Df,IAAM,gBAAN,cAA4B,wBAAgB;AAAA,EAC1C,MAAuD;AACrD,WAAO,KAAK,KAAK;AAAA,MACf,gBAAQ,GAAG,KAAK;AAAA,MAChB;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAAA,EAEA,OAAO,KAAkB;AACvB,SAAK,KAAK,IAAI,gBAAQ,GAAG,KAAK,GAAG,KAAK,KAAK,QAAQ,IAAI,GAAG,CAAC;AAAA,EAC7D;AAAA,EAEA,kBAA4D;AAC1D,UAAM,MAAM,KAAK,IAAI;AAErB,QAAI,CAAC,IAAK,QAAO;AAEjB,QAAI,eAAe,qBAAa,eAAe,sBAAc;AAC3D,aAAO,CAAC,GAAG;AAAA,IACb;AAEA,UAAMC,UAAuC,CAAC;AAC9C,aAAS,MAAM,GAAG,MAAM,IAAI,KAAK,GAAG,MAAM,KAAK,OAAO;AACpD,YAAM,QAAQ,IAAI,OAAO,GAAG;AAC5B,UAAI,iBAAiB,qBAAa,iBAAiB,sBAAc;AAC/D,QAAAA,QAAO,KAAK,KAAK;AAAA,MACnB;AAAA,IACF;AAEA,WAAOA;AAAA,EACT;AAAA,EAEA,kBAAkB,KAAa;AAC7B,UAAM,MAAM,KAAK,IAAI;AAErB,QAAI,CAAC,IAAK;AAEV,QAAI,eAAe,qBAAa,eAAe,sBAAc;AAC3D,UAAI,QAAQ,EAAG,OAAM,IAAI,sBAAsB,KAAK,GAAG,CAAC;AACxD,WAAK,OAAO,CAAC,CAAC;AAAA,IAChB,OAAO;AACL,UAAI,MAAM,KAAK,MAAM,IAAI,KAAK,GAAG;AAC/B,cAAM,IAAI,sBAAsB,KAAK,GAAG,IAAI,KAAK,CAAC;AAAA,MACpD;AACA,UAAI,OAAO,GAAG;AAAA,IAChB;AAAA,EACF;AAAA;AAAA,EAGA,wBAAwB;AACtB,UAAM,eAAe,KAAK,gBAAgB,KAAK,CAAC;AAEhD,UAAM,MAAoC,CAAC;AAE3C,UAAM,UAAU,KAAK,WAAW;AAChC,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,YAAM,YACJ,aAAa,GAAG,KAChB,qBAAa,SAAS,OAAO,WAAW,GAAG,WAAW,KAAK,EAAE;AAC/D,UAAI,KAAK,SAAS;AAAA,IACpB;AAEA,SAAK,OAAO,GAAG;AAAA,EACjB;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,OAAO,KAA+B,mBAAoC;AACxE,SAAK,sBAAsB;AAE3B,UAAM,UAAU,IAAI,WAAW;AAE/B,QAAI;AACJ,QAAI,mBAAmB;AACrB,YAAM,eAAe,KAAK,gBAAgB,KAAK,CAAC;AAChD,eAAS,MAAM,GAAG,MAAM,aAAa,QAAQ,MAAM,KAAK,OAAO;AAC7D,cAAM,YAAY,aAAa,GAAG;AAClC,YAAI,UAAU,WAAW,MAAM,QAAS,eAAc;AAAA,MACxD;AAAA,IACF;AAEA,UAAM,MAAM,KAAK,IAAI;AACrB,QAAI,KAAK,GAAG;AAEZ,WAAO,eAAe,IAAI,KAAK,IAAI;AAAA,EACrC;AAAA,EAEA,iBACE,QACA,KACA,mBACA;AACA,UAAM,SAAS,KAAK,OAAO,KAAK,iBAAiB;AACjD,UAAM,eAAe,gBAAQ,GAAG,OAAO,MAAM,CAAC;AAC9C,SAAK,UAAU,MAAM;AACrB,WAAO;AAAA,EACT;AACF;AAEA,IAAO,wBAAQ;;;AC1Gf,IAAM,mBAAN,MAAM,yBAAwB,sBAAc;AAAA,EAa1C,SAAS,OAAgB;AACvB,UAAM,UAAU,KAAK,WAAW,KAAK,gBAAQ,GAAG,KAAK;AACrD,QAAI,UAAU,WAAW,UAAU,gBAAQ,GAAG,KAAK,GAAG;AACpD,YAAM,IAAI,2BAA2B;AAAA,IACvC;AAEA,SAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,GAAG,KAAK;AAEpC,UAAM,UAAU,KAAK,WAAW;AAChC,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,YAAM,QAAQ,OAAO,WAAW,MAAM,QAAQ,QAAQ,gBAAQ,GAAG,KAAK;AACtE,aAAO,mBAAmB,KAAK;AAAA,IACjC;AAAA,EACF;AAAA,EAEA,WAAoB;AAClB,UAAM,IAAI,KAAK,EAAE;AACjB,QAAI,aAAa,gBAAS,QAAO;AACjC,WAAO,gBAAQ,GAAG,KAAK;AAAA,EACzB;AAAA,EAEA,aAAkC;AAChC,UAAM,CAAC,MAAM,IAAI,KAAK,WAAW;AACjC,WAAO,QAAQ,WAAW;AAAA,EAC5B;AACF;AAtCE,cADI,kBACG,YAAW,CAAC,MAAe,QAChC,IAAI,iBAAgB,MAAM,GAAG;AAE/B,cAJI,kBAIG,UAAS,CAAC,YAAwB;AACvC,QAAM,OAAO,QAAQ,IAAI;AAAA,IACvB,IAAI;AAAA,IACJ,MAAM,CAAC;AAAA,EACT,CAAC;AACD,QAAM,MAAM,QAAQ,SAAS,IAAI;AACjC,SAAO,IAAI,iBAAgB,MAAM,GAAG;AACtC;AAXF,IAAM,kBAAN;AAyCA,IAAO,0BAAQ;;;AChDf,IAAM,OAAO,CAAC,aAAqB,KAAK;AAGjC,IAAK,kBAAL,CAAKC,oBAAL;AAQL,EAAAA,gCAAA,cAAW,KAAK,CAAK,KAArB;AAMA,EAAAA,gCAAA,cAAW,KAAK,CAAK,KAArB;AAMA,EAAAA,gCAAA,cAAW,KAAK,CAAK,KAArB;AApBU,SAAAA;AAAA,GAAA;AAwBL,IAAK,mBAAL,CAAKC,qBAAL;AAML,EAAAA,kCAAA,mBAAgB,KAAK,EAAM,KAA3B;AAMA,EAAAA,kCAAA,WAAQ,KAAK,EAAM,KAAnB;AAKA,EAAAA,kCAAA,gBAAa,KAAK,EAAM,KAAxB;AAQA,EAAAA,kCAAA,oBAAiB,KAAK,EAAM,KAA5B;AAzBU,SAAAA;AAAA,GAAA;AA6BL,IAAK,iBAAL,CAAKC,mBAAL;AAKL,EAAAA,8BAAA,eAAY,KAAK,EAAM,KAAvB;AAUA,EAAAA,8BAAA,cAAW,KAAK,EAAM,KAAtB;AAMA,EAAAA,8BAAA,gBAAa,KAAK,EAAM,KAAxB;AAKA,EAAAA,8BAAA,qBAAkB,KAAK,EAAM,KAA7B;AAUA,EAAAA,8BAAA,iBAAc,KAAK,EAAM,KAAzB;AASA,EAAAA,8BAAA,UAAO,KAAK,EAAM,KAAlB;AAQA,EAAAA,8BAAA,cAAW,KAAK,EAAM,KAAtB;AArDU,SAAAA;AAAA,GAAA;AAyDL,IAAK,mBAAL,CAAKC,qBAAL;AAIL,EAAAA,kCAAA,WAAQ,KAAK,EAAM,KAAnB;AAOA,EAAAA,kCAAA,UAAO,KAAK,EAAM,KAAlB;AAQA,EAAAA,kCAAA,UAAO,KAAK,EAAM,KAAlB;AAMA,EAAAA,kCAAA,iBAAc,KAAK,EAAM,KAAzB;AAMA,EAAAA,kCAAA,qBAAkB,KAAK,EAAM,KAA7B;AAgBA,EAAAA,kCAAA,uBAAoB,KAAK,EAAM,KAA/B;AA/CU,SAAAA;AAAA,GAAA;;;ACtGZ,IAAM,gBAAN,cAA4B,wBAAgB;AAAA,EAC1C,UAAUC,SAAsC;AAC9C,QACE,KAAK,QAAQ,gBAAgB,KAAK,KAClC,CAAC,KAAK,QAAQ,gBAAgB,IAAI,KAClC,CAAC,KAAK,eAAeA,OAAM,GAC3B;AACA,YAAM,IAAI,2BAA2B;AAAA,IACvC;AAEA,QAAIA,QAAO,WAAW,GAAG;AACvB,WAAK,KAAK,OAAO,gBAAQ,GAAG,GAAG,CAAC;AAAA,IAClC;AACA,QAAIA,QAAO,WAAW,GAAG;AACvB,WAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,GAAGA,QAAO,CAAC,CAAC;AAAA,IAC1C;AACA,QAAIA,QAAO,SAAS,GAAG;AACrB,UAAI,CAAC,KAAK,QAAQ,gBAAgB,WAAW,GAAG;AAC9C,cAAM,IAAI,sBAAsB;AAAA,MAClC;AACA,WAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,GAAG,KAAK,KAAK,QAAQ,IAAIA,OAAM,CAAC;AAAA,IAC9D;AAEA,SAAK,sBAAsBA,OAAM;AAAA,EACnC;AAAA,EAEA,eAAeA,SAA+C;AAC5D,UAAM,UAAU,KAAK,WAAW;AAChC,aAAS,MAAM,GAAG,MAAMA,QAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,YAAM,MAAMA,QAAO,GAAG,EAAE,WAAW;AACnC,UAAI,CAAC,QAAQ,KAAK,CAAC,MAAM,SAAS,EAAE,WAAW,EAAE,OAAO,WAAW,CAAC,GAAG;AACrE,eAAO;AAAA,MACT;AAAA,IACF;AACA,WAAO;AAAA,EACT;AAAA,EAEA,sBAAsBA,SAAsC;AAC1D,QAAIA,QAAO,SAAS,GAAG;AACrB,YAAM,UAAU,IAAI,MAAcA,QAAO,MAAM;AAC/C,YAAM,UAAU,KAAK,WAAW;AAChC,eAAS,MAAM,GAAG,MAAMA,QAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,cAAM,MAAMA,QAAO,GAAG,EAAE,WAAW;AACnC,gBAAQ,GAAG,IAAI,QAAQ;AAAA,UACrB,CAAC,MAAM,SAAS,EAAE,WAAW,EAAE,OAAO,WAAW;AAAA,QACnD;AAAA,MACF;AACA,WAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,GAAG,KAAK,KAAK,QAAQ,IAAI,QAAQ,KAAK,CAAC,CAAC;AAAA,IACtE,OAAO;AACL,WAAK,KAAK,OAAO,gBAAQ,GAAG,GAAG,CAAC;AAAA,IAClC;AAAA,EACF;AAAA,EAEA,YAA0C;AACxC,UAAM,IAAI,KAAK,EAAE;AAEjB,QAAI,aAAa,qBAAa,aAAa,qBAAc,QAAO,CAAC,CAAC;AAElE,QAAI,aAAa,kBAAU;AACzB,YAAMA,UAAuC,CAAC;AAE9C,eAAS,MAAM,GAAG,MAAM,EAAE,KAAK,GAAG,MAAM,KAAK,OAAO;AAClD,cAAM,QAAQ,EAAE,OAAO,GAAG;AAC1B,YAAI,iBAAiB,qBAAa,iBAAiB,sBAAc;AAC/D,UAAAA,QAAO,KAAK,KAAK;AAAA,QACnB;AAAA,MACF;AAEA,aAAOA;AAAA,IACT;AAEA,WAAO,CAAC;AAAA,EACV;AAAA,EAEA,MAAuD;AACrD,WAAO,KAAK,KAAK;AAAA,MACf,gBAAQ,GAAG,KAAK;AAAA,MAChB;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAAA,EAEA,WACE,SAIA;AACA,UAAM,SAAS,IAAI,MAAgB,QAAQ,MAAM;AACjD,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,EAAE,OAAO,QAAQ,IAAI,QAAQ,GAAG;AACtC,aAAO,GAAG,IAAI,KAAK,KAAK,QAAQ,IAAI,CAAC,OAAO,WAAW,KAAK,CAAC;AAAA,IAC/D;AACA,SAAK,KAAK,IAAI,gBAAQ,GAAG,KAAK,GAAG,KAAK,KAAK,QAAQ,IAAI,MAAM,CAAC;AAAA,EAChE;AAAA,EAEA,aAGI;AACF,UAAM,MAAM,KAAK,IAAI;AAGrB,QAAI,eAAe,qBAAa,eAAe,sBAAc;AAC3D,aAAO,CAAC,EAAE,OAAO,KAAK,SAAS,IAAI,CAAC;AAAA,IACtC;AAEA,QAAI,eAAe,kBAAU;AAC3B,YAAM,MAGA,CAAC;AAEP,eAAS,MAAM,GAAG,MAAM,IAAI,KAAK,GAAG,MAAM,KAAK,OAAO;AACpD,cAAM,OAAO,IAAI,OAAO,GAAG;AAG3B,YAAI,gBAAgB,qBAAa,gBAAgB,sBAAc;AAC7D,cAAI,KAAK,EAAE,OAAO,MAAM,SAAS,KAAK,CAAC;AAAA,QACzC;AAKA,YAAI,gBAAgB,kBAAU;AAC5B,cAAI,KAAK,KAAK,IAAI,GAAG;AACnB,kBAAM,QAAQ,KAAK,OAAO,GAAG,mBAAW,oBAAY;AACpD,kBAAM,SAAS,KAAK,YAAY,GAAG,mBAAW,oBAAY;AAC1D,gBAAI,KAAK,EAAE,OAAO,OAAO,SAAS,UAAU,MAAM,CAAC;AAAA,UACrD;AAAA,QACF;AAAA,MACF;AAEA,aAAO;AAAA,IACT;AAEA,WAAO,CAAC;AAAA,EACV;AACF;AAEA,IAAO,wBAAQ;;;AClJf,IAAM,mBAAN,MAAM,yBAAwB,sBAAc;AAa5C;AAZE,cADI,kBACG,YAAW,CAAC,MAAe,QAChC,IAAI,iBAAgB,MAAM,GAAG;AAE/B,cAJI,kBAIG,UAAS,CAAC,YAAwB;AACvC,QAAM,OAAO,QAAQ,IAAI;AAAA,IACvB,IAAI;AAAA,IACJ,IAAI,gBAAgB;AAAA,IACpB,MAAM,CAAC;AAAA,EACT,CAAC;AACD,QAAM,MAAM,QAAQ,SAAS,IAAI;AACjC,SAAO,IAAI,iBAAgB,MAAM,GAAG;AACtC;AAZF,IAAM,kBAAN;AAeA,IAAO,0BAAQ;;;ACff,IAAM,sBAAN,MAAM,4BAA2B,qBAAa;AAAA,EAU5C,SAAS,OAAe;AACtB,UAAM,EAAE,KAAK,IAAI,KAAK,kBAAkB;AACxC,UAAM,KAAK,KAAK;AAAA,EAClB;AAAA,EAEA,oBAAoB;AAClB,QAAI,OAAO,KAAK,KAAK;AAErB,QAAI,CAAC,MAAM;AACT,aAAO,KAAK,KAAK,QAAQ,IAAI,CAAC,CAAC;AAC/B,WAAK,KAAK,IAAI,gBAAQ,GAAG,MAAM,GAAG,IAAI;AAAA,IACxC;AAEA,WAAO,EAAE,KAAK;AAAA,EAChB;AACF;AAxBE,cADI,qBACG,YAAW,CAAC,MAAe,QAChC,IAAI,oBAAmB,MAAM,GAAG;AAElC,cAJI,qBAIG,UAAS,CAAC,YAAwB;AACvC,QAAM,OAAO,QAAQ,IAAI,CAAC,CAAC;AAC3B,QAAM,MAAM,QAAQ,SAAS,IAAI;AACjC,SAAO,IAAI,oBAAmB,MAAM,GAAG;AACzC;AARF,IAAM,qBAAN;AA2BA,IAAO,6BAAQ;;;AC7Bf,IAAM,oBAAN,MAAM,0BAAyB,wBAAgB;AAG/C;AAFE,cADI,mBACG,YAAW,CAAC,MAAe,QAChC,IAAI,kBAAiB,MAAM,GAAG;AAFlC,IAAM,mBAAN;AAKA,IAAO,2BAAQ;;;ACAf,IAAM,eAAN,MAAM,qBAAoB,wBAAgB;AAAA,EAYxC,SAAgC;AAC9B,UAAM,SAAS,KAAK,KAAK,OAAO,gBAAQ,GAAG,QAAQ,CAAC;AACpD,QAAI,kBAAkB,kBAAW,QAAO;AACxC,WAAO;AAAA,EACT;AAAA,EAEA,IAA2B;AACzB,UAAM,IAAI,KAAK,KAAK,OAAO,gBAAQ,GAAG,GAAG,CAAC;AAC1C,QAAI,aAAa,kBAAW,QAAO;AACnC,WAAO;AAAA,EACT;AAAA,EAEA,aAAa,WAAmB;AAC9B,SAAK,KAAK,IAAI,gBAAQ,GAAG,QAAQ,GAAG,kBAAU,GAAG,SAAS,CAAC;AAAA,EAC7D;AAAA,EAEA,kBAAkB;AAChB,SAAK,KAAK,OAAO,gBAAQ,GAAG,QAAQ,CAAC;AAAA,EACvC;AAAA,EAEA,eAAmC;AACjC,WAAO,KAAK,OAAO,GAAG,SAAS;AAAA,EACjC;AAAA,EAEA,YAAY,UAAqB;AAC/B,SAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,GAAG,kBAAU,GAAG,QAAQ,CAAC;AAAA,EACvD;AAAA,EAEA,cAAkC;AAChC,WAAO,KAAK,EAAE,GAAG,SAAS;AAAA,EAC5B;AAAA,EAEA,SAAS,OAAiC;AACxC,SAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,GAAG,KAAK;AAAA,EAQtC;AAAA,EAEA,cAAc;AACZ,SAAK,KAAK,OAAO,gBAAQ,GAAG,GAAG,CAAC;AAAA,EAClC;AAAA,EAEA,WAAiD;AAC/C,UAAM,IAAI,KAAK,EAAE;AACjB,QAAI,aAAa,qBAAa,aAAa,qBAAc,QAAO;AAChE,WAAO;AAAA,EACT;AACF;AA/DE,cADI,cACG,YAAW,CAAC,MAAe,QAAgB,IAAI,aAAY,MAAM,GAAG;AAE3E,cAHI,cAGG,UAAS,CAAC,YAAwB;AACvC,QAAM,OAAO,QAAQ,IAAI;AAAA,IACvB,IAAI;AAAA,IACJ,MAAM,CAAC;AAAA,EACT,CAAC;AACD,QAAM,MAAM,QAAQ,SAAS,IAAI;AACjC,SAAO,IAAI,aAAY,MAAM,GAAG;AAClC;AAVF,IAAM,cAAN;AAkEA,IAAO,sBAAQ;;;ACrEf,IAAM,qBAAN,MAAM,2BAA0B,sBAAc;AAa9C;AAZE,cADI,oBACG,YAAW,CAAC,MAAe,QAChC,IAAI,mBAAkB,MAAM,GAAG;AAEjC,cAJI,oBAIG,UAAS,CAAC,YAAwB;AACvC,QAAM,OAAO,QAAQ,IAAI;AAAA,IACvB,IAAI;AAAA,IACJ,IAAI,gBAAgB;AAAA,IACpB,MAAM,CAAC;AAAA,EACT,CAAC;AACD,QAAM,MAAM,QAAQ,SAAS,IAAI;AACjC,SAAO,IAAI,mBAAkB,MAAM,GAAG;AACxC;AAZF,IAAM,oBAAN;AAeA,IAAO,4BAAQ;;;ACbf,IAAM,sBAAN,MAAM,4BAA2B,sBAAc;AAAA,EAc7C,SAAS,OAAgB;AACvB,UAAM,WAAW,KAAK,YAAY;AAClC,QAAI,CAAC,SAAS,SAAS,KAAK,KAAK,UAAU,gBAAQ,GAAG,KAAK,GAAG;AAC5D,YAAM,IAAI,2BAA2B;AAAA,IACvC;AAEA,SAAK,KAAK,IAAI,gBAAQ,GAAG,GAAG,GAAG,KAAK;AAEpC,UAAM,UAAU,KAAK,WAAW;AAChC,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,YAAM,QAAQ,OAAO,WAAW,MAAM,QAAQ,QAAQ,gBAAQ,GAAG,KAAK;AACtE,aAAO,mBAAmB,KAAK;AAAA,IACjC;AAAA,EACF;AAAA,EAEA,WAAoB;AAClB,UAAM,IAAI,KAAK,EAAE;AACjB,QAAI,aAAa,gBAAS,QAAO;AACjC,WAAO,gBAAQ,GAAG,KAAK;AAAA,EACzB;AAAA,EAEA,cAAyB;AACvB,UAAM,UAAU,KAAK,WAAW;AAEhC,UAAM,WAAsB,CAAC;AAC7B,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,UAAU,QAAQ,GAAG,EAAE,WAAW;AACxC,UAAI,QAAS,UAAS,KAAK,OAAO;AAAA,IACpC;AAEA,WAAO;AAAA,EACT;AACF;AA9CE,cADI,qBACG,YAAW,CAAC,MAAe,QAChC,IAAI,oBAAmB,MAAM,GAAG;AAElC,cAJI,qBAIG,UAAS,CAAC,YAAwB;AACvC,QAAM,OAAO,QAAQ,IAAI;AAAA,IACvB,IAAI;AAAA,IACJ,IAAI,gBAAgB;AAAA,IACpB,MAAM,CAAC;AAAA,EACT,CAAC;AACD,QAAM,MAAM,QAAQ,SAAS,IAAI;AACjC,SAAO,IAAI,oBAAmB,MAAM,GAAG;AACzC;AAZF,IAAM,qBAAN;AAiDA,IAAO,6BAAQ;;;ACpDf,IAAM,kBAAN,MAAM,wBAAuB,sBAAc;AAY3C;AAXE,cADI,iBACG,YAAW,CAAC,MAAe,QAChC,IAAI,gBAAe,MAAM,GAAG;AAE9B,cAJI,iBAIG,UAAS,CAAC,YAAwB;AACvC,QAAM,OAAO,QAAQ,IAAI;AAAA,IACvB,IAAI;AAAA,IACJ,MAAM,CAAC;AAAA,EACT,CAAC;AACD,QAAM,MAAM,QAAQ,SAAS,IAAI;AACjC,SAAO,IAAI,gBAAe,MAAM,GAAG;AACrC;AAXF,IAAM,iBAAN;AAcA,IAAO,yBAAQ;;;ACER,IAAM,sBAAsB,CACjC,aAC6B;AAC7B,MAAI,CAAC,SAAU,QAAO,CAAC;AAEvB,QAAM,OAAiC,CAAC;AACxC,WAAS,MAAM,GAAG,MAAM,SAAS,KAAK,GAAG,MAAM,KAAK,OAAO;AACzD,UAAM,MAAM,SAAS,IAAI,GAAG;AAC5B,UAAM,OAAO,SAAS,OAAO,GAAG;AAEhC,QAAI,eAAe,kBAAU,gBAAgB,iBAAS;AACpD,WAAK,KAAK,CAAC,mBAAmB,MAAM,GAAG,GAAG,GAAG,CAAC;AAAA,IAChD;AAAA,EACF;AAEA,SAAO;AACT;AAEO,IAAM,qBAAqB,CAChC,MACA,QACiB;AACjB,QAAM,gBAAgB,uBAAuB,IAAI;AACjD,MAAI,cAAe,QAAO,2BAAmB,SAAS,MAAM,GAAG;AAC/D,SAAO,sBAAsB,MAAM,GAAG;AACxC;AAkBA,IAAM,yBAAyB,CAAC,SAA2B;AACzD,QAAM,OAAO,KAAK,OAAO,gBAAQ,GAAG,MAAM,CAAC;AAE3C,MAAI,gBAAgB,kBAAU;AAC5B,aAAS,MAAM,GAAG,MAAM,KAAK,KAAK,GAAG,MAAM,KAAK,OAAO;AACrD,YAAM,MAAM,KAAK,OAAO,GAAG;AAC3B,YAAM,aAAa,eAAe,mBAAW,IAAI,IAAI,gBAAQ,GAAG,GAAG,CAAC;AACpE,UAAI,WAAY,QAAO;AAAA,IACzB;AAAA,EACF;AAEA,SAAO;AACT;AAEA,IAAM,wBAAwB,CAAC,MAAe,QAAiC;AAC7E,QAAM,cAAc,wBAAwB,MAAM,gBAAQ,GAAG,IAAI,CAAC;AAClE,QAAM,OAAO,KAAK,QAAQ,OAAO,aAAa,eAAO;AAErD,MAAI,SAAS,gBAAQ,GAAG,KAAK,EAAG,QAAO,oBAAoB,MAAM,GAAG;AACpE,MAAI,SAAS,gBAAQ,GAAG,IAAI,EAAG,QAAO,oBAAoB,MAAM,GAAG;AACnE,MAAI,SAAS,gBAAQ,GAAG,IAAI,EAAG,QAAO,oBAAY,SAAS,MAAM,GAAG;AACpE,MAAI,SAAS,gBAAQ,GAAG,KAAK,EAAG,QAAO,yBAAiB,SAAS,MAAM,GAAG;AAK1E,SAAO,wBAAgB,SAAS,MAAM,GAAG;AAC3C;AAEA,IAAM,sBAAsB,CAAC,MAAe,QAA+B;AACzE,QAAM,gBAAgB,wBAAwB,MAAM,gBAAQ,GAAG,IAAI,CAAC;AACpE,QAAM,WAAW,KAAK,QAAQ,YAAY,eAAe,iBAAS;AAClE,QAAM,QAAQ,UAAU,SAAS,KAAK;AAEtC,MAAI,UAAU,OAAO,gBAAgB,UAAU,GAAG;AAChD,WAAO,0BAAkB,SAAS,MAAM,GAAG;AAAA,EAC7C,WAAW,UAAU,OAAO,gBAAgB,KAAK,GAAG;AAClD,WAAO,2BAAmB,SAAS,MAAM,GAAG;AAAA,EAC9C,OAAO;AACL,WAAO,wBAAgB,SAAS,MAAM,GAAG;AAAA,EAC3C;AACF;AAEA,IAAM,sBAAsB,CAAC,MAAe,QAA+B;AACzE,QAAM,gBAAgB,wBAAwB,MAAM,gBAAQ,GAAG,IAAI,CAAC;AACpE,QAAM,WAAW,KAAK,QAAQ,YAAY,eAAe,iBAAS;AAClE,QAAM,QAAQ,UAAU,SAAS,KAAK;AAEtC,MAAI,UAAU,OAAO,gBAAgB,KAAK,GAAG;AAC3C,WAAO,wBAAgB,SAAS,MAAM,GAAG;AAAA,EAC3C,OAAO;AACL,WAAO,uBAAe,SAAS,MAAM,GAAG;AAAA,EAC1C;AACF;AAEA,IAAM,YAAY,CAAC,OAAeC,WAC/B,QAAQA,WAAU;AAErB,IAAM,0BAA0B,CAAC,WAAoB,SAAkB;AACrE,MAAI;AACJ,SAAO,WAAW,CAAC,SAAS;AAC1B,QAAI,CAAC,UAAW,aAAY,KAAK,IAAI,IAAI;AAAA,EAC3C,CAAC;AACD,SAAO;AACT;AAEA,IAAM,SAAS,CAAC,WAAoB,YAAoC;AACtE,UAAQ,SAAS;AACjB,QAAM,SAAS,UAAU,YAAY,gBAAQ,GAAG,QAAQ,GAAG,eAAO;AAClE,MAAI,OAAQ,QAAO,QAAQ,OAAO;AACpC;;;AC1HA,IAAM,eAAN,MAAM,aAAY;AAAA,EAUR,YAAY,MAAe;AATnC,wBAAS;AAUP,SAAK,OAAO;AAAA,EACd;AAAA,EAEA,SAA+B;AAC7B,UAAM,SAAS,KAAK,KAAK,OAAO,gBAAQ,GAAG,QAAQ,CAAC;AACpD,QAAI,kBAAkB,iBAAU,QAAO;AACvC,WAAO;AAAA,EACT;AAAA,EAEA,YAAsC;AACpC,UAAM,EAAE,OAAO,IAAI,KAAK,kBAAkB;AAE1C,UAAM,SAAS,IAAI,MAAM,OAAO,KAAK,CAAC;AACtC,aAAS,MAAM,GAAG,MAAM,OAAO,KAAK,GAAG,MAAM,KAAK,OAAO;AACvD,YAAM,MAAM,OAAO,IAAI,GAAG;AAC1B,YAAM,OAAO,OAAO,OAAO,KAAK,eAAO;AACvC,aAAO,GAAG,IAAI,CAAC,mBAAmB,MAAM,GAAG,GAAG,GAAG;AAAA,IACnD;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,eAAyC;AACvC,UAAM,YAAsC,CAAC;AAE7C,UAAM,aAAa,CAAC,WAAsC;AACxD,UAAI,CAAC,OAAQ;AACb,eAAS,MAAM,GAAG,MAAM,OAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,cAAM,QAAQ,OAAO,GAAG;AACxB,kBAAU,KAAK,KAAK;AACpB,cAAM,CAAC,UAAU,IAAI;AACrB,YAAI,sBAAsB,4BAAoB;AAC5C,qBAAW,oBAAoB,WAAW,KAAK,CAAC,CAAC;AAAA,QACnD;AAAA,MACF;AAAA,IACF;AAEA,eAAW,KAAK,UAAU,CAAC;AAE3B,WAAO;AAAA,EACT;AAAA,EAEA,SAAS,OAAe;AACtB,UAAM,EAAE,OAAO,IAAI,KAAK,kBAAkB;AAC1C,YAAQ,KAAK,KAAK;AAAA,EACpB;AAAA,EAEA,YAAY,OAA2B;AACrC,UAAM,SAAS,MAAM,UAAU;AAC/B,UAAM,SACJ,WAAW,SAAY,KAAK,kBAAkB,EAAE,SAAS,OAAO,KAAK;AAEvE,UAAM,QAAQ,QAAQ,QAAQ,MAAM,GAAG;AACvC,QAAI,WAAW,UAAa,UAAU,QAAW;AAC/C,YAAM,IAAI;AAAA,QACR,oCAAoC,MAAM,sBAAsB,CAAC;AAAA,MACnE;AAAA,IACF;AAEA,WAAO,OAAO,KAAK;AAEnB,QAAI,WAAW,UAAa,OAAO,KAAK,MAAM,GAAG;AAC/C,WAAK,YAAY,MAAM;AAAA,IACzB;AAAA,EACF;AAAA,EAEA,oBAAoB;AAClB,QAAI,SAAS,KAAK,OAAO;AAEzB,QAAI,CAAC,QAAQ;AACX,eAAS,KAAK,KAAK,QAAQ,IAAI,CAAC,CAAC;AACjC,WAAK,KAAK,IAAI,gBAAQ,GAAG,QAAQ,GAAG,MAAM;AAAA,IAC5C;AAEA,WAAO,EAAE,OAAO;AAAA,EAClB;AACF;AApFE,cAHI,cAGG,YAAW,CAAC,SAAkB,IAAI,aAAY,IAAI;AAEzD,cALI,cAKG,UAAS,CAAC,YAAwB;AACvC,QAAM,OAAO,QAAQ,IAAI,EAAE,QAAQ,CAAC,EAAE,CAAC;AACvC,SAAO,IAAI,aAAY,IAAI;AAC7B;AARF,IAAM,cAAN;AAyFA,IAAO,sBAAQ;;;AC7Ff,IAAM,cAAN,MAAM,oBAAmB,gBAAQ;AAAA,EAc/B,QAAqB;AACnB,WAAO,KAAK,OAAO,gBAAQ,GAAG,OAAO,GAAG,eAAO;AAAA,EACjD;AAAA,EAEA,WAAgC;AAC9B,WAAO,KAAK,YAAY,gBAAQ,GAAG,UAAU,GAAG,eAAO;AAAA,EACzD;AAAA,EAEA,cAAuC;AACrC,UAAM,OAAO,KAAK,SAAS;AAC3B,QAAI,CAAC,KAAM,QAAO;AAClB,WAAO,oBAAY,SAAS,IAAI;AAAA,EAClC;AAAA,EAEA,sBAAmC;AACjC,QAAI,WAAW,KAAK,YAAY;AAChC,QAAI,CAAC,UAAU;AACb,iBAAW,oBAAY,OAAO,KAAK,OAAO;AAC1C,YAAM,cAAc,KAAK,QAAQ,SAAS,SAAS,IAAI;AACvD,WAAK,IAAI,gBAAQ,GAAG,UAAU,GAAG,WAAW;AAAA,IAC9C;AACA,WAAO;AAAA,EACT;AAAA,EAEA,oBAAyC;AACvC,WAAO,KAAK,YAAY,gBAAQ,GAAG,mBAAmB,GAAG,eAAO;AAAA,EAClE;AAAA,EAEA,uBAAsD;AACpD,UAAM,OAAO,KAAK,kBAAkB;AACpC,QAAI,CAAC,KAAM,QAAO;AAClB,WAAO,0BAAkB,SAAS,IAAI;AAAA,EACxC;AAAA,EAEA,+BAAkD;AAChD,QAAI,cAAc,KAAK,qBAAqB;AAC5C,QAAI,CAAC,aAAa;AAChB,oBAAc,0BAAkB,OAAO,KAAK,OAAO;AACnD,YAAM,iBAAiB,KAAK,QAAQ,SAAS,YAAY,IAAI;AAC7D,WAAK,IAAI,gBAAQ,GAAG,mBAAmB,GAAG,cAAc;AAAA,IAC1D;AACA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,eAAe,SAAiB,OAAuB;AACrD,UAAM,WAAW,KAAK,IAAI,gBAAQ,GAAG,OAAO,CAAC;AAC7C,UAAM,iBAAiB,KAAK,MAAM,EAAE,eAAe,SAAS,KAAK;AACjE,WAAO,kBAAkB;AAAA,EAC3B;AAAA,EAEA,eAAe,OAAqB;AAClC,SAAK,MAAM,EAAE,eAAe,KAAK;AAAA,EACnC;AACF;AAzEE,cADI,aACG,uBAAsB,CAC3B,SACA,UACG;AACH,QAAM,OAAO,oBAAI,IAAI;AACrB,OAAK,IAAI,gBAAQ,GAAG,MAAM,GAAG,gBAAQ,GAAG,SAAS,CAAC;AAClD,OAAK,IAAI,gBAAQ,GAAG,OAAO,GAAG,KAAK;AACnC,SAAO,IAAI,YAAW,MAAM,OAAO;AACrC;AAEA,cAXI,aAWG,sBAAqB,CAAC,KAAc,YACzC,IAAI,YAAW,KAAK,OAAO;AAZ/B,IAAM,aAAN;AA4EA,IAAO,qBAAQ;;;ACzEf,IAAM,eAAN,MAAM,qBAAoB,gBAAQ;AAAA,EAahC,SAAkC;AAChC,WAAO,KAAK,OAAO,gBAAQ,GAAG,QAAQ,CAAC;AAAA,EACzC;AAAA,EAEA,OAAiB;AACf,WAAO,KAAK,OAAO,gBAAQ,GAAG,MAAM,GAAG,gBAAQ;AAAA,EACjD;AAAA,EAEA,QAAmB;AACjB,WAAO,KAAK,OAAO,gBAAQ,GAAG,OAAO,GAAG,iBAAS;AAAA,EACnD;AAAA,EAEA,aAAa,SAAuB;AAClC,UAAM,OAAO,KAAK,KAAK;AACvB,SAAK,KAAK,OAAO;AAAA,EACnB;AAAA,EAEA,aAAa,SAAuB;AAClC,UAAM,OAAO,KAAK,KAAK;AACvB,SAAK,cAAc,KAAK,KAAK,GAAG,OAAO;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,eAAe,SAAiB,aAAyC;AACvE,UAAM,OAAO,KAAK,KAAK;AACvB,UAAM,QAAQ,KAAK,MAAM,EAAE,SAAS;AAEpC,QAAI,cAAc,OAAO;AACvB,YAAM,IAAI,wBAAwB,aAAa,KAAK;AAAA,IACtD;AAEA,QAAI,4BAA4B;AAChC,aAAS,MAAM,GAAG,MAAM,KAAK,KAAK,GAAG,MAAM,KAAK,OAAO;AACrD,UAAI,8BAA8B,GAAG;AAEnC,aAAK,cAAc,KAAK,OAAO;AAC/B,eAAO;AAAA,MACT;AAEA,YAAM,SAAS,KAAK,IAAI,GAAG;AAC3B,YAAM,MAAM,KAAK,QAAQ,OAAO,MAAM;AAEtC,UAAI,eAAe,cAAa;AAC9B,YAAI,IAAI,MAAM,EAAE,SAAS,IAAI,2BAA2B;AAEtD,iBACE,IAAI,eAAe,SAAS,yBAAyB,KAAK;AAAA,QAE9D,OAAO;AAEL,uCAA6B,IAAI,MAAM,EAAE,SAAS;AAAA,QACpD;AAAA,MACF;AAEA,UAAI,eAAe,qBAAa;AAE9B,qCAA6B;AAAA,MAC/B;AAAA,IACF;AAEA,QAAI,8BAA8B,GAAG;AAEnC,WAAK,cAAc,KAAK,KAAK,GAAG,OAAO;AACvC,aAAO;AAAA,IACT;AAGA,UAAM,IAAI,qBAAqB,aAAa,gBAAgB;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,eAAe,aAAqB,QAAQ,MAAY;AACtD,UAAM,OAAO,KAAK,KAAK;AACvB,UAAM,QAAQ,KAAK,MAAM,EAAE,SAAS;AAEpC,QAAI,eAAe,OAAO;AACxB,YAAM,IAAI,wBAAwB,aAAa,KAAK;AAAA,IACtD;AAEA,QAAI,4BAA4B;AAChC,aAAS,MAAM,GAAG,MAAM,KAAK,KAAK,GAAG,MAAM,KAAK,OAAO;AACrD,YAAM,SAAS,KAAK,IAAI,GAAG;AAC3B,YAAM,MAAM,KAAK,QAAQ,OAAO,MAAM;AAEtC,UAAI,eAAe,cAAa;AAC9B,YAAI,IAAI,MAAM,EAAE,SAAS,IAAI,2BAA2B;AAEtD,cAAI,eAAe,2BAA2B,KAAK;AACnD,cAAI,SAAS,IAAI,KAAK,EAAE,KAAK,MAAM,EAAG,MAAK,OAAO,GAAG;AACrD;AAAA,QACF,OAAO;AAEL,uCAA6B,IAAI,MAAM,EAAE,SAAS;AAAA,QACpD;AAAA,MACF;AAEA,UAAI,eAAe,qBAAa;AAC9B,YAAI,8BAA8B,GAAG;AAEnC,eAAK,UAAU,GAAG;AAClB;AAAA,QACF,OAAO;AAEL,uCAA6B;AAAA,QAC/B;AAAA,MACF;AAAA,IACF;AAGA,UAAM,IAAI,qBAAqB,aAAa,gBAAgB;AAAA,EAC9D;AAAA,EAEA,OAAO,SAA2C;AAChD,YAAQ,IAAI;AACZ,UAAM,SAAS,KAAK,OAAO;AAC3B,QAAI,OAAQ,QAAO,OAAO,OAAO;AAAA,EACnC;AAAA;AAAA,EAGA,SAAS,SAAqD;AAC5D,UAAM,OAAO,KAAK,KAAK;AACvB,aAAS,MAAM,GAAG,MAAM,KAAK,KAAK,GAAG,MAAM,KAAK,OAAO;AACrD,YAAM,SAAS,KAAK,IAAI,GAAG;AAC3B,YAAM,MAAM,KAAK,QAAQ,OAAO,MAAM;AACtC,UAAI,eAAe,aAAa,KAAI,SAAS,OAAO;AACpD,cAAQ,KAAK,MAAM;AAAA,IACrB;AAAA,EACF;AAAA,EAEQ,cAAc,QAAgB,SAAuB;AAC3D,UAAM,OAAO,KAAK,KAAK;AAEvB,SAAK,OAAO,CAAC,SAAS;AACpB,YAAM,WAAW,KAAK,MAAM,EAAE,SAAS,IAAI;AAC3C,WAAK,IAAI,gBAAQ,GAAG,OAAO,GAAG,kBAAU,GAAG,QAAQ,CAAC;AAAA,IACtD,CAAC;AAED,SAAK,OAAO,QAAQ,OAAO;AAAA,EAC7B;AAAA,EAEQ,UAAU,QAAsB;AACtC,UAAM,OAAO,KAAK,KAAK;AAEvB,UAAM,MAAM,KAAK,OAAO,MAAM;AAC9B,QAAI,eAAe,qBAAa;AAC9B,WAAK,OAAO,CAAC,SAAS;AACpB,cAAM,WAAW,KAAK,MAAM,EAAE,SAAS,IAAI;AAC3C,aAAK,IAAI,gBAAQ,GAAG,OAAO,GAAG,kBAAU,GAAG,QAAQ,CAAC;AAAA,MACtD,CAAC;AAAA,IACH;AAEA,SAAK,OAAO,MAAM;AAAA,EACpB;AACF;AApLE,cADI,cACG,eAAc,CAAC,SAAqB,WAAoB;AAC7D,QAAM,OAAO,oBAAI,IAAI;AACrB,OAAK,IAAI,gBAAQ,GAAG,MAAM,GAAG,gBAAQ,GAAG,OAAO,CAAC;AAChD,OAAK,IAAI,gBAAQ,GAAG,MAAM,GAAG,QAAQ,IAAI,CAAC,CAAC,CAAC;AAC5C,OAAK,IAAI,gBAAQ,GAAG,OAAO,GAAG,QAAQ,IAAI,CAAC,CAAC;AAC5C,MAAI,OAAQ,MAAK,IAAI,gBAAQ,GAAG,QAAQ,GAAG,MAAM;AACjD,SAAO,IAAI,aAAY,MAAM,OAAO;AACtC;AAEA,cAVI,cAUG,sBAAqB,CAAC,KAAc,YACzC,IAAI,aAAY,KAAK,OAAO;AAXhC,IAAM,cAAN;AAuLA,IAAO,sBAAQ;;;AChMR,IAAM,UAAU,IAAI,WAAW,GAAG;AAEzC,QAAQ,kBAAU,IAAI,IAAI;AAC1B,QAAQ,kBAAU,GAAG,IAAI;AACzB,QAAQ,kBAAU,GAAG,IAAI;AACzB,QAAQ,kBAAU,KAAK,IAAI;AAC3B,QAAQ,kBAAU,IAAI,IAAI;AAC1B,QAAQ,kBAAU,IAAI,IAAI;AAC1B,QAAQ,kBAAU,GAAG,IAAI;AACzB,QAAQ,kBAAU,KAAK,IAAI;AAC3B,QAAQ,kBAAU,KAAK,IAAI;AAC3B,QAAQ,kBAAU,IAAI,IAAI;AAEnB,IAAM,kBAAkB,IAAI,WAAW,GAAG;AAEjD,gBAAgB,kBAAU,MAAM,IAAI;AACpC,gBAAgB,kBAAU,IAAI,IAAI;AAClC,gBAAgB,kBAAU,KAAK,IAAI;AAE5B,IAAM,YAAY,IAAI,WAAW,GAAG;AAE3C,SAAS,MAAM,GAAG,MAAM,KAAK,MAAM,KAAK,OAAO;AAC7C,YAAU,GAAG,IAAI,QAAQ,GAAG,KAAK,gBAAgB,GAAG,IAAI,IAAI;AAC9D;;;AClBA,IAAM,EAAE,SAAS,eAAe,IAAI;AAGpC,IAAM,aAAN,MAAiB;AAAA,EAIf,YAAY,OAAmB,aAAa,OAAO;AAHnD,wBAAmB;AACnB,wBAAmB;AAGjB,SAAK,QAAQ;AACb,SAAK,aAAa;AAAA,EACpB;AAAA,EAEU,cAAsB;AAC9B,QAAI,QAAQ;AAEZ,WAAO,CAAC,KAAK,MAAM,KAAK,GAAG;AACzB,YAAM,OAAO,KAAK,MAAM,KAAK;AAC7B,UAAI,CAAC,QAAQ,IAAI,EAAG;AACpB,eAAS,aAAa,KAAK,MAAM,KAAK,CAAC;AAAA,IACzC;AAEA,UAAM,cAAc,OAAO,KAAK;AAEhC,QAAI,CAAC,SAAS,CAAC,SAAS,WAAW,GAAG;AACpC,YAAM,IAAI,mBAAmB,KAAK,MAAM,SAAS,GAAG,KAAK;AAAA,IAC3D;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA,EAIU,iBAAyB;AACjC,QAAI,QAAQ;AAGZ,WAAO,CAAC,KAAK,MAAM,KAAK,GAAG;AACzB,YAAM,OAAO,KAAK,MAAM,KAAK;AAC7B,UAAI,CAAC,UAAU,IAAI,EAAG;AACtB,eAAS,aAAa,KAAK,MAAM,KAAK,CAAC;AACvC,UAAI,SAAS,kBAAU,OAAQ;AAAA,IACjC;AAGA,WAAO,CAAC,KAAK,MAAM,KAAK,GAAG;AACzB,YAAM,OAAO,KAAK,MAAM,KAAK;AAC7B,UAAI,CAAC,QAAQ,IAAI,EAAG;AACpB,eAAS,aAAa,KAAK,MAAM,KAAK,CAAC;AAAA,IACzC;AAEA,UAAM,cAAc,OAAO,KAAK;AAEhC,QAAI,CAAC,SAAS,CAAC,SAAS,WAAW,GAAG;AACpC,YAAM,IAAI,mBAAmB,KAAK,MAAM,SAAS,GAAG,KAAK;AAAA,IAC3D;AAEA,QAAI,cAAc,OAAO,kBAAkB;AACzC,UAAI,KAAK,YAAY;AACnB,cAAM,MAAM,yDAAyD,KAAK;AAC1E,gBAAQ,KAAK,GAAG;AAChB,eAAO,OAAO;AAAA,MAChB,OAAO;AACL,cAAM,MAAM,yDAAyD,KAAK;AAC1E,gBAAQ,KAAK,GAAG;AAAA,MAClB;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,EAEU,iBAAuB;AAC/B,WAAO,CAAC,KAAK,MAAM,KAAK,KAAK,aAAa,KAAK,MAAM,KAAK,CAAC,GAAG;AAC5D,WAAK,MAAM,KAAK;AAAA,IAClB;AAAA,EACF;AAAA,EAEU,WAAiB;AACzB,WAAO,CAAC,KAAK,MAAM,KAAK,GAAG;AACzB,YAAM,OAAO,KAAK,MAAM,KAAK;AAC7B,UAAI,SAAS,WAAW,SAAS,eAAgB;AACjD,WAAK,MAAM,KAAK;AAAA,IAClB;AAAA,EACF;AAAA,EAEU,cAAuB;AAC/B,QAAI,KAAK,MAAM,KAAK,MAAM,kBAAU,QAAS,QAAO;AACpD,WAAO,CAAC,KAAK,MAAM,KAAK,GAAG;AACzB,YAAM,OAAO,KAAK,MAAM,KAAK;AAC7B,UAAI,SAAS,WAAW,SAAS,eAAgB,QAAO;AACxD,WAAK,MAAM,KAAK;AAAA,IAClB;AACA,WAAO;AAAA,EACT;AAAA,EAEU,4BAAkC;AAC1C,SAAK,eAAe;AACpB,WAAO,KAAK,YAAY,EAAG,MAAK,eAAe;AAAA,EACjD;AAAA,EAEU,aAAa,SAA4B;AACjD,UAAM,gBAAgB,KAAK,MAAM,OAAO;AACxC,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,UAAI,KAAK,MAAM,KAAK,KAAK,KAAK,MAAM,KAAK,MAAM,QAAQ,GAAG,GAAG;AAC3D,aAAK,MAAM,OAAO,aAAa;AAC/B,eAAO;AAAA,MACT;AAAA,IACF;AACA,WAAO;AAAA,EACT;AACF;AAEA,IAAO,qBAAQ;;;AChHf,IAAM,cAAN,MAAM,YAAW;AAAA,EAaf,YAAY,OAAmB;AAP/B,wBAAiB;AACjB,wBAAiB;AAEjB,wBAAQ,OAAM;AACd,wBAAQ,QAAO;AACf,wBAAQ,UAAS;AAGf,SAAK,QAAQ;AACb,SAAK,SAAS,KAAK,MAAM;AAAA,EAC3B;AAAA,EAEA,OAAO,QAAsB;AAC3B,SAAK,MAAM;AAAA,EACb;AAAA,EAEA,OAAe;AACb,UAAM,OAAO,KAAK,MAAM,KAAK,KAAK;AAClC,QAAI,SAAS,kBAAU,SAAS;AAC9B,WAAK,QAAQ;AACb,WAAK,SAAS;AAAA,IAChB,OAAO;AACL,WAAK,UAAU;AAAA,IACjB;AACA,WAAO;AAAA,EACT;AAAA,EAEA,WAAW,UAA0B;AACnC,QAAI,KAAK,KAAK,MAAM,UAAU;AAC5B,YAAM,IAAI,uBAAuB,KAAK,SAAS,GAAG,UAAU,KAAK,KAAK,CAAC;AAAA,IACzE;AACA,WAAO,KAAK,KAAK;AAAA,EACnB;AAAA,EAEA,OAAe;AACb,WAAO,KAAK,MAAM,KAAK,GAAG;AAAA,EAC5B;AAAA,EAEA,UAAU,OAAe;AACvB,WAAO,KAAK,MAAM,KAAK,MAAM,KAAK;AAAA,EACpC;AAAA,EAEA,OAAO,QAAgB;AACrB,WAAO,KAAK,MAAM,MAAM;AAAA,EAC1B;AAAA,EAEA,OAAgB;AACd,WAAO,KAAK,OAAO,KAAK;AAAA,EAC1B;AAAA,EAEA,SAAiB;AACf,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,MAAM,OAAe,KAAyB;AAC5C,WAAO,KAAK,MAAM,MAAM,OAAO,GAAG;AAAA,EACpC;AAAA,EAEA,WAA6D;AAC3D,WAAO,EAAE,MAAM,KAAK,MAAM,QAAQ,KAAK,QAAQ,QAAQ,KAAK,IAAI;AAAA,EAClE;AACF;AAlEE,cADI,aACG,MAAK,CAAC,UAAsB,IAAI,YAAW,KAAK;AAEvD,cAHI,aAGG,oBAAmB,CAAC,cACzB,YAAW,GAAG,mBAAmB,SAAS,EAAE,OAAO,CAAC;AAJxD,IAAM,aAAN;AAqEA,IAAO,qBAAQ;;;ACzEf,IAAM,EAAE,OAAO,gBAAAC,iBAAgB,SAAAC,SAAQ,IAAI;AAE3C,IAAM,SAAS;AAAA,EACb,kBAAU;AAAA,EACV,kBAAU;AAAA,EACV,kBAAU;AAAA,EACV,kBAAU;AAAA,EACV,kBAAU;AAAA,EACV,kBAAU;AACZ;AAEA,IAAM,YAAY;AAAA,EAChB,kBAAU;AAAA,EACV,kBAAU;AAAA,EACV,kBAAU;AAAA,EACV,kBAAU;AAAA,EACV,kBAAU;AAAA,EACV,kBAAU;AAAA,EACV,kBAAU;AAAA,EACV,kBAAU;AAAA,EACV,kBAAU;AACZ;AAEO,IAAM,WAAW;AAAA,EACtB,QAAQ;AAAA,IACN,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,EACZ;AAAA,EACA,KAAK;AAAA,IACH,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,EACZ;AAAA,EACA,KAAK,CAAC,kBAAU,GAAG,kBAAU,GAAG,kBAAU,CAAC;AAAA,EAC3C,QAAQ;AAAA,IACN,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,EACZ;AAAA,EACA,MAAM,CAAC,kBAAU,GAAG,kBAAU,GAAG,kBAAU,GAAG,kBAAU,CAAC;AAAA,EACzD,SAAS;AAAA,IACP,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,EACZ;AAAA,EACA,WAAW;AAAA,IACT,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,IACV,kBAAU;AAAA,EACZ;AAAA,EACA,MAAM,CAAC,kBAAU,GAAG,kBAAU,GAAG,kBAAU,GAAG,kBAAU,CAAC;AAAA,EACzD,OAAO,CAAC,kBAAU,GAAG,kBAAU,GAAG,kBAAU,GAAG,kBAAU,GAAG,kBAAU,CAAC;AAAA,EACvE,MAAM,CAAC,kBAAU,GAAG,kBAAU,GAAG,kBAAU,GAAG,kBAAU,CAAC;AAAA,EACzD;AAAA,EACA,YAAY,CAAC,GAAG,QAAQ,OAAOD,iBAAgBC,QAAO;AAAA,EACtD,YAAY,CAAC,GAAG,QAAQD,iBAAgBC,QAAO;AAAA,EAC/C,YAAY,CAAC,GAAG,QAAQD,eAAc;AAAA,EACtC,YAAY,CAAC,GAAG,QAAQC,QAAO;AAAA,EAC/B;AAAA,EACA,eAAe,CAACD,iBAAgBC,UAAS,GAAG,SAAS;AAAA,EACrD,eAAe,CAACD,iBAAgB,GAAG,SAAS;AAAA,EAC5C,eAAe,CAACC,UAAS,GAAG,SAAS;AACvC;;;AClDA,IAAM,mBAAN,MAAM,yBAAwB,mBAAW;AAAA,EAevC,YAAY,YAAwB,SAAqB,aAAa,OAAO;AAC3E,UAAM,YAAY,UAAU;AAH9B,wBAAmB;AAIjB,SAAK,UAAU;AAAA,EACjB;AAAA;AAAA,EAGA,cAAyB;AACvB,SAAK,0BAA0B;AAE/B,QAAI,KAAK,aAAa,SAAS,IAAI,EAAG,QAAO,gBAAQ;AACrD,QAAI,KAAK,aAAa,SAAS,KAAK,EAAG,QAAO,gBAAQ;AACtD,QAAI,KAAK,aAAa,SAAS,IAAI,EAAG,QAAO;AAE7C,UAAM,OAAO,KAAK,MAAM,KAAK;AAE7B,QACE,SAAS,kBAAU,YACnB,KAAK,MAAM,UAAU,CAAC,MAAM,kBAAU,UACtC;AACA,aAAO,KAAK,kBAAkB;AAAA,IAChC;AACA,QAAI,SAAS,kBAAU,SAAU,QAAO,KAAK,eAAe;AAC5D,QAAI,SAAS,kBAAU,UAAW,QAAO,KAAK,YAAY;AAC1D,QAAI,SAAS,kBAAU,aAAc,QAAO,KAAK,UAAU;AAC3D,QAAI,SAAS,kBAAU,kBAAmB,QAAO,KAAK,WAAW;AACjE,QAAI,UAAU,IAAI,EAAG,QAAO,KAAK,iBAAiB;AAElD,UAAM,IAAI,sBAAsB,KAAK,MAAM,SAAS,GAAG,IAAI;AAAA,EAC7D;AAAA,EAEU,mBAAuC;AAC/C,UAAM,WAAW,KAAK,eAAe;AACrC,SAAK,0BAA0B;AAE/B,UAAM,iBAAiB,KAAK,MAAM,OAAO;AACzC,QAAI,QAAQ,KAAK,MAAM,KAAK,CAAC,GAAG;AAC9B,YAAM,YAAY,KAAK,eAAe;AACtC,WAAK,0BAA0B;AAC/B,UAAI,KAAK,MAAM,KAAK,MAAM,kBAAU,GAAG;AACrC,aAAK,MAAM,WAAW,kBAAU,CAAC;AACjC,eAAO,eAAO,GAAG,UAAU,SAAS;AAAA,MACtC;AAAA,IACF;AAEA,SAAK,MAAM,OAAO,cAAc;AAChC,WAAO,kBAAU,GAAG,QAAQ;AAAA,EAC9B;AAAA;AAAA,EAGU,iBAA+B;AACvC,QAAI,QAAQ;AAEZ,SAAK,MAAM,WAAW,kBAAU,QAAQ;AACxC,WAAO,CAAC,KAAK,MAAM,KAAK,KAAK,KAAK,MAAM,KAAK,MAAM,kBAAU,aAAa;AACxE,eAAS,aAAa,KAAK,MAAM,KAAK,CAAC;AAAA,IACzC;AACA,SAAK,MAAM,WAAW,kBAAU,WAAW;AAE3C,WAAO,qBAAa,GAAG,KAAK;AAAA,EAC9B;AAAA,EAEU,cAAyB;AACjC,QAAI,aAAa;AACjB,QAAI,YAAY;AAChB,QAAI,QAAQ;AAEZ,WAAO,CAAC,KAAK,MAAM,KAAK,GAAG;AACzB,YAAM,OAAO,KAAK,MAAM,KAAK;AAC7B,eAAS,aAAa,IAAI;AAG1B,UAAI,CAAC,WAAW;AACd,YAAI,SAAS,kBAAU,UAAW,eAAc;AAChD,YAAI,SAAS,kBAAU,WAAY,eAAc;AAAA,MACnD;AAGA,UAAI,SAAS,kBAAU,WAAW;AAChC,oBAAY,CAAC;AAAA,MACf,WAAW,WAAW;AACpB,oBAAY;AAAA,MACd;AAGA,UAAI,eAAe,GAAG;AAEpB,eAAO,kBAAU,GAAG,MAAM,UAAU,GAAG,MAAM,SAAS,CAAC,CAAC;AAAA,MAC1D;AAAA,IACF;AAEA,UAAM,IAAI,2BAA2B,KAAK,MAAM,SAAS,CAAC;AAAA,EAC5D;AAAA;AAAA;AAAA,EAIU,YAAqB;AAC7B,SAAK,MAAM,WAAW,kBAAU,YAAY;AAE5C,QAAI,OAAO;AACX,WAAO,CAAC,KAAK,MAAM,KAAK,GAAG;AACzB,YAAM,OAAO,KAAK,MAAM,KAAK;AAC7B,UAAI,aAAa,IAAI,KAAK,YAAY,IAAI,EAAG;AAC7C,cAAQ,aAAa,IAAI;AACzB,WAAK,MAAM,KAAK;AAAA,IAClB;AAEA,WAAO,gBAAQ,GAAG,IAAI;AAAA,EACxB;AAAA,EAEU,aAAuB;AAC/B,SAAK,MAAM,WAAW,kBAAU,iBAAiB;AACjD,SAAK,0BAA0B;AAE/B,UAAM,WAAW,iBAAS,YAAY,KAAK,OAAO;AAClD,WAAO,KAAK,MAAM,KAAK,MAAM,kBAAU,oBAAoB;AACzD,YAAM,UAAU,KAAK,YAAY;AACjC,eAAS,KAAK,OAAO;AACrB,WAAK,0BAA0B;AAAA,IACjC;AACA,SAAK,MAAM,WAAW,kBAAU,kBAAkB;AAClD,WAAO;AAAA,EACT;AAAA,EAEU,YAAqB;AAC7B,SAAK,MAAM,WAAW,kBAAU,QAAQ;AACxC,SAAK,MAAM,WAAW,kBAAU,QAAQ;AACxC,SAAK,0BAA0B;AAE/B,UAAM,OAAgB,oBAAI,IAAI;AAE9B,WACE,CAAC,KAAK,MAAM,KAAK,KACjB,KAAK,MAAM,KAAK,MAAM,kBAAU,eAChC,KAAK,MAAM,UAAU,CAAC,MAAM,kBAAU,aACtC;AACA,YAAM,MAAM,KAAK,UAAU;AAC3B,YAAM,QAAQ,KAAK,YAAY;AAC/B,WAAK,IAAI,KAAK,KAAK;AACnB,WAAK,0BAA0B;AAAA,IACjC;AAEA,SAAK,0BAA0B;AAC/B,SAAK,MAAM,WAAW,kBAAU,WAAW;AAC3C,SAAK,MAAM,WAAW,kBAAU,WAAW;AAE3C,UAAM,OAAO,KAAK,IAAI,gBAAQ,GAAG,MAAM,CAAC;AAExC,QAAI,SAAS,gBAAQ,GAAG,SAAS,GAAG;AAClC,aAAO,mBAAW,mBAAmB,MAAM,KAAK,OAAO;AAAA,IACzD,WAAW,SAAS,gBAAQ,GAAG,OAAO,GAAG;AACvC,aAAO,oBAAY,mBAAmB,MAAM,KAAK,OAAO;AAAA,IAC1D,WAAW,SAAS,gBAAQ,GAAG,MAAM,GAAG;AACtC,aAAO,oBAAY,mBAAmB,MAAM,KAAK,OAAO;AAAA,IAC1D,OAAO;AACL,aAAO,gBAAQ,mBAAmB,MAAM,KAAK,OAAO;AAAA,IACtD;AAAA,EACF;AAAA,EAEU,oBAAyC;AACjD,UAAM,WAAW,KAAK,MAAM,SAAS;AAErC,UAAM,OAAO,KAAK,UAAU;AAE5B,SAAK,0BAA0B;AAE/B,QACE,CAAC,KAAK,aAAa,SAAS,UAAU,KACtC,CAAC,KAAK,aAAa,SAAS,UAAU,KACtC,CAAC,KAAK,aAAa,SAAS,UAAU,KACtC,CAAC,KAAK,aAAa,SAAS,UAAU,KACtC,CAAC,KAAK,aAAa,SAAS,MAAM,GAClC;AACA,aAAO;AAAA,IACT;AAEA,UAAM,QAAQ,KAAK,MAAM,OAAO;AAChC,QAAI;AAEJ,UAAM,SAAS,KAAK,IAAI,gBAAQ,GAAG,QAAQ,CAAC;AAC5C,QAAI,kBAAkB,mBAAW;AAC/B,YAAM,QAAQ,OAAO,SAAS;AAC9B,WAAK,MAAM,OAAO,GAAG;AACrB,WAAK,0BAA0B;AAC/B,UAAI,CAAC,KAAK,aAAa,SAAS,SAAS,GAAG;AAC1C,aAAK,MAAM,OAAO,KAAK;AACvB,cAAM,KAAK,wBAAwB,QAAQ;AAAA,MAC7C;AAAA,IACF,OAAO;AACL,YAAM,KAAK,wBAAwB,QAAQ;AAAA,IAC7C;AAEA,UAAM,WAAW,KAAK,MAAM,MAAM,OAAO,GAAG;AAE5C,WAAO,qBAAa,GAAG,MAAM,QAAQ;AAAA,EACvC;AAAA,EAEU,wBAAwB,UAAoB;AAEpD,QAAI,aAAa;AACjB,QAAI,MAAM,KAAK,MAAM,OAAO;AAE5B,WAAO,CAAC,KAAK,MAAM,KAAK,GAAG;AACzB,YAAM,KAAK,MAAM,OAAO;AAExB,UAAI,KAAK,aAAa,SAAS,MAAM,GAAG;AACtC,sBAAc;AAAA,MAChB,WACE,KAAK,aAAa,SAAS,aAAa,KACxC,KAAK,aAAa,SAAS,aAAa,KACxC,KAAK,aAAa,SAAS,aAAa,KACxC,KAAK,aAAa,SAAS,SAAS,GACpC;AACA,sBAAc;AAAA,MAChB,OAAO;AACL,aAAK,MAAM,KAAK;AAAA,MAClB;AAEA,UAAI,eAAe,EAAG;AAAA,IACxB;AAEA,QAAI,eAAe,EAAG,OAAM,IAAI,sBAAsB,QAAQ;AAE9D,WAAO;AAAA,EACT;AACF;AA9OE,cADI,kBACG,YAAW,CAChB,OACA,SACA,eACG,IAAI,iBAAgB,mBAAW,GAAG,KAAK,GAAG,SAAS,UAAU;AAElE,cAPI,kBAOG,iBAAgB,CACrB,YACA,SACA,aAAa,UACV,IAAI,iBAAgB,YAAY,SAAS,UAAU;AAX1D,IAAM,kBAAN;AAiPA,IAAO,0BAAQ;;;ACxQf,IAAM,yBAAN,MAAM,+BAA8B,wBAAgB;AAAA,EAWlD,YAAY,WAAyB,mBAAmC;AACtE,UAAM,mBAAW,iBAAiB,SAAS,GAAG,UAAU,KAAK,OAAO;AANtE,wBAAQ;AACR,wBAAiB;AACjB,wBAAiB;AACjB,wBAAiB;AAKf,UAAM,EAAE,KAAK,IAAI;AAEjB,SAAK,gBAAgB;AACrB,SAAK,oBAAoB,sBAAsB,MAAM;AACrD,SAAK,cAAc,KAAK,OAAO,gBAAQ,GAAG,OAAO,GAAG,iBAAS,EAAE,SAAS;AACxE,SAAK,cAAc,KAAK,OAAO,gBAAQ,GAAG,GAAG,GAAG,iBAAS,EAAE,SAAS;AAAA,EACtE;AAAA,EAEA,MAAM,mBAAkC;AACtC,QAAI,KAAK,eAAe;AACtB,YAAM,IAAI,aAAa,yBAAyB,kBAAkB;AAAA,IACpE;AACA,SAAK,gBAAgB;AAErB,UAAM,0BAA0B,KAAK,6BAA6B;AAClE,aAAS,MAAM,GAAG,MAAM,wBAAwB,QAAQ,MAAM,KAAK,OAAO;AACxE,YAAM,EAAE,cAAc,OAAO,IAAI,wBAAwB,GAAG;AAC5D,WAAK,MAAM,OAAO,KAAK,cAAc,MAAM;AAC3C,YAAM,SAAS,KAAK,YAAY;AAChC,YAAM,MAAM,eAAO,GAAG,cAAc,CAAC;AACrC,WAAK,QAAQ,OAAO,KAAK,MAAM;AAC/B,UAAI,KAAK,kBAAkB,EAAG,OAAM,YAAY;AAAA,IAClD;AAAA,EACF;AAAA,EAEQ,+BAGJ;AACF,UAAM,0BAA0B,CAAC;AACjC,aAAS,MAAM,GAAG,MAAM,KAAK,aAAa,MAAM,KAAK,OAAO;AAC1D,WAAK,0BAA0B;AAC/B,YAAM,eAAe,KAAK,YAAY;AAEtC,WAAK,0BAA0B;AAC/B,YAAM,SAAS,KAAK,YAAY;AAEhC,8BAAwB,KAAK,EAAE,cAAc,OAAO,CAAC;AAAA,IACvD;AACA,WAAO;AAAA,EACT;AACF;AAtDE,cADI,wBACG,aAAY,CACjB,WACA,sBACG,IAAI,uBAAsB,WAAW,iBAAiB;AAJ7D,IAAM,wBAAN;AAyDA,IAAO,gCAAQ;;;ACjDf,IAAM,uBAAN,MAAM,qBAAoB;AAAA,EAexB,YAAY,WAAyB;AAXrC,wBAAQ;AAER,wBAAiB;AACjB,wBAAiB;AACjB,wBAAiB;AACjB,wBAAiB;AAIjB,wBAAiB;AAGf,SAAK,gBAAgB;AAErB,SAAK,OAAO,UAAU;AACtB,SAAK,QAAQ,mBAAW,iBAAiB,SAAS;AAClD,SAAK,UAAU,KAAK,KAAK;AAEzB,UAAM,OAAO,KAAK,KAAK,OAAO,gBAAQ,GAAG,MAAM,GAAG,iBAAS;AAE3D,UAAM,QAAQ,KAAK,KAAK,OAAO,gBAAQ,GAAG,OAAO,CAAC;AAClD,QAAI,iBAAiB,kBAAU;AAC7B,WAAK,cAAc,CAAC;AACpB,eAAS,MAAM,GAAG,MAAM,MAAM,KAAK,GAAG,MAAM,KAAK,OAAO,GAAG;AACzD,cAAM,oBAAoB,MAAM,OAAO,MAAM,GAAG,iBAAS,EAAE,SAAS;AACpE,cAAM,SAAS,MAAM,OAAO,MAAM,GAAG,iBAAS,EAAE,SAAS;AACzD,aAAK,YAAY,KAAK,EAAE,mBAAmB,OAAO,CAAC;AAAA,MACrD;AAAA,IACF,OAAO;AACL,WAAK,cAAc,CAAC,EAAE,mBAAmB,GAAG,QAAQ,KAAK,SAAS,EAAE,CAAC;AAAA,IACvE;AAEA,UAAM,IAAI,KAAK,KAAK,OAAO,gBAAQ,GAAG,GAAG,GAAG,gBAAQ;AACpD,SAAK,aAAa,CAAC,IAAI,IAAI,EAAE;AAC7B,aAAS,MAAM,GAAG,MAAM,EAAE,KAAK,GAAG,MAAM,KAAK,OAAO;AAClD,WAAK,WAAW,GAAG,IAAI,EAAE,OAAO,KAAK,iBAAS,EAAE,SAAS;AAAA,IAC3D;AAAA,EACF;AAAA,EAEA,mBAA4B;AAC1B,QAAI,KAAK,eAAe;AACtB,YAAM,IAAI,aAAa,uBAAuB,kBAAkB;AAAA,IAClE;AACA,SAAK,gBAAgB;AAErB,SAAK,QAAQ,cAAc;AAAA,MACzB,MAAM,KAAK,KAAK,IAAI,gBAAQ,GAAG,MAAM,CAAC;AAAA,MACtC,SAAS,KAAK,KAAK,IAAI,gBAAQ,GAAG,SAAS,CAAC;AAAA,MAC5C,MAAM,KAAK,KAAK,IAAI,gBAAQ,GAAG,MAAM,CAAC;AAAA,MACtC,IAAI,KAAK,KAAK,IAAI,gBAAQ,GAAG,IAAI,CAAC;AAAA,IACpC;AAEA,UAAM,UAAU,KAAK,aAAa;AAOlC,WAAO;AAAA,EACT;AAAA,EAEQ,eAAwB;AAC9B,UAAM,UAAU,CAAC;AACjB,UAAM,CAAC,gBAAgB,kBAAkB,aAAa,IAAI,KAAK;AAE/D,aACM,gBAAgB,GAAG,gBAAgB,KAAK,YAAY,QACxD,gBAAgB,eAChB,iBACA;AACA,YAAM,EAAE,mBAAmB,OAAO,IAAI,KAAK,YAAY,aAAa;AAEpE,eAAS,SAAS,GAAG,SAAS,QAAQ,UAAU;AAC9C,YAAI,OAAO;AACX,iBAAS,MAAM,GAAG,MAAM,gBAAgB,MAAM,KAAK,OAAO;AACxD,iBAAQ,QAAQ,IAAK,KAAK,MAAM,KAAK;AAAA,QACvC;AAEA,YAAI,SAAS;AACb,iBAAS,MAAM,GAAG,MAAM,kBAAkB,MAAM,KAAK,OAAO;AAC1D,mBAAU,UAAU,IAAK,KAAK,MAAM,KAAK;AAAA,QAC3C;AAEA,YAAI,mBAAmB;AACvB,iBAAS,MAAM,GAAG,MAAM,eAAe,MAAM,KAAK,OAAO;AACvD,6BAAoB,oBAAoB,IAAK,KAAK,MAAM,KAAK;AAAA,QAC/D;AAGA,YAAI,mBAAmB,EAAG,QAAO;AAEjC,cAAM,eAAe,oBAAoB;AACzC,cAAM,QAAQ;AAAA,UACZ,KAAK,eAAO,GAAG,cAAc,gBAAgB;AAAA,UAC7C;AAAA,UACA,SAAS,SAAS;AAAA,UAClB,gBAAgB,SAAS;AAAA,QAC3B;AAEA,gBAAQ,KAAK,KAAK;AAAA,MACpB;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AACF;AA7GE,cADI,sBACG,aAAY,CAAC,cAClB,IAAI,qBAAoB,SAAS;AAFrC,IAAM,sBAAN;AAgHA,IAAO,8BAAQ;;;ACvGf,IAAM,aAAN,MAAM,mBAAkB,wBAAgB;AAAA,EActC,YACE,UACA,iBAAiB,UACjB,uBAAuB,OACvB,aAAa,OACb;AACA,UAAM,mBAAW,GAAG,QAAQ,GAAG,mBAAW,OAAO,GAAG,UAAU;AAXhE,wBAAiB;AACjB,wBAAiB;AACjB,wBAAQ,iBAAgB;AACxB,wBAAQ,iBAAgB;AAqGxB,wBAAQ,qBAAoB,MAAM;AAChC,WAAK,iBAAiB;AACtB,aAAO,KAAK,gBAAgB,KAAK,mBAAmB;AAAA,IACtD;AA/FE,SAAK,iBAAiB;AACtB,SAAK,uBAAuB;AAAA,EAC9B;AAAA,EAEA,MAAM,gBAAqC;AACzC,QAAI,KAAK,eAAe;AACtB,YAAM,IAAI,aAAa,aAAa,eAAe;AAAA,IACrD;AACA,SAAK,gBAAgB;AAErB,SAAK,QAAQ,SAAS,KAAK,YAAY;AAEvC,QAAI;AACJ,WAAO,CAAC,KAAK,MAAM,KAAK,GAAG;AACzB,YAAM,KAAK,qBAAqB;AAChC,YAAM,SAAS,KAAK,MAAM,OAAO;AACjC,UAAI,WAAW,YAAY;AACzB,cAAM,IAAI,mBAAmB,KAAK,MAAM,SAAS,CAAC;AAAA,MACpD;AACA,mBAAa;AAAA,IACf;AAEA,SAAK,iBAAiB;AAEtB,QAAI,KAAK,QAAQ,OAAO,eAAO,GAAG,CAAC,CAAC,GAAG;AACrC,cAAQ,KAAK,+BAA+B;AAC5C,WAAK,QAAQ,OAAO,eAAO,GAAG,CAAC,CAAC;AAAA,IAClC;AAEA,WAAO,KAAK;AAAA,EACd;AAAA,EAEQ,mBAAyB;AAC/B,UAAM,iBAAiB,CAAC,QACtB,eAAe,mBACf,IAAI,OAAO,gBAAQ,GAAG,MAAM,CAAC,MAAM,gBAAQ,GAAG,SAAS;AAEzD,UAAM,UAAU,KAAK,QAAQ,OAAO,KAAK,QAAQ,YAAY,IAAI;AAEjE,QAAI,CAAC,eAAe,OAAO,GAAG;AAC5B,YAAM,kBAAkB,KAAK,QAAQ,yBAAyB;AAC9D,eAAS,MAAM,GAAG,MAAM,gBAAgB,QAAQ,MAAM,KAAK,OAAO;AAChE,cAAM,CAAC,KAAK,MAAM,IAAI,gBAAgB,GAAG;AACzC,YAAI,eAAe,MAAM,GAAG;AAC1B,eAAK,QAAQ,YAAY,OAAO;AAAA,QAClC;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA,EAEQ,cAAyB;AAC/B,WAAO,CAAC,KAAK,MAAM,KAAK,GAAG;AACzB,UAAI,KAAK,aAAa,SAAS,MAAM,GAAG;AACtC,cAAM,QAAQ,KAAK,YAAY;AAC/B,aAAK,MAAM,WAAW,kBAAU,MAAM;AACtC,cAAM,QAAQ,KAAK,YAAY;AAC/B,cAAM,SAAS,kBAAU,WAAW,OAAO,KAAK;AAChD,aAAK,wBAAwB;AAC7B,eAAO;AAAA,MACT;AACA,WAAK,MAAM,KAAK;AAAA,IAClB;AAEA,UAAM,IAAI,sBAAsB,KAAK,MAAM,SAAS,CAAC;AAAA,EACvD;AAAA,EAEQ,4BAAoC;AAC1C,SAAK,0BAA0B;AAC/B,UAAM,eAAe,KAAK,YAAY;AAEtC,SAAK,0BAA0B;AAC/B,UAAM,mBAAmB,KAAK,YAAY;AAE1C,SAAK,0BAA0B;AAC/B,QAAI,CAAC,KAAK,aAAa,SAAS,GAAG,GAAG;AACpC,YAAM,IAAI,oBAAoB,KAAK,MAAM,SAAS,GAAG,SAAS,GAAG;AAAA,IACnE;AAEA,WAAO,eAAO,GAAG,cAAc,gBAAgB;AAAA,EACjD;AAAA,EAEQ,4BAAqC;AAC3C,UAAM,gBAAgB,KAAK,MAAM,OAAO;AACxC,QAAI;AACF,WAAK,0BAA0B;AAC/B,aAAO;AAAA,IACT,SAAS,GAAG;AACV,WAAK,MAAM,OAAO,aAAa;AAC/B,aAAO;AAAA,IACT;AAAA,EACF;AAAA,EAOA,MAAc,sBAAuC;AACnD,UAAM,MAAM,KAAK,0BAA0B;AAE3C,SAAK,0BAA0B;AAC/B,UAAM,SAAS,KAAK,YAAY;AAEhC,SAAK,0BAA0B;AAM/B,SAAK,aAAa,SAAS,MAAM;AAEjC,QACE,kBAAkB,wBAClB,OAAO,KAAK,OAAO,gBAAQ,GAAG,MAAM,CAAC,MAAM,gBAAQ,GAAG,QAAQ,GAC9D;AACA,YAAM,8BAAsB;AAAA,QAC1B;AAAA,QACA,KAAK;AAAA,MACP,EAAE,iBAAiB;AAAA,IACrB,WACE,kBAAkB,wBAClB,OAAO,KAAK,OAAO,gBAAQ,GAAG,MAAM,CAAC,MAAM,gBAAQ,GAAG,MAAM,GAC5D;AACA,kCAAoB,UAAU,MAAM,EAAE,iBAAiB;AAAA,IACzD,OAAO;AACL,WAAK,QAAQ,OAAO,KAAK,MAAM;AAAA,IACjC;AAEA,WAAO;AAAA,EACT;AAAA;AAAA,EAGQ,kCAAkC;AACxC,UAAM,WAAW,KAAK,MAAM,SAAS;AAErC,UAAM,MAAM,mCAAmC,KAAK,UAAU,QAAQ,CAAC;AACvE,QAAI,KAAK,qBAAsB,OAAM,IAAI,MAAM,GAAG;AAClD,YAAQ,KAAK,GAAG;AAEhB,UAAM,MAAM,KAAK,0BAA0B;AAE3C,YAAQ,KAAK,uBAAuB,GAAG,EAAE;AAEzC,SAAK,0BAA0B;AAC/B,UAAM,QAAQ,KAAK,MAAM,OAAO;AAEhC,QAAI,SAAS;AACb,WAAO,CAAC,KAAK,MAAM,KAAK,GAAG;AACzB,UAAI,KAAK,aAAa,SAAS,MAAM,GAAG;AACtC,iBAAS;AAAA,MACX;AACA,UAAI,CAAC,OAAQ;AACb,WAAK,MAAM,KAAK;AAAA,IAClB;AAEA,QAAI,OAAQ,OAAM,IAAI,6BAA6B,QAAQ;AAE3D,UAAM,MAAM,KAAK,MAAM,OAAO,IAAI,SAAS,OAAO;AAElD,UAAM,SAAS,yBAAiB,GAAG,KAAK,MAAM,MAAM,OAAO,GAAG,CAAC;AAC/D,SAAK,QAAQ,OAAO,KAAK,MAAM;AAE/B,WAAO;AAAA,EACT;AAAA,EAEA,MAAc,uBAAsC;AAClD,SAAK,0BAA0B;AAE/B,WAAO,CAAC,KAAK,MAAM,KAAK,KAAK,QAAQ,KAAK,MAAM,KAAK,CAAC,GAAG;AACvD,YAAM,gBAAgB,KAAK,MAAM,OAAO;AAExC,UAAI;AACF,cAAM,KAAK,oBAAoB;AAAA,MACjC,SAAS,GAAG;AAEV,aAAK,MAAM,OAAO,aAAa;AAC/B,aAAK,gCAAgC;AAAA,MACvC;AACA,WAAK,0BAA0B;AAG/B,WAAK,cAAc;AAEnB,UAAI,KAAK,kBAAkB,EAAG,OAAM,YAAY;AAAA,IAClD;AAAA,EACF;AAAA,EAEQ,4BAAuD;AAC7D,SAAK,0BAA0B;AAC/B,QAAI,CAAC,KAAK,aAAa,SAAS,IAAI,EAAG;AACvC,SAAK,0BAA0B;AAE/B,QAAI,eAAe;AACnB,UAAM,OAAO,2BAAmB,YAAY;AAE5C,WAAO,CAAC,KAAK,MAAM,KAAK,KAAK,QAAQ,KAAK,MAAM,KAAK,CAAC,GAAG;AACvD,YAAM,WAAW,KAAK,YAAY;AAClC,WAAK,0BAA0B;AAE/B,YAAM,YAAY,KAAK,YAAY;AACnC,WAAK,0BAA0B;AAE/B,YAAM,OAAO,KAAK,MAAM,KAAK;AAC7B,UAAI,SAAS,kBAAU,KAAK,SAAS,kBAAU,GAAG;AAChD,cAAM,MAAM,eAAO,GAAG,cAAc,SAAS;AAC7C,YAAI,KAAK,MAAM,KAAK,MAAM,kBAAU,GAAG;AACrC,eAAK,SAAS,KAAK,QAAQ;AAAA,QAC7B,OAAO;AAEL,eAAK,gBAAgB,KAAK,QAAQ;AAAA,QACpC;AACA,wBAAgB;AAAA,MAClB,OAAO;AACL,uBAAe;AAAA,MACjB;AACA,WAAK,0BAA0B;AAAA,IACjC;AAEA,WAAO;AAAA,EACT;AAAA,EAEQ,wBAA8B;AACpC,SAAK,0BAA0B;AAC/B,QAAI,CAAC,KAAK,aAAa,SAAS,OAAO,EAAG;AAC1C,SAAK,0BAA0B;AAE/B,UAAM,OAAO,KAAK,UAAU;AAE5B,UAAM,EAAE,QAAQ,IAAI;AACpB,YAAQ,cAAc;AAAA,MACpB,MAAM,KAAK,IAAI,gBAAQ,GAAG,MAAM,CAAC,KAAK,QAAQ,YAAY;AAAA,MAC1D,SAAS,KAAK,IAAI,gBAAQ,GAAG,SAAS,CAAC,KAAK,QAAQ,YAAY;AAAA,MAChE,MAAM,KAAK,IAAI,gBAAQ,GAAG,MAAM,CAAC,KAAK,QAAQ,YAAY;AAAA,MAC1D,IAAI,KAAK,IAAI,gBAAQ,GAAG,IAAI,CAAC,KAAK,QAAQ,YAAY;AAAA,IACxD;AAAA,EACF;AAAA,EAEQ,oBAAuC;AAC7C,SAAK,0BAA0B;AAC/B,QAAI,CAAC,KAAK,aAAa,SAAS,SAAS,EAAG;AAC5C,SAAK,0BAA0B;AAE/B,UAAM,SAAS,KAAK,YAAY;AAEhC,SAAK,eAAe;AACpB,SAAK,aAAa,SAAS,GAAG;AAC9B,SAAK,0BAA0B;AAC/B,SAAK,aAAa,SAAS,GAAG;AAC9B,SAAK,0BAA0B;AAE/B,WAAO,mBAAW,6BAA6B,MAAM;AAAA,EACvD;AAAA,EAEA,MAAc,uBAAsC;AAClD,UAAM,KAAK,qBAAqB;AAChC,SAAK,0BAA0B;AAC/B,SAAK,sBAAsB;AAC3B,SAAK,kBAAkB;AAGvB,SAAK,cAAc;AAAA,EACrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQQ,gBAAsB;AAC5B,SAAK,0BAA0B;AAC/B,WAAO,CAAC,KAAK,MAAM,KAAK,GAAG;AACzB,YAAM,gBAAgB,KAAK,MAAM,OAAO;AACxC,YAAM,OAAO,KAAK,MAAM,KAAK;AAC7B,YAAM,iBAAiB,QAAQ,kBAAU,SAAS,QAAQ,kBAAU;AACpE,UAAI,gBAAgB;AAClB,YACE,KAAK,aAAa,SAAS,IAAI,KAC/B,KAAK,aAAa,SAAS,OAAO,KAClC,KAAK,aAAa,SAAS,SAAS,KACpC,KAAK,0BAA0B,GAC/B;AACA,eAAK,MAAM,OAAO,aAAa;AAC/B;AAAA,QACF;AAAA,MACF;AACA,WAAK,MAAM,KAAK;AAAA,IAClB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeQ,0BAAgC;AACtC,SAAK,0BAA0B;AAC/B,QAAI;AACF,YAAM,gBAAgB,KAAK,MAAM,OAAO;AACxC,WAAK,0BAA0B;AAC/B,WAAK,MAAM,OAAO,aAAa;AAAA,IACjC,SAAS,GAAG;AACV,WAAK,MAAM,KAAK;AAChB,WAAK,0BAA0B;AAAA,IACjC;AAAA,EACF;AACF;AA9UE,cADI,YACG,uBAAsB,CAC3B,UACA,gBACA,sBACA,eAEA,IAAI,WAAU,UAAU,gBAAgB,sBAAsB,UAAU;AAP5E,IAAM,YAAN;AAiVA,IAAO,oBAAQ;;;AC3Wf,IAAMC,QAAO,CAAC,aAAqB,KAAK;AAGjC,IAAK,mBAAL,CAAKC,qBAAL;AAOL,EAAAA,kCAAA,eAAYD,MAAK,CAAK,KAAtB;AAYA,EAAAC,kCAAA,YAASD,MAAK,CAAK,KAAnB;AASA,EAAAC,kCAAA,WAAQD,MAAK,CAAK,KAAlB;AAQA,EAAAC,kCAAA,YAASD,MAAK,CAAK,KAAnB;AAOA,EAAAC,kCAAA,cAAWD,MAAK,CAAK,KAArB;AAQA,EAAAC,kCAAA,YAASD,MAAK,CAAK,KAAnB;AAWA,EAAAC,kCAAA,cAAWD,MAAK,CAAK,KAArB;AAQA,EAAAC,kCAAA,YAASD,MAAK,CAAK,KAAnB;AAQA,EAAAC,kCAAA,kBAAeD,MAAK,CAAK,KAAzB;AAOA,EAAAC,kCAAA,oBAAiBD,MAAK,CAAM,KAA5B;AArFU,SAAAC;AAAA,GAAA;;;ACDL,IAAM,YAAY,CAAC,SACxB,gBAAgB,kBAAU,OAAO,gBAAQ,GAAG,IAAI;AAE3C,IAAM,cAAc,CAAC,QAC1B,eAAe,oBAAY,MAAM,kBAAU,GAAG,GAAG;AAE5C,IAAM,WAAW,CAAC,QACvB,eAAe,oBAAY,IAAI,SAAS,IAAI;;;ACPvC,IAAK,gBAAL,kBAAKC,mBAAL;AACL,EAAAA,eAAA,aAAU;AACV,EAAAA,eAAA,aAAU;AAFA,SAAAA;AAAA,GAAA;AAiBL,IAAM,UAAU,CAAC,gBAAiC;AACvD,WAAS,aAAa,eAAe,CAAC,QAAQ,CAAC;AAC/C,SAAO,EAAE,MAAM,yBAAuB,OAAO,YAAY;AAC3D;AAEO,IAAM,UAAU,CAAC,gBAAiC;AACvD,WAAS,aAAa,eAAe,CAAC,QAAQ,CAAC;AAC/C,SAAO,EAAE,MAAM,yBAAuB,OAAO,YAAY;AAC3D;AAEA,IAAM,EAAE,SAAS,QAAQ,IAAI;AAEtB,IAAM,mBAAmB,CAAC,WAAoB,SAAS,KAAK,KAAM;AAClE,IAAM,mBAAmB,CAAC,WAAoB,SAAS,MAAO,KAAK;AAGnE,IAAM,YAAY,CAAC,aACxB,SAAS,SAAS,UAAU,SAAS,QACjC,SAAS,SAAS,UAAU,iBAAiB,SAAS,KAAK,IACzD,MAAM,qBAAqB,KAAK,UAAU,QAAQ,CAAC,EAAE;AAGtD,IAAM,YAAY,CAAC,aACxB,SAAS,SAAS,UAAU,iBAAiB,SAAS,KAAK,IACvD,SAAS,SAAS,UAAU,SAAS,QACnC,MAAM,qBAAqB,KAAK,UAAU,QAAQ,CAAC,EAAE;AAEtD,IAAM,iBAAiB,CAAC,cAAc,MAAM;AACjD,QAAM,YAAa,cAAc,KAAM;AACvC,MAAI,cAAc,EAAG,QAAO;AAC5B,MAAI,cAAc,EAAG,QAAO;AAC5B,MAAI,cAAc,EAAG,QAAO;AAC5B,MAAI,cAAc,EAAG,QAAO;AAC5B,SAAO;AACT;AAEO,IAAM,wBAAwB,CACnC,MACA,cAAc,MACX;AACH,QAAM,WAAW,eAAe,WAAW;AAC3C,SAAO,aAAa,MAAM,aAAa,MACnC,EAAE,OAAO,KAAK,QAAQ,QAAQ,KAAK,MAAM,IACzC,EAAE,OAAO,KAAK,OAAO,QAAQ,KAAK,OAAO;AAC/C;AAEO,IAAM,kBAAkB,CAC7BC,YAMA,cAAc,GACd,cAAc,MACX;AACH,QAAM,EAAE,GAAG,GAAG,OAAO,GAAG,QAAQ,EAAE,IAAIA;AAEtC,QAAM,IAAI,eAAe,WAAW;AACpC,QAAM,IAAI,cAAc;AAGxB,MAAI,MAAM,EAAG,QAAO,EAAE,GAAG,IAAI,GAAG,GAAG,IAAI,GAAG,OAAO,GAAG,QAAQ,EAAE;AAAA,WACrD,MAAM,GAAI,QAAO,EAAE,GAAG,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,OAAO,GAAG,QAAQ,EAAE;AAAA,WAC/D,MAAM,IAAK,QAAO,EAAE,GAAG,IAAI,IAAI,GAAG,GAAG,IAAI,IAAI,GAAG,OAAO,GAAG,QAAQ,EAAE;AAAA,WACpE,MAAM,IAAK,QAAO,EAAE,GAAG,IAAI,GAAG,GAAG,IAAI,IAAI,GAAG,OAAO,GAAG,QAAQ,EAAE;AAAA,MACpE,QAAO,EAAE,GAAG,IAAI,GAAG,GAAG,IAAI,GAAG,OAAO,GAAG,QAAQ,EAAE;AACxD;;;AC1EO,IAAM,OAAO,MAAM,oBAAY,GAAG,yBAAI,WAAW;AACjD,IAAM,cAAc,MAAM,oBAAY,GAAG,yBAAI,WAAW;AAI/D,IAAM,EAAE,KAAK,KAAK,IAAI,IAAI;AAEnB,IAAM,6BAA6B,CACxC,GACA,GACA,GACA,GACA,GACA,MAEA,oBAAY,GAAG,yBAAI,4BAA4B;AAAA,EAC7C,YAAY,CAAC;AAAA,EACb,YAAY,CAAC;AAAA,EACb,YAAY,CAAC;AAAA,EACb,YAAY,CAAC;AAAA,EACb,YAAY,CAAC;AAAA,EACb,YAAY,CAAC;AACf,CAAC;AAEI,IAAM,YAAY,CAAC,MAA0B,SAClD,2BAA2B,GAAG,GAAG,GAAG,GAAG,MAAM,IAAI;AAE5C,IAAM,QAAQ,CAAC,MAA0B,SAC9C,2BAA2B,MAAM,GAAG,GAAG,MAAM,GAAG,CAAC;AAE5C,IAAM,gBAAgB,CAAC,UAC5B;AAAA,EACE,IAAI,SAAS,KAAK,CAAC;AAAA,EACnB,IAAI,SAAS,KAAK,CAAC;AAAA,EACnB,CAAC,IAAI,SAAS,KAAK,CAAC;AAAA,EACpB,IAAI,SAAS,KAAK,CAAC;AAAA,EACnB;AAAA,EACA;AACF;AAEK,IAAM,gBAAgB,CAAC,UAC5B,cAAc,iBAAiB,SAAS,KAAK,CAAC,CAAC;AAE1C,IAAM,cAAc,CACzB,YACA,eAEA;AAAA,EACE;AAAA,EACA,IAAI,SAAS,UAAU,CAAC;AAAA,EACxB,IAAI,SAAS,UAAU,CAAC;AAAA,EACxB;AAAA,EACA;AAAA,EACA;AACF;AAEK,IAAM,cAAc,CACzB,YACA,eAEA;AAAA,EACE,iBAAiB,SAAS,UAAU,CAAC;AAAA,EACrC,iBAAiB,SAAS,UAAU,CAAC;AACvC;AAEK,IAAM,iBAAiB,CAC5B,WACA,cAEA,oBAAY,GAAG,yBAAI,oBAAoB;AAAA,EACrC,IAAI,UAAU,IAAI,WAAW,EAAE,KAAK,GAAG,CAAC;AAAA,EACxC,YAAY,SAAS;AACvB,CAAC;AAEI,IAAM,qBAAqB,MAAM,eAAe,CAAC,GAAG,CAAC;AAErD,IAAK,eAAL,kBAAKC,kBAAL;AACL,EAAAA,4BAAA,UAAO,KAAP;AACA,EAAAA,4BAAA,WAAQ,KAAR;AACA,EAAAA,4BAAA,gBAAa,KAAb;AAHU,SAAAA;AAAA,GAAA;AAML,IAAM,aAAa,CAAC,UACzB,oBAAY,GAAG,yBAAI,iBAAiB,CAAC,YAAY,KAAK,CAAC,CAAC;AAEnD,IAAK,gBAAL,kBAAKC,mBAAL;AACL,EAAAA,8BAAA,WAAQ,KAAR;AACA,EAAAA,8BAAA,WAAQ,KAAR;AACA,EAAAA,8BAAA,WAAQ,KAAR;AAHU,SAAAA;AAAA,GAAA;AAML,IAAM,cAAc,CAAC,UAC1B,oBAAY,GAAG,yBAAI,kBAAkB,CAAC,YAAY,KAAK,CAAC,CAAC;AAEpD,IAAM,mBAAmB,CAAC,UAC/B,oBAAY,GAAG,yBAAI,wBAAwB,CAAC,UAAU,KAAK,CAAC,CAAC;AAExD,IAAM,oBAAoB,MAAM,oBAAY,GAAG,yBAAI,iBAAiB;AAEpE,IAAM,mBAAmB,MAAM,oBAAY,GAAG,yBAAI,gBAAgB;AAElE,IAAM,eAAe,CAAC,UAC3B,oBAAY,GAAG,yBAAI,cAAc,CAAC,YAAY,KAAK,CAAC,CAAC;AAIhD,IAAM,oBAAoB,CAC/B,IACA,IACA,IACA,IACA,IACA,OAEA,oBAAY,GAAG,yBAAI,mBAAmB;AAAA,EACpC,YAAY,EAAE;AAAA,EACd,YAAY,EAAE;AAAA,EACd,YAAY,EAAE;AAAA,EACd,YAAY,EAAE;AAAA,EACd,YAAY,EAAE;AAAA,EACd,YAAY,EAAE;AAChB,CAAC;AAEI,IAAM,uBAAuB,CAClC,IACA,IACA,IACA,OAEA,oBAAY,GAAG,yBAAI,8BAA8B;AAAA,EAC/C,YAAY,EAAE;AAAA,EACd,YAAY,EAAE;AAAA,EACd,YAAY,EAAE;AAAA,EACd,YAAY,EAAE;AAChB,CAAC;AAEI,IAAM,YAAY,MAAM,oBAAY,GAAG,yBAAI,SAAS;AAEpD,IAAM,SAAS,CAAC,MAA0B,SAC/C,oBAAY,GAAG,yBAAI,QAAQ,CAAC,YAAY,IAAI,GAAG,YAAY,IAAI,CAAC,CAAC;AAE5D,IAAM,SAAS,CAAC,MAA0B,SAC/C,oBAAY,GAAG,yBAAI,QAAQ,CAAC,YAAY,IAAI,GAAG,YAAY,IAAI,CAAC,CAAC;AAQ5D,IAAM,YAAY,CACvB,MACA,MACA,OACA,WAEA,oBAAY,GAAG,yBAAI,iBAAiB;AAAA,EAClC,YAAY,IAAI;AAAA,EAChB,YAAY,IAAI;AAAA,EAChB,YAAY,KAAK;AAAA,EACjB,YAAY,MAAM;AACpB,CAAC;AAOI,IAAM,SAAS,CAAC,MAAc,MAAc,SACjD,UAAU,MAAM,MAAM,MAAM,IAAI;AAI3B,IAAM,SAAS,MAAM,oBAAY,GAAG,yBAAI,UAAU;AAElD,IAAM,OAAO,MAAM,oBAAY,GAAG,yBAAI,WAAW;AAEjD,IAAM,gBAAgB,MAAM,oBAAY,GAAG,yBAAI,oBAAoB;AAEnE,IAAM,UAAU,MAAM,oBAAY,GAAG,yBAAI,OAAO;AAIhD,IAAM,WAAW,MAAM,oBAAY,GAAG,yBAAI,QAAQ;AAElD,IAAM,WAAW,CAAC,GAAuB,MAC9C,oBAAY,GAAG,yBAAI,UAAU,CAAC,YAAY,CAAC,GAAG,YAAY,CAAC,CAAC,CAAC;AAIxD,IAAM,WAAW,CAAC,SACvB,oBAAY,GAAG,yBAAI,UAAU,CAAC,IAAI,CAAC;AAI9B,IAAM,YAAY,MAAM,oBAAY,GAAG,yBAAI,SAAS;AACpD,IAAM,UAAU,MAAM,oBAAY,GAAG,yBAAI,OAAO;AAEhD,IAAM,iBAAiB,CAC5B,MACA,SACG,oBAAY,GAAG,yBAAI,gBAAgB,CAAC,UAAU,IAAI,GAAG,YAAY,IAAI,CAAC,CAAC;AAErE,IAAM,sBAAsB,CAAC,YAClC,oBAAY,GAAG,yBAAI,qBAAqB,CAAC,YAAY,OAAO,CAAC,CAAC;AAEzD,IAAM,iBAAiB,CAAC,YAC7B,oBAAY,GAAG,yBAAI,gBAAgB,CAAC,YAAY,OAAO,CAAC,CAAC;AAGpD,IAAM,sBAAsB,CAAC,YAClC,oBAAY,GAAG,yBAAI,0BAA0B,CAAC,YAAY,OAAO,CAAC,CAAC;AAE9D,IAAM,gBAAgB,CAAC,eAC5B,oBAAY,GAAG,yBAAI,mBAAmB,CAAC,YAAY,UAAU,CAAC,CAAC;AAE1D,IAAM,cAAc,CAAC,SAC1B,oBAAY,GAAG,yBAAI,aAAa,CAAC,YAAY,IAAI,CAAC,CAAC;AAE9C,IAAK,oBAAL,kBAAKC,uBAAL;AACL,EAAAA,sCAAA,UAAO,KAAP;AACA,EAAAA,sCAAA,aAAU,KAAV;AACA,EAAAA,sCAAA,oBAAiB,KAAjB;AACA,EAAAA,sCAAA,eAAY,KAAZ;AACA,EAAAA,sCAAA,iBAAc,KAAd;AACA,EAAAA,sCAAA,oBAAiB,KAAjB;AACA,EAAAA,sCAAA,2BAAwB,KAAxB;AACA,EAAAA,sCAAA,UAAO,KAAP;AARU,SAAAA;AAAA,GAAA;AAWL,IAAM,uBAAuB,CAAC,SACnC,oBAAY,GAAG,yBAAI,sBAAsB,CAAC,YAAY,IAAI,CAAC,CAAC;AAEvD,IAAM,gBAAgB,CAC3B,GACA,GACA,GACA,GACA,GACA,MAEA,oBAAY,GAAG,yBAAI,eAAe;AAAA,EAChC,YAAY,CAAC;AAAA,EACb,YAAY,CAAC;AAAA,EACb,YAAY,CAAC;AAAA,EACb,YAAY,CAAC;AAAA,EACb,YAAY,CAAC;AAAA,EACb,YAAY,CAAC;AACf,CAAC;AAEI,IAAM,uCAAuC,CAClD,eACA,YACA,YACA,GACA,MAEA;AAAA,EACE,IAAI,SAAS,aAAa,CAAC;AAAA,EAC3B,IAAI,SAAS,aAAa,CAAC,IAAI,IAAI,SAAS,UAAU,CAAC;AAAA,EACvD,CAAC,IAAI,SAAS,aAAa,CAAC,IAAI,IAAI,SAAS,UAAU,CAAC;AAAA,EACxD,IAAI,SAAS,aAAa,CAAC;AAAA,EAC3B;AAAA,EACA;AACF;AAEK,IAAM,uCAAuC,CAClD,eACA,YACA,YACA,GACA,MAEA;AAAA,EACE,iBAAiB,SAAS,aAAa,CAAC;AAAA,EACxC,iBAAiB,SAAS,UAAU,CAAC;AAAA,EACrC,iBAAiB,SAAS,UAAU,CAAC;AAAA,EACrC;AAAA,EACA;AACF;AAIK,IAAM,aAAa,CAAC,SACzB,oBAAY,GAAG,yBAAI,YAAY,CAAC,UAAU,IAAI,CAAC,CAAC;AAI3C,IAAM,2BAA2B,CAAC,SACvC,oBAAY,GAAG,yBAAI,sBAAsB,CAAC,YAAY,IAAI,CAAC,CAAC;AAEvD,IAAM,4BAA4B,CAAC,SACxC,oBAAY,GAAG,yBAAI,mBAAmB,CAAC,YAAY,IAAI,CAAC,CAAC;AAEpD,IAAM,qBAAqB,CAChC,KACA,OACA,SAEA,oBAAY,GAAG,yBAAI,qBAAqB;AAAA,EACtC,YAAY,GAAG;AAAA,EACf,YAAY,KAAK;AAAA,EACjB,YAAY,IAAI;AAClB,CAAC;AAEI,IAAM,sBAAsB,CACjC,KACA,OACA,SAEA,oBAAY,GAAG,yBAAI,kBAAkB;AAAA,EACnC,YAAY,GAAG;AAAA,EACf,YAAY,KAAK;AAAA,EACjB,YAAY,IAAI;AAClB,CAAC;AAEI,IAAM,sBAAsB,CACjC,MACA,SACA,QACA,QAEA,oBAAY,GAAG,yBAAI,sBAAsB;AAAA,EACvC,YAAY,IAAI;AAAA,EAChB,YAAY,OAAO;AAAA,EACnB,YAAY,MAAM;AAAA,EAClB,YAAY,GAAG;AACjB,CAAC;AAEI,IAAM,uBAAuB,CAClC,MACA,SACA,QACA,QAEA,oBAAY,GAAG,yBAAI,mBAAmB;AAAA,EACpC,YAAY,IAAI;AAAA,EAChB,YAAY,OAAO;AAAA,EACnB,YAAY,MAAM;AAAA,EAClB,YAAY,GAAG;AACjB,CAAC;AAII,IAAM,qBAAqB,CAAC,QACjC,oBAAY,GAAG,yBAAI,oBAAoB,CAAC,UAAU,GAAG,CAAC,CAAC;AAElD,IAAM,mBAAmB,MAAM,oBAAY,GAAG,yBAAI,gBAAgB;;;AC7VlE,IAAK,aAAL,kBAAKC,gBAAL;AACL,EAAAA,YAAA,eAAY;AACZ,EAAAA,YAAA,SAAM;AACN,EAAAA,YAAA,UAAO;AAHG,SAAAA;AAAA,GAAA;AA4BL,IAAM,YAAY,CAAC,SAA4B;AACpD,cAAY,MAAM,QAAQ,GAAK,CAAG;AAClC,SAAO,EAAE,MAAM,6BAAsB,KAAK;AAC5C;AAEO,IAAM,MAAM,CAAC,KAAa,OAAe,SAAsB;AACpE,cAAY,KAAK,OAAO,GAAG,CAAC;AAC5B,cAAY,OAAO,SAAS,GAAG,CAAC;AAChC,cAAY,MAAM,QAAQ,GAAG,CAAC;AAC9B,SAAO,EAAE,MAAM,iBAAgB,KAAK,OAAO,KAAK;AAClD;AAEO,IAAM,OAAO,CAClB,MACA,SACA,QACA,QACS;AACT,cAAY,MAAM,QAAQ,GAAG,CAAC;AAC9B,cAAY,SAAS,WAAW,GAAG,CAAC;AACpC,cAAY,QAAQ,UAAU,GAAG,CAAC;AAClC,cAAY,KAAK,OAAO,GAAG,CAAC;AAC5B,SAAO,EAAE,MAAM,mBAAiB,MAAM,SAAS,QAAQ,IAAI;AAC7D;AAEA,IAAM,EAAE,WAAW,KAAK,KAAK,IAAI;AAG1B,IAAM,kBAAkB,CAAC,UAC9B,MAAM,SAAS,YAAY,yBAAyB,MAAM,IAAI,IAC1D,MAAM,SAAS,MAAY,mBAAmB,MAAM,KAAK,MAAM,OAAO,MAAM,IAAI,IAC9E,MAAM,SAAS,OAAY,oBAAoB,MAAM,MAAM,MAAM,SAAS,MAAM,QAAQ,MAAM,GAAG,IAC/F,MAAM,kBAAkB,KAAK,UAAU,KAAK,CAAC,EAAE;AAGlD,IAAM,mBAAmB,CAAC,UAC/B,MAAM,SAAS,YAAY,0BAA0B,MAAM,IAAI,IAC3D,MAAM,SAAS,MAAY,oBAAoB,MAAM,KAAK,MAAM,OAAO,MAAM,IAAI,IAC/E,MAAM,SAAS,OAAY,qBAAqB,MAAM,MAAM,MAAM,SAAS,MAAM,QAAQ,MAAM,GAAG,IAChG,MAAM,kBAAkB,KAAK,UAAU,KAAK,CAAC,EAAE;AAGlD,IAAM,oBAAoB,CAAC,OAAkBC,SAAQ,MAC1D,OAAO,WAAW,IAAI;AAAA,EACpB,MAAM,CAAC,IAAIA;AACb,IACI,OAAO,WAAW,IAAI;AAAA,EACtB,MAAM,CAAC,IAAIA;AAAA,EACX,MAAM,CAAC,IAAIA;AAAA,EACX,MAAM,CAAC,IAAIA;AACb,IACI,OAAO,WAAW,IAAI;AAAA,EACtB,MAAM,CAAC,IAAIA;AAAA,EACX,MAAM,CAAC,IAAIA;AAAA,EACX,MAAM,CAAC,IAAIA;AAAA,EACX,MAAM,CAAC,IAAIA;AACb,IACI;AAIH,IAAM,oBAAoB,CAAC,UAChC,MAAM,SAAS,YAAY,CAAC,MAAM,IAAI,IAClC,MAAM,SAAS,MAAY,CAAC,MAAM,KAAK,MAAM,OAAO,MAAM,IAAI,IAC5D,MAAM,SAAS,OAAY,CAAC,MAAM,MAAM,MAAM,SAAS,MAAM,QAAQ,MAAM,GAAG,IAC5E,MAAM,kBAAkB,KAAK,UAAU,KAAK,CAAC,EAAE;;;ACzFzD,IAAI,KAAa;AACjB,IAAI,KAAa;AACjB,IAAI,KAAoB;AACxB,IAAI,KAAoB;AACxB,IAAI,KAAa;AACjB,IAAI,KAAa;AAEjB,IAAM,aAAa,oBAAI,IAAoB;AAAA,EACzC,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AAAA,EACP,CAAC,KAAK,CAAC;AACT,CAAC;AAOD,IAAM,QAAQ,CAAC,SAAiB;AAC9B,MAAI;AACJ,QAAM,MAAa,CAAC;AACpB,MAAI,OAAiB,CAAC;AACtB,MAAI,SAAS;AACb,MAAI,eAAe;AACnB,MAAI,SAAS;AAEb,aAAW,KAAK,MAAM;AACpB,QAAI,WAAW,IAAI,CAAC,GAAG;AACrB,eAAS,WAAW,IAAI,CAAC;AACzB,UAAI,KAAK;AAEP,YAAI,OAAO,SAAS,GAAG;AACrB,eAAK,KAAK,MAAM,IAAI,CAAC;AAAA,QACvB;AACA,YAAI,IAAI,MAAM,IAAI,EAAE,KAAK,KAAK;AAE9B,eAAO,CAAC;AACR,iBAAS;AACT,uBAAe;AAAA,MACjB;AAEA,YAAM;AAAA,IACR,WACE,CAAC,KAAK,GAAG,EAAE,SAAS,CAAC,KACpB,MAAM,OAAO,OAAO,SAAS,KAAK,OAAO,OAAO,SAAS,CAAC,MAAM,OAChE,MAAM,OAAO,cACd;AACA,UAAI,OAAO,WAAW,GAAG;AACvB;AAAA,MACF;AAEA,UAAI,KAAK,WAAW,QAAQ;AAE1B,YAAI,IAAI,MAAM,IAAI,EAAE,KAAK,KAAK;AAC9B,eAAO,CAAC,CAAC,MAAM;AAGf,YAAI,QAAQ,KAAK;AACf,gBAAM;AAAA,QACR;AACA,YAAI,QAAQ,KAAK;AACf,gBAAM;AAAA,QACR;AAAA,MACF,OAAO;AACL,aAAK,KAAK,MAAM,IAAI,CAAC;AAAA,MACvB;AAEA,qBAAe,MAAM;AAGrB,eAAS,CAAC,KAAK,GAAG,EAAE,SAAS,CAAC,IAAI,IAAI;AAAA,IACxC,OAAO;AACL,gBAAU;AACV,UAAI,MAAM,KAAK;AACb,uBAAe;AAAA,MACjB;AAAA,IACF;AAAA,EACF;AAGA,MAAI,OAAO,SAAS,GAAG;AACrB,QAAI,KAAK,WAAW,QAAQ;AAE1B,UAAI,IAAI,MAAM,IAAI,EAAE,KAAK,KAAK;AAC9B,aAAO,CAAC,CAAC,MAAM;AAGf,UAAI,QAAQ,KAAK;AACf,cAAM;AAAA,MACR;AACA,UAAI,QAAQ,KAAK;AACf,cAAM;AAAA,MACR;AAAA,IACF,OAAO;AACL,WAAK,KAAK,MAAM,IAAI,CAAC;AAAA,IACvB;AAAA,EACF;AAEA,MAAI,IAAI,MAAM,IAAI,EAAE,KAAK,KAAK;AAE9B,SAAO;AACT;AAEA,IAAM,QAAQ,CAAC,aAAoB;AAEjC,OAAK,KAAK,KAAK,KAAK,KAAK,KAAK;AAG9B,MAAI,OAAsB,CAAC;AAC3B,WAAS,IAAI,GAAG,IAAI,SAAS,QAAQ,KAAK;AACxC,UAAM,IAAI,SAAS,CAAC;AACpB,QAAI,EAAE,OAAO,OAAO,QAAQ,EAAE,GAAG,MAAM,YAAY;AACjD,YAAM,MAAM,QAAQ,EAAE,GAAG,EAAE,EAAE,IAAI;AACjC,UAAI,MAAM,QAAQ,GAAG,GAAG;AACtB,eAAO,KAAK,OAAO,GAAG;AAAA,MACxB,OAAO;AACL,aAAK,KAAK,GAAG;AAAA,MACf;AAAA,IACF;AAAA,EACF;AACA,SAAO;AACT;AAMA,IAAM,UAA6B;AAAA,EACjC,EAAE,GAAG;AACH,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,CAAC;AACR,SAAK,KAAK;AACV,SAAK;AACL,SAAK;AACL,WAAO,OAAO,IAAI,EAAE;AAAA,EACtB;AAAA,EAEA,EAAE,GAAG;AACH,UAAM,EAAE,CAAC;AACT,UAAM,EAAE,CAAC;AACT,SAAK,KAAK;AACV,SAAK;AACL,SAAK;AACL,WAAO,OAAO,IAAI,EAAE;AAAA,EACtB;AAAA,EAEA,EAAE,GAAG;AACH,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,CAAC;AACR,WAAO,kBAAkB,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC;AAAA,EAC7D;AAAA,EAEA,EAAE,GAAG;AACH,UAAM,MAAM;AAAA,MACV,EAAE,CAAC,IAAI;AAAA,MACP,EAAE,CAAC,IAAI;AAAA,MACP,EAAE,CAAC,IAAI;AAAA,MACP,EAAE,CAAC,IAAI;AAAA,MACP,EAAE,CAAC,IAAI;AAAA,MACP,EAAE,CAAC,IAAI;AAAA,IACT;AACA,SAAK,KAAK,EAAE,CAAC;AACb,SAAK,KAAK,EAAE,CAAC;AACb,UAAM,EAAE,CAAC;AACT,UAAM,EAAE,CAAC;AACT,WAAO;AAAA,EACT;AAAA,EAEA,EAAE,GAAG;AACH,QAAI,OAAO,QAAQ,OAAO,MAAM;AAC9B,WAAK;AACL,WAAK;AAAA,IACP;AAEA,UAAM,MAAM;AAAA,MACV,MAAM,KAAK;AAAA,MACX,MAAM,KAAK;AAAA,MACX,EAAE,CAAC;AAAA,MACH,EAAE,CAAC;AAAA,MACH,EAAE,CAAC;AAAA,MACH,EAAE,CAAC;AAAA,IACL;AACA,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,CAAC;AACR,WAAO;AAAA,EACT;AAAA,EAEA,EAAE,GAAG;AACH,QAAI,OAAO,QAAQ,OAAO,MAAM;AAC9B,WAAK;AACL,WAAK;AAAA,IACP;AAEA,UAAM,MAAM;AAAA,MACV,MAAM,KAAK;AAAA,MACX,MAAM,KAAK;AAAA,MACX,KAAK,EAAE,CAAC;AAAA,MACR,KAAK,EAAE,CAAC;AAAA,MACR,KAAK,EAAE,CAAC;AAAA,MACR,KAAK,EAAE,CAAC;AAAA,IACV;AACA,SAAK,KAAK,EAAE,CAAC;AACb,SAAK,KAAK,EAAE,CAAC;AACb,UAAM,EAAE,CAAC;AACT,UAAM,EAAE,CAAC;AACT,WAAO;AAAA,EACT;AAAA,EAEA,EAAE,GAAG;AACH,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,CAAC;AACR,WAAO,qBAAqB,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,IAAI,EAAE;AAAA,EAChD;AAAA,EAEA,EAAE,GAAG;AACH,UAAM,MAAM;AAAA,MACV,EAAE,CAAC,IAAI;AAAA,MACP,EAAE,CAAC,IAAI;AAAA,MACP,EAAE,CAAC,IAAI;AAAA,MACP,EAAE,CAAC,IAAI;AAAA,IACT;AACA,SAAK,KAAK,EAAE,CAAC;AACb,SAAK,KAAK,EAAE,CAAC;AACb,UAAM,EAAE,CAAC;AACT,UAAM,EAAE,CAAC;AACT,WAAO;AAAA,EACT;AAAA,EAEA,EAAE,GAAG;AACH,QAAI,OAAO,QAAQ,OAAO,MAAM;AAC9B,WAAK;AACL,WAAK;AAAA,IACP,OAAO;AACL,WAAK,MAAM,KAAK;AAChB,WAAK,MAAM,KAAK;AAAA,IAClB;AAEA,UAAM,MAAM,qBAAqB,IAAI,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC;AACnD,SAAK,MAAM,KAAK;AAChB,SAAK,MAAM,KAAK;AAChB,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,CAAC;AACR,WAAO;AAAA,EACT;AAAA,EAEA,EAAE,GAAG;AACH,QAAI,OAAO,QAAQ,OAAO,MAAM;AAC9B,WAAK;AACL,WAAK;AAAA,IACP,OAAO;AACL,WAAK,MAAM,KAAK;AAChB,WAAK,MAAM,KAAK;AAAA,IAClB;AAEA,UAAM,MAAM,qBAAqB,IAAI,IAAI,KAAK,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,CAAC;AAC7D,UAAM,EAAE,CAAC;AACT,UAAM,EAAE,CAAC;AACT,WAAO;AAAA,EACT;AAAA,EAEA,EAAE,GAAG;AACH,UAAM,OAAO,SAAS,IAAI,IAAI,CAAC;AAC/B,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,CAAC;AACR,WAAO;AAAA,EACT;AAAA,EAEA,EAAE,GAAG;AACH,MAAE,CAAC,KAAK;AACR,MAAE,CAAC,KAAK;AACR,UAAM,OAAO,SAAS,IAAI,IAAI,CAAC;AAC/B,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,CAAC;AACR,WAAO;AAAA,EACT;AAAA,EAEA,EAAE,GAAG;AACH,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,CAAC;AACR,SAAK,KAAK;AACV,WAAO,OAAO,IAAI,EAAE;AAAA,EACtB;AAAA,EAEA,EAAE,GAAG;AACH,UAAM,EAAE,CAAC;AACT,UAAM,EAAE,CAAC;AACT,SAAK,KAAK;AACV,WAAO,OAAO,IAAI,EAAE;AAAA,EACtB;AAAA,EAEA,EAAE,GAAG;AACH,SAAK,EAAE,CAAC;AACR,SAAK,KAAK;AACV,WAAO,OAAO,IAAI,EAAE;AAAA,EACtB;AAAA,EAEA,EAAE,GAAG;AACH,UAAM,EAAE,CAAC;AACT,SAAK,KAAK;AACV,WAAO,OAAO,IAAI,EAAE;AAAA,EACtB;AAAA,EAEA,EAAE,GAAG;AACH,SAAK,EAAE,CAAC;AACR,SAAK,KAAK;AACV,WAAO,OAAO,IAAI,EAAE;AAAA,EACtB;AAAA,EAEA,EAAE,GAAG;AACH,UAAM,EAAE,CAAC;AACT,SAAK,KAAK;AACV,WAAO,OAAO,IAAI,EAAE;AAAA,EACtB;AAAA,EAEA,IAAI;AACF,UAAM,MAAM,UAAU;AACtB,SAAK;AACL,SAAK;AACL,WAAO;AAAA,EACT;AAAA,EAEA,IAAI;AACF,UAAM,MAAM,UAAU;AACtB,SAAK;AACL,SAAK;AACL,WAAO;AAAA,EACT;AACF;AAEA,IAAM,WAAW,CAAC,GAAW,GAAW,WAAqB;AAC3D,QAAM,CAAC,IAAI,IAAI,KAAK,OAAO,OAAO,IAAI,EAAE,IAAI;AAC5C,QAAM,OAAO,cAAc,IAAI,IAAI,IAAI,IAAI,OAAO,OAAO,KAAK,GAAG,CAAC;AAElE,QAAM,OAAsB,CAAC;AAC7B,aAAW,OAAO,MAAM;AACtB,UAAM,MAAM,gBAAgB,GAAG,GAAG;AAClC,SAAK,KAAK,kBAAkB,GAAG,GAAG,CAAC;AAAA,EACrC;AACA,SAAO;AACT;AAMA,IAAM,gBAAgB,CACpB,GACA,GACA,IACA,IACA,OACA,OACA,SACA,IACA,OACG;AACH,QAAM,KAAK,WAAW,KAAK,KAAK;AAChC,QAAM,QAAQ,KAAK,IAAI,EAAE;AACzB,QAAM,QAAQ,KAAK,IAAI,EAAE;AACzB,OAAK,KAAK,IAAI,EAAE;AAChB,OAAK,KAAK,IAAI,EAAE;AAChB,OAAK,SAAS,KAAK,KAAK,MAAM,SAAS,KAAK,KAAK;AACjD,OAAK,SAAS,KAAK,KAAK,MAAM,SAAS,KAAK,KAAK;AACjD,MAAI,KAAM,KAAK,MAAO,KAAK,MAAO,KAAK,MAAO,KAAK;AACnD,MAAI,KAAK,GAAG;AACV,SAAK,KAAK,KAAK,EAAE;AACjB,UAAM;AACN,UAAM;AAAA,EACR;AAEA,QAAM,MAAM,QAAQ;AACpB,QAAM,MAAM,QAAQ;AACpB,QAAM,MAAM,CAAC,QAAQ;AACrB,QAAM,MAAM,QAAQ;AACpB,QAAM,KAAK,MAAM,KAAK,MAAM;AAC5B,QAAM,KAAK,MAAM,KAAK,MAAM;AAC5B,QAAM,KAAK,MAAM,IAAI,MAAM;AAC3B,QAAM,KAAK,MAAM,IAAI,MAAM;AAE3B,QAAM,KAAK,KAAK,OAAO,KAAK,OAAO,KAAK,OAAO,KAAK;AACpD,MAAI,YAAY,IAAI,IAAI;AACxB,MAAI,YAAY,GAAG;AACjB,gBAAY;AAAA,EACd;AACA,MAAI,UAAU,KAAK,KAAK,SAAS;AACjC,MAAI,UAAU,OAAO;AACnB,cAAU,CAAC;AAAA,EACb;AAEA,QAAM,KAAK,OAAO,KAAK,MAAM,WAAW,KAAK;AAC7C,QAAM,KAAK,OAAO,KAAK,MAAM,WAAW,KAAK;AAE7C,QAAM,MAAM,KAAK,MAAM,KAAK,IAAI,KAAK,EAAE;AACvC,QAAM,MAAM,KAAK,MAAM,KAAK,IAAI,KAAK,EAAE;AAEvC,MAAI,QAAQ,MAAM;AAClB,MAAI,QAAQ,KAAK,UAAU,GAAG;AAC5B,aAAS,IAAI,KAAK;AAAA,EACpB,WAAW,QAAQ,KAAK,UAAU,GAAG;AACnC,aAAS,IAAI,KAAK;AAAA,EACpB;AAEA,QAAM,WAAW,KAAK,KAAK,KAAK,IAAI,SAAS,KAAK,KAAK,MAAM,KAAM,CAAC;AACpE,QAAM,SAAoB,CAAC;AAE3B,WAAS,IAAI,GAAG,IAAI,UAAU,KAAK;AACjC,UAAM,MAAM,MAAO,IAAI,QAAS;AAChC,UAAM,MAAM,OAAQ,IAAI,KAAK,QAAS;AACtC,WAAO,CAAC,IAAI,CAAC,IAAI,IAAI,KAAK,KAAK,IAAI,IAAI,OAAO,KAAK;AAAA,EACrD;AAEA,SAAO;AACT;AAEA,IAAM,kBAAkB,CACtB,KACA,KACA,KACA,KACA,IACA,IACA,OACA,UACG;AACH,QAAM,MAAM,QAAQ;AACpB,QAAM,MAAM,CAAC,QAAQ;AACrB,QAAM,MAAM,QAAQ;AACpB,QAAM,MAAM,QAAQ;AAEpB,QAAM,SAAS,OAAO,MAAM;AAC5B,QAAM,IACF,IAAI,IAAK,KAAK,IAAI,SAAS,GAAG,IAAI,KAAK,IAAI,SAAS,GAAG,IACzD,KAAK,IAAI,MAAM;AACjB,QAAM,KAAK,MAAM,KAAK,IAAI,GAAG,IAAI,IAAI,KAAK,IAAI,GAAG;AACjD,QAAM,KAAK,MAAM,KAAK,IAAI,GAAG,IAAI,IAAI,KAAK,IAAI,GAAG;AACjD,QAAM,KAAK,MAAM,KAAK,IAAI,GAAG;AAC7B,QAAM,KAAK,MAAM,KAAK,IAAI,GAAG;AAC7B,QAAM,KAAK,KAAK,IAAI,KAAK,IAAI,GAAG;AAChC,QAAM,KAAK,KAAK,IAAI,KAAK,IAAI,GAAG;AAEhC,QAAM,SAAiB;AAAA,IACrB,MAAM,KAAK,MAAM;AAAA,IACjB,MAAM,KAAK,MAAM;AAAA,IACjB,MAAM,KAAK,MAAM;AAAA,IACjB,MAAM,KAAK,MAAM;AAAA,IACjB,MAAM,KAAK,MAAM;AAAA,IACjB,MAAM,KAAK,MAAM;AAAA,EACnB;AACA,SAAO;AACT;AAEO,IAAM,qBAAqB,CAAC,SAAiB,MAAM,MAAM,IAAI,CAAC;;;ACrb9D,IAAM,WAAW,CACtB,MACA,YAEA;AAAA,EACE,kBAAkB;AAAA,EAClB,QAAQ,iBAAiB,iBAAiB,QAAQ,aAAa;AAAA,EAC/D,UAAU;AAAA,EACV,gBAAgB,QAAQ,KAAK;AAAA,EAC7B,eAAe,QAAQ,MAAM,QAAQ,IAAI;AAAA,EACzC;AAAA,IACE,UAAU,QAAQ,MAAM;AAAA,IACxB,UAAU,QAAQ,KAAK;AAAA,IACvB,UAAU,QAAQ,KAAK;AAAA,IACvB,QAAQ;AAAA,IACR,QAAQ;AAAA,EACV;AAAA,EACA,SAAS,IAAI;AAAA,EACb,QAAQ;AAAA,EACR,iBAAiB;AACnB,EAAE,OAAO,OAAO;AAMX,IAAM,kBAAkB,CAC7B,OACA,YACkB;AAClB,QAAM,YAAY;AAAA,IAChB,kBAAkB;AAAA,IAClB,QAAQ,iBAAiB,iBAAiB,QAAQ,aAAa;AAAA,IAC/D,UAAU;AAAA,IACV,gBAAgB,QAAQ,KAAK;AAAA,IAC7B,eAAe,QAAQ,MAAM,QAAQ,IAAI;AAAA,IACzC,cAAc,QAAQ,UAAU;AAAA,IAChC;AAAA,MACE,UAAU,QAAQ,MAAM;AAAA,MACxB,UAAU,QAAQ,KAAK;AAAA,MACvB,UAAU,QAAQ,KAAK;AAAA,MACvB,QAAQ;AAAA,MACR,QAAQ;AAAA,IACV;AAAA,EACF,EAAE,OAAO,OAAO;AAEhB,WAAS,MAAM,GAAG,MAAM,MAAM,QAAQ,MAAM,KAAK,OAAO;AACtD,cAAU,KAAK,SAAS,MAAM,GAAG,CAAC,GAAG,SAAS,CAAC;AAAA,EACjD;AAEA,YAAU,KAAK,QAAQ,GAAG,iBAAiB,CAAC;AAC5C,SAAO;AACT;AAEO,IAAM,YAAY,CACvB,MACA,YAWA;AAAA,EACE,kBAAkB;AAAA,EAClB,QAAQ,iBAAiB,iBAAiB,QAAQ,aAAa;AAAA,EAC/D,UAAU,QAAQ,GAAG,QAAQ,CAAC;AAAA,EAC9B,cAAc,UAAU,QAAQ,MAAM,CAAC;AAAA,EACvC,MAAM,QAAQ,OAAO,QAAQ,MAAM;AAAA,EACnC,YAAY,UAAU,QAAQ,KAAK,GAAG,UAAU,QAAQ,KAAK,CAAC;AAAA,EAC9D,WAAW,IAAI;AAAA,EACf,iBAAiB;AACnB,EAAE,OAAO,OAAO;AAEX,IAAM,WAAW,CACtB,MACA,YAWA;AAAA,EACE,kBAAkB;AAAA,EAClB,QAAQ,iBAAiB,iBAAiB,QAAQ,aAAa;AAAA,EAC/D,UAAU,QAAQ,GAAG,QAAQ,CAAC;AAAA,EAC9B,cAAc,UAAU,QAAQ,MAAM,CAAC;AAAA,EACvC,MAAM,QAAQ,QAAQ,QAAQ,MAAM;AAAA,EACpC,YAAY,UAAU,QAAQ,KAAK,GAAG,UAAU,QAAQ,KAAK,CAAC;AAAA,EAC9D,WAAW,IAAI;AAAA,EACf,iBAAiB;AACnB,EAAE,OAAO,OAAO;AAEX,IAAM,WAAW,CAAC,YAUvB;AAAA,EACE,kBAAkB;AAAA,EAClB,QAAQ,iBAAiB,iBAAiB,QAAQ,aAAa;AAAA,EAC/D,QAAQ,SAAS,iBAAiB,QAAQ,KAAK;AAAA,EAC/C,aAAa,QAAQ,SAAS;AAAA,EAC9B,eAAe,QAAQ,aAAa,CAAC,GAAG,QAAQ,aAAa,CAAC;AAAA,EAC9D,OAAO,QAAQ,MAAM,GAAG,QAAQ,MAAM,CAAC;AAAA,EACvC,QAAQ,WAAW,WAAW,QAAQ,OAAO;AAAA,EAC7C,OAAO,QAAQ,MAAM,GAAG,QAAQ,MAAM,CAAC;AAAA,EACvC,OAAO,QAAQ,IAAI,GAAG,QAAQ,IAAI,CAAC;AAAA,EACnC,OAAO;AAAA,EACP,iBAAiB;AACnB,EAAE,OAAO,OAAO;AAEX,IAAM,gBAAgB,CAAC,YAgB5B;AAAA,EACE,kBAAkB;AAAA,EAClB,QAAQ,iBAAiB,iBAAiB,QAAQ,aAAa;AAAA,EAC/D,QAAQ,SAAS,gBAAgB,QAAQ,KAAK;AAAA,EAC9C,QAAQ,eAAe,iBAAiB,QAAQ,WAAW;AAAA,EAC3D,aAAa,QAAQ,WAAW;AAAA,EAChC,QAAQ,iBAAiB,WAAW,QAAQ,aAAa;AAAA,EACzD,eAAe,QAAQ,mBAAmB,CAAC,GAAG,QAAQ,mBAAmB,CAAC;AAAA,EAC1E,UAAU,QAAQ,GAAG,QAAQ,CAAC;AAAA,EAC9B,cAAc,UAAU,QAAQ,MAAM,CAAC;AAAA,EACvC,YAAY,UAAU,QAAQ,KAAK,GAAG,UAAU,QAAQ,KAAK,CAAC;AAAA,EAC9D,OAAO,GAAG,CAAC;AAAA,EACX,OAAO,GAAG,QAAQ,MAAM;AAAA,EACxB,OAAO,QAAQ,OAAO,QAAQ,MAAM;AAAA,EACpC,OAAO,QAAQ,OAAO,CAAC;AAAA,EACvB,UAAU;AAAA;AAAA,EAGV,QAAQ,SAAS,QAAQ,cAAc,cAAc,IACjD,QAAQ,QAA6B,KAAK,IACxC,QAAQ,cAA6B,OAAO,IAC1C,UAAU;AAAA,EAElB,iBAAiB;AACnB,EAAE,OAAO,OAAO;AAElB,IAAM,QAAQ,MAAQ,KAAK,KAAK,CAAC,IAAI,KAAO;AAGrC,IAAM,kBAAkB,CAAC,WAKX;AACnB,MAAI,IAAI,SAAS,OAAO,CAAC;AACzB,MAAI,IAAI,SAAS,OAAO,CAAC;AACzB,QAAM,SAAS,SAAS,OAAO,MAAM;AACrC,QAAM,SAAS,SAAS,OAAO,MAAM;AAErC,OAAK;AACL,OAAK;AAEL,QAAM,KAAK,SAAS;AACpB,QAAM,KAAK,SAAS;AACpB,QAAM,KAAK,IAAI,SAAS;AACxB,QAAM,KAAK,IAAI,SAAS;AACxB,QAAM,KAAK,IAAI;AACf,QAAM,KAAK,IAAI;AAEf,SAAO;AAAA,IACL,kBAAkB;AAAA,IAClB,OAAO,GAAG,EAAE;AAAA,IACZ,kBAAkB,GAAG,KAAK,IAAI,KAAK,IAAI,GAAG,IAAI,CAAC;AAAA,IAC/C,kBAAkB,KAAK,IAAI,GAAG,IAAI,KAAK,IAAI,IAAI,EAAE;AAAA,IACjD,kBAAkB,IAAI,KAAK,IAAI,KAAK,IAAI,IAAI,IAAI,EAAE;AAAA,IAClD,kBAAkB,KAAK,IAAI,IAAI,GAAG,KAAK,IAAI,GAAG,EAAE;AAAA,IAChD,iBAAiB;AAAA,EACnB;AACF;AAEA,IAAM,oBAAoB,CAAC,WAMN;AACnB,QAAM,UAAU,SAAS,OAAO,CAAC;AACjC,QAAM,UAAU,SAAS,OAAO,CAAC;AACjC,QAAM,SAAS,SAAS,OAAO,MAAM;AACrC,QAAM,SAAS,SAAS,OAAO,MAAM;AAErC,QAAM,IAAI,CAAC;AACX,QAAM,IAAI,CAAC;AAEX,QAAM,KAAK,SAAS;AACpB,QAAM,KAAK,SAAS;AACpB,QAAM,KAAK,IAAI,SAAS;AACxB,QAAM,KAAK,IAAI,SAAS;AACxB,QAAM,KAAK,IAAI;AACf,QAAM,KAAK,IAAI;AAEf,SAAO;AAAA,IACL,UAAU,SAAS,OAAO;AAAA,IAC1B,cAAc,UAAU,OAAO,MAAM,CAAC;AAAA,IACtC,OAAO,GAAG,EAAE;AAAA,IACZ,kBAAkB,GAAG,KAAK,IAAI,KAAK,IAAI,GAAG,IAAI,CAAC;AAAA,IAC/C,kBAAkB,KAAK,IAAI,GAAG,IAAI,KAAK,IAAI,IAAI,EAAE;AAAA,IACjD,kBAAkB,IAAI,KAAK,IAAI,KAAK,IAAI,IAAI,IAAI,EAAE;AAAA,IAClD,kBAAkB,KAAK,IAAI,IAAI,GAAG,KAAK,IAAI,GAAG,EAAE;AAAA,EAClD;AACF;AAEO,IAAM,cAAc,CAAC,YAc1B;AAAA,EACE,kBAAkB;AAAA,EAClB,QAAQ,iBAAiB,iBAAiB,QAAQ,aAAa;AAAA,EAC/D,QAAQ,SAAS,gBAAgB,QAAQ,KAAK;AAAA,EAC9C,QAAQ,eAAe,iBAAiB,QAAQ,WAAW;AAAA,EAC3D,aAAa,QAAQ,WAAW;AAAA,EAChC,QAAQ,iBAAiB,WAAW,QAAQ,aAAa;AAAA,EACzD,eAAe,QAAQ,mBAAmB,CAAC,GAAG,QAAQ,mBAAmB,CAAC;AAAA;AAAA;AAAA,EAI1E,GAAI,QAAQ,WAAW,SACnB,gBAAgB;AAAA,IAChB,GAAG,QAAQ;AAAA,IACX,GAAG,QAAQ;AAAA,IACX,QAAQ,QAAQ;AAAA,IAChB,QAAQ,QAAQ;AAAA,EAClB,CAAC,IACC,kBAAkB;AAAA,IAClB,GAAG,QAAQ;AAAA,IACX,GAAG,QAAQ;AAAA,IACX,QAAQ,QAAQ;AAAA,IAChB,QAAQ,QAAQ;AAAA,IAChB,QAAQ,QAAQ,UAAU,QAAQ,CAAC;AAAA,EACrC,CAAC;AAAA;AAAA,EAGH,QAAQ,SAAS,QAAQ,cAAc,cAAc,IACjD,QAAQ,QAA6B,KAAK,IACxC,QAAQ,cAA6B,OAAO,IAC1C,UAAU;AAAA,EAElB,iBAAiB;AACnB,EAAE,OAAO,OAAO;AAEX,IAAM,cAAc,CACzB,MACA,YAcA;AAAA,EACE,kBAAkB;AAAA,EAClB,QAAQ,iBAAiB,iBAAiB,QAAQ,aAAa;AAAA,EAE/D,UAAU,QAAQ,GAAG,QAAQ,CAAC;AAAA,EAC9B,cAAc,UAAU,QAAQ,UAAU,QAAQ,CAAC,CAAC,CAAC;AAAA;AAAA,EAGrD,QAAQ,QAAQ,MAAM,QAAQ,OAAO,CAAC,QAAQ,KAAK,IAAI,MAAM,GAAG,EAAE;AAAA,EAElE,QAAQ,SAAS,gBAAgB,QAAQ,KAAK;AAAA,EAC9C,QAAQ,eAAe,iBAAiB,QAAQ,WAAW;AAAA,EAC3D,QAAQ,eAAe,aAAa,QAAQ,WAAW;AAAA,EACvD,QAAQ,iBAAiB,WAAW,QAAQ,aAAa;AAAA,EAEzD,eAAe,QAAQ,mBAAmB,CAAC,GAAG,QAAQ,mBAAmB,CAAC;AAAA,EAE1E,GAAG,mBAAmB,IAAI;AAAA;AAAA,EAG1B,QAAQ,SAAS,QAAQ,cAAc,cAAc,IACjD,QAAQ,QAA6B,KAAK,IACxC,QAAQ,cAA6B,OAAO,IAC1C,UAAU;AAAA,EAElB,iBAAiB;AACnB,EAAE,OAAO,OAAO;AAEX,IAAM,gBAAgB,CAAC,YAMxB;AACJ,QAAM,OAAO,SAAS,QAAQ,IAAI;AAwBlC,QAAM,MAAM,KAAK;AACjB,QAAM,MAAM,KAAK;AAGjB,QAAM,MAAM,IAAI;AAChB,QAAM,MAAM,IAAI;AAGhB,QAAM,MAAM,KAAK;AACjB,QAAM,MAAM,GAAG,MAAM,QAAQ,MAAM,SAAS,MAAM,OAAO;AAGzD,SAAO;AAAA,IACL,kBAAkB;AAAA,IAClB,QAAQ,SAAS,iBAAiB,QAAQ,KAAK;AAAA,IAC/C,aAAa,QAAQ,SAAS;AAAA,IAE9B,UAAU,QAAQ,GAAG,QAAQ,CAAC;AAAA,IAC9B,OAAO,MAAM,MAAM,MAAM,IAAI;AAAA,IAC7B,OAAO,MAAM,MAAM,MAAM,IAAI;AAAA,IAC7B,OAAO,MAAM,MAAM,MAAM,IAAI;AAAA,IAE7B,OAAO;AAAA,IACP,iBAAiB;AAAA,EACnB,EAAE,OAAO,OAAO;AAClB;AAGO,IAAM,gBAAgB,CAAC,YAK5B,QAAQ,aAAa,IAAI;AAAA,EACvB,UAAU,GAAG,CAAC;AAAA,EACd,cAAc,CAAC;AACjB,IACI,QAAQ,aAAa,KAAK;AAAA,EAC1B,UAAU,QAAQ,OAAO,CAAC;AAAA,EAC1B,cAAc,EAAE;AAClB,IACI,QAAQ,aAAa,MAAM;AAAA,EAC3B,UAAU,QAAQ,OAAO,QAAQ,MAAM;AAAA,EACvC,cAAc,GAAG;AACnB,IACI,QAAQ,aAAa,MAAM;AAAA,EAC3B,UAAU,GAAG,QAAQ,MAAM;AAAA,EAC3B,cAAc,GAAG;AACnB,IACI,CAAC;AAEN,IAAM,eAAe,CAAC,YAWvB;AACJ,QAAM,UAAU,cAAc;AAAA,IAC5B,GAAG,QAAQ;AAAA,IACX,GAAG,QAAQ;AAAA,IACX,OAAO,QAAQ;AAAA,IACf,QAAQ,QAAQ;AAAA,IAChB,aAAa,QAAQ;AAAA,IACrB,OAAO,QAAQ;AAAA,IACf,aAAa,QAAQ;AAAA,IACrB,QAAQ,QAAQ,CAAC;AAAA,IACjB,OAAO,QAAQ,CAAC;AAAA,IAChB,OAAO,QAAQ,CAAC;AAAA,EAClB,CAAC;AAED,MAAI,CAAC,QAAQ,OAAQ,QAAO;AAE5B,QAAM,QAAQ,SAAS,QAAQ,KAAK;AACpC,QAAM,SAAS,SAAS,QAAQ,MAAM;AAEtC,QAAM,gBAAgB,KAAK,IAAI,OAAO,MAAM,IAAI;AAEhD,QAAM,YAAY,cAAc;AAAA,IAC9B,GAAG,QAAQ;AAAA,IACX,GAAG,SAAS;AAAA,IACZ,MAAM;AAAA,IACN,WAAW,QAAQ;AAAA,IACnB,OAAO,QAAQ;AAAA,EACjB,CAAC;AAED,SAAO,CAAC,kBAAkB,GAAG,GAAG,SAAS,GAAG,WAAW,iBAAiB,CAAC;AAC3E;AAEO,IAAM,kBAAkB,CAAC,YAU1B;AACJ,QAAM,QAAQ,SAAS,QAAQ,KAAK;AACpC,QAAM,SAAS,SAAS,QAAQ,MAAM;AAEtC,QAAM,eAAe,KAAK,IAAI,OAAO,MAAM,IAAI;AAE/C,QAAM,UAAU,YAAY;AAAA,IAC1B,GAAG,QAAQ;AAAA,IACX,GAAG,QAAQ;AAAA,IACX,QAAQ;AAAA,IACR,QAAQ;AAAA,IACR,OAAO,QAAQ;AAAA,IACf,aAAa,QAAQ;AAAA,IACrB,aAAa,QAAQ;AAAA,EACvB,CAAC;AAED,MAAI,CAAC,QAAQ,OAAQ,QAAO;AAE5B,QAAM,MAAM,YAAY;AAAA,IACtB,GAAG,QAAQ;AAAA,IACX,GAAG,QAAQ;AAAA,IACX,QAAQ,eAAe;AAAA,IACvB,QAAQ,eAAe;AAAA,IACvB,OAAO,QAAQ;AAAA,IACf,aAAa;AAAA,IACb,aAAa;AAAA,EACf,CAAC;AAED,SAAO,CAAC,kBAAkB,GAAG,GAAG,SAAS,GAAG,KAAK,iBAAiB,CAAC;AACrE;AAEO,IAAM,aAAa,CAAC,YAYrB;AACJ,QAAM,IAAI,SAAS,QAAQ,CAAC;AAC5B,QAAM,IAAI,SAAS,QAAQ,CAAC;AAC5B,QAAM,QAAQ,SAAS,QAAQ,KAAK;AACpC,QAAM,SAAS,SAAS,QAAQ,MAAM;AAEtC,QAAM,aAAa,cAAc;AAAA,IAC/B;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,aAAa,QAAQ;AAAA,IACrB,OAAO,QAAQ;AAAA,IACf,aAAa,QAAQ;AAAA,IACrB,QAAQ,QAAQ,CAAC;AAAA,IACjB,OAAO,QAAQ,CAAC;AAAA,IAChB,OAAO,QAAQ,CAAC;AAAA,EAClB,CAAC;AAED,QAAM,QAAQ,cAAc,QAAQ,WAAW;AAAA,IAC7C,OAAO,QAAQ;AAAA,IACf,MAAM,QAAQ;AAAA,IACd,MAAM,QAAQ;AAAA,IACd,QAAQ,QAAQ,CAAC;AAAA,IACjB,OAAO,QAAQ,CAAC;AAAA,IAChB,OAAO,QAAQ,CAAC;AAAA,EAClB,CAAC;AAED,SAAO,CAAC,kBAAkB,GAAG,GAAG,YAAY,GAAG,OAAO,iBAAiB,CAAC;AAC1E;AAWO,IAAM,gBAAgB,CAC3B,OACA,YACkB;AAClB,QAAM,YAAY;AAAA,IAChB,UAAU;AAAA,IACV,gBAAgB,QAAQ,KAAK;AAAA,IAC7B,eAAe,QAAQ,MAAM,QAAQ,IAAI;AAAA,EAC3C;AAEA,WAAS,MAAM,GAAG,MAAM,MAAM,QAAQ,MAAM,KAAK,OAAO;AACtD,UAAM,EAAE,SAAS,GAAG,EAAE,IAAI,MAAM,GAAG;AACnC,cAAU;AAAA,MACR;AAAA,QACE,UAAU,QAAQ,MAAM;AAAA,QACxB,UAAU,QAAQ,KAAK;AAAA,QACvB,UAAU,QAAQ,KAAK;AAAA,QACvB;AAAA,QACA;AAAA,MACF;AAAA,MACA,SAAS,OAAO;AAAA,IAClB;AAAA,EACF;AAEA,YAAU,KAAK,QAAQ,CAAC;AAExB,SAAO;AACT;AAEO,IAAM,gBAAgB,CAAC,YAaxB;AACJ,QAAM,IAAI,SAAS,QAAQ,CAAC;AAC5B,QAAM,IAAI,SAAS,QAAQ,CAAC;AAC5B,QAAM,QAAQ,SAAS,QAAQ,KAAK;AACpC,QAAM,SAAS,SAAS,QAAQ,MAAM;AACtC,QAAM,cAAc,SAAS,QAAQ,WAAW;AAChD,QAAM,UAAU,SAAS,QAAQ,OAAO;AAExC,QAAM,QAAQ,IAAI,cAAc,IAAI;AACpC,QAAM,QAAQ,IAAI,cAAc,IAAI;AACpC,QAAM,YAAY,SAAS,cAAc,IAAI,WAAW;AACxD,QAAM,aAAa,UAAU,cAAc,IAAI,WAAW;AAE1D,QAAM,eAAe;AAAA,IACnB,OAAO,OAAO,KAAK;AAAA,IACnB,OAAO,OAAO,QAAQ,UAAU;AAAA,IAChC,OAAO,QAAQ,WAAW,QAAQ,UAAU;AAAA,IAC5C,OAAO,QAAQ,WAAW,KAAK;AAAA,IAC/B,UAAU;AAAA,IACV,KAAK;AAAA,IACL,QAAQ;AAAA,EACV;AAEA,QAAM,aAAa,cAAc;AAAA,IAC/B;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,aAAa,QAAQ;AAAA,IACrB,OAAO,QAAQ;AAAA,IACf,aAAa,QAAQ;AAAA,IACrB,QAAQ,QAAQ,CAAC;AAAA,IACjB,OAAO,QAAQ,CAAC;AAAA,IAChB,OAAO,QAAQ,CAAC;AAAA,EAClB,CAAC;AAED,QAAM,QAAQ,cAAc,QAAQ,WAAW;AAAA,IAC7C,OAAO,QAAQ;AAAA,IACf,MAAM,QAAQ;AAAA,IACd,MAAM,QAAQ;AAAA,IACd,QAAQ,QAAQ,CAAC;AAAA,IACjB,OAAO,QAAQ,CAAC;AAAA,IAChB,OAAO,QAAQ,CAAC;AAAA,EAClB,CAAC;AAED,QAAM,gBAAgB;AAAA,IACpB,mBAAmB,IAAI;AAAA,IACvB,kBAAkB;AAAA,IAClB,GAAG;AAAA,IACH,iBAAiB;AAAA,IACjB,iBAAiB;AAAA,EACnB;AAEA,SAAO;AAAA,IACL,kBAAkB;AAAA,IAClB,GAAG;AAAA,IACH,GAAG;AAAA,IACH,GAAG;AAAA,IACH,iBAAiB;AAAA,EACnB;AACF;AAEO,IAAM,iBAAiB,CAAC,YAgBzB;AACJ,QAAM,IAAI,SAAS,QAAQ,CAAC;AAC5B,QAAM,IAAI,SAAS,QAAQ,CAAC;AAC5B,QAAM,QAAQ,SAAS,QAAQ,KAAK;AACpC,QAAM,SAAS,SAAS,QAAQ,MAAM;AACtC,QAAM,aAAa,SAAS,QAAQ,UAAU;AAC9C,QAAM,cAAc,SAAS,QAAQ,WAAW;AAChD,QAAM,UAAU,SAAS,QAAQ,OAAO;AAExC,QAAM,QAAQ,IAAI,cAAc,IAAI;AACpC,QAAM,QAAQ,IAAI,cAAc,IAAI;AACpC,QAAM,YAAY,SAAS,cAAc,IAAI,WAAW;AACxD,QAAM,aAAa,UAAU,cAAc,IAAI,WAAW;AAE1D,QAAM,eAAe;AAAA,IACnB,OAAO,OAAO,KAAK;AAAA,IACnB,OAAO,OAAO,QAAQ,UAAU;AAAA,IAChC,OAAO,QAAQ,WAAW,QAAQ,UAAU;AAAA,IAC5C,OAAO,QAAQ,WAAW,KAAK;AAAA,IAC/B,UAAU;AAAA,IACV,KAAK;AAAA,IACL,QAAQ;AAAA,EACV;AAEA,QAAM,aAAa,cAAc;AAAA,IAC/B;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,aAAa,QAAQ;AAAA,IACrB,OAAO,QAAQ;AAAA,IACf,aAAa,QAAQ;AAAA,IACrB,QAAQ,QAAQ,CAAC;AAAA,IACjB,OAAO,QAAQ,CAAC;AAAA,IAChB,OAAO,QAAQ,CAAC;AAAA,EAClB,CAAC;AAED,QAAM,aAA4B,CAAC;AACnC,WAAS,MAAM,GAAG,MAAM,QAAQ,cAAc,QAAQ,MAAM,KAAK,OAAO;AACtE,UAAM,OAAO,QAAQ,UAAU,QAAQ,cAAc,GAAG,CAAC;AACzD,eAAW;AAAA,MACT,GAAG,cAAc;AAAA,QACf,GAAG,KAAK,IAAI;AAAA,QACZ,GAAG,KAAK,KAAK,aAAa,KAAK,UAAU;AAAA,QACzC,OAAO,QAAQ;AAAA,QACf,QAAQ,KAAK,UAAU,aAAa,KAAK,UAAU;AAAA,QACnD,aAAa;AAAA,QACb,OAAO,QAAQ;AAAA,QACf,aAAa;AAAA,QACb,QAAQ,QAAQ,CAAC;AAAA,QACjB,OAAO,QAAQ,CAAC;AAAA,QAChB,OAAO,QAAQ,CAAC;AAAA,MAClB,CAAC;AAAA,IACH;AAAA,EACF;AAEA,QAAM,QAAQ,cAAc,QAAQ,WAAW;AAAA,IAC7C,OAAO,QAAQ;AAAA,IACf,MAAM,QAAQ;AAAA,IACd,MAAM,QAAQ;AAAA,IACd,QAAQ,QAAQ,CAAC;AAAA,IACjB,OAAO,QAAQ,CAAC;AAAA,IAChB,OAAO,QAAQ,CAAC;AAAA,EAClB,CAAC;AAED,QAAM,gBAAgB;AAAA,IACpB,mBAAmB,IAAI;AAAA,IACvB,kBAAkB;AAAA,IAClB,GAAG;AAAA,IACH,iBAAiB;AAAA,IACjB,iBAAiB;AAAA,EACnB;AAEA,SAAO;AAAA,IACL,kBAAkB;AAAA,IAClB,GAAG;AAAA,IACH,GAAG;AAAA,IACH,GAAG;AAAA,IACH,GAAG;AAAA,IACH,iBAAiB;AAAA,EACnB;AACF;;;AC5xBO,IAAM,oBAAN,cAAgC,MAAM;AAAA,EAC3C,cAAc;AACZ,UAAM,MACJ;AACF,UAAM,GAAG;AAAA,EACX;AACF;AAGO,IAAM,4BAAN,cAAwC,MAAM;AAAA,EACnD,cAAc;AACZ,UAAM,MACJ;AACF,UAAM,GAAG;AAAA,EACX;AACF;AAGO,IAAM,mBAAN,cAA+B,MAAM;AAAA,EAC1C,cAAc;AACZ,UAAM,MACJ;AACF,UAAM,GAAG;AAAA,EACX;AACF;AAGO,IAAM,mCAAN,cAA+C,MAAM;AAAA,EAC1D,cAAc;AACZ,UAAM,MACJ;AACF,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,mBAAN,cAA+B,MAAM;AAAA,EAC1C,YAAY,MAAc;AACxB,UAAM,MAAM,gDAAgD,IAAI;AAChE,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,2BAAN,cAAuC,MAAM;AAAA,EAClD,YAAY,MAAc,UAAe,QAAa;AACpD,UAAM,eAAe,UAAU;AAC/B,UAAM,aAAa,QAAQ,aAAa,QAAQ;AAChD,UAAM,MACJ,mBAAmB,IAAI,mBAAmB,YAAY,gCACxB,UAAU;AAC1C,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,2BAAN,cAAuC,MAAM;AAAA,EAClD,YAAY,SAAc;AACxB,UAAM,MAAM,uDAAuD,OAAO;AAC1E,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,0BAAN,cAAsC,MAAM;AAAA,EACjD,YAAY,MAAc;AACxB,UAAM,MAAM,oDAAoD,IAAI;AACpE,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,4BAAN,cAAwC,MAAM;AAAA,EACnD,YAAY,UAAkB;AAC5B,UAAM,MAAM,2CAA2C,QAAQ;AAC/D,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,gCAAN,cAA4C,MAAM;AAAA,EACvD,YAAY,MAAc;AACxB,UAAM,MAAM,iEAAiE,IAAI;AACjF,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,yBAAN,cAAqC,MAAM;AAAA,EAChD,YAAY,WAAmB;AAC7B,UAAM,MAAM,iFAAiF,SAAS;AACtG,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,wBAAN,cAAoC,MAAM;AAAA,EAC/C,YAAY,YAAoB,WAAmB;AACjD,UAAM,MAAM,8CAA8C,UAAU,8BAA8B,SAAS;AAC3G,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,yBAAN,cAAqC,MAAM;AAAA,EAChD,YAAY,YAAoB,WAAmB,MAAc;AAC/D,UAAM,MAAM,qCAAqC,UAAU,iCAAiC,SAAS,aAAa,IAAI;AACtH,UAAM,GAAG;AAAA,EACX;AACF;AAEO,IAAM,wBAAN,cAAoC,MAAM;AAAA,EAC/C,YAAY,YAAoB,WAAmB,MAAc;AAC/D,UAAM,MAAM,8BAA8B,SAAS,wBAAwB,UAAU,oDAAoD,IAAI;AAC7I,UAAM,GAAG;AAAA,EACX;AACF;;;AC9GO,IAAK,gBAAL,kBAAKC,mBAAL;AACL,EAAAA,8BAAA,UAAO,KAAP;AACA,EAAAA,8BAAA,YAAS,KAAT;AACA,EAAAA,8BAAA,WAAQ,KAAR;AAHU,SAAAA;AAAA,GAAA;;;AC6BZ,IAAM,gBAAgB;AACtB,IAAM,gBAAgB;AAEtB,IAAM,kBAAkB,CACtB,OACA,MACA,QACA,YAAqB,UAClB;AACH,MAAI,WAAW;AAEf,SAAO,WAAW,eAAe;AAC/B,QAAI,YAAY;AAEhB,aACM,UAAU,GAAG,UAAU,MAAM,QACjC,UAAU,SACV,WACA;AACA,mBAAa;AAEb,YAAM,OAAO,MAAM,OAAO;AAC1B,YAAM,QAAQ,KAAK,MAAM,GAAG;AAI5B,UAAI,uBAAuB,OAAO;AAClC,eAAS,MAAM,GAAG,MAAM,MAAM,QAAQ,MAAM,KAAK,OAAO;AACtD,cAAM,aAAa,QAAQ,MAAM;AACjC,cAAM,OAAO,aAAa,MAAM,GAAG,IAAI,MAAM,GAAG,IAAI;AACpD,cAAM,cAAc,KAAK,kBAAkB,MAAM,QAAQ;AACzD,gCAAwB;AACxB,YAAI,wBAAwB,GAAG;AAC7B,uBAAa;AACb,iCAAuB,OAAO,QAAQ;AAAA,QACxC;AAAA,MACF;AAAA,IACF;AAGA,QAAI,CAAC,aAAa,YAAY,MAAM,OAAQ,QAAO,WAAW;AAE9D,UAAM,SAAS,KAAK,aAAa,QAAQ;AACzC,UAAM,aAAa,SAAS,SAAS;AACrC,UAAM,cAAc,aAAa;AAGjC,QAAI,cAAc,KAAK,IAAI,OAAO,MAAM,EAAG,QAAO,WAAW;AAE7D,gBAAY;AAAA,EACd;AAEA,SAAO;AACT;AAEA,IAAM,wBAAwB,CAC5B,MACA,MACA,QACA,cACG;AACH,QAAM,YAAY,OAAO,QAAQ;AACjC,QAAM,aAAa,OAAO;AAE1B,MAAI,WAAW;AAEf,QAAMC,SAAQ,UAAU,IAAI;AAC5B,SAAO,WAAW,eAAe;AAC/B,aAAS,MAAM,GAAG,MAAMA,OAAM,QAAQ,MAAM,KAAK,OAAO;AACtD,YAAM,IAAIA,OAAM,GAAG;AACnB,YAAM,UAAU,KAAK,kBAAkB,GAAG,QAAQ,IAAI,YAAY;AAClE,UAAI,QAAS,QAAO,WAAW;AAAA,IACjC;AAEA,UAAM,SAAS,KAAK,aAAa,UAAU,EAAE,WAAW,MAAM,CAAC;AAC/D,QAAI,SAAS,WAAY,QAAO,WAAW;AAE3C,gBAAY;AAAA,EACd;AAEA,SAAO;AACT;AAgBA,IAAM,wBAAwB,CAAC,SAAiB;AAC9C,WAAS,MAAM,KAAK,QAAQ,MAAM,GAAG,OAAO;AAC1C,QAAI,KAAK,KAAK,KAAK,GAAG,CAAC,EAAG,QAAO;AAAA,EACnC;AACA,SAAO;AACT;AAEA,IAAM,gBAAgB,CACpB,OACA,UACA,MACA,aACG;AACH,MAAI,oBAAoB,MAAM;AAC9B,SAAO,oBAAoB,GAAG;AAC5B,UAAM,OAAO,MAAM,UAAU,GAAG,iBAAiB;AACjD,UAAM,UAAU,KAAK,WAAW,IAAI;AACpC,UAAM,QAAQ,KAAK,kBAAkB,MAAM,QAAQ;AACnD,QAAI,QAAQ,UAAU;AACpB,YAAM,YAAY,MAAM,UAAU,iBAAiB,KAAK;AACxD,aAAO,EAAE,MAAM,SAAS,OAAO,UAAU;AAAA,IAC3C;AACA,wBAAoB,sBAAsB,IAAI,KAAK;AAAA,EACrD;AAIA,SAAO;AAAA,IACL,MAAM;AAAA,IACN,SAAS,KAAK,WAAW,KAAK;AAAA,IAC9B,OAAO,KAAK,kBAAkB,OAAO,QAAQ;AAAA,IAC7C,WAAW;AAAA,EACb;AACF;AAEO,IAAM,sBAAsB,CACjC,MACA,EAAE,WAAW,UAAU,MAAM,OAAO,MACZ;AACxB,QAAM,QAAQ,UAAU,UAAU,IAAI,CAAC;AAEvC,MAAI,aAAa,UAAa,aAAa,GAAG;AAC5C,eAAW,gBAAgB,OAAO,MAAM,QAAQ,IAAI;AAAA,EACtD;AACA,QAAM,SAAS,KAAK,aAAa,QAAQ;AACzC,QAAM,aAAa,SAAS,SAAS;AAErC,QAAM,YAA4B,CAAC;AAEnC,MAAI,OAAO,OAAO;AAClB,MAAI,OAAO,OAAO;AAClB,MAAI,OAAO,OAAO,IAAI,OAAO;AAC7B,MAAI,OAAO,OAAO,IAAI,OAAO;AAE7B,MAAI,IAAI,OAAO,IAAI,OAAO;AAC1B,WAAS,MAAM,GAAG,MAAM,MAAM,QAAQ,MAAM,KAAK,OAAO;AACtD,QAAI,gBAAoC,MAAM,GAAG;AACjD,WAAO,kBAAkB,QAAW;AAClC,YAAM,EAAE,MAAM,SAAS,OAAO,UAAU,IAAI;AAAA,QAC1C;AAAA,QACA,OAAO;AAAA,QACP;AAAA,QACA;AAAA,MACF;AAGA,YAAM,IACJ,6BAAqC,OAAO,IACxC,+BAAqC,OAAO,IAAK,OAAO,QAAQ,IAAM,QAAQ,IAC5E,8BAAqC,OAAO,IAAI,OAAO,QAAQ,QAC7D,OAAO;AAGjB,WAAK;AAEL,UAAI,IAAI,KAAM,QAAO;AACrB,UAAI,IAAI,KAAM,QAAO;AACrB,UAAI,IAAI,QAAQ,KAAM,QAAO,IAAI;AACjC,UAAI,IAAI,SAAS,KAAM,QAAO,IAAI;AAElC,gBAAU,KAAK,EAAE,MAAM,MAAM,SAAS,OAAO,QAAQ,GAAG,EAAE,CAAC;AAI3D,sBAAgB,WAAW,KAAK;AAAA,IAClC;AAAA,EACF;AAEA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA,OAAO;AAAA,IACP,QAAQ;AAAA,MACN,GAAG;AAAA,MACH,GAAG;AAAA,MACH,OAAO,OAAO;AAAA,MACd,QAAQ,OAAO;AAAA,IACjB;AAAA,EACF;AACF;AAeO,IAAM,mBAAmB,CAC9B,MACA,EAAE,UAAU,MAAM,QAAQ,UAAU,MACf;AACrB,QAAM,OAAO,WAAW,UAAU,IAAI,CAAC;AAEvC,MAAI,KAAK,SAAS,WAAW;AAC3B,UAAM,IAAI,sBAAsB,KAAK,QAAQ,SAAS;AAAA,EACxD;AAEA,MAAI,aAAa,UAAa,aAAa,GAAG;AAC5C,eAAW,sBAAsB,MAAM,MAAM,QAAQ,SAAS;AAAA,EAChE;AAEA,QAAM,YAAY,OAAO,QAAQ;AAEjC,QAAM,SAAS,KAAK,aAAa,UAAU,EAAE,WAAW,MAAM,CAAC;AAC/D,QAAM,IAAI,OAAO,KAAK,OAAO,SAAS,IAAI,SAAS;AAEnD,QAAM,QAAwB,CAAC;AAE/B,MAAI,OAAO,OAAO;AAClB,MAAI,OAAO,OAAO;AAClB,MAAI,OAAO,OAAO,IAAI,OAAO;AAC7B,MAAI,OAAO,OAAO,IAAI,OAAO;AAE7B,MAAI,aAAa;AACjB,MAAI,aAAa;AACjB,SAAO,aAAa,WAAW;AAC7B,UAAM,CAAC,MAAM,UAAU,IAAI,YAAY,MAAM,UAAU;AAEvD,UAAM,UAAU,KAAK,WAAW,IAAI;AACpC,UAAM,QAAQ,KAAK,kBAAkB,MAAM,QAAQ;AAEnD,UAAM,aAAa,OAAO,KAAK,YAAY,aAAa,YAAY;AACpE,UAAM,IAAI,aAAa,QAAQ;AAE/B,QAAI,IAAI,KAAM,QAAO;AACrB,QAAI,IAAI,KAAM,QAAO;AACrB,QAAI,IAAI,QAAQ,KAAM,QAAO,IAAI;AACjC,QAAI,IAAI,SAAS,KAAM,QAAO,IAAI;AAElC,UAAM,KAAK,EAAE,MAAM,MAAM,SAAS,OAAO,QAAQ,GAAG,EAAE,CAAC;AAEvD,kBAAc;AACd,kBAAc;AAAA,EAChB;AAEA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA,QAAQ;AAAA,MACN,GAAG;AAAA,MACH,GAAG;AAAA,MACH,OAAO,OAAO;AAAA,MACd,QAAQ,OAAO;AAAA,IACjB;AAAA,EACF;AACF;AAeO,IAAM,uBAAuB,CAClC,MACA,EAAE,WAAW,UAAU,MAAM,OAAO,MACX;AACzB,QAAM,OAAO,WAAW,UAAU,IAAI,CAAC;AAEvC,MAAI,aAAa,UAAa,aAAa,GAAG;AAC5C,eAAW,gBAAgB,CAAC,IAAI,GAAG,MAAM,MAAM;AAAA,EACjD;AAEA,QAAM,UAAU,KAAK,WAAW,IAAI;AACpC,QAAM,QAAQ,KAAK,kBAAkB,MAAM,QAAQ;AACnD,QAAM,SAAS,KAAK,aAAa,UAAU,EAAE,WAAW,MAAM,CAAC;AAG/D,QAAM,IACJ,6BAAqC,OAAO,IACxC,+BAAqC,OAAO,IAAK,OAAO,QAAQ,IAAM,QAAQ,IAC5E,8BAAqC,OAAO,IAAI,OAAO,QAAQ,QAC7D,OAAO;AAGjB,QAAM,IAAI,OAAO,KAAK,OAAO,SAAS,IAAI,SAAS;AAEnD,SAAO;AAAA,IACL;AAAA,IACA,MAAM,EAAE,MAAM,MAAM,SAAS,OAAO,QAAQ,GAAG,EAAE;AAAA,IACjD,QAAQ,EAAE,GAAG,GAAG,OAAO,OAAO;AAAA,EAChC;AACF;;;AC9OO,IAAM,sBAAsB,CACjC,eACyB;AACzB,MACE,OAAO,eAAe,YACtB,eAAe,QACf,YAAY,YACZ;AACA,WAAO;AAAA,EACT;AACA,SAAO,EAAE,QAAQ,WAAW;AAC9B;AAKA,IAAMC,WACJ;AAEF,IAAM,qBAAqB,CAAC,UAEtB;AACJ,QAAM,KAAK,MAAM,qBAAqB,KAAK;AAC3C,QAAM,UAAU,cAAc,IAAIA,QAAO,EAAE,SAAS,CAAC;AACrD,QAAM,kBAAkB,OAAO,QAAQ,CAAC,CAAC;AACzC,SAAO,SAAS,eAAe,IAAI,kBAAkB;AACvD;AAMA,IAAM,aACJ;AAEF,IAAM,kBAAkB,CAAC,UAEnB;AACJ,QAAM,KAAK,MAAM,qBAAqB,KAAK;AAC3C,QAAM,UAAU,cAAc,IAAI,UAAU,EAAE;AAE9C,QAAM,CAAC,EAAE,IAAI,IAAI,IAAI,IAAI,UAAU,IAAI,WAAW,CAAC;AAEnD,MAAI,eAAe,OAAO,IAAI;AAC5B,WAAO,UAAU,OAAO,EAAE,CAAC;AAAA,EAC7B;AACA,MAAI,eAAe,QAAQ,MAAM,MAAM,IAAI;AACzC,WAAO,IAAI,OAAO,EAAE,GAAG,OAAO,EAAE,GAAG,OAAO,EAAE,CAAC;AAAA,EAC/C;AACA,MAAI,eAAe,OAAO,MAAM,MAAM,MAAM,IAAI;AAC9C,WAAO,KAAK,OAAO,EAAE,GAAG,OAAO,EAAE,GAAG,OAAO,EAAE,GAAG,OAAO,EAAE,CAAC;AAAA,EAC5D;AAEA,SAAO;AACT;AAEA,IAAM,0BAA0B,CAC9B,OACA,OACA,MACA,WAAmB,MAChB;AACH,QAAM,KAAK;AAAA,IACT,gBAAgB,KAAK,EAAE,SAAS;AAAA,IAChC,eAAe,MAAM,QAAQ,eAAe,QAAQ,EAAE,SAAS;AAAA,EACjE,EAAE,KAAK,IAAI;AACX,QAAM,qBAAqB,EAAE;AAC/B;AAEO,IAAM,oCAET,CAAC,UAAU,WAAW;AAExB,QAAM,cAAc,gBAAgB,MAAM;AAC1C,QAAM,aAAa,gBAAgB,SAAS,SAAS;AAErD,QAAMC,aAAY,OAAO,aAAa;AACtC,QAAM,KAAK,OAAO,6BAA6B;AAC/C,QAAM,KAAK,OAAO,eAAe;AAEjC,QAAM,cAAc,IAAI,SAAS,KAAK;AACtC,QAAM,WAAW,eAAe,IAAI,YAAY,CAAC;AACjD,QAAM,EAAE,OAAO,OAAO,IAAI,sBAAsBA,YAAW,QAAQ;AAEnE,QAAM,SAAS,cAAc,EAAE,GAAGA,YAAW,SAAS,CAAC;AAEvD,QAAM,QAAQ,IAAI,GAAG,GAAG,CAAC;AACzB,QAAM,cAAc,kBAAkB,IAAI,eAAe,CAAC,KAAK;AAC/D,QAAM,wBAAwB,kBAAkB,IAAI,mBAAmB,CAAC;AACxE,QAAM,sBAAsB,kBAAkB,IAAI,mBAAmB,GAAG,GAAG;AAG3E,QAAM,YAAY,eAAe,cAAc;AAC/C,MAAI,aAAa;AACf,4BAAwB,QAAQ,SAAS;AAAA,EAC3C,OAAO;AACL,4BAAwB,SAAS,WAAW,SAAS;AAAA,EACvD;AAEA,QAAM,UAAU;AAAA,IACd,GAAG,IAAI,cAAc;AAAA,IACrB,GAAG,IAAI,cAAc;AAAA,IACrB,OAAO,QAAQ;AAAA,IACf,QAAQ,SAAS;AAAA,IACjB,WAAW;AAAA,IACX;AAAA,IACA;AAAA,IACA,WAAW;AAAA,EACb;AAEA,SAAO;AAAA,IACL,QAAQ;AAAA,MACN,IAAI;AAAA,QACF,GAAG;AAAA,QACH,GAAG,aAAa;AAAA,UACd,GAAG;AAAA,UACH,OAAO;AAAA,UACP,QAAQ;AAAA,QACV,CAAC;AAAA,MACH;AAAA,MACA,KAAK;AAAA,QACH,GAAG;AAAA,QACH,GAAG,aAAa;AAAA,UACd,GAAG;AAAA,UACH,OAAO;AAAA,UACP,QAAQ;AAAA,QACV,CAAC;AAAA,MACH;AAAA,IACF;AAAA,IACA,MAAM;AAAA,MACJ,IAAI;AAAA,QACF,GAAG;AAAA,QACH,GAAG,aAAa;AAAA,UACd,GAAG;AAAA,UACH,OAAO;AAAA,UACP,QAAQ;AAAA,QACV,CAAC;AAAA,MACH;AAAA,MACA,KAAK;AAAA,QACH,GAAG;AAAA,QACH,GAAG,aAAa;AAAA,UACd,GAAG;AAAA,UACH,OAAO;AAAA,UACP,QAAQ;AAAA,QACV,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AACF;AAEO,IAAM,sCAET,CAAC,YAAY,WAAW;AAE1B,QAAM,cAAc,gBAAgB,MAAM;AAC1C,QAAM,aAAa,gBAAgB,WAAW,SAAS;AAEvD,QAAMA,aAAY,OAAO,aAAa;AACtC,QAAM,KAAK,OAAO,6BAA6B;AAC/C,QAAM,KAAK,OAAO,eAAe;AAEjC,QAAM,cAAc,IAAI,SAAS,KAAK;AACtC,QAAM,WAAW,eAAe,IAAI,YAAY,CAAC;AACjD,QAAM,EAAE,OAAO,OAAO,IAAI,sBAAsBA,YAAW,QAAQ;AAEnE,QAAM,SAAS,cAAc,EAAE,GAAGA,YAAW,SAAS,CAAC;AAEvD,QAAM,QAAQ,IAAI,GAAG,GAAG,CAAC;AACzB,QAAM,cAAc,kBAAkB,IAAI,eAAe,CAAC,KAAK;AAC/D,QAAM,wBAAwB,kBAAkB,IAAI,mBAAmB,CAAC;AACxE,QAAM,sBAAsB,kBAAkB,IAAI,mBAAmB,GAAG,GAAG;AAG3E,QAAM,YAAY,eAAe,cAAc;AAC/C,MAAI,aAAa;AACf,4BAAwB,QAAQ,SAAS;AAAA,EAC3C,OAAO;AACL,4BAAwB,WAAW,WAAW,SAAS;AAAA,EACzD;AAEA,QAAM,UAAU;AAAA,IACd,GAAG,QAAQ;AAAA,IACX,GAAG,SAAS;AAAA,IACZ,OAAO,QAAQ;AAAA,IACf,QAAQ,SAAS;AAAA,IACjB;AAAA,IACA;AAAA,IACA,UAAU;AAAA,EACZ;AAEA,SAAO;AAAA,IACL,QAAQ;AAAA,MACN,IAAI;AAAA,QACF,GAAG;AAAA,QACH,GAAG,gBAAgB;AAAA,UACjB,GAAG;AAAA,UACH,OAAO;AAAA,UACP,QAAQ;AAAA,QACV,CAAC;AAAA,MACH;AAAA,MACA,KAAK;AAAA,QACH,GAAG;AAAA,QACH,GAAG,gBAAgB;AAAA,UACjB,GAAG;AAAA,UACH,OAAO;AAAA,UACP,QAAQ;AAAA,QACV,CAAC;AAAA,MACH;AAAA,IACF;AAAA,IACA,MAAM;AAAA,MACJ,IAAI;AAAA,QACF,GAAG;AAAA,QACH,GAAG,gBAAgB;AAAA,UACjB,GAAG;AAAA,UACH,OAAO;AAAA,UACP,QAAQ;AAAA,QACV,CAAC;AAAA,MACH;AAAA,MACA,KAAK;AAAA,QACH,GAAG;AAAA,QACH,GAAG,gBAAgB;AAAA,UACjB,GAAG;AAAA,UACH,OAAO;AAAA,UACP,QAAQ;AAAA,QACV,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AACF;AAEO,IAAM,kCAET,CAAC,QAAQ,QAAQ,SAAS;AAE5B,QAAM,cAAc,gBAAgB,MAAM;AAC1C,QAAM,aAAa,gBAAgB,OAAO,SAAS;AACnD,QAAM,iBAAiB,mBAAmB,MAAM;AAChD,QAAM,gBAAgB,mBAAmB,OAAO,SAAS;AAEzD,QAAMA,aAAY,OAAO,aAAa;AACtC,QAAM,KAAK,OAAO,6BAA6B;AAC/C,QAAM,KAAK,OAAO,eAAe;AACjC,QAAM,WAAW,IAAI,YAAY;AACjC,QAAM,aAAa,UAAU,UAAU;AACvC,QAAM,WAAW,UAAU,QAAQ,cAAc;AAEjD,QAAM,cAAc,IAAI,SAAS,KAAK;AACtC,QAAM,WAAW,eAAe,IAAI,YAAY,CAAC;AACjD,QAAM,EAAE,OAAO,OAAO,IAAI,sBAAsBA,YAAW,QAAQ;AAEnE,QAAM,SAAS,cAAc,EAAE,GAAGA,YAAW,SAAS,CAAC;AAEvD,QAAM,QAAQ,IAAI,GAAG,GAAG,CAAC;AAEzB,QAAM,cAAc,kBAAkB,IAAI,eAAe,CAAC;AAC1D,QAAM,wBAAwB,kBAAkB,IAAI,mBAAmB,CAAC;AACxE,QAAM,sBAAsB,kBAAkB,IAAI,mBAAmB,GAAG,GAAG;AAE3E,QAAM,SAAS;AAAA,IACb,GAAG;AAAA,IACH,GAAG;AAAA,IACH,OAAO,QAAQ,cAAc;AAAA,IAC7B,QAAQ,SAAS,cAAc;AAAA,EACjC;AACA,QAAM,eAAe,qBAAqB,YAAY;AAAA,IACpD;AAAA,IACA,UAAU,kBAAkB;AAAA,IAC5B;AAAA,IACA;AAAA,EACF,CAAC;AACD,QAAM,aAAa,qBAAqB,UAAU;AAAA,IAChD;AAAA,IACA,UAAU,kBAAkB;AAAA,IAC5B;AAAA,IACA;AAAA,EACF,CAAC;AAGD,QAAM,WAAW,KAAK,IAAI,aAAa,UAAU,WAAW,QAAQ;AACpE,QAAM,YAAY,eAAe,cAAc;AAC/C,MAAI,eAAe,mBAAmB,QAAW;AAC/C,4BAAwB,QAAQ,WAAW,MAAM,QAAQ;AAAA,EAC3D,OAAO;AACL,4BAAwB,OAAO,WAAW,WAAW,MAAM,QAAQ;AAAA,EACrE;AAEA,QAAM,UAAU;AAAA,IACd,GAAG,IAAI,cAAc;AAAA,IACrB,GAAG,IAAI,cAAc;AAAA,IACrB,OAAO,QAAQ;AAAA,IACf,QAAQ,SAAS;AAAA,IACjB;AAAA,IACA;AAAA,IACA;AAAA,IACA,MAAM,KAAK;AAAA,IACX;AAAA,EACF;AAEA,SAAO;AAAA,IACL,QAAQ;AAAA,MACN,GAAG;AAAA,MACH,GAAG,WAAW;AAAA,QACZ,GAAG;AAAA,QACH,OAAO;AAAA,QACP,WAAW,CAAC,aAAa,IAAI;AAAA,MAC/B,CAAC;AAAA,IACH;AAAA,IACA,MAAM;AAAA,MACJ,GAAG;AAAA,MACH,GAAG,WAAW;AAAA,QACZ,GAAG;AAAA,QACH,OAAO;AAAA,QACP,WAAW,CAAC,WAAW,IAAI;AAAA,MAC7B,CAAC;AAAA,IACH;AAAA,EACF;AACF;AAEO,IAAM,qCAET,CAAC,WAAW,QAAQ,SAAS;AAE/B,QAAM,cAAc,gBAAgB,MAAM;AAC1C,QAAM,aAAa,gBAAgB,UAAU,SAAS;AACtD,QAAM,iBAAiB,mBAAmB,MAAM;AAChD,QAAM,gBAAgB,mBAAmB,UAAU,SAAS;AAE5D,QAAMA,aAAY,OAAO,aAAa;AACtC,QAAM,KAAK,OAAO,6BAA6B;AAC/C,QAAM,KAAK,OAAO,eAAe;AACjC,QAAM,OAAO,UAAU,QAAQ,KAAK;AAEpC,QAAM,cAAc,IAAI,SAAS,KAAK;AACtC,QAAM,WAAW,eAAe,IAAI,YAAY,CAAC;AACjD,QAAM,EAAE,OAAO,OAAO,IAAI,sBAAsBA,YAAW,QAAQ;AAEnE,QAAM,SAAS,cAAc,EAAE,GAAGA,YAAW,SAAS,CAAC;AAEvD,QAAM,QAAQ,IAAI,GAAG,GAAG,CAAC;AAEzB,QAAM,cAAc,kBAAkB,IAAI,eAAe,CAAC;AAC1D,QAAM,wBAAwB,kBAAkB,IAAI,mBAAmB,CAAC;AAExE,MAAI;AACJ,MAAI;AAEJ,QAAM,UAAU,UAAU,SAAS,IAAI,IAAI;AAC3C,QAAM,SAAS;AAAA,IACb,GAAG,cAAc;AAAA,IACjB,GAAG,cAAc;AAAA,IACjB,OAAO,SAAS,cAAc,WAAW;AAAA,IACzC,QAAQ,UAAU,cAAc,WAAW;AAAA,EAC7C;AACA,MAAI,UAAU,YAAY,GAAG;AAC3B,UAAM,SAAS,oBAAoB,MAAM;AAAA,MACvC,WAAW,UAAU,aAAa;AAAA,MAClC,UAAU,kBAAkB;AAAA,MAC5B;AAAA,MACA;AAAA,IACF,CAAC;AACD,gBAAY,OAAO;AACnB,eAAW,OAAO;AAAA,EACpB,WAAW,UAAU,SAAS,GAAG;AAC/B,UAAM,SAAS,iBAAiB,MAAM;AAAA,MACpC,UAAU,kBAAkB;AAAA,MAC5B;AAAA,MACA;AAAA,MACA,WAAW,UAAU,aAAa,KAAK;AAAA,IACzC,CAAC;AACD,gBAAY,OAAO;AACnB,eAAW,OAAO;AAAA,EACpB,OAAO;AACL,UAAM,SAAS,qBAAqB,MAAM;AAAA,MACxC,WAAW,UAAU,aAAa;AAAA,MAClC,UAAU,kBAAkB;AAAA,MAC5B;AAAA,MACA;AAAA,IACF,CAAC;AACD,gBAAY,CAAC,OAAO,IAAI;AACxB,eAAW,OAAO;AAAA,EACpB;AAGA,QAAM,YAAY,eAAe,cAAc;AAC/C,MAAI,eAAe,mBAAmB,QAAW;AAC/C,4BAAwB,QAAQ,WAAW,MAAM,QAAQ;AAAA,EAC3D,OAAO;AACL,4BAAwB,UAAU,WAAW,WAAW,MAAM,QAAQ;AAAA,EACxE;AAEA,QAAM,UAAU;AAAA,IACd,GAAG,IAAI,cAAc;AAAA,IACrB,GAAG,IAAI,cAAc;AAAA,IACrB,OAAO,QAAQ;AAAA,IACf,QAAQ,SAAS;AAAA,IACjB,aAAa,eAAe;AAAA,IAC5B;AAAA,IACA;AAAA,IACA,MAAM,KAAK;AAAA,IACX;AAAA,IACA,OAAO;AAAA,IACP;AAAA,IACA;AAAA,EACF;AAEA,SAAO,CAAC,GAAG,QAAQ,GAAG,cAAc,OAAO,CAAC;AAC9C;AAEO,IAAM,oCAET,CAAC,UAAU,QAAQ,SAAS;AAE9B,QAAM,cAAc,gBAAgB,MAAM;AAC1C,QAAM,aAAa,gBAAgB,SAAS,SAAS;AACrD,QAAM,iBAAiB,mBAAmB,MAAM;AAChD,QAAM,gBAAgB,mBAAmB,SAAS,SAAS;AAE3D,QAAMA,aAAY,OAAO,aAAa;AACtC,QAAM,KAAK,OAAO,6BAA6B;AAC/C,QAAM,KAAK,OAAO,eAAe;AACjC,QAAM,OAAO,SAAS,YAAY,EAAE,CAAC,KAAK;AAE1C,QAAM,cAAc,IAAI,SAAS,KAAK;AACtC,QAAM,WAAW,eAAe,IAAI,YAAY,CAAC;AACjD,QAAM,EAAE,OAAO,OAAO,IAAI,sBAAsBA,YAAW,QAAQ;AAEnE,QAAM,SAAS,cAAc,EAAE,GAAGA,YAAW,SAAS,CAAC;AAEvD,QAAM,QAAQ,IAAI,GAAG,GAAG,CAAC;AAEzB,QAAM,cAAc,kBAAkB,IAAI,eAAe,CAAC;AAC1D,QAAM,wBAAwB,kBAAkB,IAAI,mBAAmB,CAAC;AAExE,QAAM,UAAU;AAChB,QAAM,SAAS;AAAA,IACb,GAAG,cAAc;AAAA,IACjB,GAAG,cAAc;AAAA,IACjB,OAAO,SAAS,cAAc,WAAW;AAAA,IACzC,QAAQ,UAAU,cAAc,WAAW;AAAA,EAC7C;AACA,QAAM,EAAE,MAAM,SAAS,IAAI,qBAAqB,MAAM;AAAA,IACpD;AAAA,IACA,UAAU,kBAAkB;AAAA,IAC5B;AAAA,IACA;AAAA,EACF,CAAC;AAGD,QAAM,YAAY,eAAe,cAAc;AAC/C,MAAI,eAAe,mBAAmB,QAAW;AAC/C,4BAAwB,QAAQ,WAAW,MAAM,QAAQ;AAAA,EAC3D,OAAO;AACL,4BAAwB,SAAS,WAAW,WAAW,MAAM,QAAQ;AAAA,EACvE;AAEA,QAAM,UAAU;AAAA,IACd,GAAG,IAAI,cAAc;AAAA,IACrB,GAAG,IAAI,cAAc;AAAA,IACrB,OAAO,QAAQ;AAAA,IACf,QAAQ,SAAS;AAAA,IACjB,aAAa,eAAe;AAAA,IAC5B;AAAA,IACA;AAAA,IACA,MAAM,KAAK;AAAA,IACX;AAAA,IACA,OAAO;AAAA,IACP,WAAW,CAAC,IAAI;AAAA,IAChB;AAAA,EACF;AAEA,SAAO,CAAC,GAAG,QAAQ,GAAG,cAAc,OAAO,CAAC;AAC9C;AAEO,IAAM,sCAET,CAAC,YAAY,QAAQ,SAAS;AAEhC,QAAM,cAAc,gBAAgB,MAAM;AAC1C,QAAM,aAAa,gBAAgB,WAAW,SAAS;AACvD,QAAM,iBAAiB,mBAAmB,MAAM;AAChD,QAAM,gBAAgB,mBAAmB,WAAW,SAAS;AAE7D,QAAMA,aAAY,OAAO,aAAa;AACtC,QAAM,KAAK,OAAO,6BAA6B;AAC/C,QAAM,KAAK,OAAO,eAAe;AAEjC,QAAM,cAAc,IAAI,SAAS,KAAK;AACtC,QAAM,WAAW,eAAe,IAAI,YAAY,CAAC;AACjD,QAAM,EAAE,OAAO,OAAO,IAAI,sBAAsBA,YAAW,QAAQ;AAEnE,QAAM,SAAS,cAAc,EAAE,GAAGA,YAAW,SAAS,CAAC;AAEvD,QAAM,QAAQ,IAAI,GAAG,GAAG,CAAC;AAEzB,QAAM,cAAc,kBAAkB,IAAI,eAAe,CAAC;AAC1D,QAAM,wBAAwB,kBAAkB,IAAI,mBAAmB,CAAC;AAExE,QAAM,UAAU,WAAW,WAAW;AACtC,QAAM,WAAW,WAAW,YAAY;AAExC,MAAI,WAAW,SAAS,EAAG,SAAQ,KAAK;AAExC,MAAI,OAAO;AACX,WAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAQ,QAAQ,GAAG;AACnB,QAAI,MAAM,MAAM,EAAG,SAAQ;AAAA,EAC7B;AAEA,QAAM,UAAU;AAChB,QAAM,SAAS;AAAA,IACb,GAAG,cAAc;AAAA,IACjB,GAAG,cAAc;AAAA,IACjB,OAAO,SAAS,cAAc,WAAW;AAAA,IACzC,QAAQ,UAAU,cAAc,WAAW;AAAA,EAC7C;AACA,QAAM,EAAE,OAAO,UAAU,WAAW,IAAI,oBAAoB,MAAM;AAAA,IAChE;AAAA,IACA,UAAU,kBAAkB;AAAA,IAC5B;AAAA,IACA;AAAA,EACF,CAAC;AAED,QAAM,gBAA0B,CAAC;AACjC,WAAS,MAAM,GAAG,MAAM,MAAM,QAAQ,MAAM,KAAK,OAAO;AACtD,UAAM,OAAO,MAAM,GAAG;AACtB,QAAI,SAAS,SAAS,KAAK,IAAI,EAAG,eAAc,KAAK,GAAG;AAAA,EAC1D;AAEA,QAAM,OAAO,IAAI,MAAM,KAAK,MAAM,KAAK,MAAM,GAAG;AAGhD,QAAM,YAAY,eAAe,cAAc;AAC/C,MAAI,eAAe,mBAAmB,QAAW;AAC/C,4BAAwB,QAAQ,WAAW,MAAM,QAAQ;AAAA,EAC3D,OAAO;AACL,4BAAwB,WAAW,WAAW,WAAW,MAAM,QAAQ;AAAA,EACzE;AAEA,SAAO;AAAA,IACL,GAAG;AAAA,IACH,GAAG,eAAe;AAAA,MAChB,GAAG,IAAI,cAAc;AAAA,MACrB,GAAG,IAAI,cAAc;AAAA,MACrB,OAAO,QAAQ;AAAA,MACf,QAAQ,SAAS;AAAA,MACjB,aAAa,eAAe;AAAA,MAC5B;AAAA,MACA;AAAA,MACA,MAAM,KAAK;AAAA,MACX;AAAA,MACA,OAAO;AAAA,MACP,WAAW;AAAA,MACX;AAAA,MACA,eAAe;AAAA,MACf;AAAA,MACA;AAAA,IACF,CAAC;AAAA,EACH;AACF;;;AC9oBA,IAAqB,mBAArB,MAAqB,iBAAsC;AAAA,EA+BjD,YACN,KACA,KACA,UACA;AAlBF;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAET,wBAAQ,mBAAkB;AAC1B,wBAAiB;AAOf,aAAS,KAAK,OAAO,CAAC,CAAC,gBAAQ,QAAQ,CAAC,CAAC;AACzC,aAAS,KAAK,OAAO,CAAC,CAAC,aAAa,aAAa,CAAC,CAAC;AACnD,aAAS,UAAU,YAAY,CAAC,CAAC,yBAAiB,iBAAiB,CAAC,CAAC;AAErE,SAAK,MAAM;AACX,SAAK,MAAM;AACX,SAAK,QAAQ,SAAS;AACtB,SAAK,SAAS,SAAS;AAEvB,SAAK,WAAW;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,MAAM,QAAgB;AACpB,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AACrC,WAAO,EAAE,OAAO,KAAK,QAAQ,QAAQ,QAAQ,KAAK,SAAS,OAAO;AAAA,EACpE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,OAAO;AACL,WAAO,KAAK,MAAM,CAAC;AAAA,EACrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,MAAM,QAAuB;AAC3B,QAAI,CAAC,KAAK,iBAAiB;AACzB,YAAM,KAAK,SAAS,iBAAiB,KAAK,IAAI,SAAS,KAAK,GAAG;AAC/D,WAAK,kBAAkB;AAAA,IACzB;AAAA,EACF;AACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAlFE,cAbmB,kBAaZ,MAAK,CAAC,KAAa,KAAkB,aAC1C,IAAI,iBAAgB,KAAK,KAAK,QAAQ;AAd1C,IAAqB,kBAArB;;;ACOA,IAAqB,WAArB,MAAqB,SAA8B;AAAA,EA4BzC,YAAY,KAAa,KAAkB,UAAwB;AAX3E;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAET,wBAAQ,YAAW;AACnB,wBAAiB;AAGf,aAAS,KAAK,OAAO,CAAC,CAAC,gBAAQ,QAAQ,CAAC,CAAC;AACzC,aAAS,KAAK,OAAO,CAAC,CAAC,aAAa,aAAa,CAAC,CAAC;AACnD,aAAS,UAAU,YAAY;AAAA,MAC7B,CAAC,4BAAoB,oBAAoB;AAAA,MACzC,CAAC,8BAAsB,sBAAsB;AAAA,IAC/C,CAAC;AAED,SAAK,MAAM;AACX,SAAK,MAAM;AACX,SAAK,OAAO,SAAS;AAErB,SAAK,WAAW;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,WAAW,MAA4B;AACrC,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,SAAK,WAAW;AAChB,WAAO,KAAK,SAAS,WAAW,IAAI;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,kBAAkB,MAAc,MAAsB;AACpD,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,WAAO,KAAK,SAAS,kBAAkB,MAAM,IAAI;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,aAAa,MAAc,SAA2C;AACpE,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,sBAAkB,SAAS,WAAW,qBAAqB,CAAC,SAAS,CAAC;AACtE,WAAO,KAAK,SAAS,mBAAmB,MAAM;AAAA,MAC5C,WAAW,SAAS,aAAa;AAAA,IACnC,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,aAAa,QAAwB;AACnC,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AACrC,WAAO,KAAK,SAAS,mBAAmB,MAAM;AAAA,EAChD;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,kBAA4B;AAC1B,QAAI,KAAK,oBAAoB,8BAAsB;AACjD,aAAO,KAAK,SAAS,SAAS;AAAA,IAChC,OAAO;AACL,aAAO,KAAK,SAAS,KAAK;AAAA,IAC5B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,MAAM,QAAuB;AAE3B,QAAI,KAAK,UAAU;AACjB,YAAM,KAAK,SAAS,iBAAiB,KAAK,IAAI,SAAS,KAAK,GAAG;AAC/D,WAAK,WAAW;AAAA,IAClB;AAAA,EACF;AACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA7HE,cAbmB,UAaZ,MAAK,CAAC,KAAa,KAAkB,aAC1C,IAAI,SAAQ,KAAK,KAAK,QAAQ;AAdlC,IAAqB,UAArB;;;ACLA,IAAqB,YAArB,MAAqB,UAA+B;AAAA,EA8B1C,YAAY,KAAa,KAAkB,UAAyB;AAd5E;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAET,wBAAQ;AACR,wBAAQ;AAGN,aAAS,KAAK,OAAO,CAAC,CAAC,gBAAQ,QAAQ,CAAC,CAAC;AACzC,aAAS,KAAK,OAAO,CAAC,CAAC,aAAa,aAAa,CAAC,CAAC;AACnD,aAAS,UAAU,YAAY;AAAA,MAC7B,CAAC,sBAAc,cAAc;AAAA,MAC7B,CAAC,qBAAa,aAAa;AAAA,IAC7B,CAAC;AAED,SAAK,MAAM;AACX,SAAK,MAAM;AACX,SAAK,QAAQ,SAAS;AACtB,SAAK,SAAS,SAAS;AAEvB,SAAK,WAAW;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,MAAM,QAAgB;AACpB,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AACrC,WAAO,EAAE,OAAO,KAAK,QAAQ,QAAQ,QAAQ,KAAK,SAAS,OAAO;AAAA,EACpE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAoBA,WAAW,OAAe,QAAgB;AACxC,aAAS,OAAO,SAAS,CAAC,QAAQ,CAAC;AACnC,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AAErC,UAAM,gBAAgB,QAAQ,KAAK;AACnC,UAAM,iBAAiB,SAAS,KAAK;AACrC,UAAMC,SAAQ,KAAK,IAAI,eAAe,cAAc;AAEpD,WAAO,KAAK,MAAMA,MAAK;AAAA,EACzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,OAAO;AACL,WAAO,KAAK,MAAM,CAAC;AAAA,EACrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,MAAM,QAAuB;AAC3B,QAAI,CAAC,KAAK,SAAU;AAIpB,QAAI,CAAC,KAAK,WAAW;AACnB,YAAM,EAAE,KAAK,IAAI,IAAI;AACrB,WAAK,YAAY,KAAK,SAAS,iBAAiB,IAAI,SAAS,GAAG;AAAA,IAClE;AACA,UAAM,KAAK;AAKX,SAAK,WAAW;AAAA,EAClB;AACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAxHE,cAZmB,WAYZ,MAAK,CAAC,KAAa,KAAkB,aAC1C,IAAI,UAAS,KAAK,KAAK,QAAQ;AAbnC,IAAqB,WAArB;;;ACVO,IAAK,iBAAL,kBAAKC,oBAAL;AACL,EAAAA,gCAAA,UAAO,KAAP;AACA,EAAAA,gCAAA,YAAS,KAAT;AACA,EAAAA,gCAAA,WAAQ,KAAR;AAHU,SAAAA;AAAA,GAAA;;;AC2CL,IAAM,+BAA+B,CAC1C,YACG;AACH,oBAAkB,SAAS,GAAG,aAAa,CAAC,QAAQ,CAAC;AACrD,oBAAkB,SAAS,GAAG,aAAa,CAAC,QAAQ,CAAC;AACrD,oBAAkB,SAAS,OAAO,iBAAiB,CAAC,QAAQ,CAAC;AAC7D,oBAAkB,SAAS,QAAQ,kBAAkB,CAAC,QAAQ,CAAC;AAC/D,oBAAkB,SAAS,WAAW,qBAAqB;AAAA,IACzD,CAAC,QAAQ,OAAO;AAAA,EAClB,CAAC;AACD,oBAAkB,SAAS,iBAAiB,2BAA2B;AAAA,IACrE,CAAC,QAAQ,OAAO;AAAA,EAClB,CAAC;AACD,oBAAkB,SAAS,aAAa,uBAAuB;AAAA,IAC7D,CAAC,QAAQ,OAAO;AAAA,EAClB,CAAC;AACD,oBAAkB,SAAS,aAAa,uBAAuB,CAAC,QAAQ,CAAC;AACzE,oBAAkB,SAAS,QAAQ,kBAAkB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AAC7E;AAsBA,IAAqB,WAArB,MAA8B;AAAA,EAUlB,YACR,WACA,KACA,KACA;AAZF;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAOP,aAAS,WAAW,aAAa,CAAC,CAAC,yBAAiB,iBAAiB,CAAC,CAAC;AACvE,aAAS,KAAK,OAAO,CAAC,CAAC,gBAAQ,QAAQ,CAAC,CAAC;AACzC,aAAS,KAAK,OAAO,CAAC,CAAC,aAAa,aAAa,CAAC,CAAC;AAEnD,SAAK,YAAY;AACjB,SAAK,MAAM;AACX,SAAK,MAAM;AAAA,EACb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBA,UAAkB;AAChB,WAAO,KAAK,UAAU,sBAAsB,KAAK;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,aAAsB;AACpB,WAAO,KAAK,UAAU,QAAQ,eAAe,QAAQ;AAAA,EACvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,iBAAiB;AACf,SAAK,UAAU,UAAU,eAAe,UAAU,IAAI;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,kBAAkB;AAChB,SAAK,UAAU,UAAU,eAAe,UAAU,KAAK;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,aAAsB;AACpB,WAAO,KAAK,UAAU,QAAQ,eAAe,QAAQ;AAAA,EACvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,iBAAiB;AACf,SAAK,UAAU,UAAU,eAAe,UAAU,IAAI;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,kBAAkB;AAChB,SAAK,UAAU,UAAU,eAAe,UAAU,KAAK;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,aAAsB;AACpB,WAAO,CAAC,KAAK,UAAU,QAAQ,eAAe,QAAQ;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,kBAAkB;AAChB,SAAK,UAAU,UAAU,eAAe,UAAU,KAAK;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,mBAAmB;AACjB,SAAK,UAAU,UAAU,eAAe,UAAU,IAAI;AAAA,EACxD;AAAA;AAAA,EAGA,yBAAkC;AAChC,UAAM,IAAI;AAAA,MACR,KAAK,YAAY;AAAA,MACjB;AAAA,IACF;AAAA,EACF;AAAA;AAAA,EAGA,yBAAyB,OAAgB;AACvC,UAAM,IAAI;AAAA,MACR,KAAK,YAAY;AAAA,MACjB;AAAA,IACF;AAAA,EACF;AAAA,EAEU,cAAc;AACtB,SAAK,IAAI,QAAQ,EAAE,iBAAiB,KAAK,GAAG;AAAA,EAC9C;AAAA,EAEU,cAAc;AACtB,SAAK,IAAI,QAAQ,EAAE,iBAAiB,KAAK,GAAG;AAAA,EAC9C;AAAA,EAEU,UAAmB;AAC3B,WAAO,KAAK,IAAI,QAAQ,EAAE,aAAa,KAAK,GAAG;AAAA,EACjD;AAAA,EAEU,aAAa,SAaC;AACtB,UAAM,YAAY,QAAQ;AAC1B,UAAM,kBAAkB,QAAQ;AAChC,UAAM,cAAc,QAAQ;AAC5B,UAAM,cAAc,QAAQ;AAC5B,UAAM,eAAe,UAAU,QAAQ,MAAM;AAC7C,UAAM,UAAU,QAAQ;AACxB,UAAM,IAAI,QAAQ;AAClB,UAAM,IAAI,QAAQ;AAClB,UAAM,QAAQ,QAAQ,QAAQ;AAC9B,UAAM,SAAS,QAAQ,SAAS;AAChC,UAAM,SAAS,QAAQ,QAAQ,MAAM;AACrC,UAAM,UAAU,QAAQ;AAExB,mBAAe,cAAc,gBAAgB,EAAE;AAG/C,UAAM,SAAS,4BAAoB,OAAO,KAAK,IAAI,SAAS,KAAK,GAAG;AAGpE,UAAM,OAAO;AAAA,MACX,EAAE,GAAG,GAAG,OAAO,OAAO;AAAA,MACtB;AAAA,MACA;AAAA,IACF;AACA,WAAO,aAAa,IAAI;AAExB,QAAI,QAAS,QAAO,KAAK,OAAO;AAEhC,UAAM,KAAK,OAAO,qCAAqC;AACvD,QAAI,iBAAiB;AACnB,SAAG,mBAAmB,kBAAkB,eAAe,CAAC;AAAA,IAC1D;AACA,OAAG,YAAY,YAAY;AAC3B,QAAI,QAAS,IAAG,YAAY,EAAE,QAAQ,QAAQ,CAAC;AAC/C,QAAI,YAAa,IAAG,eAAe,kBAAkB,WAAW,CAAC;AAEjE,UAAM,KAAK,OAAO,uBAAuB;AACzC,QAAI,gBAAgB,OAAW,IAAG,SAAS,WAAW;AAEtD,WAAO,UAAU,gBAAgB,OAAO,IAAI;AAC5C,WAAO,UAAU,gBAAgB,QAAQ,MAAM;AAC/C,WAAO,UAAU,gBAAgB,WAAW,KAAK;AAGjD,QAAI,WAAW;AACb,YAAM,KAAK,KAAK,UAAU,qBAAqB,KAAK;AACpD,YAAM,QAAQ,KAAK,OAAO,gBAAgB,SAAS,EAAE,SAAS;AAC9D,WAAK,UAAU,qBAAqB,KAAK;AAAA,IAC3C;AAEA,WAAO;AAAA,EACT;AAAA,EAEU,+BACR,QACA,MACA,EAAE,QAAQ,UAAU,KAAK,GACzB;AACA,SAAK,wBAAwB,QAAQ;AAAA,MACnC,QAAQ,KAAK,uBAAuB,QAAQ,QAAQ,IAAI;AAAA,MACxD,UAAU,YAAY,KAAK,uBAAuB,QAAQ,UAAU,IAAI;AAAA,MACxE,MAAM,QAAQ,KAAK,uBAAuB,QAAQ,MAAM,IAAI;AAAA,IAC9D,CAAC;AAAA,EACH;AAAA,EAEU,4BACR,QACA,SACA;AAAA,IACE;AAAA,IACA;AAAA,IACA;AAAA,EACF,GACA;AACA,SAAK,wBAAwB,QAAQ;AAAA,MACnC,QAAQ,KAAK,qBAAqB,QAAQ,QAAQ,OAAO;AAAA,MACzD,UACE,YAAY,KAAK,qBAAqB,QAAQ,UAAU,OAAO;AAAA,MACjE,MAAM,QAAQ,KAAK,qBAAqB,QAAQ,MAAM,OAAO;AAAA,IAC/D,CAAC;AAAA,EACH;AAAA,EAEU,wBACR,QACA,EAAE,QAAQ,UAAU,KAAK,GACzB;AACA,WAAO,oBAAoB,MAAM;AAEjC,QAAI,UAAU;AACZ,aAAO,sBAAsB,QAAQ;AAAA,IACvC,OAAO;AACL,aAAO,yBAAyB;AAAA,IAClC;AAEA,QAAI,MAAM;AACR,aAAO,kBAAkB,IAAI;AAAA,IAC/B,OAAO;AACL,aAAO,qBAAqB;AAAA,IAC9B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiBQ,uBACN,QACA,YACA,MACQ;AACR,UAAM,EAAE,QAAQ,IAAI,KAAK,UAAU;AACnC,UAAM,EAAE,OAAO,OAAO,IAAI,OAAO,aAAa;AAS9C,UAAM,YAAY,QAAQ,EAAE,MAAM,EAAE,CAAC,KAAK,IAAI,GAAG,KAAK,IAAI,EAAE;AAC5D,UAAMC,UAAS,QAAQ,YAAY,YAAY;AAAA,MAC7C;AAAA,MACA,MAAM,QAAQ,IAAI,CAAC,GAAG,GAAG,OAAO,MAAM,CAAC;AAAA,MACvC,QAAQ,QAAQ,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;AAAA,IACxC,CAAC;AACD,UAAM,YAAY,QAAQ,SAASA,OAAM;AAEzC,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWU,4BACR,QACA,OACA,WACQ;AAMR,UAAM,EAAE,QAAQ,IAAI,KAAK,UAAU;AAEnC,UAAMC,aAAY,OAAO,aAAa;AACtC,UAAM,KAAK,OAAO,6BAA6B;AAC/C,UAAM,KAAK,OAAO,eAAe;AAEjC,UAAM,cAAc,IAAI,SAAS,KAAK;AACtC,UAAM,WAAW,eAAe,IAAI,YAAY,CAAC;AAEjD,UAAM,SAAS,cAAc,EAAE,GAAGA,YAAW,SAAS,CAAC;AAEvD,UAAM,MAAM,sBAAsBA,YAAW,QAAQ;AACrD,UAAM,YAAY,MAAM;AAAA,MACtB,IAAI,QAAQ,cAAc;AAAA,MAC1B,IAAI,SAAS,cAAc;AAAA,IAC7B;AAGA,UAAM,UAAU;AAAA,MACd,GAAG;AAAA,MACH,GAAG;AAAA,MACH,OAAO,UAAU;AAAA,MACjB,QAAQ,UAAU;AAAA;AAAA,MAElB,QAAQ,QAAQ,CAAC;AAAA,MACjB,OAAO,QAAQ,CAAC;AAAA,MAChB,OAAO,QAAQ,CAAC;AAAA,IAClB;AAEA,QAAI,8BAAqC;AACvC,cAAQ,MAAM,IAAI,QAAQ,cAAc,KAAK,IAAI,UAAU,QAAQ;AACnE,cAAQ,MAAM,IAAI,SAAS,cAAc,KAAK,IAAI,UAAU,SAAS;AAAA,IACvE,WAAW,6BAAoC;AAC7C,cAAQ,IAAI,IAAI,QAAQ,cAAc,UAAU;AAChD,cAAQ,IAAI,IAAI,SAAS,cAAc,UAAU;AAAA,IACnD;AAEA,UAAM,YAAY,KAAK,IAAI,QAAQ,gBAAgB,SAAS,EAAE;AAC9D,UAAM,aAAa,CAAC,GAAG,QAAQ,GAAG,UAAU,WAAW,OAAO,CAAC;AAG/D,UAAM,YAAY,EAAE,SAAS,EAAE,CAAC,SAAS,GAAG,MAAM,IAAI,EAAE;AACxD,UAAMD,UAAS,QAAQ,YAAY,YAAY;AAAA,MAC7C;AAAA,MACA,MAAM,QAAQ,IAAI,CAAC,GAAG,GAAGC,WAAU,OAAOA,WAAU,MAAM,CAAC;AAAA,MAC3D,QAAQ,QAAQ,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;AAAA,IACxC,CAAC;AAED,WAAO,QAAQ,SAASD,OAAM;AAAA,EAChC;AAAA,EAEQ,qBACN,QACA,YACA,SACS;AACT,UAAM,EAAE,QAAQ,IAAI,KAAK,UAAU;AAEnC,UAAM,cAAc,KAAK,uBAAuB,QAAQ,WAAW,EAAE;AACrE,UAAM,eAAe,KAAK,uBAAuB,QAAQ,WAAW,GAAG;AAEvE,UAAM,iBAAiB,QAAQ,IAAI,CAAC,CAAC;AACrC,mBAAe,IAAI,SAAS,WAAW;AACvC,mBAAe,IAAI,gBAAQ,GAAG,KAAK,GAAG,YAAY;AAElD,WAAO;AAAA,EACT;AACF;;;ACxeA,IAAqB,eAArB,MAAqB,qBAAoB,SAAS;AAAA,EAkBxC,YACN,cACA,KACA,KACA;AACA,UAAM,cAAc,KAAK,GAAG;AAP9B;AAAA,wBAAS;AASP,aAAS,cAAc,gBAAgB;AAAA,MACrC,CAAC,yBAAiB,iBAAiB;AAAA,IACrC,CAAC;AAED,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAqBA,QAAQ;AACN,UAAM,UAAU,KAAK,UAAU,WAAW,KAAK,gBAAQ,GAAG,KAAK;AAC/D,SAAK,YAAY;AACjB,SAAK,UAAU,SAAS,OAAO;AAAA,EACjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,UAAU;AACR,SAAK,YAAY;AACjB,SAAK,UAAU,SAAS,gBAAQ,GAAG,KAAK,CAAC;AAAA,EAC3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,YAAqB;AACnB,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,WAAO,CAAC,CAAC,WAAW,YAAY,KAAK,UAAU,SAAS;AAAA,EAC1D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA2BA,UAAU,MAAe,SAAkC;AACzD,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,iCAA6B,OAAO;AAEpC,QAAI,CAAC,QAAS,WAAU,CAAC;AAEzB,QAAI,EAAE,eAAe,SAAU,SAAQ,YAAY,IAAI,GAAG,GAAG,CAAC;AAC9D,QAAI,EAAE,qBAAqB,SAAU,SAAQ,kBAAkB,IAAI,GAAG,GAAG,CAAC;AAC1E,QAAI,EAAE,iBAAiB,SAAU,SAAQ,cAAc,IAAI,GAAG,GAAG,CAAC;AAClE,QAAI,EAAE,iBAAiB,SAAU,SAAQ,cAAc;AAGvD,UAAM,SAAS,KAAK,aAAa;AAAA,MAC/B,GAAG,QAAQ,KAAK;AAAA,MAChB,GAAG,QAAQ,KAAK;AAAA,MAChB,OAAO,QAAQ,SAAS;AAAA,MACxB,QAAQ,QAAQ,UAAU;AAAA,MAC1B,WAAW,QAAQ;AAAA,MACnB,iBAAiB,QAAQ;AAAA,MACzB,aAAa,QAAQ;AAAA,MACrB,aAAa,QAAQ,eAAe;AAAA,MACpC,QAAQ,QAAQ,UAAU,QAAQ,CAAC;AAAA,MACnC,QAAQ,QAAQ;AAAA,MAChB,MAAM,KAAK;AAAA,IACb,CAAC;AACD,UAAM,YAAY,KAAK,IAAI,QAAQ,SAAS,OAAO,IAAI;AAGvD,SAAK,UAAU,UAAU,SAAS;AAGlC,WAAO,mBAAmB,gBAAQ,GAAG,KAAK,CAAC;AAC3C,SAAK,uBAAuB,QAAQ,gBAAQ,GAAG,KAAK,CAAC;AAGrD,SAAK,KAAK,SAAS,SAAS;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,yBAAkC;AAChC,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,YAAM,QAAQ,OAAO,mBAAmB;AACxC,YAAM,SAAS,OAAO,eAAe,GAAG;AAExC,UAAI,EAAE,kBAAkB,iBAAU,QAAO;AACzC,UAAI,SAAS,CAAC,OAAO,IAAI,KAAK,EAAG,QAAO;AAAA,IAC1C;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,2BAA2B;AACzB,SAAK,kBAAkB;AAAA,EACzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,kBAAkB,UAA+C;AAC/D,sBAAkB,UAAU,YAAY,CAAC,QAAQ,CAAC;AAElD,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,YAAM,UAAU,OAAO,WAAW,KAAK,gBAAQ,GAAG,KAAK;AACvD,UAAI,CAAC,QAAS;AACd,WAAK,uBAAuB,QAAQ,SAAS,QAAQ;AAAA,IACvD;AACA,SAAK,YAAY;AAAA,EACnB;AAAA,EAEQ,uBACN,QACA,SACA,UACA;AACA,UAAM,aAAa,YAAY;AAC/B,UAAM,cAAc,oBAAoB,WAAW,MAAM,MAAM,CAAC;AAChE,SAAK,4BAA4B,QAAQ,SAAS,WAAW;AAAA,EAC/D;AACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAzNE,cAZmB,cAYZ,MAAK,CAAC,cAA+B,KAAa,QACvD,IAAI,aAAY,cAAc,KAAK,GAAG;AAb1C,IAAqB,cAArB;;;ACMA,IAAqB,eAArB,MAAqB,qBAAoB,SAAS;AAAA,EAkBxC,YACN,cACA,KACA,KACA;AACA,UAAM,cAAc,KAAK,GAAG;AAP9B;AAAA,wBAAS;AASP,aAAS,cAAc,gBAAgB;AAAA,MACrC,CAAC,yBAAiB,iBAAiB;AAAA,IACrC,CAAC;AAED,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,aAAuB;AACrB,UAAM,aAAa,KAAK,UAAU,WAAW;AAE7C,UAAM,UAAU,IAAI,MAAc,WAAW,MAAM;AACnD,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,EAAE,SAAS,MAAM,IAAI,WAAW,GAAG;AACzC,cAAQ,GAAG,KAAK,WAAW,OAAO,WAAW;AAAA,IAC/C;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,cAAwB;AACtB,UAAME,UAAS,KAAK,UAAU,UAAU;AAExC,UAAM,WAAW,IAAI,MAAcA,QAAO,MAAM;AAChD,aAAS,MAAM,GAAG,MAAMA,QAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,eAAS,GAAG,IAAIA,QAAO,GAAG,EAAE,WAAW;AAAA,IACzC;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,WAAW,SAAmB;AAC5B,aAAS,SAAS,WAAW,CAAC,KAAK,CAAC;AAEpC,UAAM,gBAAgB,IAAI,MAA+B,QAAQ,MAAM;AACvE,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,oBAAc,GAAG,IAAI,EAAE,OAAO,qBAAa,SAAS,QAAQ,GAAG,CAAC,EAAE;AAAA,IACpE;AACA,SAAK,UAAU,WAAW,aAAa;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,WAAW,SAA4B;AACrC,aAAS,SAAS,WAAW,CAAC,UAAU,KAAK,CAAC;AAE9C,UAAM,aAAa,MAAM,QAAQ,OAAO,IAAI,UAAU,CAAC,OAAO;AAE9D,UAAM,kBAGA,KAAK,UAAU,WAAW;AAEhC,UAAM,aAAa,IAAI,MAA+B,WAAW,MAAM;AACvE,aAAS,MAAM,GAAG,MAAM,WAAW,QAAQ,MAAM,KAAK,OAAO;AAC3D,iBAAW,GAAG,IAAI,EAAE,OAAO,qBAAa,SAAS,WAAW,GAAG,CAAC,EAAE;AAAA,IACpE;AAEA,SAAK,UAAU,WAAW,gBAAgB,OAAO,UAAU,CAAC;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA6CA,OAAO,SAA4B,QAAQ,OAAO;AAChD,aAAS,SAAS,WAAW,CAAC,UAAU,KAAK,CAAC;AAC9C,aAAS,OAAO,SAAS,CAAC,SAAS,CAAC;AAEpC,UAAM,aAAa,MAAM,QAAQ,OAAO,IAAI,UAAU,CAAC,OAAO;AAE9D,UAAM,eAAe,KAAK,WAAW;AACrC,UAAM,kBAAkB,WAAW;AAAA,MACjC,CAAC,WAAW,CAAC,aAAa,SAAS,MAAM;AAAA,IAC3C;AACA,QAAI,gBAAiB,MAAK,cAAc;AAExC,SAAK,YAAY;AAEjB,QAAI,WAAW,SAAS,KAAM,WAAW,WAAW,KAAK,OAAQ;AAC/D,WAAK,kBAAkB;AAAA,IACzB;AAEA,UAAMA,UAAS,IAAI,MAAoB,WAAW,MAAM;AACxD,aAAS,MAAM,GAAG,MAAM,WAAW,QAAQ,MAAM,KAAK,OAAO;AAC3D,MAAAA,QAAO,GAAG,IAAI,qBAAa,SAAS,WAAW,GAAG,CAAC;AAAA,IACrD;AAEA,QAAI,OAAO;AACT,YAAM,iBAAiB,KAAK,UAAU,UAAU;AAChD,WAAK,UAAU,UAAU,eAAe,OAAOA,OAAM,CAAC;AAAA,IACxD,OAAO;AACL,WAAK,UAAU,UAAUA,OAAM;AAAA,IACjC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,QAAQ;AACN,SAAK,YAAY;AACjB,SAAK,UAAU,UAAU,CAAC,CAAC;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBA,YAAY,UAAkB;AAC5B,mBAAe,UAAU,UAAU;AACnC,SAAK,UAAU,YAAY,QAAQ;AACnC,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,aAAsB;AACpB,WAAO,KAAK,UAAU,QAAQ,gBAAgB,IAAI;AAAA,EACpD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,gBAAgB;AACd,SAAK,UAAU,UAAU,gBAAgB,MAAM,IAAI;AAAA,EACrD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,iBAAiB;AACf,SAAK,UAAU,UAAU,gBAAgB,MAAM,KAAK;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,WAAoB;AAClB,WAAO,KAAK,UAAU,QAAQ,gBAAgB,IAAI;AAAA,EACpD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,gBAAgB;AACd,SAAK,UAAU,UAAU,gBAAgB,MAAM,IAAI;AAAA,EACrD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,iBAAiB;AACf,SAAK,UAAU,UAAU,gBAAgB,MAAM,KAAK;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,gBAAyB;AACvB,WAAO,KAAK,UAAU,QAAQ,gBAAgB,WAAW;AAAA,EAC3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,oBAAoB;AAClB,SAAK,UAAU,UAAU,gBAAgB,aAAa,IAAI;AAAA,EAC5D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,qBAAqB;AACnB,SAAK,UAAU,UAAU,gBAAgB,aAAa,KAAK;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,iBAA0B;AACxB,WAAO,CAAC,KAAK,UAAU,QAAQ,gBAAgB,eAAe;AAAA,EAChE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,sBAAsB;AACpB,SAAK,UAAU,UAAU,gBAAgB,iBAAiB,KAAK;AAAA,EACjE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,uBAAuB;AACrB,SAAK,UAAU,UAAU,gBAAgB,iBAAiB,IAAI;AAAA,EAChE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,kBAA2B;AACzB,WAAO,KAAK,UAAU,QAAQ,gBAAgB,iBAAiB;AAAA,EACjE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,sBAAsB;AACpB,SAAK,UAAU,UAAU,gBAAgB,mBAAmB,IAAI;AAAA,EAClE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,uBAAuB;AACrB,SAAK,UAAU,UAAU,gBAAgB,mBAAmB,KAAK;AAAA,EACnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA8BA,UAAU,MAAe,SAAkC;AACzD,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,iCAA6B,OAAO;AAEpC,QAAI,CAAC,QAAS,WAAU,CAAC;AAEzB,QAAI,EAAE,eAAe,SAAU,SAAQ,YAAY,IAAI,GAAG,GAAG,CAAC;AAC9D,QAAI,EAAE,qBAAqB,SAAU,SAAQ,kBAAkB,IAAI,GAAG,GAAG,CAAC;AAC1E,QAAI,EAAE,iBAAiB,SAAU,SAAQ,cAAc,IAAI,GAAG,GAAG,CAAC;AAClE,QAAI,EAAE,iBAAiB,SAAU,SAAQ,cAAc;AAGvD,UAAM,SAAS,KAAK,aAAa;AAAA,MAC/B,GAAG,QAAQ,KAAK;AAAA,MAChB,GAAG,QAAQ,KAAK;AAAA,MAChB,OAAO,QAAQ,SAAS;AAAA,MACxB,QAAQ,QAAQ,UAAU;AAAA,MAC1B,WAAW,QAAQ;AAAA,MACnB,iBAAiB,QAAQ;AAAA,MACzB,aAAa,QAAQ;AAAA,MACrB,aAAa,QAAQ,eAAe;AAAA,MACpC,QAAQ,QAAQ,UAAU,QAAQ,CAAC;AAAA,MACnC,QAAQ,QAAQ;AAAA,MAChB,MAAM,KAAK;AAAA,IACb,CAAC;AACD,UAAM,YAAY,KAAK,IAAI,QAAQ,SAAS,OAAO,IAAI;AAGvD,SAAK,UAAU,UAAU,SAAS;AAGlC,UAAM,OAAO,QAAQ,QAAQ,KAAK,IAAI,QAAQ,EAAE,eAAe;AAC/D,SAAK,uBAAuB,QAAQ,IAAI;AAGxC,SAAK,KAAK,SAAS,SAAS;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,yBAAkC;AAChC,QAAI,KAAK,QAAQ,EAAG,QAAO;AAE3B,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,YAAM,iBACJ,OAAO,eAAe,GAAG,kBAAkB;AAC7C,UAAI,CAAC,eAAgB,QAAO;AAAA,IAC9B;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,yBAAyB,MAAe;AACtC,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,SAAK,kBAAkB,IAAI;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,kBACE,MACA,UACA;AACA,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,sBAAkB,UAAU,YAAY,CAAC,QAAQ,CAAC;AAElD,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,WAAK,uBAAuB,QAAQ,MAAM,QAAQ;AAAA,IACpD;AACA,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASQ,uBACN,QACA,MACA,UACA;AACA,UAAM,aAAa,YAAY;AAC/B,UAAM,cAAc,oBAAoB,WAAW,MAAM,QAAQ,IAAI,CAAC;AACtE,SAAK,+BAA+B,QAAQ,MAAM,WAAW;AAAA,EAC/D;AACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAzlBE,cAZmB,cAYZ,MAAK,CAAC,cAA+B,KAAa,QACvD,IAAI,aAAY,cAAc,KAAK,GAAG;AAb1C,IAAqB,cAArB;;;ACIA,IAAqB,iBAArB,MAAqB,uBAAsB,SAAS;AAAA,EAmB1C,YACN,aACA,KACA,KACA;AACA,UAAM,aAAa,KAAK,GAAG;AAP7B;AAAA,wBAAS;AASP,aAAS,aAAa,eAAe,CAAC,CAAC,wBAAgB,gBAAgB,CAAC,CAAC;AAEzE,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,aAAuB;AACrB,UAAM,aAAa,KAAK,UAAU,WAAW;AAE7C,UAAM,UAAU,IAAI,MAAc,WAAW,MAAM;AACnD,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,EAAE,SAAS,MAAM,IAAI,WAAW,GAAG;AACzC,cAAQ,GAAG,KAAK,WAAW,OAAO,WAAW;AAAA,IAC/C;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,cAAwB;AACtB,UAAMC,UAAS,KAAK,UAAU,UAAU;AAExC,UAAM,WAAW,IAAI,MAAcA,QAAO,MAAM;AAChD,aAAS,MAAM,GAAG,MAAMA,QAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,eAAS,GAAG,IAAIA,QAAO,GAAG,EAAE,WAAW;AAAA,IACzC;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiCA,WAAW,SAAmB;AAC5B,aAAS,SAAS,WAAW,CAAC,KAAK,CAAC;AAEpC,SAAK,YAAY;AACjB,UAAM,gBAAgB,IAAI,MAA+B,QAAQ,MAAM;AACvE,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,oBAAc,GAAG,IAAI,EAAE,OAAO,qBAAa,SAAS,QAAQ,GAAG,CAAC,EAAE;AAAA,IACpE;AACA,SAAK,UAAU,WAAW,aAAa;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,WAAW,SAA4B;AACrC,aAAS,SAAS,WAAW,CAAC,UAAU,KAAK,CAAC;AAE9C,SAAK,YAAY;AAEjB,UAAM,aAAa,MAAM,QAAQ,OAAO,IAAI,UAAU,CAAC,OAAO;AAE9D,UAAM,kBAGA,KAAK,UAAU,WAAW;AAEhC,UAAM,aAAa,IAAI,MAA+B,WAAW,MAAM;AACvE,aAAS,MAAM,GAAG,MAAM,WAAW,QAAQ,MAAM,KAAK,OAAO;AAC3D,iBAAW,GAAG,IAAI,EAAE,OAAO,qBAAa,SAAS,WAAW,GAAG,CAAC,EAAE;AAAA,IACpE;AAEA,SAAK,UAAU,WAAW,gBAAgB,OAAO,UAAU,CAAC;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,OAAO,SAA4B,QAAQ,OAAO;AAChD,aAAS,SAAS,WAAW,CAAC,UAAU,KAAK,CAAC;AAC9C,aAAS,OAAO,SAAS,CAAC,SAAS,CAAC;AAEpC,UAAM,aAAa,MAAM,QAAQ,OAAO,IAAI,UAAU,CAAC,OAAO;AAE9D,UAAM,eAAe,KAAK,WAAW;AACrC,mBAAe,YAAY,UAAU,YAAY;AAEjD,SAAK,YAAY;AAEjB,QAAI,WAAW,SAAS,KAAM,WAAW,WAAW,KAAK,OAAQ;AAC/D,WAAK,kBAAkB;AAAA,IACzB;AAEA,UAAMA,UAAS,IAAI,MAAoB,WAAW,MAAM;AACxD,aAAS,MAAM,GAAG,MAAM,WAAW,QAAQ,MAAM,KAAK,OAAO;AAC3D,MAAAA,QAAO,GAAG,IAAI,qBAAa,SAAS,WAAW,GAAG,CAAC;AAAA,IACrD;AAEA,QAAI,OAAO;AACT,YAAM,iBAAiB,KAAK,UAAU,UAAU;AAChD,WAAK,UAAU,UAAU,eAAe,OAAOA,OAAM,CAAC;AAAA,IACxD,OAAO;AACL,WAAK,UAAU,UAAUA,OAAM;AAAA,IACjC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,QAAQ;AACN,SAAK,YAAY;AACjB,SAAK,UAAU,UAAU,CAAC,CAAC;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiCA,YAAY,UAAkB;AAC5B,mBAAe,UAAU,UAAU;AACnC,SAAK,UAAU,YAAY,QAAQ;AACnC,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,WAAoB;AAClB,WAAO,KAAK,UAAU,QAAQ,gBAAgB,IAAI;AAAA,EACpD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,gBAAgB;AACd,SAAK,UAAU,UAAU,gBAAgB,MAAM,IAAI;AAAA,EACrD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,iBAAiB;AACf,SAAK,UAAU,UAAU,gBAAgB,MAAM,KAAK;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,gBAAyB;AACvB,WAAO,KAAK,UAAU,QAAQ,gBAAgB,WAAW;AAAA,EAC3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,oBAAoB;AAClB,SAAK,UAAU,UAAU,gBAAgB,aAAa,IAAI;AAAA,EAC5D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,qBAAqB;AACnB,SAAK,UAAU,UAAU,gBAAgB,aAAa,KAAK;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,kBAA2B;AACzB,WAAO,KAAK,UAAU,QAAQ,gBAAgB,iBAAiB;AAAA,EACjE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,sBAAsB;AACpB,SAAK,UAAU,UAAU,gBAAgB,mBAAmB,IAAI;AAAA,EAClE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,uBAAuB;AACrB,SAAK,UAAU,UAAU,gBAAgB,mBAAmB,KAAK;AAAA,EACnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA8BA,UAAU,MAAe,SAAkC;AACzD,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,iCAA6B,OAAO;AAEpC,QAAI,CAAC,QAAS,WAAU,CAAC;AAEzB,QAAI,EAAE,eAAe,SAAU,SAAQ,YAAY,IAAI,GAAG,GAAG,CAAC;AAC9D,QAAI,EAAE,qBAAqB,SAAU,SAAQ,kBAAkB,IAAI,GAAG,GAAG,CAAC;AAC1E,QAAI,EAAE,iBAAiB,SAAU,SAAQ,cAAc,IAAI,GAAG,GAAG,CAAC;AAClE,QAAI,EAAE,iBAAiB,SAAU,SAAQ,cAAc;AAGvD,UAAM,SAAS,KAAK,aAAa;AAAA,MAC/B,GAAG,QAAQ,KAAK;AAAA,MAChB,GAAG,QAAQ,KAAK;AAAA,MAChB,OAAO,QAAQ,SAAS;AAAA,MACxB,QAAQ,QAAQ,UAAU;AAAA,MAC1B,WAAW,QAAQ;AAAA,MACnB,iBAAiB,QAAQ;AAAA,MACzB,aAAa,QAAQ;AAAA,MACrB,aAAa,QAAQ,eAAe;AAAA,MACpC,QAAQ,QAAQ,UAAU,QAAQ,CAAC;AAAA,MACnC,QAAQ,QAAQ;AAAA,MAChB,MAAM,KAAK;AAAA,IACb,CAAC;AACD,UAAM,YAAY,KAAK,IAAI,QAAQ,SAAS,OAAO,IAAI;AAGvD,SAAK,UAAU,UAAU,SAAS;AAGlC,UAAM,OAAO,QAAQ,QAAQ,KAAK,IAAI,QAAQ,EAAE,eAAe;AAC/D,SAAK,uBAAuB,QAAQ,IAAI;AAGxC,SAAK,KAAK,SAAS,SAAS;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,yBAAkC;AAChC,QAAI,KAAK,QAAQ,EAAG,QAAO;AAE3B,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,YAAM,iBACJ,OAAO,eAAe,GAAG,kBAAkB;AAC7C,UAAI,CAAC,eAAgB,QAAO;AAAA,IAC9B;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,yBAAyB,MAAe;AACtC,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,SAAK,kBAAkB,IAAI;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,kBACE,MACA,UACA;AACA,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,sBAAkB,UAAU,YAAY,CAAC,QAAQ,CAAC;AAElD,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,WAAK,uBAAuB,QAAQ,MAAM,QAAQ;AAAA,IACpD;AACA,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASQ,uBACN,QACA,MACA,UACA;AACA,UAAM,aAAa,YAAY;AAC/B,UAAM,cAAc,oBAAoB,WAAW,MAAM,QAAQ,IAAI,CAAC;AACtE,SAAK,+BAA+B,QAAQ,MAAM,WAAW;AAAA,EAC/D;AACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAngBE,cAbmB,gBAaZ,MAAK,CAAC,aAA6B,KAAa,QACrD,IAAI,eAAc,aAAa,KAAK,GAAG;AAd3C,IAAqB,gBAArB;;;ACAA,IAAqB,iBAArB,MAAqB,uBAAsB,SAAS;AAAA,EAuB1C,YACN,iBACA,KACA,KACA;AACA,UAAM,iBAAiB,KAAK,GAAG;AAPjC;AAAA,wBAAS;AASP,aAAS,iBAAiB,mBAAmB;AAAA,MAC3C,CAAC,4BAAoB,oBAAoB;AAAA,IAC3C,CAAC;AAED,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,aAAuB;AACrB,UAAM,eAAe,KAAK,UAAU,gBAAgB;AACpD,QAAI,cAAc;AAChB,YAAM,gBAAgB,IAAI,MAAc,aAAa,MAAM;AAC3D,eAAS,MAAM,GAAG,MAAM,aAAa,QAAQ,MAAM,KAAK,OAAO;AAC7D,sBAAc,GAAG,IAAI,aAAa,GAAG,EAAE,WAAW;AAAA,MACpD;AACA,aAAO;AAAA,IACT;AAEA,UAAM,WAAW,KAAK,UAAU,YAAY;AAC5C,UAAM,YAAY,IAAI,MAAc,SAAS,MAAM;AACnD,aAAS,MAAM,GAAG,MAAM,UAAU,QAAQ,MAAM,KAAK,OAAO;AAC1D,gBAAU,GAAG,IAAI,SAAS,GAAG,EAAE,WAAW;AAAA,IAC5C;AACA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,cAAkC;AAChC,UAAM,QAAQ,KAAK,UAAU,SAAS;AACtC,QAAI,UAAU,gBAAQ,GAAG,KAAK,EAAG,QAAO;AACxC,UAAM,eAAe,KAAK,UAAU,gBAAgB;AACpD,QAAI,cAAc;AAChB,YAAM,WAAW,KAAK,UAAU,YAAY;AAC5C,eAAS,MAAM,GAAG,MAAM,SAAS,QAAQ,MAAM,KAAK,OAAO;AACzD,YAAI,SAAS,GAAG,MAAM,MAAO,QAAO,aAAa,GAAG,EAAE,WAAW;AAAA,MACnE;AAAA,IACF;AACA,WAAO,MAAM,WAAW;AAAA,EAC1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkDA,OAAO,QAAgB;AACrB,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AAErC,UAAM,eAAe,KAAK,WAAW;AACrC,kBAAc,QAAQ,UAAU,YAAY;AAE5C,SAAK,YAAY;AAEjB,UAAM,WAAW,KAAK,UAAU,YAAY;AAC5C,UAAM,eAAe,KAAK,UAAU,gBAAgB;AACpD,QAAI,cAAc;AAChB,eAAS,MAAM,GAAG,MAAM,aAAa,QAAQ,MAAM,KAAK,OAAO;AAC7D,YAAI,aAAa,GAAG,EAAE,WAAW,MAAM,QAAQ;AAC7C,eAAK,UAAU,SAAS,SAAS,GAAG,CAAC;AAAA,QACvC;AAAA,MACF;AAAA,IACF,OAAO;AACL,eAAS,MAAM,GAAG,MAAM,SAAS,QAAQ,MAAM,KAAK,OAAO;AACzD,cAAM,QAAQ,SAAS,GAAG;AAC1B,YAAI,MAAM,WAAW,MAAM,OAAQ,MAAK,UAAU,SAAS,KAAK;AAAA,MAClE;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,QAAQ;AACN,SAAK,YAAY;AACjB,SAAK,UAAU,SAAS,gBAAQ,GAAG,KAAK,CAAC;AAAA,EAC3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,kBAAkB;AAChB,WAAO,CAAC,KAAK,UAAU,QAAQ,gBAAgB,aAAa;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,oBAAoB;AAClB,SAAK,UAAU,UAAU,gBAAgB,eAAe,KAAK;AAAA,EAC/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,qBAAqB;AACnB,SAAK,UAAU,UAAU,gBAAgB,eAAe,IAAI;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiBA,sBAAsB;AACpB,WAAO,CAAC,KAAK,UAAU,QAAQ,gBAAgB,cAAc;AAAA,EAC/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,wBAAwB;AACtB,SAAK,UAAU,UAAU,gBAAgB,gBAAgB,KAAK;AAAA,EAChE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,yBAAyB;AACvB,SAAK,UAAU,UAAU,gBAAgB,gBAAgB,IAAI;AAAA,EAC/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA6BA,gBACE,QACA,MACA,SACA;AACA,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AACrC,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,iCAA6B,OAAO;AAGpC,UAAM,SAAS,KAAK,aAAa;AAAA,MAC/B,GAAG,SAAS,KAAK;AAAA,MACjB,GAAG,SAAS,KAAK;AAAA,MACjB,OAAO,SAAS,SAAS;AAAA,MACzB,QAAQ,SAAS,UAAU;AAAA,MAC3B,WAAW,SAAS,aAAa,IAAI,GAAG,GAAG,CAAC;AAAA,MAC5C,iBAAiB,SAAS,mBAAmB,IAAI,GAAG,GAAG,CAAC;AAAA,MACxD,aAAa,SAAS,eAAe,IAAI,GAAG,GAAG,CAAC;AAAA,MAChD,aAAa,SAAS,eAAe;AAAA,MACrC,QAAQ,SAAS,UAAU,QAAQ,CAAC;AAAA,MACpC,QAAQ,SAAS;AAAA,MACjB,MAAM,KAAK;AAAA,IACb,CAAC;AACD,UAAM,YAAY,KAAK,IAAI,QAAQ,SAAS,OAAO,IAAI;AAGvD,UAAM,eAAe,KAAK,UAAU;AAAA,MAClC;AAAA,MACA,qBAAa,SAAS,MAAM;AAAA,MAC5B,CAAC,KAAK,oBAAoB;AAAA,IAC5B;AAGA,WAAO,mBAAmB,gBAAQ,GAAG,KAAK,CAAC;AAC3C,SAAK,uBAAuB,QAAQ,YAAY;AAGhD,SAAK,KAAK,SAAS,SAAS;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,yBAAkC;AAChC,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,YAAM,QAAQ,OAAO,mBAAmB;AACxC,YAAM,SAAS,OAAO,eAAe,GAAG;AAExC,UAAI,EAAE,kBAAkB,iBAAU,QAAO;AACzC,UAAI,SAAS,CAAC,OAAO,IAAI,KAAK,EAAG,QAAO;AAAA,IAC1C;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,2BAA2B;AACzB,SAAK,kBAAkB;AAAA,EACzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAyBA,kBAAkB,UAAiD;AACjE,sBAAkB,UAAU,YAAY,CAAC,QAAQ,CAAC;AAElD,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,YAAM,UAAU,OAAO,WAAW;AAClC,UAAI,CAAC,QAAS;AACd,WAAK,uBAAuB,QAAQ,SAAS,QAAQ;AAAA,IACvD;AAAA,EACF;AAAA,EAEQ,uBACN,QACA,SACA,UACA;AACA,UAAM,aAAa,YAAY;AAC/B,UAAM,cAAc,oBAAoB,WAAW,MAAM,MAAM,CAAC;AAChE,SAAK,4BAA4B,QAAQ,SAAS,WAAW;AAAA,EAC/D;AACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA9ZE,cAdmB,gBAcZ,MAAK,CACV,iBACA,KACA,QACG,IAAI,eAAc,iBAAiB,KAAK,GAAG;AAlBlD,IAAqB,gBAArB;;;AC7BA,IAAqB,gBAArB,MAAqB,sBAAqB,SAAS;AAAA,EAsBzC,YACN,eACA,KACA,KACA;AACA,UAAM,eAAe,KAAK,GAAG;AAP/B;AAAA,wBAAS;AASP,aAAS,eAAe,iBAAiB;AAAA,MACvC,CAAC,0BAAkB,kBAAkB;AAAA,IACvC,CAAC;AAED,SAAK,YAAY;AAAA,EACnB;AAAA,EAEA,yBAAyB;AACvB,WAAO;AAAA,EACT;AACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA1BE,cAbmB,eAaZ,MAAK,CACV,eACA,KACA,QACG,IAAI,cAAa,eAAe,KAAK,GAAG;AAjB/C,IAAqB,eAArB;;;ACmCA,IAAqB,gBAArB,MAAqB,sBAAqB,SAAS;AAAA,EAkBzC,YAAY,UAAuB,KAAa,KAAkB;AACxE,UAAM,UAAU,KAAK,GAAG;AAH1B;AAAA,wBAAS;AAKP,aAAS,UAAU,YAAY,CAAC,CAAC,qBAAa,aAAa,CAAC,CAAC;AAE7D,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA8BA,UAA8B;AAC5B,UAAM,QAAQ,KAAK,UAAU,SAAS;AACtC,QAAI,CAAC,SAAS,KAAK,gBAAgB,GAAG;AACpC,YAAM,IAAI,uBAAuB,KAAK,QAAQ,CAAC;AAAA,IACjD;AACA,WAAO,OAAO,WAAW;AAAA,EAC3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAwCA,QAAQ,MAA0B;AAChC,sBAAkB,MAAM,QAAQ,CAAC,QAAQ,CAAC;AAE1C,UAAM,YAAY,KAAK,aAAa;AACpC,QAAI,cAAc,UAAa,QAAQ,KAAK,SAAS,WAAW;AAC9D,YAAM,IAAI,uBAAuB,KAAK,QAAQ,WAAW,KAAK,QAAQ,CAAC;AAAA,IACzE;AAEA,SAAK,YAAY;AACjB,SAAK,sBAAsB;AAE3B,QAAI,MAAM;AACR,WAAK,UAAU,SAAS,qBAAa,SAAS,IAAI,CAAC;AAAA,IACrD,OAAO;AACL,WAAK,UAAU,YAAY;AAAA,IAC7B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,eAA8B;AAC5B,UAAM,WAAW,KAAK,UAAU,YAAY;AAG5C,WACE,aAAa,mBACT,aAAa,qBACX,aAAa;AAAA,EAGvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBA,aAAa,WAA0B;AACrC,kBAAc,WAAW,aAAa,aAAa;AACnD,SAAK,YAAY;AACjB,SAAK,UAAU,YAAY,SAAS;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,eAAmC;AACjC,WAAO,KAAK,UAAU,aAAa;AAAA,EACrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAqBA,aAAa,WAAoB;AAC/B,2BAAuB,WAAW,aAAa,GAAG,OAAO,gBAAgB;AAEzE,SAAK,YAAY;AAEjB,QAAI,cAAc,QAAW;AAC3B,WAAK,UAAU,gBAAgB;AAAA,IACjC,OAAO;AACL,YAAM,OAAO,KAAK,QAAQ;AAC1B,UAAI,QAAQ,KAAK,SAAS,WAAW;AACnC,cAAM,IAAI,sBAAsB,KAAK,QAAQ,WAAW,KAAK,QAAQ,CAAC;AAAA,MACxE;AACA,WAAK,UAAU,aAAa,SAAS;AAAA,IACvC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,kBAAkB;AAChB,SAAK,YAAY;AACjB,SAAK,UAAU,gBAAgB;AAAA,EACjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,SAAS,OAAiB;AACxB,UAAM,iBAAiB,KAAK,aAAa;AAGzC,UAAM,YACF,qDACI;AAGR,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,YAAM,YAAY,KAAK;AAAA,QACrB;AAAA,QACA;AAAA,QACA;AAAA,MACF;AACA,WAAK,wBAAwB,QAAQ,EAAE,QAAQ,UAAU,CAAC;AAAA,IAC5D;AAEA,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBA,YAAY,UAAkB;AAC5B,mBAAe,UAAU,UAAU;AACnC,SAAK,UAAU,YAAY,QAAQ;AACnC,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,cAAuB;AACrB,WAAO,KAAK,UAAU,QAAQ,cAAc,SAAS;AAAA,EACvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,kBAAkB;AAChB,SAAK,YAAY;AACjB,SAAK,UAAU,UAAU,cAAc,WAAW,IAAI;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,mBAAmB;AACjB,SAAK,YAAY;AACjB,SAAK,UAAU,UAAU,cAAc,WAAW,KAAK;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,aAAsB;AACpB,WAAO,KAAK,UAAU,QAAQ,cAAc,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,iBAAiB;AACf,SAAK,UAAU,UAAU,cAAc,UAAU,IAAI;AAAA,EACvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,kBAAkB;AAChB,SAAK,UAAU,UAAU,cAAc,UAAU,KAAK;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,iBAA0B;AACxB,WAAO,KAAK,UAAU,QAAQ,cAAc,UAAU;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,sBAAsB;AACpB,SAAK,UAAU,UAAU,cAAc,YAAY,IAAI;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,uBAAuB;AACrB,SAAK,UAAU,UAAU,cAAc,YAAY,KAAK;AAAA,EAC1D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,iBAA0B;AACxB,WAAO,CAAC,KAAK,UAAU,QAAQ,cAAc,eAAe;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,sBAAsB;AACpB,SAAK,UAAU,UAAU,cAAc,iBAAiB,KAAK;AAAA,EAC/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,uBAAuB;AACrB,SAAK,UAAU,UAAU,cAAc,iBAAiB,IAAI;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,eAAwB;AACtB,WAAO,CAAC,KAAK,UAAU,QAAQ,cAAc,WAAW;AAAA,EAC1D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,kBAAkB;AAChB,SAAK,UAAU,UAAU,cAAc,aAAa,KAAK;AAAA,EAC3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,mBAAmB;AACjB,SAAK,UAAU,UAAU,cAAc,aAAa,IAAI;AAAA,EAC1D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAqBA,WAAoB;AAClB,WACE,KAAK,UAAU,QAAQ,cAAc,IAAI,KACzC,CAAC,KAAK,YAAY,KAClB,CAAC,KAAK,WAAW,KACjB,CAAC,KAAK,eAAe,KACrB,KAAK,aAAa,MAAM;AAAA,EAE5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAuBA,gBAAgB;AACd,QAAI,KAAK,aAAa,MAAM,QAAW;AACrC,YAAM,MAAM;AACZ,cAAQ,KAAK,GAAG;AAAA,IAClB;AAEA,SAAK,YAAY;AAEjB,SAAK,iBAAiB;AACtB,SAAK,gBAAgB;AACrB,SAAK,qBAAqB;AAE1B,SAAK,UAAU,UAAU,cAAc,MAAM,IAAI;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,iBAAiB;AACf,SAAK,YAAY;AACjB,SAAK,UAAU,UAAU,cAAc,MAAM,KAAK;AAAA,EACpD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,kBAA2B;AACzB,WAAO,KAAK,UAAU,QAAQ,cAAc,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,uBAAuB;AACrB,SAAK,UAAU,UAAU,cAAc,UAAU,IAAI;AAAA,EACvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,wBAAwB;AACtB,SAAK,UAAU,UAAU,cAAc,UAAU,KAAK;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA6BA,UAAU,MAAe,SAAkC;AACzD,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,iCAA6B,OAAO;AAEpC,QAAI,CAAC,QAAS,WAAU,CAAC;AAEzB,QAAI,EAAE,eAAe,SAAU,SAAQ,YAAY,IAAI,GAAG,GAAG,CAAC;AAC9D,QAAI,EAAE,qBAAqB,SAAU,SAAQ,kBAAkB,IAAI,GAAG,GAAG,CAAC;AAC1E,QAAI,EAAE,iBAAiB,SAAU,SAAQ,cAAc,IAAI,GAAG,GAAG,CAAC;AAClE,QAAI,EAAE,iBAAiB,SAAU,SAAQ,cAAc;AAGvD,UAAM,SAAS,KAAK,aAAa;AAAA,MAC/B,GAAG,QAAQ,KAAK;AAAA,MAChB,GAAG,QAAQ,KAAK;AAAA,MAChB,OAAO,QAAQ,SAAS;AAAA,MACxB,QAAQ,QAAQ,UAAU;AAAA,MAC1B,WAAW,QAAQ;AAAA,MACnB,iBAAiB,QAAQ;AAAA,MACzB,aAAa,QAAQ;AAAA,MACrB,aAAa,QAAQ,eAAe;AAAA,MACpC,QAAQ,QAAQ,UAAU,QAAQ,CAAC;AAAA,MACnC,QAAQ,QAAQ;AAAA,MAChB,MAAM,KAAK;AAAA,IACb,CAAC;AACD,UAAM,YAAY,KAAK,IAAI,QAAQ,SAAS,OAAO,IAAI;AAGvD,SAAK,UAAU,UAAU,SAAS;AAGlC,UAAM,OAAO,QAAQ,QAAQ,KAAK,IAAI,QAAQ,EAAE,eAAe;AAC/D,SAAK,uBAAuB,QAAQ,IAAI;AAGxC,SAAK,KAAK,SAAS,SAAS;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,yBAAkC;AAChC,QAAI,KAAK,QAAQ,EAAG,QAAO;AAE3B,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,YAAM,iBACJ,OAAO,eAAe,GAAG,kBAAkB;AAC7C,UAAI,CAAC,eAAgB,QAAO;AAAA,IAC9B;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,yBAAyB,MAAe;AACtC,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,SAAK,kBAAkB,IAAI;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,kBACE,MACA,UACA;AACA,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,sBAAkB,UAAU,YAAY,CAAC,QAAQ,CAAC;AAElD,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,WAAK,uBAAuB,QAAQ,MAAM,QAAQ;AAAA,IACpD;AACA,SAAK,YAAY;AAAA,EACnB;AAAA,EAEQ,uBACN,QACA,MACA,UACA;AACA,UAAM,aAAa,YAAY;AAC/B,UAAM,cAAc,oBAAoB,WAAW,MAAM,QAAQ,IAAI,CAAC;AACtE,SAAK,+BAA+B,QAAQ,MAAM,WAAW;AAAA,EAC/D;AACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA7vBE,cAZmB,eAYZ,MAAK,CAAC,UAAuB,KAAa,QAC/C,IAAI,cAAa,UAAU,KAAK,GAAG;AAbvC,IAAqB,eAArB;;;AChDO,IAAK,gBAAL,kBAAKC,mBAAL;AACL,EAAAA,eAAA,aAAU;AACV,EAAAA,eAAA,iBAAc;AACd,EAAAA,eAAA,oBAAiB;AACjB,EAAAA,eAAA,wBAAqB;AACrB,EAAAA,eAAA,eAAY;AACZ,EAAAA,eAAA,mBAAgB;AAChB,EAAAA,eAAA,sBAAmB;AACnB,EAAAA,eAAA,0BAAuB;AACvB,EAAAA,eAAA,gBAAa;AACb,EAAAA,eAAA,oBAAiB;AACjB,EAAAA,eAAA,sBAAmB;AACnB,EAAAA,eAAA,0BAAuB;AACvB,EAAAA,eAAA,YAAS;AACT,EAAAA,eAAA,kBAAe;AAdL,SAAAA;AAAA,GAAA;;;AC2DZ,IAAqB,WAArB,MAAqB,SAAQ;AAAA,EAuBnB,YAAY,UAAuB,KAAkB;AAR7D;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAET,wBAAiB;AACjB,wBAAiB;AAosBjB,wBAAQ,oBAAmB,MACzB,KAAK,IAAI,6CAAyC;AAlsBlD,aAAS,UAAU,YAAY,CAAC,CAAC,qBAAa,aAAa,CAAC,CAAC;AAC7D,aAAS,KAAK,OAAO,CAAC,CAAC,aAAa,aAAa,CAAC,CAAC;AAEnD,SAAK,WAAW;AAChB,SAAK,MAAM;AAEX,SAAK,cAAc,oBAAI,IAAI;AAC3B,SAAK,mBAAmB,cAAM,YAAY,KAAK,gBAAgB;AAAA,EACjE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,SAAkB;AAChB,WAAO,KAAK,SAAS,KAAK,IAAI,gBAAQ,GAAG,KAAK,CAAC;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,YAAkB;AAChB,SAAK,SAAS,KAAK,OAAO,gBAAQ,GAAG,KAAK,CAAC;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,YAAwB;AACtB,UAAM,YAAY,KAAK,SAAS,aAAa;AAE7C,UAAM,SAAqB,CAAC;AAC5B,aAAS,MAAM,GAAG,MAAM,UAAU,QAAQ,MAAM,KAAK,OAAO;AAC1D,YAAM,CAAC,WAAW,GAAG,IAAI,UAAU,GAAG;AACtC,YAAM,QAAQ,kBAAkB,WAAW,KAAK,KAAK,GAAG;AACxD,UAAI,MAAO,QAAO,KAAK,KAAK;AAAA,IAC9B;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,cAAc,MAAoC;AAChD,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,UAAM,SAAS,KAAK,UAAU;AAC9B,aAAS,MAAM,GAAG,MAAM,OAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,YAAM,QAAQ,OAAO,GAAG;AACxB,UAAI,MAAM,QAAQ,MAAM,KAAM,QAAO;AAAA,IACvC;AACA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,SAAS,MAAwB;AAC/B,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,UAAM,QAAQ,KAAK,cAAc,IAAI;AACrC,QAAI,MAAO,QAAO;AAClB,UAAM,IAAI,iBAAiB,IAAI;AAAA,EACjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,UAAU,MAAyB;AACjC,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,UAAM,QAAQ,KAAK,SAAS,IAAI;AAChC,QAAI,iBAAiB,UAAW,QAAO;AACvC,UAAM,IAAI,yBAAyB,MAAM,WAAW,KAAK;AAAA,EAC3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,YAAY,MAA2B;AACrC,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,UAAM,QAAQ,KAAK,SAAS,IAAI;AAChC,QAAI,iBAAiB,YAAa,QAAO;AACzC,UAAM,IAAI,yBAAyB,MAAM,aAAa,KAAK;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,YAAY,MAA2B;AACrC,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,UAAM,QAAQ,KAAK,SAAS,IAAI;AAChC,QAAI,iBAAiB,YAAa,QAAO;AACzC,UAAM,IAAI,yBAAyB,MAAM,aAAa,KAAK;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,cAAc,MAA6B;AACzC,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,UAAM,QAAQ,KAAK,SAAS,IAAI;AAChC,QAAI,iBAAiB,cAAe,QAAO;AAC3C,UAAM,IAAI,yBAAyB,MAAM,eAAe,KAAK;AAAA,EAC/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,cAAc,MAA6B;AACzC,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,UAAM,QAAQ,KAAK,SAAS,IAAI;AAChC,QAAI,iBAAiB,cAAe,QAAO;AAC3C,UAAM,IAAI,yBAAyB,MAAM,eAAe,KAAK;AAAA,EAC/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,aAAa,MAA4B;AACvC,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,UAAM,QAAQ,KAAK,SAAS,IAAI;AAChC,QAAI,iBAAiB,aAAc,QAAO;AAC1C,UAAM,IAAI,yBAAyB,MAAM,cAAc,KAAK;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,aAAa,MAA4B;AACvC,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,UAAM,QAAQ,KAAK,SAAS,IAAI;AAChC,QAAI,iBAAiB,aAAc,QAAO;AAC1C,UAAM,IAAI,yBAAyB,MAAM,cAAc,KAAK;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,aAAa,MAAyB;AACpC,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AAEjC,UAAM,YAAY,eAAe,IAAI;AACrC,UAAM,SAAS,KAAK,yBAAyB,UAAU,WAAW;AAElE,UAAM,SAAS,0BAAkB,OAAO,KAAK,IAAI,OAAO;AACxD,WAAO,eAAe,UAAU,QAAQ;AAExC,qBAAiB,QAAQ,CAAC,QAAQ,OAAO,GAAG,GAAG,UAAU,QAAQ;AAEjE,WAAO,UAAU,GAAG,QAAQ,OAAO,KAAK,KAAK,GAAG;AAAA,EAClD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,eAAe,MAA2B;AACxC,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AAEjC,UAAM,YAAY,eAAe,IAAI;AACrC,UAAM,SAAS,KAAK,yBAAyB,UAAU,WAAW;AAElE,UAAM,WAAW,wBAAgB,OAAO,KAAK,IAAI,OAAO;AACxD,aAAS,eAAe,UAAU,QAAQ;AAE1C,qBAAiB,QAAQ,CAAC,UAAU,SAAS,GAAG,GAAG,UAAU,QAAQ;AAErE,WAAO,YAAY,GAAG,UAAU,SAAS,KAAK,KAAK,GAAG;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,eAAe,MAA2B;AACxC,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AAEjC,UAAM,YAAY,eAAe,IAAI;AACrC,UAAM,SAAS,KAAK,yBAAyB,UAAU,WAAW;AAElE,UAAM,WAAW,wBAAgB,OAAO,KAAK,IAAI,OAAO;AACxD,aAAS,eAAe,UAAU,QAAQ;AAE1C,qBAAiB,QAAQ,CAAC,UAAU,SAAS,GAAG,GAAG,UAAU,QAAQ;AAErE,WAAO,YAAY,GAAG,UAAU,SAAS,KAAK,KAAK,GAAG;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,iBAAiB,MAA6B;AAC5C,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AAEjC,UAAM,YAAY,eAAe,IAAI;AACrC,UAAM,SAAS,KAAK,yBAAyB,UAAU,WAAW;AAElE,UAAM,UAAU,uBAAe,OAAO,KAAK,IAAI,OAAO;AACtD,YAAQ,eAAe,UAAU,QAAQ;AAEzC,qBAAiB,QAAQ,CAAC,SAAS,QAAQ,GAAG,GAAG,UAAU,QAAQ;AAEnE,WAAO,cAAc,GAAG,SAAS,QAAQ,KAAK,KAAK,GAAG;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,iBAAiB,MAA6B;AAC5C,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,UAAM,YAAY,eAAe,IAAI;AAErC,UAAM,SAAS,KAAK,yBAAyB,UAAU,WAAW;AAElE,UAAM,cAAc,2BAAmB,OAAO,KAAK,IAAI,OAAO;AAC9D,gBAAY,eAAe,UAAU,QAAQ;AAE7C;AAAA,MACE;AAAA,MACA,CAAC,aAAa,YAAY,GAAG;AAAA,MAC7B,UAAU;AAAA,IACZ;AAEA,WAAO,cAAc,GAAG,aAAa,YAAY,KAAK,KAAK,GAAG;AAAA,EAChE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,gBAAgB,MAA4B;AAC1C,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,UAAM,YAAY,eAAe,IAAI;AAErC,UAAM,SAAS,KAAK,yBAAyB,UAAU,WAAW;AAElE,UAAM,OAAO,oBAAY,OAAO,KAAK,IAAI,OAAO;AAChD,SAAK,eAAe,UAAU,QAAQ;AAEtC,qBAAiB,QAAQ,CAAC,MAAM,KAAK,GAAG,GAAG,UAAU,QAAQ;AAE7D,WAAO,aAAa,GAAG,MAAM,KAAK,KAAK,KAAK,GAAG;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAuBA,QAAQ,UAA0B,EAAE,wBAAwB,KAAK,GAAG;AAClE,QAAI,QAAQ,wBAAwB;AAClC,WAAK,uBAAuB;AAAA,IAC9B;AAEA,UAAM,SAAS,KAAK,UAAU;AAE9B,aAAS,IAAI,GAAG,YAAY,OAAO,QAAQ,IAAI,WAAW,KAAK;AAC7D,YAAM,QAAQ,OAAO,CAAC;AACtB,YAAM,UAAU,MAAM,UAAU,WAAW;AAE3C,eAAS,IAAI,GAAG,aAAa,QAAQ,QAAQ,IAAI,YAAY,KAAK;AAChE,cAAM,SAAS,QAAQ,CAAC;AACxB,cAAM,OAAO,KAAK,eAAe,MAAM;AACvC,cAAM,YAAY,KAAK,wBAAwB,OAAO,MAAM;AAE5D,cAAM,aAAa,KAAK,KAAK,WAAW,cAAc,SAAS;AAE/D,cAAMC,aAAY,OAAO,aAAa;AACtC,cAAM,YAAY;AAAA,UAChB,kBAAkB;AAAA,UAClB,UAAUA,WAAU,GAAGA,WAAU,CAAC;AAAA,UAClC,GAAG,cAAc,EAAE,GAAGA,YAAW,UAAU,EAAE,CAAC;AAAA,UAC9C,WAAW,UAAU;AAAA,UACrB,iBAAiB;AAAA,QACnB,EAAE,OAAO,OAAO;AAEhB,aAAK,cAAc,GAAG,SAAS;AAAA,MACjC;AAEA,WAAK,YAAY,KAAK;AAAA,IACxB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,YAAY,OAAiB;AAC3B,UAAM,UAAU,MAAM,UAAU,WAAW;AAC3C,UAAM,QAAsB,oBAAI,IAAI;AAEpC,aAAS,IAAI,GAAG,MAAM,QAAQ,QAAQ,IAAI,KAAK,KAAK;AAClD,YAAM,SAAS,QAAQ,CAAC;AACxB,YAAM,YAAY,KAAK,wBAAwB,OAAO,MAAM;AAE5D,YAAM,OAAO,KAAK,eAAe,MAAM;AACvC,YAAM,IAAI,IAAI;AAEd,WAAK,KAAK,YAAY,SAAS;AAAA,IACjC;AAEA,UAAM,QAAQ,CAAC,SAAS,KAAK,KAAK,YAAY,MAAM,GAAG,CAAC;AACxD,SAAK,SAAS,YAAY,MAAM,SAAS;AACzC,UAAM,YAAY,MAAM,UAAU,kBAAkB,EAAE;AACtD,UAAM,YAAY,UAAU,KAAK;AACjC,aAAS,aAAa,GAAG,aAAa,WAAW,cAAc;AAC7D,YAAM,QAAQ,UAAU,IAAI,UAAU;AACtC,UAAI,iBAAiB,gBAAQ;AAC3B,aAAK,IAAI,QAAQ,OAAO,KAAK;AAAA,MAC/B;AAAA,IACF;AACA,SAAK,IAAI,QAAQ,OAAO,MAAM,GAAG;AAAA,EACnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA+BA,uBAAuB,MAAgB;AACrC,sBAAkB,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAEtD,WAAO,QAAQ,KAAK,eAAe;AAEnC,UAAM,SAAS,KAAK,UAAU;AAE9B,aAAS,MAAM,GAAG,MAAM,OAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,YAAM,QAAQ,OAAO,GAAG;AACxB,UAAI,MAAM,uBAAuB,GAAG;AAClC,cAAM,yBAAyB,IAAI;AAAA,MACrC;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,iBAAiB,UAAkB;AACjC,sBAAkB,UAAU,YAAY,CAAC,CAAC,gBAAQ,QAAQ,CAAC,CAAC;AAC5D,SAAK,YAAY,IAAI,QAAQ;AAAA,EAC/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,iBAAiB,UAAkB;AACjC,sBAAkB,UAAU,YAAY,CAAC,CAAC,gBAAQ,QAAQ,CAAC,CAAC;AAC5D,SAAK,YAAY,OAAO,QAAQ;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,aAAa,UAA2B;AACtC,sBAAkB,UAAU,YAAY,CAAC,CAAC,gBAAQ,QAAQ,CAAC,CAAC;AAC5D,WAAO,KAAK,YAAY,IAAI,QAAQ;AAAA,EACtC;AAAA,EAEA,iBAAiB;AACf,WAAO,KAAK,iBAAiB,OAAO;AAAA,EACtC;AAAA,EAEQ,eAAe,QAAsC;AAC3D,UAAM,UAAU,OAAO,EAAE;AACzB,QAAI,OAAO,KAAK,IAAI,SAAS,EAAE,KAAK,CAAC,MAAM,EAAE,QAAQ,OAAO;AAC5D,QAAI,SAAS,QAAW;AACtB,YAAM,YAAY,KAAK,IAAI,QAAQ,aAAa,OAAO,IAAI;AAC3D,UAAI,cAAc,QAAW;AAC3B,cAAM,IAAI,MAAM,qCAAqC;AAAA,MACvD;AAEA,aAAO,KAAK,IAAI,yBAAyB,SAAS;AAElD,UAAI,SAAS,QAAW;AACtB,cAAM,IAAI,MAAM,kCAAkC,SAAS,EAAE;AAAA,MAC/D;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,EAEQ,wBACN,OACA,QACQ;AACR,QAAI,YAAY,OAAO,oBAAoB;AAE3C,QACE,qBAAqB,oBACpB,iBAAiB,eAAe,iBAAiB,gBAClD;AACA,YAAM,QAAQ,MAAM,UAAU,SAAS;AACvC,YAAM,MAAM,UAAU,IAAI,KAAK,KAAK,UAAU,IAAI,gBAAQ,GAAG,KAAK,CAAC;AAEnE,UAAI,eAAe,gBAAQ;AACzB,oBAAY;AAAA,MACd;AAAA,IACF;AAEA,QAAI,EAAE,qBAAqB,iBAAS;AAClC,YAAM,OAAO,MAAM,QAAQ;AAC3B,YAAM,IAAI,MAAM,yCAAyC,IAAI,EAAE;AAAA,IACjE;AAEA,WAAO;AAAA,EACT;AAAA,EAEQ,yBAAyB,cAAwB;AACvD,QAAI,cAA4D;AAAA,MAC9D,KAAK;AAAA,IACP;AACA,aAAS,MAAM,GAAG,MAAM,aAAa,QAAQ,MAAM,KAAK,OAAO;AAC7D,YAAM,WAAW,aAAa,GAAG;AACjC,UAAI,CAAC,SAAU,OAAM,IAAI,0BAA0B,QAAQ;AAC3D,YAAM,CAAC,QAAQ,SAAS,IAAI;AAC5B,YAAM,MAAM,KAAK,gBAAgB,UAAU,MAAM;AAEjD,UAAI,KAAK;AACP,sBAAc;AAAA,MAChB,OAAO;AACL,cAAM,OAAO,2BAAmB,OAAO,KAAK,IAAI,OAAO;AACvD,aAAK,eAAe,QAAQ;AAC5B,aAAK,UAAU,SAAS;AACxB,cAAM,UAAU,KAAK,IAAI,QAAQ,SAAS,KAAK,IAAI;AACnD,eAAO,SAAS,OAAO;AACvB,sBAAc,CAAC,MAAM,OAAO;AAAA,MAC9B;AAAA,IACF;AACA,WAAO;AAAA,EACT;AAAA,EAEQ,gBACN,aACA,QAC0C;AAC1C,UAAM,SACJ,kBAAkB,sBACd,KAAK,SAAS,UAAU,IACxB,oBAAoB,OAAO,KAAK,CAAC;AAEvC,aAAS,MAAM,GAAG,MAAM,OAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,YAAM,CAAC,OAAO,GAAG,IAAI,OAAO,GAAG;AAC/B,UAAI,MAAM,eAAe,MAAM,aAAa;AAC1C,YAAI,iBAAiB,2BAAoB,QAAO,CAAC,OAAO,GAAG;AAC3D,cAAM,IAAI,wBAAwB,WAAW;AAAA,MAC/C;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAIF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAhtBE,cAXmB,UAWZ,MAAK,CAAC,UAAuB,QAClC,IAAI,SAAQ,UAAU,GAAG;AAZ7B,IAAqB,UAArB;AA6tBA,IAAM,oBAAoB,CACxB,OACA,KACA,QACyB;AACzB,MAAI,iBAAiB,0BAAmB,QAAO,UAAU,GAAG,OAAO,KAAK,GAAG;AAC3E,MAAI,iBAAiB,wBAAiB,QAAO,YAAY,GAAG,OAAO,KAAK,GAAG;AAC3E,MAAI,iBAAiB,wBAAiB,QAAO,YAAY,GAAG,OAAO,KAAK,GAAG;AAC3E,MAAI,iBAAiB,uBAAgB,QAAO,cAAc,GAAG,OAAO,KAAK,GAAG;AAC5E,MAAI,iBAAiB,oBAAa,QAAO,aAAa,GAAG,OAAO,KAAK,GAAG;AACxE,MAAI,iBAAiB,4BAAoB;AACvC,WAAO,cAAc,GAAG,OAAO,KAAK,GAAG;AAAA,EACzC;AACA,MAAI,iBAAiB,0BAAkB;AACrC,WAAO,aAAa,GAAG,OAAO,KAAK,GAAG;AAAA,EACxC;AACA,SAAO;AACT;AAEA,IAAM,iBAAiB,CAAC,uBAA+B;AACrD,MAAI,mBAAmB,WAAW,GAAG;AACnC,UAAM,IAAI,MAAM,2CAA2C;AAAA,EAC7D;AAEA,QAAM,QAAQ,mBAAmB,MAAM,GAAG;AAE1C,WAAS,MAAM,GAAG,MAAM,MAAM,QAAQ,MAAM,KAAK,OAAO;AACtD,QAAI,MAAM,GAAG,MAAM,IAAI;AACrB,YAAM,IAAI;AAAA,QACR,4EAA4E,kBAAkB;AAAA,MAChG;AAAA,IACF;AAAA,EACF;AAEA,MAAI,MAAM,WAAW,EAAG,QAAO,EAAE,aAAa,CAAC,GAAG,UAAU,MAAM,CAAC,EAAE;AAErE,SAAO;AAAA,IACL,aAAa,MAAM,MAAM,GAAG,MAAM,SAAS,CAAC;AAAA,IAC5C,UAAU,MAAM,MAAM,SAAS,CAAC;AAAA,EAClC;AACF;AAEA,IAAM,mBAAmB,CACvB,CAAC,QAAQ,SAAS,GAClB,CAAC,OAAO,QAAQ,GAChB,gBACG;AACH,QAAM,UAAU,OAAO,kBAAkB;AACzC,QAAM,SAAS;AAAA,IACb,UAAU,UAAU,QAAQ,OAAO,QAAQ;AAAA,EAC7C;AACA,WAAS,MAAM,GAAG,MAAM,OAAO,QAAQ,MAAM,KAAK,OAAO;AACvD,QAAI,OAAO,GAAG,EAAE,CAAC,EAAE,eAAe,MAAM,aAAa;AACnD,YAAM,IAAI,wBAAwB,WAAW;AAAA,IAC/C;AAAA,EACF;AACA,SAAO,SAAS,QAAQ;AACxB,QAAM,UAAU,SAAS;AAC3B;;;ACl1BO,IAAM,YAAY;AAAA,EACvB,OAAO,CAAC,SAAS,OAAO;AAAA,EACxB,OAAO,CAAC,SAAS,OAAO;AAAA,EACxB,IAAI,CAAC,SAAS,OAAO;AAAA,EACrB,IAAI,CAAC,SAAS,OAAO;AAAA,EACrB,IAAI,CAAC,SAAS,OAAO;AAAA,EACrB,IAAI,CAAC,QAAQ,OAAO;AAAA,EACpB,IAAI,CAAC,QAAQ,MAAM;AAAA,EACnB,IAAI,CAAC,QAAQ,MAAM;AAAA,EACnB,IAAI,CAAC,QAAQ,MAAM;AAAA,EACnB,IAAI,CAAC,QAAQ,MAAM;AAAA,EACnB,IAAI,CAAC,OAAO,MAAM;AAAA,EAClB,IAAI,CAAC,QAAQ,KAAK;AAAA,EAClB,KAAK,CAAC,MAAM,MAAM;AAAA,EAClB,IAAI,CAAC,SAAS,OAAO;AAAA,EACrB,IAAI,CAAC,SAAS,OAAO;AAAA,EACrB,IAAI,CAAC,SAAS,OAAO;AAAA,EACrB,IAAI,CAAC,SAAS,OAAO;AAAA,EACrB,IAAI,CAAC,QAAQ,OAAO;AAAA,EACpB,IAAI,CAAC,OAAO,MAAM;AAAA,EAClB,IAAI,CAAC,QAAQ,KAAK;AAAA,EAClB,IAAI,CAAC,QAAQ,MAAM;AAAA,EACnB,IAAI,CAAC,QAAQ,MAAM;AAAA,EACnB,IAAI,CAAC,QAAQ,MAAM;AAAA,EACnB,KAAK,CAAC,OAAO,MAAM;AAAA,EACnB,IAAI,CAAC,SAAS,OAAO;AAAA,EACrB,IAAI,CAAC,SAAS,OAAO;AAAA,EACrB,IAAI,CAAC,SAAS,OAAO;AAAA,EACrB,IAAI,CAAC,QAAQ,OAAO;AAAA,EACpB,IAAI,CAAC,QAAQ,MAAM;AAAA,EACnB,IAAI,CAAC,QAAQ,MAAM;AAAA,EACnB,IAAI,CAAC,QAAQ,MAAM;AAAA,EACnB,IAAI,CAAC,QAAQ,MAAM;AAAA,EACnB,IAAI,CAAC,QAAQ,MAAM;AAAA,EACnB,IAAI,CAAC,QAAQ,MAAM;AAAA,EACnB,KAAK,CAAC,OAAO,MAAM;AAAA,EACnB,KAAK,CAAC,QAAQ,OAAO;AAAA,EACrB,KAAK,CAAC,SAAS,MAAM;AAAA,EACrB,KAAK,CAAC,QAAQ,OAAO;AAAA,EACrB,KAAK,CAAC,QAAQ,MAAM;AAAA,EACpB,KAAK,CAAC,QAAQ,MAAM;AAAA,EACpB,MAAM,CAAC,SAAS,OAAO;AAAA,EACvB,MAAM,CAAC,SAAS,OAAO;AAAA,EACvB,MAAM,CAAC,SAAS,OAAO;AAAA,EACvB,MAAM,CAAC,QAAQ,OAAO;AAAA,EACtB,MAAM,CAAC,OAAO,MAAM;AAAA,EACpB,WAAW,CAAC,QAAQ,GAAK;AAAA,EACzB,OAAO,CAAC,KAAO,GAAK;AAAA,EACpB,OAAO,CAAC,KAAO,IAAM;AAAA,EACrB,QAAQ,CAAC,KAAO,GAAK;AAAA,EACrB,SAAS,CAAC,KAAO,IAAM;AACzB;;;AChDO,IAAK,cAAL,kBAAKC,iBAAL;AACL,EAAAA,0BAAA,aAAU,YAAV;AACA,EAAAA,0BAAA,UAAO,QAAP;AACA,EAAAA,0BAAA,YAAS,OAAT;AACA,EAAAA,0BAAA,UAAO,OAAP;AAJU,SAAAA;AAAA,GAAA;;;ACKZ,IAAqB,mBAArB,MAAqB,iBAAsC;AAAA,EAwBjD,YAAY,KAAa,KAAkB,UAAwB;AAR3E;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAET,wBAAQ,mBAAkB;AAC1B,wBAAiB;AAGf,SAAK,MAAM;AACX,SAAK,MAAM;AACX,SAAK,WAAW;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,MAAM,QAAuB;AAC3B,QAAI,CAAC,KAAK,iBAAiB;AACzB,YAAM,MAAM,MAAM,KAAK,SAAS;AAAA,QAC9B,KAAK,IAAI;AAAA,QACT,KAAK;AAAA,MACP;AAEA,UAAI,CAAC,KAAK,IAAI,QAAQ,IAAI,gBAAQ,GAAG,OAAO,CAAC,GAAG;AAC9C,aAAK,IAAI,QAAQ,IAAI,gBAAQ,GAAG,OAAO,GAAG,KAAK,IAAI,QAAQ,IAAI,CAAC,CAAC,CAAC;AAAA,MACpE;AACA,YAAM,QAAQ,KAAK,IAAI,QAAQ,OAAO,gBAAQ,GAAG,OAAO,GAAG,eAAO;AAElE,UAAI,CAAC,MAAM,IAAI,gBAAQ,GAAG,eAAe,CAAC,GAAG;AAC3C,cAAM,IAAI,gBAAQ,GAAG,eAAe,GAAG,KAAK,IAAI,QAAQ,IAAI,CAAC,CAAC,CAAC;AAAA,MACjE;AACA,YAAM,gBAAgB,MAAM,OAAO,gBAAQ,GAAG,eAAe,GAAG,eAAO;AAEvE,UAAI,CAAC,cAAc,IAAI,gBAAQ,GAAG,OAAO,CAAC,GAAG;AAC3C,sBAAc,IAAI,gBAAQ,GAAG,OAAO,GAAG,KAAK,IAAI,QAAQ,IAAI,CAAC,CAAC,CAAC;AAAA,MACjE;AACA,YAAM,UAAU,cAAc,OAAO,gBAAQ,GAAG,OAAO,GAAG,gBAAQ;AAElE,cAAQ,KAAK,qBAAa,SAAS,KAAK,SAAS,QAAQ,CAAC;AAC1D,cAAQ,KAAK,GAAG;AAUhB,UAAI,CAAC,KAAK,IAAI,QAAQ,IAAI,gBAAQ,GAAG,IAAI,CAAC,GAAG;AAC3C,aAAK,IAAI,QAAQ,IAAI,gBAAQ,GAAG,IAAI,GAAG,KAAK,IAAI,QAAQ,IAAI,CAAC,CAAC,CAAC;AAAA,MACjE;AACA,YAAM,KAAK,KAAK,IAAI,QAAQ,OAAO,gBAAQ,GAAG,IAAI,GAAG,gBAAQ;AAC7D,SAAG,KAAK,GAAG;AAEX,WAAK,kBAAkB;AAAA,IACzB;AAAA,EACF;AACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AArEE,cAZmB,kBAYZ,MAAK,CAAC,KAAa,KAAkB,aAC1C,IAAI,iBAAgB,KAAK,KAAK,QAAQ;AAb1C,IAAqB,kBAArB;;;ACAA,IAAqB,iBAArB,MAAqB,eAAoC;AAAA,EAwB/C,YACN,KACA,KACA,UACA;AAZF;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAET,wBAAQ,mBAAkB;AAC1B,wBAAiB;AAOf,SAAK,MAAM;AACX,SAAK,MAAM;AACX,SAAK,WAAW;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,MAAM,QAAuB;AAC3B,QAAI,CAAC,KAAK,iBAAiB;AACzB,YAAM,EAAE,SAAS,QAAQ,IAAI,KAAK;AAElC,YAAM,MAAM,MAAM,KAAK,SAAS;AAAA,QAC9B,KAAK,IAAI;AAAA,QACT,KAAK;AAAA,MACP;AAEA,UAAI,CAAC,QAAQ,IAAI,gBAAQ,GAAG,OAAO,CAAC,GAAG;AACrC,gBAAQ,IAAI,gBAAQ,GAAG,OAAO,GAAG,QAAQ,IAAI,CAAC,CAAC,CAAC;AAAA,MAClD;AACA,YAAM,QAAQ,QAAQ,OAAO,gBAAQ,GAAG,OAAO,GAAG,eAAO;AAEzD,UAAI,CAAC,MAAM,IAAI,gBAAQ,GAAG,YAAY,CAAC,GAAG;AACxC,cAAM,IAAI,gBAAQ,GAAG,YAAY,GAAG,QAAQ,IAAI,CAAC,CAAC,CAAC;AAAA,MACrD;AACA,YAAM,aAAa,MAAM,OAAO,gBAAQ,GAAG,YAAY,GAAG,eAAO;AAEjE,UAAI,CAAC,WAAW,IAAI,gBAAQ,GAAG,OAAO,CAAC,GAAG;AACxC,mBAAW,IAAI,gBAAQ,GAAG,OAAO,GAAG,QAAQ,IAAI,CAAC,CAAC,CAAC;AAAA,MACrD;AACA,YAAM,UAAU,WAAW,OAAO,gBAAQ,GAAG,OAAO,GAAG,gBAAQ;AAE/D,cAAQ,KAAK,qBAAa,SAAS,KAAK,SAAS,UAAU,CAAC;AAC5D,cAAQ,KAAK,GAAG;AAEhB,WAAK,kBAAkB;AAAA,IACzB;AAAA,EACF;AACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA7DE,cAZmB,gBAYZ,MAAK,CAAC,KAAa,KAAkB,aAC1C,IAAI,eAAc,KAAK,KAAK,QAAQ;AAbxC,IAAqB,gBAArB;;;ACJA,IAAM,qBAAN,MAAM,oBAAmB;AAAA,EAQf,YAAY,QAAgB,YAAoB;AAHxD,wBAAiB;AACjB,wBAAS;AAGP,SAAK,SAAS;AACd,SAAK,aAAa;AAAA,EACpB;AAAA,EAVA,OAAO,IAAI,QAAgB,YAAoB;AAC7C,WAAO,IAAI,oBAAmB,QAAQ,UAAU;AAAA,EAClD;AAAA,EAUA,MAAM,iBAAiB,SAAqB,KAA+B;AACzE,UAAM,eAAe,QAAQ,IAAI;AAAA,MAC/B,MAAM;AAAA,MACN,GAAG;AAAA,MACH,IAAI,qBAAa,SAAS,KAAK,MAAM;AAAA,IACvC,CAAC;AAED,QAAI,KAAK;AACP,cAAQ,OAAO,KAAK,YAAY;AAChC,aAAO;AAAA,IACT,OAAO;AACL,aAAO,QAAQ,SAAS,YAAY;AAAA,IACtC;AAAA,EACF;AACF;AAEA,IAAO,6BAAQ;;;ACuCf,IAAqB,cAArB,MAAqB,aAAY;AAAA,EAuHvB,YACN,SACA,kBACA,gBACA;AA1BF;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAGT;AAAA,6CAA8B,CAAC,GAAG;AAElC,wBAAQ;AACR,wBAAQ;AACR,wBAAiB;AACjB,wBAAiB;AACjB,wBAAiB;AACjB,wBAAiB;AACjB,wBAAiB;AACjB,wBAAiB;AACjB,wBAAiB;AACjB,wBAAiB;AAspCjB,wBAAQ,gBAAe,MAAiB;AACtC,YAAM,QAAmB,CAAC;AAC1B,WAAK,QAAQ,MAAM,EAAE,SAAS,CAAC,MAAM,QAAQ;AAC3C,YAAI,gBAAgB,qBAAa;AAC/B,cAAI,OAAO,KAAK,QAAQ,IAAI,IAAI;AAChC,cAAI,CAAC,MAAM;AACT,mBAAO,QAAQ,GAAG,MAAM,KAAK,IAAI;AACjC,iBAAK,QAAQ,IAAI,MAAM,IAAI;AAAA,UAC7B;AACA,gBAAM,KAAK,IAAI;AAAA,QACjB;AAAA,MACF,CAAC;AACD,aAAO;AAAA,IACT;AAEA,wBAAQ,mBAAkB,MAAe;AACvC,YAAM,WAAW,KAAK,QAAQ,oBAAoB;AAClD,aAAO,QAAQ,GAAG,UAAU,IAAI;AAAA,IAClC;AAjqCE,aAAS,SAAS,WAAW,CAAC,CAAC,oBAAY,YAAY,CAAC,CAAC;AACzD,aAAS,kBAAkB,oBAAoB,CAAC,SAAS,CAAC;AAE1D,SAAK,UAAU;AACf,SAAK,UAAU,QAAQ,OAAO,QAAQ,YAAY,IAAI;AACtD,SAAK,cAAc,CAAC,CAAC,QAAQ,OAAO,QAAQ,YAAY,OAAO;AAE/D,SAAK,YAAY,cAAM,YAAY,KAAK,YAAY;AACpD,SAAK,UAAU,oBAAI,IAAI;AACvB,SAAK,YAAY,cAAM,YAAY,KAAK,eAAe;AACvD,SAAK,QAAQ,CAAC;AACd,SAAK,SAAS,CAAC;AACf,SAAK,gBAAgB,CAAC;AACtB,SAAK,gBAAgB,CAAC;AACtB,SAAK,cAAc,CAAC;AAEpB,QAAI,CAAC,oBAAoB,KAAK,YAAa,OAAM,IAAI,kBAAkB;AAEvE,QAAI,eAAgB,MAAK,eAAe;AAAA,EAC1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA1FA,aAAa,KACX,KACA,UAAuB,CAAC,GACxB;AACA,UAAM;AAAA,MACJ,mBAAmB;AAAA,MACnB;AAAA,MACA,uBAAuB;AAAA,MACvB,iBAAiB;AAAA,MACjB,aAAa;AAAA,IACf,IAAI;AAEJ,aAAS,KAAK,OAAO,CAAC,UAAU,YAAY,WAAW,CAAC;AACxD,aAAS,kBAAkB,oBAAoB,CAAC,SAAS,CAAC;AAC1D,aAAS,YAAY,cAAc,CAAC,QAAQ,CAAC;AAC7C,aAAS,sBAAsB,wBAAwB,CAAC,SAAS,CAAC;AAElE,UAAM,QAAQ,aAAa,GAAG;AAC9B,UAAM,UAAU,MAAM,kBAAU;AAAA,MAC9B;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF,EAAE,cAAc;AAChB,WAAO,IAAI,aAAY,SAAS,kBAAkB,cAAc;AAAA,EAClE;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,aAAa,OAAO,UAAyB,CAAC,GAAG;AAC/C,UAAM,EAAE,iBAAiB,KAAK,IAAI;AAElC,UAAM,UAAU,mBAAW,OAAO;AAClC,UAAM,WAAW,oBAAY,YAAY,OAAO;AAChD,UAAM,cAAc,QAAQ,SAAS,QAAQ;AAC7C,UAAM,UAAU,mBAAW,oBAAoB,SAAS,WAAW;AACnE,YAAQ,YAAY,OAAO,QAAQ,SAAS,OAAO;AAEnD,WAAO,IAAI,aAAY,SAAS,OAAO,cAAc;AAAA,EACvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAqEA,gBAAgB,SAAwB;AACtC,SAAK,UAAU;AAAA,EACjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,UAAmB;AACjB,UAAM,OAAO,KAAK,UAAU,OAAO;AACnC,QAAI,KAAK,OAAO,GAAG;AACjB,cAAQ;AAAA,QACN;AAAA,MACF;AACA,WAAK,UAAU;AAAA,IACjB;AACA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,WAA+B;AAC7B,UAAM,QAAQ,KAAK,YAAY,EAAE,OAAO,gBAAQ,KAAK;AACrD,QAAI,CAAC,MAAO,QAAO;AACnB,+BAA2B,KAAK;AAChC,WAAO,MAAM,WAAW;AAAA,EAC1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,YAAgC;AAC9B,UAAM,SAAS,KAAK,YAAY,EAAE,OAAO,gBAAQ,MAAM;AACvD,QAAI,CAAC,OAAQ,QAAO;AACpB,+BAA2B,MAAM;AACjC,WAAO,OAAO,WAAW;AAAA,EAC3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,aAAiC;AAC/B,UAAM,UAAU,KAAK,YAAY,EAAE,OAAO,gBAAQ,OAAO;AACzD,QAAI,CAAC,QAAS,QAAO;AACrB,+BAA2B,OAAO;AAClC,WAAO,QAAQ,WAAW;AAAA,EAC5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,cAAkC;AAChC,UAAM,WAAW,KAAK,YAAY,EAAE,OAAO,gBAAQ,QAAQ;AAC3D,QAAI,CAAC,SAAU,QAAO;AACtB,+BAA2B,QAAQ;AACnC,WAAO,SAAS,WAAW;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,aAAiC;AAC/B,UAAM,UAAU,KAAK,YAAY,EAAE,OAAO,gBAAQ,OAAO;AACzD,QAAI,CAAC,QAAS,QAAO;AACrB,+BAA2B,OAAO;AAClC,WAAO,QAAQ,WAAW;AAAA,EAC5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,cAAkC;AAChC,UAAM,WAAW,KAAK,YAAY,EAAE,OAAO,gBAAQ,QAAQ;AAC3D,QAAI,CAAC,SAAU,QAAO;AACtB,+BAA2B,QAAQ;AACnC,WAAO,SAAS,WAAW;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,kBAAoC;AAClC,UAAM,eAAe,KAAK,YAAY,EAAE,OAAO,gBAAQ,YAAY;AACnE,QAAI,CAAC,aAAc,QAAO;AAC1B,+BAA2B,YAAY;AACvC,WAAO,aAAa,WAAW;AAAA,EACjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,sBAAwC;AACtC,UAAM,mBAAmB,KAAK,YAAY,EAAE,OAAO,gBAAQ,OAAO;AAClE,QAAI,CAAC,iBAAkB,QAAO;AAC9B,+BAA2B,gBAAgB;AAC3C,WAAO,iBAAiB,WAAW;AAAA,EACrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,SAAS,OAAe,SAAiC;AACvD,aAAS,OAAO,SAAS,CAAC,QAAQ,CAAC;AACnC,UAAM,MAAM,gBAAQ,GAAG,OAAO;AAC9B,SAAK,YAAY,EAAE,IAAI,KAAK,qBAAa,SAAS,KAAK,CAAC;AAGxD,QAAI,SAAS,sBAAsB;AACjC,YAAM,QAAQ,KAAK,QAAQ,6BAA6B;AACxD,YAAM,mBAAmB,IAAI;AAAA,IAC/B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,UAAU,QAAsB;AAC9B,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AACrC,UAAM,MAAM,gBAAQ,GAAG,QAAQ;AAC/B,SAAK,YAAY,EAAE,IAAI,KAAK,qBAAa,SAAS,MAAM,CAAC;AAAA,EAC3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,WAAW,SAAuB;AAChC,aAAS,SAAS,UAAU,CAAC,QAAQ,CAAC;AACtC,UAAM,MAAM,gBAAQ,GAAG,SAAS;AAChC,SAAK,YAAY,EAAE,IAAI,KAAK,qBAAa,SAAS,OAAO,CAAC;AAAA,EAC5D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,YAAY,UAA0B;AACpC,aAAS,UAAU,YAAY,CAAC,KAAK,CAAC;AACtC,UAAM,MAAM,gBAAQ,GAAG,UAAU;AACjC,SAAK,YAAY,EAAE,IAAI,KAAK,qBAAa,SAAS,SAAS,KAAK,GAAG,CAAC,CAAC;AAAA,EACvE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,WAAW,SAAuB;AAChC,aAAS,SAAS,WAAW,CAAC,QAAQ,CAAC;AACvC,UAAM,MAAM,gBAAQ,GAAG,SAAS;AAChC,SAAK,YAAY,EAAE,IAAI,KAAK,qBAAa,SAAS,OAAO,CAAC;AAAA,EAC5D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,YAAY,UAAwB;AAClC,aAAS,UAAU,WAAW,CAAC,QAAQ,CAAC;AACxC,UAAM,MAAM,gBAAQ,GAAG,UAAU;AACjC,SAAK,YAAY,EAAE,IAAI,KAAK,qBAAa,SAAS,QAAQ,CAAC;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,YAAY,UAAwB;AAClC,aAAS,UAAU,YAAY,CAAC,QAAQ,CAAC;AACzC,UAAM,MAAM,gBAAQ,GAAG,MAAM;AAC7B,SAAK,QAAQ,IAAI,KAAK,kBAAU,GAAG,QAAQ,CAAC;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,gBAAgB,cAA0B;AACxC,aAAS,cAAc,gBAAgB,CAAC,CAAC,MAAM,MAAM,CAAC,CAAC;AACvD,UAAM,MAAM,gBAAQ,GAAG,cAAc;AACrC,SAAK,YAAY,EAAE,IAAI,KAAK,kBAAU,SAAS,YAAY,CAAC;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,oBAAoB,kBAA8B;AAChD,aAAS,kBAAkB,oBAAoB,CAAC,CAAC,MAAM,MAAM,CAAC,CAAC;AAC/D,UAAM,MAAM,gBAAQ,GAAG,SAAS;AAChC,SAAK,YAAY,EAAE,IAAI,KAAK,kBAAU,SAAS,gBAAgB,CAAC;AAAA,EAClE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,eAAuB;AACrB,QAAI,KAAK,cAAc,OAAW,MAAK,YAAY,KAAK,SAAS,EAAE;AACnE,WAAO,KAAK;AAAA,EACd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,WAAsB;AACpB,WAAO,KAAK,UAAU,OAAO;AAAA,EAC/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,QAAQ,OAAwB;AAC9B,UAAM,QAAQ,KAAK,SAAS;AAC5B,gBAAY,OAAO,SAAS,GAAG,MAAM,SAAS,CAAC;AAC/C,WAAO,MAAM,KAAK;AAAA,EACpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiBA,iBAA2B;AACzB,WAAO,MAAM,GAAG,KAAK,aAAa,CAAC;AAAA,EACrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,WAAW,OAAqB;AAC9B,UAAM,YAAY,KAAK,aAAa;AACpC,QAAI,KAAK,cAAc,EAAG,OAAM,IAAI,iCAAiC;AACrE,gBAAY,OAAO,SAAS,GAAG,YAAY,CAAC;AAC5C,SAAK,QAAQ,eAAe,KAAK;AACjC,SAAK,YAAY,YAAY;AAAA,EAC/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiCA,QAAQ,MAA4C;AAClD,aAAS,MAAM,QAAQ,CAAC,aAAa,CAAC,SAAS,SAAS,GAAG,KAAK,CAAC;AACjE,WAAO,KAAK,WAAW,KAAK,aAAa,GAAG,IAAI;AAAA,EAClD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkCA,WAAW,OAAe,MAA4C;AACpE,UAAM,YAAY,KAAK,aAAa;AACpC,gBAAY,OAAO,SAAS,GAAG,SAAS;AACxC,aAAS,MAAM,QAAQ,CAAC,aAAa,CAAC,SAAS,SAAS,GAAG,KAAK,CAAC;AACjE,QAAI,CAAC,QAAQ,MAAM,QAAQ,IAAI,GAAG;AAChC,YAAM,OAAO,MAAM,QAAQ,IAAI,IAAI,OAAO,UAAU;AACpD,aAAO,QAAQ,OAAO,IAAI;AAC1B,WAAK,QAAQ,GAAG,IAAI;AAAA,IACtB,WAAW,KAAK,QAAQ,MAAM;AAC5B,YAAM,IAAI,iBAAiB;AAAA,IAC7B;AAEA,UAAM,YAAY,KAAK,QAAQ,eAAe,KAAK,KAAK,KAAK;AAC7D,SAAK,KAAK,UAAU,SAAS;AAE7B,SAAK,QAAQ,IAAI,KAAK,MAAM,IAAI;AAChC,SAAK,UAAU,WAAW;AAE1B,SAAK,YAAY,YAAY;AAE7B,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAoBA,MAAM,UAAU,QAAqB,SAAuC;AAC1E,aAAS,QAAQ,UAAU,CAAC,CAAC,cAAa,aAAa,CAAC,CAAC;AACzD,aAAS,SAAS,WAAW,CAAC,KAAK,CAAC;AACpC,UAAM,OAAO,MAAM;AACnB,UAAM,SAAS,wBAAgB,IAAI,OAAO,SAAS,KAAK,OAAO;AAC/D,UAAM,WAAW,OAAO,SAAS;AACjC,UAAM,cAAyB,IAAI,MAAM,QAAQ,MAAM;AACvD,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,UAAU,SAAS,QAAQ,GAAG,CAAC;AACrC,YAAM,aAAa,OAAO,KAAK,QAAQ,IAAI;AAC3C,YAAM,MAAM,KAAK,QAAQ,SAAS,UAAU;AAC5C,kBAAY,GAAG,IAAI,QAAQ,GAAG,YAAY,KAAK,IAAI;AAAA,IACrD;AACA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,MAAM,OAA6B;AACjC,UAAM,UAAU,MAAM,aAAY,OAAO;AACzC,UAAM,eAAe,MAAM,QAAQ,UAAU,MAAM,KAAK,eAAe,CAAC;AAExE,aAAS,MAAM,GAAG,MAAM,aAAa,QAAQ,MAAM,KAAK,OAAO;AAC7D,cAAQ,QAAQ,aAAa,GAAG,CAAC;AAAA,IACnC;AAEA,QAAI,KAAK,UAAU,MAAM,QAAW;AAClC,cAAQ,UAAU,KAAK,UAAU,CAAE;AAAA,IACrC;AACA,QAAI,KAAK,gBAAgB,MAAM,QAAW;AACxC,cAAQ,gBAAgB,KAAK,gBAAgB,CAAE;AAAA,IACjD;AACA,QAAI,KAAK,WAAW,MAAM,QAAW;AACnC,cAAQ,WAAW,KAAK,WAAW,CAAE;AAAA,IACvC;AACA,QAAI,KAAK,oBAAoB,MAAM,QAAW;AAC5C,cAAQ,oBAAoB,KAAK,oBAAoB,CAAE;AAAA,IACzD;AACA,QAAI,KAAK,YAAY,MAAM,QAAW;AACpC,cAAQ,YAAY,KAAK,YAAY,CAAE;AAAA,IACzC;AACA,QAAI,KAAK,WAAW,MAAM,QAAW;AACnC,cAAQ,WAAW,KAAK,WAAW,CAAE;AAAA,IACvC;AACA,QAAI,KAAK,SAAS,MAAM,QAAW;AACjC,cAAQ,SAAS,KAAK,SAAS,CAAE;AAAA,IACnC;AACA,YAAQ,oBAAoB,KAAK;AAEjC,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA0BA,cAAc,MAAc,QAAgB;AAC1C,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AAErC,UAAM,WAAW,2BAAmB,IAAI,QAAQ,IAAI;AAEpD,UAAM,MAAM,KAAK,QAAQ,QAAQ;AACjC,UAAM,aAAa,cAAc,GAAG,KAAK,MAAM,QAAQ;AACvD,SAAK,YAAY,KAAK,UAAU;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAyDA,MAAM,OACJ,YACA,MACA,UAA6B,CAAC,GACf;AACf,aAAS,YAAY,cAAc,CAAC,UAAU,YAAY,WAAW,CAAC;AACtE,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,sBAAkB,QAAQ,UAAU,YAAY,CAAC,QAAQ,CAAC;AAC1D,sBAAkB,QAAQ,aAAa,eAAe,CAAC,QAAQ,CAAC;AAChE,sBAAkB,QAAQ,cAAc,wBAAwB,CAAC,IAAI,CAAC;AACtE,sBAAkB,QAAQ,kBAAkB,4BAA4B;AAAA,MACtE;AAAA,IACF,CAAC;AACD;AAAA,MACE,QAAQ;AAAA,MACR;AAAA,MACA;AAAA,IACF;AAEA,UAAM,QAAQ,aAAa,UAAU;AACrC,UAAM,WAAW,qBAAa,IAAI,OAAO,MAAM,OAAO;AAEtD,UAAM,MAAM,KAAK,QAAQ,QAAQ;AACjC,UAAM,eAAe,gBAAgB,GAAG,KAAK,MAAM,QAAQ;AAC3D,SAAK,cAAc,KAAK,YAAY;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAqCA,MAAM,UACJ,MACA,UAA4B,CAAC,GACX;AAClB,UAAM,EAAE,SAAS,OAAO,YAAY,SAAS,IAAI;AAEjD,aAAS,MAAM,QAAQ,CAAC,UAAU,YAAY,WAAW,CAAC;AAC1D,aAAS,QAAQ,UAAU,CAAC,SAAS,CAAC;AAEtC,QAAI;AACJ,QAAI,eAAe,IAAI,GAAG;AACxB,iBAAW,6BAAqB,IAAI,MAAM,UAAU;AAAA,IACtD,WAAW,2BAA2B,IAAI,GAAG;AAC3C,YAAM,QAAQ,aAAa,IAAI;AAC/B,YAAM,UAAU,KAAK,cAAc;AACnC,iBAAW,SACP,MAAM,iCAAyB;AAAA,QAC/B;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACF,IACE,MAAM,2BAAmB,IAAI,SAAS,OAAO,YAAY,QAAQ;AAAA,IACvE,OAAO;AACL,YAAM,IAAI;AAAA,QACR;AAAA,MACF;AAAA,IACF;AAEA,UAAM,MAAM,KAAK,QAAQ,QAAQ;AACjC,UAAM,UAAU,QAAQ,GAAG,KAAK,MAAM,QAAQ;AAC9C,SAAK,MAAM,KAAK,OAAO;AAEvB,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,kBAAkB,MAAqB,YAA8B;AACnE,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,QAAI,CAAC,eAAe,IAAI,GAAG;AACzB,YAAM,IAAI,UAAU,4CAA4C;AAAA,IAClE;AAEA,UAAM,WAAW,6BAAqB,IAAI,MAAM,UAAU;AAE1D,UAAM,MAAM,KAAK,QAAQ,QAAQ;AACjC,UAAM,UAAU,QAAQ,GAAG,KAAK,MAAM,QAAQ;AAC9C,SAAK,MAAM,KAAK,OAAO;AAEvB,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgCA,MAAM,SAAS,KAA2D;AACxE,aAAS,KAAK,OAAO,CAAC,UAAU,YAAY,WAAW,CAAC;AACxD,UAAM,QAAQ,aAAa,GAAG;AAC9B,UAAM,WAAW,MAAM,qBAAa,IAAI,KAAK;AAC7C,UAAM,MAAM,KAAK,QAAQ,QAAQ;AACjC,UAAM,WAAW,SAAS,GAAG,KAAK,MAAM,QAAQ;AAChD,SAAK,OAAO,KAAK,QAAQ;AACzB,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgCA,MAAM,SAAS,KAA2D;AACxE,aAAS,KAAK,OAAO,CAAC,UAAU,YAAY,WAAW,CAAC;AACxD,UAAM,QAAQ,aAAa,GAAG;AAC9B,UAAM,WAAW,MAAM,oBAAY,IAAI,KAAK;AAC5C,UAAM,MAAM,KAAK,QAAQ,QAAQ;AACjC,UAAM,WAAW,SAAS,GAAG,KAAK,MAAM,QAAQ;AAChD,SAAK,OAAO,KAAK,QAAQ;AACzB,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBA,MAAM,SACJ,KACA,UAAoB,CAAC,CAAC,GACM;AAC5B,aAAS,KAAK,OAAO;AAAA,MACnB;AAAA,MACA;AAAA,MACA;AAAA,MACA,CAAC,cAAa,aAAa;AAAA,IAC7B,CAAC;AACD,aAAS,SAAS,WAAW,CAAC,KAAK,CAAC;AAEpC,UAAM,SACJ,eAAe,eAAc,MAAM,MAAM,aAAY,KAAK,GAAG;AAE/D,UAAM,WAAW,aAAa,OAAO,SAAS,GAAG,OAAO;AAExD,WAAO,KAAK,WAAW,QAAQ;AAAA,EACjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkCA,MAAM,UACJ,MACA,aACA,sBAC0B;AAC1B,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,UAAM,CAAC,YAAY,IAAI,MAAM,KAAK;AAAA,MAChC,CAAC,IAAI;AAAA,MACL,CAAC,WAAW;AAAA,MACZ,CAAC,oBAAoB;AAAA,IACvB;AACA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA8BA,MAAM,WACJ,OACA,gBAAiD,CAAC,GAClD,yBAA+D,CAAC,GAChE;AACA,QAAI,MAAM,WAAW,EAAG,QAAO,CAAC;AAGhC,aAAS,MAAM,GAAG,MAAM,MAAM,SAAS,GAAG,MAAM,KAAK,OAAO;AAC1D,YAAM,WAAW,MAAM,GAAG;AAC1B,YAAM,WAAW,MAAM,MAAM,CAAC;AAC9B,UAAI,SAAS,KAAK,YAAY,SAAS,KAAK,SAAS;AACnD,cAAM,IAAI,oCAAoC;AAAA,MAChD;AAAA,IACF;AAEA,UAAM,UAAU,MAAM,CAAC,EAAE,KAAK;AAC9B,UAAM,gBACJ,YAAY,KAAK,UACb,CAAC,MAAmB,IACpB,wBAAgB,IAAI,SAAS,KAAK,OAAO,EAAE;AAEjD,UAAM,gBAAgB,IAAI,MAAuB,MAAM,MAAM;AAC7D,aAAS,MAAM,GAAG,MAAM,MAAM,QAAQ,MAAM,KAAK,OAAO;AACtD,YAAM,OAAO,cAAc,MAAM,GAAG,EAAE,IAAI;AAC1C,YAAM,MAAM,cAAc,GAAG;AAC7B,YAAM,SAAS,uBAAuB,GAAG;AAEzC,YAAM,WAAW,MAAM,wBAAgB,IAAI,MAAM,KAAK,MAAM;AAE5D,YAAM,MAAM,KAAK,QAAQ,QAAQ;AACjC,oBAAc,GAAG,IAAI,gBAAgB,GAAG,KAAK,MAAM,QAAQ;AAAA,IAC7D;AAEA,SAAK,cAAc,KAAK,GAAG,aAAa;AAExC,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,MAAM,QAAuB;AAC3B,UAAM,KAAK,SAAS,KAAK,KAAK;AAC9B,UAAM,KAAK,SAAS,KAAK,MAAM;AAC/B,UAAM,KAAK,SAAS,KAAK,aAAa;AACtC,UAAM,KAAK,SAAS,KAAK,aAAa;AACtC,UAAM,KAAK,SAAS,KAAK,WAAW;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,MAAM,KAAK,UAAuB,CAAC,GAAwB;AACzD,UAAM;AAAA,MACJ,mBAAmB;AAAA,MACnB,iBAAiB;AAAA,MACjB,iBAAiB;AAAA,MACjB,yBAAyB;AAAA,IAC3B,IAAI;AAEJ,aAAS,kBAAkB,oBAAoB,CAAC,SAAS,CAAC;AAC1D,aAAS,gBAAgB,kBAAkB,CAAC,SAAS,CAAC;AACtD,aAAS,gBAAgB,kBAAkB,CAAC,QAAQ,CAAC;AACrD,aAAS,wBAAwB,0BAA0B,CAAC,SAAS,CAAC;AAEtE,QAAI,kBAAkB,KAAK,aAAa,MAAM,EAAG,MAAK,QAAQ;AAE9D,QAAI,wBAAwB;AAC1B,YAAM,OAAO,KAAK,UAAU,SAAS;AACrC,UAAI,KAAM,MAAK,uBAAuB;AAAA,IACxC;AAEA,UAAM,KAAK,MAAM;AAEjB,UAAM,SAAS,mBAAmB,0BAAkB;AACpD,WAAO,OAAO,WAAW,KAAK,SAAS,cAAc,EAAE,kBAAkB;AAAA,EAC3E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiBA,MAAM,aAAa,UAA6B,CAAC,GAAoB;AACnE,UAAM,EAAE,UAAU,OAAO,GAAG,aAAa,IAAI;AAC7C,aAAS,SAAS,WAAW,CAAC,SAAS,CAAC;AACxC,UAAM,QAAQ,MAAM,KAAK,KAAK,YAAY;AAC1C,UAAM,SAAS,eAAe,KAAK;AACnC,WAAO,UAAU,+BAA+B,MAAM,KAAK;AAAA,EAC7D;AAAA,EAEA,yBAAyB,KAAkC;AACzD,UAAM,QAAQ,KAAK,SAAS;AAC5B,aAAS,MAAM,GAAG,MAAM,MAAM,QAAQ,MAAM,KAAK,OAAO;AACtD,YAAM,OAAO,MAAM,GAAG;AACtB,YAAM,cAAc,KAAK,KAAK,OAAO;AAErC,UAAI,aAAa,QAAQ,GAAG,MAAM,QAAW;AAC3C,eAAO;AAAA,MACT;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,MAAc,SAAS,aAA0C;AAC/D,aAAS,MAAM,GAAG,MAAM,YAAY,QAAQ,MAAM,KAAK,OAAO;AAC5D,YAAM,YAAY,GAAG,EAAE,MAAM;AAAA,IAC/B;AAAA,EACF;AAAA,EAEQ,iBAAuB;AAC7B,UAAM,SAAS;AACf,UAAM,MAAM,oBAAI,KAAK;AAErB,UAAM,OAAO,KAAK,YAAY;AAE9B,SAAK,YAAY,MAAM;AACvB,SAAK,oBAAoB,GAAG;AAE5B,QAAI,CAAC,KAAK,IAAI,gBAAQ,GAAG,SAAS,CAAC,EAAG,MAAK,WAAW,MAAM;AAC5D,QAAI,CAAC,KAAK,IAAI,gBAAQ,GAAG,cAAc,CAAC,EAAG,MAAK,gBAAgB,GAAG;AAAA,EACrE;AAAA,EAEQ,cAAuB;AAC7B,UAAM,eAAe,KAAK,QAAQ,OAAO,KAAK,QAAQ,YAAY,IAAI;AACtE,QAAI,wBAAwB,gBAAS,QAAO;AAE5C,UAAM,UAAU,KAAK,QAAQ,IAAI,CAAC,CAAC;AACnC,SAAK,QAAQ,YAAY,OAAO,KAAK,QAAQ,SAAS,OAAO;AAE7D,WAAO;AAAA,EACT;AAAA,EAEQ,gBAAyB;AAC/B,QAAI,CAAC,KAAK,QAAS,OAAM,IAAI,0BAA0B;AACvD,WAAO,KAAK;AAAA,EACd;AAqBF;AAGA,SAAS,2BACP,WAC+C;AAC/C,MACE,EAAE,qBAAqB,yBACvB,EAAE,qBAAqB,oBACvB;AACA,UAAM,IAAI,0BAA0B,CAAC,sBAAc,iBAAS,GAAG,SAAS;AAAA,EAC1E;AACF;;;AC72CO,IAAK,YAAL,kBAAKC,eAAL;AACL,EAAAA,WAAA,YAAS;AACT,EAAAA,WAAA,cAAW;AACX,EAAAA,WAAA,YAAS;AACT,EAAAA,WAAA,aAAU;AACV,EAAAA,WAAA,YAAS;AACT,EAAAA,WAAA,aAAU;AACV,EAAAA,WAAA,gBAAa;AACb,EAAAA,WAAA,eAAY;AACZ,EAAAA,WAAA,eAAY;AACZ,EAAAA,WAAA,eAAY;AACZ,EAAAA,WAAA,gBAAa;AACb,EAAAA,WAAA,eAAY;AAZF,SAAAA;AAAA,GAAA;;;ACwDZ,IAAqB,WAArB,MAAqB,SAAQ;AAAA,EAmDnB,YAAY,UAAuB,KAAa,KAAkB;AAlB1E;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAGT;AAAA,wBAAS;AAET,wBAAQ;AACR,wBAAQ;AACR,wBAAQ,YAAW;AACnB,wBAAQ,aAAY,IAAI,GAAG,GAAG,CAAC;AAC/B,wBAAQ,cAAa;AACrB,wBAAQ,KAAI;AACZ,wBAAQ,KAAI;AACZ,wBAAQ;AACR,wBAAQ;AAGN,aAAS,UAAU,YAAY,CAAC,CAAC,qBAAa,aAAa,CAAC,CAAC;AAC7D,aAAS,KAAK,OAAO,CAAC,CAAC,gBAAQ,QAAQ,CAAC,CAAC;AACzC,aAAS,KAAK,OAAO,CAAC,CAAC,aAAa,aAAa,CAAC,CAAC;AAEnD,SAAK,OAAO;AACZ,SAAK,MAAM;AACX,SAAK,MAAM;AAAA,EACb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,YAAY,OAAuB;AACjC,UAAM,eAAe,UAAU,KAAK;AACpC,mBAAe,cAAc,gBAAgB,EAAE;AAC/C,SAAK,KAAK,IAAI,gBAAQ,GAAG,QAAQ,GAAG,KAAK,IAAI,QAAQ,IAAI,YAAY,CAAC;AAAA,EACxE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,cAAwB;AACtB,UAAM,SAAS,KAAK,KAAK,OAAO;AAChC,WAAO,QAAQ,SAAS,OAAO,SAAS,IAAI,CAAC;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsCA,QAAQ,OAAe,QAAsB;AAC3C,aAAS,OAAO,SAAS,CAAC,QAAQ,CAAC;AACnC,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AAErC,UAAM,WAAW,KAAK,YAAY;AAClC,SAAK,YAAY,SAAS,GAAG,SAAS,GAAG,OAAO,MAAM;AAEtD,UAAM,UAAU,KAAK,WAAW;AAChC,UAAM,WAAW,KAAK,YAAY;AAClC,UAAM,UAAU,KAAK,WAAW;AAChC,UAAM,SAAS,KAAK,UAAU;AAE9B,UAAM,aAAa,KAAK,KAAK,QAAQ;AACrC,UAAM,cAAc,KAAK,KAAK,SAAS;AACvC,UAAM,aAAa,KAAK,KAAK,QAAQ;AACrC,UAAM,YAAY,KAAK,KAAK,OAAO;AAEnC,QAAI,cAAc,mBAAmB,SAAS,QAAQ,GAAG;AACvD,WAAK,WAAW,SAAS,GAAG,SAAS,GAAG,OAAO,MAAM;AAAA,IACvD;AACA,QAAI,eAAe,mBAAmB,UAAU,QAAQ,GAAG;AACzD,WAAK,YAAY,SAAS,GAAG,SAAS,GAAG,OAAO,MAAM;AAAA,IACxD;AACA,QAAI,cAAc,mBAAmB,SAAS,QAAQ,GAAG;AACvD,WAAK,WAAW,SAAS,GAAG,SAAS,GAAG,OAAO,MAAM;AAAA,IACvD;AACA,QAAI,aAAa,mBAAmB,QAAQ,QAAQ,GAAG;AACrD,WAAK,UAAU,SAAS,GAAG,SAAS,GAAG,OAAO,MAAM;AAAA,IACtD;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,SAAS,OAAqB;AAC5B,aAAS,OAAO,SAAS,CAAC,QAAQ,CAAC;AACnC,SAAK,QAAQ,OAAO,KAAK,QAAQ,EAAE,MAAM;AAAA,EAC3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,UAAU,QAAsB;AAC9B,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AACrC,SAAK,QAAQ,KAAK,QAAQ,EAAE,OAAO,MAAM;AAAA,EAC3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,YAAY,GAAW,GAAW,OAAe,QAAsB;AACrE,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,OAAO,SAAS,CAAC,QAAQ,CAAC;AACnC,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AACrC,UAAM,WAAW,KAAK,IAAI,QAAQ,IAAI,CAAC,GAAG,GAAG,IAAI,OAAO,IAAI,MAAM,CAAC;AACnE,SAAK,KAAK,IAAI,gBAAQ,UAAU,QAAQ;AAAA,EAC1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,WAAW,GAAW,GAAW,OAAe,QAAsB;AACpE,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,OAAO,SAAS,CAAC,QAAQ,CAAC;AACnC,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AACrC,UAAM,UAAU,KAAK,IAAI,QAAQ,IAAI,CAAC,GAAG,GAAG,IAAI,OAAO,IAAI,MAAM,CAAC;AAClE,SAAK,KAAK,IAAI,gBAAQ,SAAS,OAAO;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,YAAY,GAAW,GAAW,OAAe,QAAsB;AACrE,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,OAAO,SAAS,CAAC,QAAQ,CAAC;AACnC,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AACrC,UAAM,WAAW,KAAK,IAAI,QAAQ,IAAI,CAAC,GAAG,GAAG,IAAI,OAAO,IAAI,MAAM,CAAC;AACnE,SAAK,KAAK,IAAI,gBAAQ,UAAU,QAAQ;AAAA,EAC1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,WAAW,GAAW,GAAW,OAAe,QAAsB;AACpE,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,OAAO,SAAS,CAAC,QAAQ,CAAC;AACnC,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AACrC,UAAM,UAAU,KAAK,IAAI,QAAQ,IAAI,CAAC,GAAG,GAAG,IAAI,OAAO,IAAI,MAAM,CAAC;AAClE,SAAK,KAAK,IAAI,gBAAQ,SAAS,OAAO;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,UAAU,GAAW,GAAW,OAAe,QAAsB;AACnE,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,OAAO,SAAS,CAAC,QAAQ,CAAC;AACnC,aAAS,QAAQ,UAAU,CAAC,QAAQ,CAAC;AACrC,UAAM,SAAS,KAAK,IAAI,QAAQ,IAAI,CAAC,GAAG,GAAG,IAAI,OAAO,IAAI,MAAM,CAAC;AACjE,SAAK,KAAK,IAAI,gBAAQ,QAAQ,MAAM;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,UAA6C;AAC3C,UAAM,EAAE,OAAO,OAAO,IAAI,KAAK,YAAY;AAC3C,WAAO,EAAE,OAAO,OAAO;AAAA,EACzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,WAAmB;AACjB,WAAO,KAAK,QAAQ,EAAE;AAAA,EACxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,YAAoB;AAClB,WAAO,KAAK,QAAQ,EAAE;AAAA,EACxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,cAAuE;AACrE,UAAM,WAAW,KAAK,KAAK,SAAS;AACpC,WAAO,SAAS,YAAY;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,aAAsE;AACpE,UAAM,UAAU,KAAK,KAAK,QAAQ;AAClC,WAAO,SAAS,YAAY,KAAK,KAAK,YAAY;AAAA,EACpD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,cAAuE;AACrE,UAAM,WAAW,KAAK,KAAK,SAAS;AACpC,WAAO,UAAU,YAAY,KAAK,KAAK,WAAW;AAAA,EACpD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,aAAsE;AACpE,UAAM,UAAU,KAAK,KAAK,QAAQ;AAClC,WAAO,SAAS,YAAY,KAAK,KAAK,WAAW;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,YAAqE;AACnE,UAAM,SAAS,KAAK,KAAK,OAAO;AAChC,WAAO,QAAQ,YAAY,KAAK,KAAK,WAAW;AAAA,EAClD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,iBAAiB,GAAW,GAAiB;AAC3C,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAE3B,SAAK,KAAK,UAAU;AACpB,SAAK,iBAAiB;AAEtB,UAAM,QAAQ,KAAK;AAAA,MACjB,kBAAkB;AAAA,MAClB,UAAU,GAAG,CAAC;AAAA,IAChB;AACA,UAAM,WAAW,KAAK,IAAI,QAAQ,SAAS,KAAK;AAEhD,UAAM,MAAM,KAAK,oBAAoB,iBAAiB,CAAC;AACvD,UAAM,SAAS,KAAK,IAAI,QAAQ,SAAS,GAAG;AAE5C,SAAK,KAAK,mBAAmB,UAAU,MAAM;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,MAAM,GAAW,GAAiB;AAChC,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,SAAK,QAAQ,KAAK,SAAS,IAAI,GAAG,KAAK,UAAU,IAAI,CAAC;AACtD,SAAK,aAAa,GAAG,CAAC;AACtB,SAAK,iBAAiB,GAAG,CAAC;AAAA,EAC5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAoBA,aAAa,GAAW,GAAiB;AACvC,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAE3B,SAAK,KAAK,UAAU;AACpB,SAAK,iBAAiB;AAEtB,UAAM,QAAQ,KAAK,oBAAoB,kBAAkB,GAAG,MAAM,GAAG,CAAC,CAAC;AACvE,UAAM,WAAW,KAAK,IAAI,QAAQ,SAAS,KAAK;AAEhD,UAAM,MAAM,KAAK,oBAAoB,iBAAiB,CAAC;AACvD,UAAM,SAAS,KAAK,IAAI,QAAQ,SAAS,GAAG;AAE5C,SAAK,KAAK,mBAAmB,UAAU,MAAM;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,iBAAiB,GAAW,GAAW;AACrC,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAE3B,UAAM,SAAS,KAAK,KAAK,OAAO;AAChC,QAAI,CAAC,OAAQ;AAEb,aAAS,MAAM,GAAG,MAAM,OAAO,KAAK,GAAG,OAAO;AAC5C,YAAM,QAAQ,OAAO,OAAO,GAAG;AAC/B,UAAI,iBAAiB,gBAAS,MAAK,WAAW,OAAO,GAAG,CAAC;AAAA,IAC3D;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBA,gBAAsB;AACpB,SAAK,iBAAiB,KAAK;AAC3B,SAAK,IAAI;AACT,SAAK,IAAI;AAAA,EACX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBA,QAAQ,MAAqB;AAE3B,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,SAAK,OAAO;AACZ,SAAK,UAAU,KAAK,KAAK,kBAAkB,KAAK,KAAK,MAAM,KAAK,KAAK,GAAG;AAAA,EAC1E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,YAAY,UAAwB;AAClC,aAAS,UAAU,YAAY,CAAC,QAAQ,CAAC;AACzC,SAAK,WAAW;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,aAAa,WAAwB;AACnC,aAAS,WAAW,aAAa,CAAC,CAAC,QAAQ,OAAO,CAAC,CAAC;AACpD,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,cAAc,YAA0B;AACtC,aAAS,YAAY,cAAc,CAAC,QAAQ,CAAC;AAC7C,SAAK,aAAa;AAAA,EACpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,cAAwC;AACtC,WAAO,EAAE,GAAG,KAAK,GAAG,GAAG,KAAK,EAAE;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,OAAe;AACb,WAAO,KAAK;AAAA,EACd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,OAAe;AACb,WAAO,KAAK;AAAA,EACd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiBA,OAAO,GAAW,GAAiB;AACjC,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,aAAS,GAAG,KAAK,CAAC,QAAQ,CAAC;AAC3B,SAAK,IAAI;AACT,SAAK,IAAI;AAAA,EACX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,SAAS,WAAyB;AAChC,aAAS,WAAW,aAAa,CAAC,QAAQ,CAAC;AAC3C,SAAK,KAAK;AAAA,EACZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,OAAO,WAAyB;AAC9B,aAAS,WAAW,aAAa,CAAC,QAAQ,CAAC;AAC3C,SAAK,KAAK;AAAA,EACZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,SAAS,WAAyB;AAChC,aAAS,WAAW,aAAa,CAAC,QAAQ,CAAC;AAC3C,SAAK,KAAK;AAAA,EACZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,UAAU,WAAyB;AACjC,aAAS,WAAW,aAAa,CAAC,QAAQ,CAAC;AAC3C,SAAK,KAAK;AAAA,EACZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA+BA,iBAAiB,UAA+B;AAC9C,iBAAa,UAAU,YAAY,CAAC,CAAC,qBAAa,aAAa,CAAC,CAAC;AACjE,UAAM,gBAAgB,KAAK,iBAAiB;AAC5C,kBAAc,KAAK,GAAG,QAAQ;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAuCA,SAAS,MAAc,UAAkC,CAAC,GAAS;AACjE,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,CAAC,QAAQ,OAAO,CAAC,CAAC;AACrE,2BAAuB,QAAQ,SAAS,mBAAmB,GAAG,CAAC;AAC/D,sBAAkB,QAAQ,MAAM,gBAAgB,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AACtE,sBAAkB,QAAQ,MAAM,gBAAgB,CAAC,QAAQ,CAAC;AAC1D,sBAAkB,QAAQ,QAAQ,kBAAkB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AAC1E,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AACxE,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AACxE,sBAAkB,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;AACpD,sBAAkB,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;AACpD,sBAAkB,QAAQ,YAAY,sBAAsB,CAAC,QAAQ,CAAC;AACtE,sBAAkB,QAAQ,UAAU,oBAAoB,CAAC,QAAQ,CAAC;AAClE,sBAAkB,QAAQ,YAAY,sBAAsB,CAAC,KAAK,CAAC;AACnE,6BAAyB,QAAQ,WAAW,qBAAqB,SAAS;AAE1E,UAAM,EAAE,SAAS,SAAS,WAAW,IAAI,KAAK,eAAe,QAAQ,IAAI;AACzE,UAAM,WAAW,QAAQ,QAAQ,KAAK;AAEtC,UAAM,aAAa,QAAQ,cAAc,KAAK,IAAI;AAClD,UAAM,YAAY,CAAC,MAAc,QAAQ,kBAAkB,GAAG,QAAQ;AACtE,UAAM,QACJ,QAAQ,aAAa,SACjB,UAAU,UAAU,IAAI,CAAC,IACzB,mBAAmB,MAAM,YAAY,QAAQ,UAAU,SAAS;AAEtE,UAAM,eAAe,IAAI,MAAM,MAAM,MAAM;AAC3C,aAAS,MAAM,GAAG,MAAM,MAAM,QAAQ,MAAM,KAAK,OAAO;AACtD,mBAAa,GAAG,IAAI,QAAQ,WAAW,MAAM,GAAG,CAAC;AAAA,IACnD;AAEA,UAAM,mBAAmB,KAAK,wBAAwB;AAAA,MACpD,SAAS,QAAQ;AAAA,MACjB,WAAW,QAAQ;AAAA,IACrB,CAAC;AAED,UAAM,gBAAgB,KAAK,iBAAiB;AAC5C,kBAAc;AAAA,MACZ,GAAG,gBAAgB,cAAc;AAAA,QAC/B,OAAO,QAAQ,SAAS,KAAK;AAAA,QAC7B,MAAM;AAAA,QACN,MAAM;AAAA,QACN,QAAQ,QAAQ,UAAU,QAAQ,CAAC;AAAA,QACnC,OAAO,QAAQ,SAAS,QAAQ,CAAC;AAAA,QACjC,OAAO,QAAQ,SAAS,QAAQ,CAAC;AAAA,QACjC,GAAG,QAAQ,KAAK,KAAK;AAAA,QACrB,GAAG,QAAQ,KAAK,KAAK;AAAA,QACrB,YAAY,QAAQ,cAAc,KAAK;AAAA,QACvC,eAAe;AAAA,MACjB,CAAC;AAAA,IACH;AAEA,QAAI,QAAQ,MAAM;AAChB,UAAI,QAAS,MAAK,QAAQ,OAAO;AAAA,UAC5B,MAAK,UAAU;AAAA,IACtB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA2BA,UAAU,OAAiB,UAAmC,CAAC,GAAS;AAEtE,aAAS,OAAO,SAAS,CAAC,CAAC,UAAU,UAAU,CAAC,CAAC;AACjD,sBAAkB,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;AACpD,sBAAkB,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;AACpD,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,QAAQ,CAAC;AAC5D,sBAAkB,QAAQ,QAAQ,kBAAkB,CAAC,QAAQ,CAAC;AAC9D,sBAAkB,QAAQ,QAAQ,kBAAkB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AAC1E,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AACxE,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AACxE,2BAAuB,QAAQ,SAAS,mBAAmB,GAAG,CAAC;AAC/D,6BAAyB,QAAQ,WAAW,qBAAqB,SAAS;AAE1E,UAAM,aAAa,KAAK,KAAK,WAAW,SAAS,MAAM,GAAG;AAE1D,UAAM,mBAAmB,KAAK,wBAAwB;AAAA,MACpD,SAAS,QAAQ;AAAA,MACjB,WAAW,QAAQ;AAAA,IACrB,CAAC;AAED,UAAM,gBAAgB,KAAK,iBAAiB;AAC5C,kBAAc;AAAA,MACZ,GAAG,UAAU,YAAY;AAAA,QACvB,GAAG,QAAQ,KAAK,KAAK;AAAA,QACrB,GAAG,QAAQ,KAAK,KAAK;AAAA,QACrB,OAAO,QAAQ,SAAS,MAAM,KAAK,EAAE;AAAA,QACrC,QAAQ,QAAQ,UAAU,MAAM,KAAK,EAAE;AAAA,QACvC,QAAQ,QAAQ,UAAU,QAAQ,CAAC;AAAA,QACnC,OAAO,QAAQ,SAAS,QAAQ,CAAC;AAAA,QACjC,OAAO,QAAQ,SAAS,QAAQ,CAAC;AAAA,QACjC,eAAe;AAAA,MACjB,CAAC;AAAA,IACH;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkCA,SACE,cACA,UAAkC,CAAC,GAC7B;AAEN,aAAS,cAAc,gBAAgB;AAAA,MACrC,CAAC,iBAAiB,iBAAiB;AAAA,IACrC,CAAC;AACD,sBAAkB,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;AACpD,sBAAkB,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;AACpD,sBAAkB,QAAQ,QAAQ,kBAAkB,CAAC,QAAQ,CAAC;AAC9D,sBAAkB,QAAQ,QAAQ,kBAAkB,CAAC,QAAQ,CAAC;AAC9D,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,QAAQ,CAAC;AAC5D,sBAAkB,QAAQ,QAAQ,kBAAkB,CAAC,QAAQ,CAAC;AAC9D,sBAAkB,QAAQ,QAAQ,kBAAkB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AAC1E,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AACxE,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AACxE,2BAAuB,QAAQ,SAAS,mBAAmB,GAAG,CAAC;AAC/D,6BAAyB,QAAQ,WAAW,qBAAqB,SAAS;AAE1E,UAAM,aAAa,KAAK,KAAK;AAAA,MAC3B;AAAA,MACA,aAAa;AAAA,IACf;AAEA,UAAM,mBAAmB,KAAK,wBAAwB;AAAA,MACpD,SAAS,QAAQ;AAAA,MACjB,WAAW,QAAQ;AAAA,IACrB,CAAC;AAGD,UAAM,SACJ,QAAQ,UAAW,SAAY,QAAQ,QAAQ,aAAa,QACxD,QAAQ,WAAW,SAAY,QAAQ,SACrC;AAIR,UAAM,SACJ,QAAQ,WAAW,SAAY,QAAQ,SAAS,aAAa,SACzD,QAAQ,WAAW,SAAY,QAAQ,SACrC;AAGR,UAAM,gBAAgB,KAAK,iBAAiB;AAC5C,kBAAc;AAAA,MACZ,GAAG,SAAS,YAAY;AAAA,QACtB,GAAG,QAAQ,KAAK,KAAK;AAAA,QACrB,GAAG,QAAQ,KAAK,KAAK;AAAA,QACrB;AAAA,QACA;AAAA,QACA,QAAQ,QAAQ,UAAU,QAAQ,CAAC;AAAA,QACnC,OAAO,QAAQ,SAAS,QAAQ,CAAC;AAAA,QACjC,OAAO,QAAQ,SAAS,QAAQ,CAAC;AAAA,QACjC,eAAe;AAAA,MACjB,CAAC;AAAA,IACH;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAuCA,YAAY,MAAc,UAAiC,CAAC,GAAS;AACnE,aAAS,MAAM,QAAQ,CAAC,QAAQ,CAAC;AACjC,sBAAkB,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;AACpD,sBAAkB,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;AACpD,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,QAAQ,CAAC;AAC5D,sBAAkB,QAAQ,QAAQ,kBAAkB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AAC1E,sBAAkB,QAAQ,aAAa,uBAAuB,CAAC,QAAQ,CAAC;AACxE,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,CAAC,QAAQ,OAAO,CAAC,CAAC;AACrE,2BAAuB,QAAQ,SAAS,mBAAmB,GAAG,CAAC;AAC/D,sBAAkB,QAAQ,aAAa,uBAAuB;AAAA,MAC5D,CAAC,QAAQ,OAAO;AAAA,IAClB,CAAC;AACD,sBAAkB,QAAQ,iBAAiB,2BAA2B;AAAA,MACpE;AAAA,IACF,CAAC;AACD,sBAAkB,QAAQ,iBAAiB,2BAA2B;AAAA,MACpE;AAAA,IACF,CAAC;AACD;AAAA,MACE,QAAQ;AAAA,MACR;AAAA,MACA;AAAA,IACF;AACA;AAAA,MACE,QAAQ;AAAA,MACR;AAAA,MACA;AAAA,MACA;AAAA,IACF;AACA,6BAAyB,QAAQ,WAAW,qBAAqB,SAAS;AAE1E,UAAM,mBAAmB,KAAK,wBAAwB;AAAA,MACpD,SAAS,QAAQ;AAAA,MACjB,eAAe,QAAQ;AAAA,MACvB,WAAW,QAAQ;AAAA,IACrB,CAAC;AAED,QAAI,EAAE,WAAW,YAAY,EAAE,iBAAiB,UAAU;AACxD,cAAQ,cAAc,IAAI,GAAG,GAAG,CAAC;AAAA,IACnC;AAEA,UAAM,gBAAgB,KAAK,iBAAiB;AAC5C,kBAAc;AAAA,MACZ,GAAG,YAAY,MAAM;AAAA,QACnB,GAAG,QAAQ,KAAK,KAAK;AAAA,QACrB,GAAG,QAAQ,KAAK,KAAK;AAAA,QACrB,OAAO,QAAQ;AAAA,QACf,QAAQ,QAAQ,UAAU,QAAQ,CAAC;AAAA,QACnC,OAAO,QAAQ,SAAS;AAAA,QACxB,aAAa,QAAQ,eAAe;AAAA,QACpC,aAAa,QAAQ,eAAe;AAAA,QACpC,iBAAiB,QAAQ,mBAAmB;AAAA,QAC5C,iBAAiB,QAAQ,mBAAmB;AAAA,QAC5C,eAAe,QAAQ,iBAAiB;AAAA,QACxC,eAAe;AAAA,MACjB,CAAC;AAAA,IACH;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiBA,SAAS,SAAuC;AAC9C,aAAS,QAAQ,OAAO,iBAAiB;AAAA,MACvC,CAAC,QAAQ,0BAA0B;AAAA,IACrC,CAAC;AACD,aAAS,QAAQ,KAAK,eAAe;AAAA,MACnC,CAAC,QAAQ,0BAA0B;AAAA,IACrC,CAAC;AACD,aAAS,QAAQ,MAAM,GAAG,mBAAmB,CAAC,QAAQ,CAAC;AACvD,aAAS,QAAQ,MAAM,GAAG,mBAAmB,CAAC,QAAQ,CAAC;AACvD,aAAS,QAAQ,IAAI,GAAG,iBAAiB,CAAC,QAAQ,CAAC;AACnD,aAAS,QAAQ,IAAI,GAAG,iBAAiB,CAAC,QAAQ,CAAC;AACnD,sBAAkB,QAAQ,WAAW,qBAAqB,CAAC,QAAQ,CAAC;AACpE,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,CAAC,QAAQ,OAAO,CAAC,CAAC;AACrE,sBAAkB,QAAQ,WAAW,qBAAqB,CAAC,KAAK,CAAC;AACjE,sBAAkB,QAAQ,WAAW,qBAAqB,CAAC,QAAQ,CAAC;AACpE,6BAAyB,QAAQ,SAAS,mBAAmB,YAAY;AACzE,2BAAuB,QAAQ,SAAS,mBAAmB,GAAG,CAAC;AAC/D,6BAAyB,QAAQ,WAAW,qBAAqB,SAAS;AAE1E,UAAM,mBAAmB,KAAK,wBAAwB;AAAA,MACpD,eAAe,QAAQ;AAAA,MACvB,WAAW,QAAQ;AAAA,IACrB,CAAC;AAED,QAAI,EAAE,WAAW,UAAU;AACzB,cAAQ,QAAQ,IAAI,GAAG,GAAG,CAAC;AAAA,IAC7B;AAEA,UAAM,gBAAgB,KAAK,iBAAiB;AAC5C,kBAAc;AAAA,MACZ,GAAG,SAAS;AAAA,QACV,OAAO,QAAQ;AAAA,QACf,KAAK,QAAQ;AAAA,QACb,WAAW,QAAQ,aAAa;AAAA,QAChC,OAAO,QAAQ,SAAS;AAAA,QACxB,WAAW,QAAQ,aAAa;AAAA,QAChC,WAAW,QAAQ,aAAa;AAAA,QAChC,SAAS,QAAQ,WAAW;AAAA,QAC5B,eAAe;AAAA,MACjB,CAAC;AAAA,IACH;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBA,cAAc,UAAuC,CAAC,GAAS;AAC7D,sBAAkB,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;AACpD,sBAAkB,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;AACpD,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,QAAQ,CAAC;AAC5D,sBAAkB,QAAQ,QAAQ,kBAAkB,CAAC,QAAQ,CAAC;AAC9D,sBAAkB,QAAQ,QAAQ,kBAAkB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AAC1E,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AACxE,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AACxE,sBAAkB,QAAQ,aAAa,uBAAuB,CAAC,QAAQ,CAAC;AACxE,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,CAAC,QAAQ,OAAO,CAAC,CAAC;AACrE,2BAAuB,QAAQ,SAAS,mBAAmB,GAAG,CAAC;AAC/D,sBAAkB,QAAQ,aAAa,uBAAuB;AAAA,MAC5D,CAAC,QAAQ,OAAO;AAAA,IAClB,CAAC;AACD,sBAAkB,QAAQ,iBAAiB,2BAA2B;AAAA,MACpE;AAAA,IACF,CAAC;AACD,sBAAkB,QAAQ,iBAAiB,2BAA2B;AAAA,MACpE;AAAA,IACF,CAAC;AACD;AAAA,MACE,QAAQ;AAAA,MACR;AAAA,MACA;AAAA,IACF;AACA;AAAA,MACE,QAAQ;AAAA,MACR;AAAA,MACA;AAAA,MACA;AAAA,IACF;AACA,6BAAyB,QAAQ,WAAW,qBAAqB,SAAS;AAE1E,UAAM,mBAAmB,KAAK,wBAAwB;AAAA,MACpD,SAAS,QAAQ;AAAA,MACjB,eAAe,QAAQ;AAAA,MACvB,WAAW,QAAQ;AAAA,IACrB,CAAC;AAED,QAAI,EAAE,WAAW,YAAY,EAAE,iBAAiB,UAAU;AACxD,cAAQ,QAAQ,IAAI,GAAG,GAAG,CAAC;AAAA,IAC7B;AAEA,UAAM,gBAAgB,KAAK,iBAAiB;AAC5C,kBAAc;AAAA,MACZ,GAAG,cAAc;AAAA,QACf,GAAG,QAAQ,KAAK,KAAK;AAAA,QACrB,GAAG,QAAQ,KAAK,KAAK;AAAA,QACrB,OAAO,QAAQ,SAAS;AAAA,QACxB,QAAQ,QAAQ,UAAU;AAAA,QAC1B,QAAQ,QAAQ,UAAU,QAAQ,CAAC;AAAA,QACnC,OAAO,QAAQ,SAAS,QAAQ,CAAC;AAAA,QACjC,OAAO,QAAQ,SAAS,QAAQ,CAAC;AAAA,QACjC,aAAa,QAAQ,eAAe;AAAA,QACpC,OAAO,QAAQ,SAAS;AAAA,QACxB,aAAa,QAAQ,eAAe;AAAA,QACpC,iBAAiB,QAAQ,mBAAmB;AAAA,QAC5C,iBAAiB,QAAQ,mBAAmB;AAAA,QAC5C,eAAe;AAAA,QACf,eAAe,QAAQ,iBAAiB;AAAA,MAC1C,CAAC;AAAA,IACH;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAqBA,WAAW,UAAoC,CAAC,GAAS;AACvD,UAAM,EAAE,KAAK,IAAI;AACjB,sBAAkB,MAAM,QAAQ,CAAC,QAAQ,CAAC;AAC1C,SAAK,cAAc,EAAE,GAAG,SAAS,OAAO,MAAM,QAAQ,KAAK,CAAC;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAqBA,YAAY,UAAqC,CAAC,GAAS;AACzD,sBAAkB,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;AACpD,sBAAkB,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;AACpD,sBAAkB,QAAQ,QAAQ,kBAAkB,CAAC,QAAQ,CAAC;AAC9D,sBAAkB,QAAQ,QAAQ,kBAAkB,CAAC,QAAQ,CAAC;AAC9D,sBAAkB,QAAQ,QAAQ,kBAAkB,CAAC,CAAC,QAAQ,UAAU,CAAC,CAAC;AAC1E,sBAAkB,QAAQ,OAAO,iBAAiB,CAAC,CAAC,QAAQ,OAAO,CAAC,CAAC;AACrE,2BAAuB,QAAQ,SAAS,mBAAmB,GAAG,CAAC;AAC/D,sBAAkB,QAAQ,aAAa,uBAAuB;AAAA,MAC5D,CAAC,QAAQ,OAAO;AAAA,IAClB,CAAC;AACD;AAAA,MACE,QAAQ;AAAA,MACR;AAAA,MACA;AAAA,MACA;AAAA,IACF;AACA,sBAAkB,QAAQ,aAAa,uBAAuB,CAAC,QAAQ,CAAC;AACxE,sBAAkB,QAAQ,iBAAiB,2BAA2B;AAAA,MACpE;AAAA,IACF,CAAC;AACD,sBAAkB,QAAQ,iBAAiB,2BAA2B;AAAA,MACpE;AAAA,IACF,CAAC;AACD;AAAA,MACE,QAAQ;AAAA,MACR;AAAA,MACA;AAAA,IACF;AACA,6BAAyB,QAAQ,WAAW,qBAAqB,SAAS;AAC1E,UAAM,mBAAmB,KAAK,wBAAwB;AAAA,MACpD,SAAS,QAAQ;AAAA,MACjB,eAAe,QAAQ;AAAA,MACvB,WAAW,QAAQ;AAAA,IACrB,CAAC;AAED,QAAI,EAAE,WAAW,YAAY,EAAE,iBAAiB,UAAU;AACxD,cAAQ,QAAQ,IAAI,GAAG,GAAG,CAAC;AAAA,IAC7B;AAEA,UAAM,gBAAgB,KAAK,iBAAiB;AAC5C,kBAAc;AAAA,MACZ,GAAG,YAAY;AAAA,QACb,GAAG,QAAQ,KAAK,KAAK;AAAA,QACrB,GAAG,QAAQ,KAAK,KAAK;AAAA,QACrB,QAAQ,QAAQ,UAAU;AAAA,QAC1B,QAAQ,QAAQ,UAAU;AAAA,QAC1B,QAAQ,QAAQ,UAAU;AAAA,QAC1B,OAAO,QAAQ,SAAS;AAAA,QACxB,aAAa,QAAQ,eAAe;AAAA,QACpC,aAAa,QAAQ,eAAe;AAAA,QACpC,iBAAiB,QAAQ,mBAAmB;AAAA,QAC5C,iBAAiB,QAAQ,mBAAmB;AAAA,QAC5C,eAAe,QAAQ,iBAAiB;AAAA,QACxC,eAAe;AAAA,MACjB,CAAC;AAAA,IACH;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAoBA,WAAW,UAAoC,CAAC,GAAS;AACvD,UAAM,EAAE,OAAO,IAAI,IAAI;AACvB,sBAAkB,MAAM,QAAQ,CAAC,QAAQ,CAAC;AAC1C,SAAK,YAAY,EAAE,GAAG,SAAS,QAAQ,MAAM,QAAQ,KAAK,CAAC;AAAA,EAC7D;AAAA,EAEQ,eAAe,MAAgB;AACrC,UAAM,UAAU,KAAK;AACrB,UAAM,aAAa,KAAK;AAExB,QAAI,KAAM,MAAK,QAAQ,IAAI;AAAA,QACtB,MAAK,QAAQ;AAElB,UAAM,UAAU,KAAK;AACrB,UAAM,aAAa,KAAK;AAExB,WAAO,EAAE,SAAS,YAAY,SAAS,WAAW;AAAA,EACpD;AAAA,EAEQ,UAA8B;AACpC,QAAI,CAAC,KAAK,QAAQ,CAAC,KAAK,SAAS;AAC/B,YAAM,OAAO,KAAK,IAAI,6CAAyC;AAC/D,WAAK,QAAQ,IAAI;AAAA,IACnB;AACA,WAAO,CAAC,KAAK,MAAO,KAAK,OAAQ;AAAA,EACnC;AAAA,EAEQ,YAAkB;AACxB,SAAK,OAAO;AACZ,SAAK,UAAU;AAAA,EACjB;AAAA,EAEQ,iBAAiB,cAAc,MAAwB;AAC7D,QAAI,eAAe,KAAK,cAAe,QAAO,KAAK;AACnD,SAAK,gBAAgB,KAAK,oBAAoB;AAC9C,SAAK,mBAAmB,KAAK,IAAI,QAAQ,SAAS,KAAK,aAAa;AACpE,SAAK,KAAK,iBAAiB,KAAK,gBAAgB;AAChD,WAAO,KAAK;AAAA,EACd;AAAA,EAEQ,uBAAuB,WAA4C;AACzE,UAAM,OAAO,KAAK,IAAI,QAAQ,IAAI,CAAC,CAAC;AACpC,UAAM,gBAAgB,yBAAiB,GAAG,MAAM,SAAS;AACzD,WAAO;AAAA,EACT;AAAA,EAEQ,wBAAwB,SAIR;AACtB,UAAM,EAAE,SAAS,eAAe,UAAU,IAAI;AAE9C,QACE,YAAY,UACZ,kBAAkB,UAClB,cAAc,QACd;AACA,aAAO;AAAA,IACT;AAEA,UAAM,gBAAgB,KAAK,IAAI,QAAQ,IAAI;AAAA,MACzC,MAAM;AAAA,MACN,IAAI;AAAA,MACJ,IAAI;AAAA,MACJ,IAAI;AAAA,IACN,CAAC;AAED,UAAM,MAAM,KAAK,KAAK,aAAa,MAAM,aAAa;AAEtD,WAAO;AAAA,EACT;AAAA,EAEQ,WAAW,OAAgB,GAAW,GAAW;AACvD,UAAM,YAAY,CAAC,MAAM,MAAM,YAAY,cAAc,KAAK,MAAM;AACpE,aAAS,MAAM,GAAG,MAAM,UAAU,QAAQ,MAAM,KAAK,OAAO;AAC1D,YAAM,OAAO,MAAM,OAAO,gBAAQ,GAAG,UAAU,GAAG,CAAC,CAAC;AACpD,UAAI,gBAAgB,iBAAU,MAAK,gBAAgB,GAAG,CAAC;AAAA,IACzD;AAEA,UAAM,WAAW,MAAM,OAAO,gBAAQ,GAAG,SAAS,CAAC;AACnD,QAAI,oBAAoB,kBAAU;AAChC,eAAS,MAAM,GAAG,MAAM,SAAS,KAAK,GAAG,MAAM,KAAK,OAAO;AACzD,cAAM,MAAM,SAAS,OAAO,GAAG;AAC/B,YAAI,eAAe,iBAAU,KAAI,gBAAgB,GAAG,CAAC;AAAA,MACvD;AAAA,IACF;AAAA,EACF;AACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA3gDE,cAZmB,UAYZ,MAAK,CAAC,UAAuB,KAAa,QAC/C,IAAI,SAAQ,UAAU,KAAK,GAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWhC,cAxBmB,UAwBZ,UAAS,CAAC,QAAqB;AACpC,WAAS,KAAK,OAAO,CAAC,CAAC,aAAa,aAAa,CAAC,CAAC;AACnD,QAAM,WAAW,eAAO,GAAG,EAAE;AAC7B,QAAM,WAAW,oBAAY,qBAAqB,IAAI,SAAS,QAAQ;AACvE,QAAM,UAAU,IAAI,QAAQ,SAAS,QAAQ;AAC7C,SAAO,IAAI,SAAQ,UAAU,SAAS,GAAG;AAC3C;AA9BF,IAAqB,UAArB;;;AC3BA,IAAqB,aAArB,MAAqB,mBAAkB,SAAS;AAAA,EAqBtC,YACN,gBACA,KACA,KACA;AACA,UAAM,gBAAgB,KAAK,GAAG;AAPhC;AAAA,wBAAS;AASP,aAAS,gBAAgB,cAAc;AAAA,MACrC,CAAC,2BAAmB,mBAAmB;AAAA,IACzC,CAAC;AAED,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,SAAS,OAAiB,4BAAmC;AAC3D,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,YAAM,YAAY,KAAK;AAAA,QACrB;AAAA,QACA;AAAA,QACA;AAAA,MACF;AACA,WAAK,wBAAwB,QAAQ,EAAE,QAAQ,UAAU,CAAC;AAAA,IAC5D;AAEA,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBA,YAAY,UAAkB;AAC5B,mBAAe,UAAU,UAAU;AACnC,SAAK,UAAU,YAAY,QAAQ;AACnC,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA6BA,UAEE,MACA,MACA,SACA;AACA,sBAAkB,MAAM,QAAQ,CAAC,QAAQ,CAAC;AAC1C,sBAAkB,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AACtD,iCAA6B,OAAO;AAGpC,UAAM,SAAS,KAAK,aAAa;AAAA,MAC/B,IAAI,SAAS,KAAK,MAAM,SAAS,eAAe,KAAK;AAAA,MACrD,IAAI,SAAS,KAAK,MAAM,SAAS,eAAe,KAAK;AAAA,MACrD,OAAO,SAAS,SAAS;AAAA,MACzB,QAAQ,SAAS,UAAU;AAAA,MAC3B,WAAW,SAAS,aAAa,IAAI,GAAG,GAAG,CAAC;AAAA,MAC5C,iBAAiB,SAAS,mBAAmB,IAAI,MAAM,MAAM,IAAI;AAAA,MACjE,aAAa,SAAS;AAAA,MACtB,aAAa,SAAS,eAAe;AAAA,MACrC,QAAQ,SAAS,UAAU,QAAQ,CAAC;AAAA,MACpC,SAAS;AAAA,MACT,QAAQ,SAAS;AAAA,MACjB,MAAM,KAAK;AAAA,IACb,CAAC;AACD,UAAM,YAAY,KAAK,IAAI,QAAQ,SAAS,OAAO,IAAI;AAGvD,SAAK,UAAU,UAAU,SAAS;AAGlC,UAAM,OAAO,SAAS,QAAQ,KAAK,IAAI,QAAQ,EAAE,eAAe;AAChE,SAAK,uBAAuB,QAAQ,IAAI;AAGxC,SAAK,KAAK,SAAS,SAAS;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,yBAAkC;AAChC,QAAI,KAAK,QAAQ,EAAG,QAAO;AAE3B,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,YAAM,iBACJ,OAAO,eAAe,GAAG,kBAAkB;AAC7C,UAAI,CAAC,eAAgB,QAAO;AAAA,IAC9B;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,yBAAyB,MAAe;AACtC,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,SAAK,kBAAkB,IAAI;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAqBA,kBACE,MACA,UACA;AACA,aAAS,MAAM,QAAQ,CAAC,CAAC,SAAS,SAAS,CAAC,CAAC;AAC7C,sBAAkB,UAAU,YAAY,CAAC,QAAQ,CAAC;AAElD,UAAM,UAAU,KAAK,UAAU,WAAW;AAC1C,aAAS,MAAM,GAAG,MAAM,QAAQ,QAAQ,MAAM,KAAK,OAAO;AACxD,YAAM,SAAS,QAAQ,GAAG;AAC1B,WAAK,uBAAuB,QAAQ,MAAM,QAAQ;AAAA,IACpD;AAAA,EACF;AAAA,EAEQ,uBACN,QACA,MACA,UACA;AACA,UAAM,aAAa,YAAY;AAC/B,UAAM,cAAc,oBAAoB,WAAW,MAAM,QAAQ,IAAI,CAAC;AACtE,SAAK,+BAA+B,QAAQ,MAAM,WAAW;AAAA,EAC/D;AACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA5NE,cAZmB,YAYZ,MAAK,CACV,gBACA,KACA,QACG,IAAI,WAAU,gBAAgB,KAAK,GAAG;AAhB7C,IAAqB,YAArB;","names":["chars","values","stream","CharCodes","pako","ENFORCER","ENFORCER","pool","PDFOperatorNames","pako","stream","Font","range","stream","FontNames","FontNames","scale","values","scale","AFRelationship","stream","stream","stream","stream","stream","stream","stream","NonFullScreenPageMode","ReadingDirection","PrintScaling","Duplex","flag","flag","values","AcroFieldFlags","AcroButtonFlags","AcroTextFlags","AcroChoiceFlags","values","flag","CarriageReturn","Newline","flag","AnnotationFlags","RotationTypes","rectangle","LineCapStyle","LineJoinStyle","TextRenderingMode","ColorTypes","scale","TextAlignment","chars","tfRegex","rectangle","scale","ImageAlignment","stream","rectangle","values","values","StandardFonts","rectangle","ParseSpeeds","BlendMode"]}